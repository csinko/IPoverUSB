ARM GAS  /tmp/ccWJL6at.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 2
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"usbd_ncm.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.ncm_dataStage,"ax",%progbits
  18              		.align	1
  19              		.p2align 2,,3
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	ncm_dataStage:
  27              	.LVL0:
  28              	.LFB154:
  29              		.file 1 "USBDevice/Class/CDC/usbd_ncm.c"
   1:USBDevice/Class/CDC/usbd_ncm.c **** /**
   2:USBDevice/Class/CDC/usbd_ncm.c ****   ******************************************************************************
   3:USBDevice/Class/CDC/usbd_ncm.c ****   * @file    usbd_ncm.c
   4:USBDevice/Class/CDC/usbd_ncm.c ****   * @author  Benedek Kupper
   5:USBDevice/Class/CDC/usbd_ncm.c ****   * @version 0.1
   6:USBDevice/Class/CDC/usbd_ncm.c ****   * @date    2018-06-02
   7:USBDevice/Class/CDC/usbd_ncm.c ****   * @brief   USB CDC Network Control Model implementation
   8:USBDevice/Class/CDC/usbd_ncm.c ****   *
   9:USBDevice/Class/CDC/usbd_ncm.c ****   * Copyright (c) 2018 Benedek Kupper
  10:USBDevice/Class/CDC/usbd_ncm.c ****   *
  11:USBDevice/Class/CDC/usbd_ncm.c ****   * Licensed under the Apache License, Version 2.0 (the "License");
  12:USBDevice/Class/CDC/usbd_ncm.c ****   * you may not use this file except in compliance with the License.
  13:USBDevice/Class/CDC/usbd_ncm.c ****   * You may obtain a copy of the License at
  14:USBDevice/Class/CDC/usbd_ncm.c ****   *
  15:USBDevice/Class/CDC/usbd_ncm.c ****   *     http://www.apache.org/licenses/LICENSE-2.0
  16:USBDevice/Class/CDC/usbd_ncm.c ****   *
  17:USBDevice/Class/CDC/usbd_ncm.c ****   * Unless required by applicable law or agreed to in writing, software
  18:USBDevice/Class/CDC/usbd_ncm.c ****   * distributed under the License is distributed on an "AS IS" BASIS,
  19:USBDevice/Class/CDC/usbd_ncm.c ****   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  20:USBDevice/Class/CDC/usbd_ncm.c ****   * See the License for the specific language governing permissions and
  21:USBDevice/Class/CDC/usbd_ncm.c ****   * limitations under the License.
  22:USBDevice/Class/CDC/usbd_ncm.c ****   */
  23:USBDevice/Class/CDC/usbd_ncm.c **** #include <private/usbd_internal.h>
  24:USBDevice/Class/CDC/usbd_ncm.c **** #include <usbd_ncm.h>
  25:USBDevice/Class/CDC/usbd_ncm.c **** #include <usbd_utils.h>
  26:USBDevice/Class/CDC/usbd_ncm.c **** 
  27:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_MAX_IF_COUNT < 2)
  28:USBDevice/Class/CDC/usbd_ncm.c **** #error "A single NCM interface takes up 2 device interface slots!"
  29:USBDevice/Class/CDC/usbd_ncm.c **** #endif
ARM GAS  /tmp/ccWJL6at.s 			page 2


  30:USBDevice/Class/CDC/usbd_ncm.c **** 
  31:USBDevice/Class/CDC/usbd_ncm.c **** #define NCM_NOT_INTR_INTERVAL   20
  32:USBDevice/Class/CDC/usbd_ncm.c **** #define NCM_NOT_PACKET_SIZE     8
  33:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_HS_SUPPORT == 1)
  34:USBDevice/Class/CDC/usbd_ncm.c **** #define NCM_DATA_PACKET_SIZE    USB_EP_BULK_HS_MPS
  35:USBDevice/Class/CDC/usbd_ncm.c **** #else
  36:USBDevice/Class/CDC/usbd_ncm.c **** #define NCM_DATA_PACKET_SIZE    USB_EP_BULK_FS_MPS
  37:USBDevice/Class/CDC/usbd_ncm.c **** #endif
  38:USBDevice/Class/CDC/usbd_ncm.c **** 
  39:USBDevice/Class/CDC/usbd_ncm.c **** #define NCM_MAX_SEGMENT_SIZE    1514
  40:USBDevice/Class/CDC/usbd_ncm.c **** 
  41:USBDevice/Class/CDC/usbd_ncm.c **** #define NCM_APP(ITF)    ((USBD_NCM_AppType*)((ITF)->App))
  42:USBDevice/Class/CDC/usbd_ncm.c **** 
  43:USBDevice/Class/CDC/usbd_ncm.c **** typedef enum
  44:USBDevice/Class/CDC/usbd_ncm.c **** {
  45:USBDevice/Class/CDC/usbd_ncm.c ****     NTB_EMPTY,
  46:USBDevice/Class/CDC/usbd_ncm.c ****     NTB_PROCESSING,
  47:USBDevice/Class/CDC/usbd_ncm.c ****     NTB_TRANSFERRING,
  48:USBDevice/Class/CDC/usbd_ncm.c ****     NTB_READY
  49:USBDevice/Class/CDC/usbd_ncm.c **** }NTBStateType;
  50:USBDevice/Class/CDC/usbd_ncm.c **** 
  51:USBDevice/Class/CDC/usbd_ncm.c **** 
  52:USBDevice/Class/CDC/usbd_ncm.c **** typedef union {
  53:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t b[4];
  54:USBDevice/Class/CDC/usbd_ncm.c ****     uint32_t dw;
  55:USBDevice/Class/CDC/usbd_ncm.c **** }USBD_NCM_SignatureType;
  56:USBDevice/Class/CDC/usbd_ncm.c **** 
  57:USBDevice/Class/CDC/usbd_ncm.c **** 
  58:USBDevice/Class/CDC/usbd_ncm.c **** /* NTB Header */
  59:USBDevice/Class/CDC/usbd_ncm.c **** typedef union
  60:USBDevice/Class/CDC/usbd_ncm.c **** {
  61:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
  62:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t Signature;     /* "NCMH" */
  63:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t HeaderLength;  /* Size in bytes of this NTH16 structure */
  64:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t Sequence;      /* Sequence number (for debugging) */
  65:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t BlockLength;   /* Size of this NTB in bytes */
  66:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t NdpIndex;      /* Offset of the first NDP16 from byte zero of the NTB */
  67:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed V16;
  68:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
  69:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t Signature;     /* "ncmh" */
  70:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t HeaderLength;  /* Size in bytes of this NTH32 structure */
  71:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t Sequence;      /* Sequence number (for debugging) */
  72:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t BlockLength;   /* Size of this NTB in bytes */
  73:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t NdpIndex;      /* Offset of the first NDP32 from byte zero of the NTB */
  74:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed V32;
  75:USBDevice/Class/CDC/usbd_ncm.c **** }USBD_NCM_TransferHeaderType;
  76:USBDevice/Class/CDC/usbd_ncm.c **** 
  77:USBDevice/Class/CDC/usbd_ncm.c **** 
  78:USBDevice/Class/CDC/usbd_ncm.c **** typedef struct {
  79:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t Index; /* Byte index of the datagram in the NTB */
  80:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t Length;/* Size in bytes of the datagram in the NTB */
  81:USBDevice/Class/CDC/usbd_ncm.c **** }__packed USBD_NCM_Datagram16;
  82:USBDevice/Class/CDC/usbd_ncm.c **** 
  83:USBDevice/Class/CDC/usbd_ncm.c **** 
  84:USBDevice/Class/CDC/usbd_ncm.c **** typedef struct {
  85:USBDevice/Class/CDC/usbd_ncm.c ****     uint32_t Index; /* Byte index of the datagram in the NTB */
  86:USBDevice/Class/CDC/usbd_ncm.c ****     uint32_t Length;/* Size in bytes of the datagram in the NTB */
ARM GAS  /tmp/ccWJL6at.s 			page 3


  87:USBDevice/Class/CDC/usbd_ncm.c **** }__packed USBD_NCM_Datagram32;
  88:USBDevice/Class/CDC/usbd_ncm.c **** 
  89:USBDevice/Class/CDC/usbd_ncm.c **** 
  90:USBDevice/Class/CDC/usbd_ncm.c **** /* NTB Datagram Pointer Table */
  91:USBDevice/Class/CDC/usbd_ncm.c **** typedef union
  92:USBDevice/Class/CDC/usbd_ncm.c **** {
  93:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
  94:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t Signature;     /* "NCM0" for no CRC, "NCM1" for CRC-32 */
  95:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t Length;        /* Size in bytes of this NDP16 structure */
  96:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t NextNdpIndex;  /* Offset of the next NDP16 from byte zero of the NTB */
  97:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_NCM_Datagram16 Datagram[1]; /* The last datagram index + header is always 0 */
  98:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed V16;
  99:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 100:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t Signature;     /*"ncm0" for no CRC, "ncm1" for CRC-32 */
 101:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t Length;        /* Size in bytes of this NDP32 structure */
 102:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t Reserved6;     /* Keep 0 */
 103:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t NextNdpIndex;  /* Offset of the next NDP32 from byte zero of the NTB */
 104:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t Reserved12;    /* Keep 0 */
 105:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_NCM_Datagram32 Datagram[1]; /* The last datagram index + header is always 0 */
 106:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed V32;
 107:USBDevice/Class/CDC/usbd_ncm.c **** }USBD_NCM_DatagramPointerTableType;
 108:USBDevice/Class/CDC/usbd_ncm.c **** 
 109:USBDevice/Class/CDC/usbd_ncm.c **** 
 110:USBDevice/Class/CDC/usbd_ncm.c **** /* NTB Parameters */
 111:USBDevice/Class/CDC/usbd_ncm.c **** typedef struct
 112:USBDevice/Class/CDC/usbd_ncm.c **** {
 113:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t Length;                /* Size in bytes of this NTBT structure */
 114:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NtbFormatsSupported;   /* 1 if only 16bit, 3 if 32bit is supported as well */
 115:USBDevice/Class/CDC/usbd_ncm.c ****     uint32_t NtbInMaxSize;          /* IN NTB Maximum Size in bytes */
 116:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NdpInDivisor;          /* Divisor used for IN NTB Datagram payload alignment */
 117:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NdpInPayloadRemainder; /* Remainder used to align input datagram payload within the NT
 118:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NdpInAlignment;        /* Datagram alignment */
 119:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t reserved;              /* Keep 0 */
 120:USBDevice/Class/CDC/usbd_ncm.c ****     uint32_t NtbOutMaxSize;
 121:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NdpOutDivisor;
 122:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NdpOutPayloadRemainder;
 123:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NdpOutAlignment;
 124:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t NtbOutMaxDatagrams;    /* Maximum number of datagrams in a single OUT NTB */
 125:USBDevice/Class/CDC/usbd_ncm.c **** }__packed USBD_NCM_ParametersType;
 126:USBDevice/Class/CDC/usbd_ncm.c **** 
 127:USBDevice/Class/CDC/usbd_ncm.c **** 
 128:USBDevice/Class/CDC/usbd_ncm.c **** typedef struct
 129:USBDevice/Class/CDC/usbd_ncm.c **** {
 130:USBDevice/Class/CDC/usbd_ncm.c ****     /* Interface Association Descriptor */
 131:USBDevice/Class/CDC/usbd_ncm.c ****     USB_IfAssocDescType IAD;
 132:USBDevice/Class/CDC/usbd_ncm.c ****     /* Communication Interface Descriptor */
 133:USBDevice/Class/CDC/usbd_ncm.c ****     USB_InterfaceDescType CID;
 134:USBDevice/Class/CDC/usbd_ncm.c ****     /* Header Functional Descriptor */
 135:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 136:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t bLength;
 137:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t bDescriptorType;
 138:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t bDescriptorSubtype;
 139:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t bcdCDC;
 140:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed HFD;
 141:USBDevice/Class/CDC/usbd_ncm.c ****     /* Union Functional Descriptor */
 142:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 143:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bFunctionLength;
ARM GAS  /tmp/ccWJL6at.s 			page 4


 144:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bDescriptorType;
 145:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bDescriptorSubtype;
 146:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bMasterInterface;
 147:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bSlaveInterface0;
 148:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed UFD;
 149:USBDevice/Class/CDC/usbd_ncm.c ****     /* Ethernet Networking Functional Descriptor */
 150:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 151:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bFunctionLength;
 152:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bDescriptorType;
 153:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bDescriptorSubtype;
 154:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  iMACAddress;
 155:USBDevice/Class/CDC/usbd_ncm.c ****         uint32_t bmEthernetStatistics;
 156:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t wMaxSegmentSize;
 157:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t wNumberMCFilters;
 158:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bNumberPowerFilters;
 159:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed ENFD;
 160:USBDevice/Class/CDC/usbd_ncm.c ****     /* NCM Functional Descriptor */
 161:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 162:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bFunctionLength;
 163:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bDescriptorType;
 164:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bDescriptorSubtype;
 165:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t bcdNcmVersion;
 166:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t  bmNetworkCapabilities;
 167:USBDevice/Class/CDC/usbd_ncm.c ****     }__packed NCMFD;
 168:USBDevice/Class/CDC/usbd_ncm.c ****     /* Notification Endpoint Descriptor */
 169:USBDevice/Class/CDC/usbd_ncm.c ****     USB_EndpointDescType NED;
 170:USBDevice/Class/CDC/usbd_ncm.c ****     /* Data Interface Descriptors */
 171:USBDevice/Class/CDC/usbd_ncm.c ****     USB_InterfaceDescType DID0;
 172:USBDevice/Class/CDC/usbd_ncm.c ****     USB_InterfaceDescType DID;
 173:USBDevice/Class/CDC/usbd_ncm.c ****     /* Endpoint descriptors are dynamically added */
 174:USBDevice/Class/CDC/usbd_ncm.c **** }__packed USBD_NCM_DescType;
 175:USBDevice/Class/CDC/usbd_ncm.c **** 
 176:USBDevice/Class/CDC/usbd_ncm.c **** 
 177:USBDevice/Class/CDC/usbd_ncm.c **** static const USBD_NCM_SignatureType nth16_sign =
 178:USBDevice/Class/CDC/usbd_ncm.c **** { .b = {'N', 'C', 'M', 'H'} };
 179:USBDevice/Class/CDC/usbd_ncm.c **** 
 180:USBDevice/Class/CDC/usbd_ncm.c **** static const USBD_NCM_SignatureType ndp16_sign =
 181:USBDevice/Class/CDC/usbd_ncm.c **** { .b = {'N', 'C', 'M', '0'} };
 182:USBDevice/Class/CDC/usbd_ncm.c **** 
 183:USBDevice/Class/CDC/usbd_ncm.c **** static const USBD_NCM_DescType ncm_desc = {
 184:USBDevice/Class/CDC/usbd_ncm.c ****     .IAD = { /* Interface Association Descriptor */
 185:USBDevice/Class/CDC/usbd_ncm.c ****         .bLength            = sizeof(ncm_desc.IAD),
 186:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType    = USB_DESC_TYPE_IAD,
 187:USBDevice/Class/CDC/usbd_ncm.c ****         .bFirstInterface    = 0,
 188:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceCount    = 2,
 189:USBDevice/Class/CDC/usbd_ncm.c ****         .bFunctionClass     = 0x02, /* bFunctionClass: Communication Interface Class */
 190:USBDevice/Class/CDC/usbd_ncm.c ****         .bFunctionSubClass  = 0x0D, /* bFunctionSubClass: Network Control Model */
 191:USBDevice/Class/CDC/usbd_ncm.c ****         .bFunctionProtocol  = 0x00, /* bFunctionProtocol: none */
 192:USBDevice/Class/CDC/usbd_ncm.c ****         .iFunction          = USBD_ISTR_INTERFACES,
 193:USBDevice/Class/CDC/usbd_ncm.c ****     },
 194:USBDevice/Class/CDC/usbd_ncm.c ****     .CID = { /* Comm Interface Descriptor */
 195:USBDevice/Class/CDC/usbd_ncm.c ****         .bLength            = sizeof(ncm_desc.CID),
 196:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType    = USB_DESC_TYPE_INTERFACE,
 197:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceNumber   = 0,
 198:USBDevice/Class/CDC/usbd_ncm.c ****         .bAlternateSetting  = 0,
 199:USBDevice/Class/CDC/usbd_ncm.c ****         .bNumEndpoints      = 1,
 200:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceClass    = 0x02, /* bInterfaceClass: Communication Interface Class */
ARM GAS  /tmp/ccWJL6at.s 			page 5


 201:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceSubClass = 0x0D, /* bInterfaceSubClass: Network Control Model */
 202:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceProtocol = 0x00, /* bInterfaceProtocol: none */
 203:USBDevice/Class/CDC/usbd_ncm.c ****         .iInterface         = USBD_ISTR_INTERFACES,
 204:USBDevice/Class/CDC/usbd_ncm.c ****     },
 205:USBDevice/Class/CDC/usbd_ncm.c ****     .HFD = { /* Header Functional Descriptor */
 206:USBDevice/Class/CDC/usbd_ncm.c ****         .bLength            = sizeof(ncm_desc.HFD),
 207:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType    = 0x24, /* bDescriptorType: CS_INTERFACE */
 208:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorSubtype = 0x00, /* bDescriptorSubtype: Header Func Desc */
 209:USBDevice/Class/CDC/usbd_ncm.c ****         .bcdCDC             = 0x110,/* bcdCDC: spec release number v1.10 */
 210:USBDevice/Class/CDC/usbd_ncm.c ****     },
 211:USBDevice/Class/CDC/usbd_ncm.c ****     .UFD = { /* Union Functional Descriptor */
 212:USBDevice/Class/CDC/usbd_ncm.c ****         .bFunctionLength    = sizeof(ncm_desc.UFD),
 213:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType    = 0x24, /* bDescriptorType: CS_INTERFACE */
 214:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorSubtype = 0x06, /* bDescriptorSubtype: Union func desc */
 215:USBDevice/Class/CDC/usbd_ncm.c ****         .bMasterInterface   = 0,
 216:USBDevice/Class/CDC/usbd_ncm.c ****         .bSlaveInterface0   = 1,
 217:USBDevice/Class/CDC/usbd_ncm.c ****     },
 218:USBDevice/Class/CDC/usbd_ncm.c ****     .ENFD = { /* Ethernet Networking Functional Descriptor */
 219:USBDevice/Class/CDC/usbd_ncm.c ****         .bFunctionLength        = sizeof(ncm_desc.ENFD),
 220:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType        = 0x24, /* bDescriptorType: CS_INTERFACE */
 221:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorSubtype     = 0x0F, /* bDescriptorSubtype: Ethernet Networking func desc */
 222:USBDevice/Class/CDC/usbd_ncm.c ****         .iMACAddress            = USBD_IIF_INDEX(0, 1),
 223:USBDevice/Class/CDC/usbd_ncm.c ****         .bmEthernetStatistics   = 0,
 224:USBDevice/Class/CDC/usbd_ncm.c ****         .wMaxSegmentSize        = NCM_MAX_SEGMENT_SIZE, /* The maximum supported segment size */
 225:USBDevice/Class/CDC/usbd_ncm.c ****         .wNumberMCFilters       = 0,
 226:USBDevice/Class/CDC/usbd_ncm.c ****         .bNumberPowerFilters    = 0,
 227:USBDevice/Class/CDC/usbd_ncm.c ****     },
 228:USBDevice/Class/CDC/usbd_ncm.c ****     .NCMFD = { /* NCM Functional Descriptor */
 229:USBDevice/Class/CDC/usbd_ncm.c ****         .bFunctionLength        = sizeof(ncm_desc.NCMFD),
 230:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType        = 0x24, /* bDescriptorType: CS_INTERFACE */
 231:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorSubtype     = 0x1A, /* bDescriptorSubtype: NCM func desc */
 232:USBDevice/Class/CDC/usbd_ncm.c ****         .bcdNcmVersion          = 0x0100,
 233:USBDevice/Class/CDC/usbd_ncm.c ****         .bmNetworkCapabilities  = 0, /* D1: GetNetAddress and SetNetAddress requests support */
 234:USBDevice/Class/CDC/usbd_ncm.c ****     },
 235:USBDevice/Class/CDC/usbd_ncm.c ****     .NED = { /* Notification Endpoint Descriptor */
 236:USBDevice/Class/CDC/usbd_ncm.c ****         .bLength            = sizeof(ncm_desc.NED),
 237:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType    = USB_DESC_TYPE_ENDPOINT,
 238:USBDevice/Class/CDC/usbd_ncm.c ****         .bEndpointAddress   = 0x82,
 239:USBDevice/Class/CDC/usbd_ncm.c ****         .bmAttributes       = USB_EP_TYPE_INTERRUPT,
 240:USBDevice/Class/CDC/usbd_ncm.c ****         .wMaxPacketSize     = NCM_NOT_PACKET_SIZE,
 241:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterval          = NCM_NOT_INTR_INTERVAL,
 242:USBDevice/Class/CDC/usbd_ncm.c ****     },
 243:USBDevice/Class/CDC/usbd_ncm.c ****     .DID0 = { /* Dummy data class interface descriptor */
 244:USBDevice/Class/CDC/usbd_ncm.c ****         .bLength = sizeof(ncm_desc.DID0),
 245:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType = USB_DESC_TYPE_INTERFACE,
 246:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceNumber   = 1,
 247:USBDevice/Class/CDC/usbd_ncm.c ****         .bAlternateSetting  = 0,
 248:USBDevice/Class/CDC/usbd_ncm.c ****         .bNumEndpoints      = 0,
 249:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceClass    = 0x0A, /* bInterfaceClass: Data Interface Class */
 250:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceSubClass = 0x00,
 251:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceProtocol = 0x01, /* bInterfaceProtocol: Network Transfer Block */
 252:USBDevice/Class/CDC/usbd_ncm.c ****         .iInterface         = 0,
 253:USBDevice/Class/CDC/usbd_ncm.c ****     },
 254:USBDevice/Class/CDC/usbd_ncm.c ****     .DID = { /* Data class interface descriptor */
 255:USBDevice/Class/CDC/usbd_ncm.c ****         .bLength = sizeof(ncm_desc.DID),
 256:USBDevice/Class/CDC/usbd_ncm.c ****         .bDescriptorType = USB_DESC_TYPE_INTERFACE,
 257:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceNumber   = 1,
ARM GAS  /tmp/ccWJL6at.s 			page 6


 258:USBDevice/Class/CDC/usbd_ncm.c ****         .bAlternateSetting  = 1,
 259:USBDevice/Class/CDC/usbd_ncm.c ****         .bNumEndpoints      = 2,
 260:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceClass    = 0x0A, /* bInterfaceClass: Data Interface Class */
 261:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceSubClass = 0x00,
 262:USBDevice/Class/CDC/usbd_ncm.c ****         .bInterfaceProtocol = 0x01, /* bInterfaceProtocol: Network Transfer Block */
 263:USBDevice/Class/CDC/usbd_ncm.c ****         .iInterface         = USBD_ISTR_INTERFACES,
 264:USBDevice/Class/CDC/usbd_ncm.c ****     },
 265:USBDevice/Class/CDC/usbd_ncm.c **** };
 266:USBDevice/Class/CDC/usbd_ncm.c **** 
 267:USBDevice/Class/CDC/usbd_ncm.c **** static uint16_t         ncm_getDesc     (USBD_NCM_IfHandleType *itf, uint8_t ifNum, uint8_t * dest)
 268:USBDevice/Class/CDC/usbd_ncm.c **** static const char *     ncm_getString   (USBD_NCM_IfHandleType *itf, uint8_t intNum);
 269:USBDevice/Class/CDC/usbd_ncm.c **** static void             ncm_init        (USBD_NCM_IfHandleType *itf);
 270:USBDevice/Class/CDC/usbd_ncm.c **** static void             ncm_deinit      (USBD_NCM_IfHandleType *itf);
 271:USBDevice/Class/CDC/usbd_ncm.c **** static USBD_ReturnType  ncm_setupStage  (USBD_NCM_IfHandleType *itf);
 272:USBDevice/Class/CDC/usbd_ncm.c **** static void             ncm_dataStage   (USBD_NCM_IfHandleType *itf);
 273:USBDevice/Class/CDC/usbd_ncm.c **** static void             ncm_outData     (USBD_NCM_IfHandleType *itf, USBD_EpHandleType *ep);
 274:USBDevice/Class/CDC/usbd_ncm.c **** static void             ncm_inData      (USBD_NCM_IfHandleType *itf, USBD_EpHandleType *ep);
 275:USBDevice/Class/CDC/usbd_ncm.c **** static void             ncm_sendNTB    (USBD_NCM_IfHandleType *itf, uint8_t page);
 276:USBDevice/Class/CDC/usbd_ncm.c **** 
 277:USBDevice/Class/CDC/usbd_ncm.c **** /* NCM interface class callbacks structure */
 278:USBDevice/Class/CDC/usbd_ncm.c **** static const USBD_ClassType ncm_cbks = {
 279:USBDevice/Class/CDC/usbd_ncm.c ****     .GetDescriptor  = (USBD_IfDescCbkType)  ncm_getDesc,
 280:USBDevice/Class/CDC/usbd_ncm.c ****     .GetString      = (USBD_IfStrCbkType)   ncm_getString,
 281:USBDevice/Class/CDC/usbd_ncm.c ****     .Init           = (USBD_IfCbkType)      ncm_init,
 282:USBDevice/Class/CDC/usbd_ncm.c ****     .Deinit         = (USBD_IfCbkType)      ncm_deinit,
 283:USBDevice/Class/CDC/usbd_ncm.c ****     .SetupStage     = (USBD_IfSetupCbkType) ncm_setupStage,
 284:USBDevice/Class/CDC/usbd_ncm.c ****     .DataStage      = (USBD_IfCbkType)      ncm_dataStage,
 285:USBDevice/Class/CDC/usbd_ncm.c ****     .OutData        = (USBD_IfEpCbkType)    ncm_outData,
 286:USBDevice/Class/CDC/usbd_ncm.c ****     .InData         = (USBD_IfEpCbkType)    ncm_inData,
 287:USBDevice/Class/CDC/usbd_ncm.c **** };
 288:USBDevice/Class/CDC/usbd_ncm.c **** 
 289:USBDevice/Class/CDC/usbd_ncm.c **** /** @ingroup USBD_NCM
 290:USBDevice/Class/CDC/usbd_ncm.c ****  * @defgroup USBD_NCM_Private_Functions NCM Private Functions
 291:USBDevice/Class/CDC/usbd_ncm.c ****  * @{ */
 292:USBDevice/Class/CDC/usbd_ncm.c **** 
 293:USBDevice/Class/CDC/usbd_ncm.c **** /**
 294:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Copies the interface descriptor to the destination buffer.
 295:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 296:USBDevice/Class/CDC/usbd_ncm.c ****  * @param ifNum: the index of the current interface in the device
 297:USBDevice/Class/CDC/usbd_ncm.c ****  * @param dest: the destination buffer
 298:USBDevice/Class/CDC/usbd_ncm.c ****  * @return Length of the copied descriptor
 299:USBDevice/Class/CDC/usbd_ncm.c ****  */
 300:USBDevice/Class/CDC/usbd_ncm.c **** static uint16_t ncm_getDesc(USBD_NCM_IfHandleType *itf, uint8_t ifNum, uint8_t * dest)
 301:USBDevice/Class/CDC/usbd_ncm.c **** {
 302:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DescType *desc = (USBD_NCM_DescType*)dest;
 303:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t len = sizeof(ncm_desc);
 304:USBDevice/Class/CDC/usbd_ncm.c **** 
 305:USBDevice/Class/CDC/usbd_ncm.c ****     memcpy(dest, &ncm_desc, sizeof(ncm_desc));
 306:USBDevice/Class/CDC/usbd_ncm.c **** 
 307:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_MAX_IF_COUNT > 2)
 308:USBDevice/Class/CDC/usbd_ncm.c ****     /* Adjustment of interface indexes */
 309:USBDevice/Class/CDC/usbd_ncm.c ****     desc->IAD.bFirstInterface  = ifNum;
 310:USBDevice/Class/CDC/usbd_ncm.c ****     desc->IAD.iFunction = USBD_IIF_INDEX(ifNum, 0);
 311:USBDevice/Class/CDC/usbd_ncm.c **** 
 312:USBDevice/Class/CDC/usbd_ncm.c ****     desc->CID.bInterfaceNumber = ifNum;
 313:USBDevice/Class/CDC/usbd_ncm.c ****     desc->UFD.bMasterInterface = ifNum;
 314:USBDevice/Class/CDC/usbd_ncm.c **** 
ARM GAS  /tmp/ccWJL6at.s 			page 7


 315:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID0.bInterfaceNumber = ifNum + 1;
 316:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID.bInterfaceNumber = ifNum + 1;
 317:USBDevice/Class/CDC/usbd_ncm.c ****     desc->UFD.bSlaveInterface0 = ifNum + 1;
 318:USBDevice/Class/CDC/usbd_ncm.c **** 
 319:USBDevice/Class/CDC/usbd_ncm.c ****     desc->CID.iInterface = USBD_IIF_INDEX(ifNum, 0);
 320:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID.iInterface = USBD_IIF_INDEX(ifNum, 0);
 321:USBDevice/Class/CDC/usbd_ncm.c ****     desc->ENFD.iMACAddress = USBD_IIF_INDEX(ifNum, 1);
 322:USBDevice/Class/CDC/usbd_ncm.c **** #endif /* (USBD_MAX_IF_COUNT > 2) */
 323:USBDevice/Class/CDC/usbd_ncm.c **** 
 324:USBDevice/Class/CDC/usbd_ncm.c ****     desc->NED.bEndpointAddress = itf->Config.NotEpNum;
 325:USBDevice/Class/CDC/usbd_ncm.c **** 
 326:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.OutEpNum, &dest[len]);
 327:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.InEpNum, &dest[len]);
 328:USBDevice/Class/CDC/usbd_ncm.c **** 
 329:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_HS_SUPPORT == 1)
 330:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Base.Device->Speed == USB_SPEED_FULL)
 331:USBDevice/Class/CDC/usbd_ncm.c ****     {
 332:USBDevice/Class/CDC/usbd_ncm.c ****         USB_EndpointDescType* ed = &dest[sizeof(ncm_desc)];
 333:USBDevice/Class/CDC/usbd_ncm.c ****         ed[0].wMaxPacketSize = USB_EP_BULK_FS_MPS;
 334:USBDevice/Class/CDC/usbd_ncm.c ****         ed[1].wMaxPacketSize = USB_EP_BULK_FS_MPS;
 335:USBDevice/Class/CDC/usbd_ncm.c ****     }
 336:USBDevice/Class/CDC/usbd_ncm.c **** #endif
 337:USBDevice/Class/CDC/usbd_ncm.c **** 
 338:USBDevice/Class/CDC/usbd_ncm.c ****     return len;
 339:USBDevice/Class/CDC/usbd_ncm.c **** }
 340:USBDevice/Class/CDC/usbd_ncm.c **** 
 341:USBDevice/Class/CDC/usbd_ncm.c **** /**
 342:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Returns the selected interface string (either the name or the MAC address).
 343:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 344:USBDevice/Class/CDC/usbd_ncm.c ****  * @param intNum: interface-internal string index
 345:USBDevice/Class/CDC/usbd_ncm.c ****  * @return The referenced string
 346:USBDevice/Class/CDC/usbd_ncm.c ****  */
 347:USBDevice/Class/CDC/usbd_ncm.c **** static const char* ncm_getString(USBD_NCM_IfHandleType *itf, uint8_t intNum)
 348:USBDevice/Class/CDC/usbd_ncm.c **** {
 349:USBDevice/Class/CDC/usbd_ncm.c ****     const char* str;
 350:USBDevice/Class/CDC/usbd_ncm.c ****     if (intNum == 0)
 351:USBDevice/Class/CDC/usbd_ncm.c ****     {
 352:USBDevice/Class/CDC/usbd_ncm.c ****         str = NCM_APP(itf)->Name;
 353:USBDevice/Class/CDC/usbd_ncm.c ****     }
 354:USBDevice/Class/CDC/usbd_ncm.c ****     else
 355:USBDevice/Class/CDC/usbd_ncm.c ****     {
 356:USBDevice/Class/CDC/usbd_ncm.c ****         /* Allocate string after the end of the string descriptor */
 357:USBDevice/Class/CDC/usbd_ncm.c ****         str = (void*)itf->Base.Device->CtrlData + 2 +
 358:USBDevice/Class/CDC/usbd_ncm.c ****                 sizeof(*NCM_APP(itf)->NetAddress) * 4;
 359:USBDevice/Class/CDC/usbd_ncm.c ****         Uint2Unicode((void*)NCM_APP(itf)->NetAddress, (void*)str,
 360:USBDevice/Class/CDC/usbd_ncm.c ****                 2 * sizeof(*NCM_APP(itf)->NetAddress));
 361:USBDevice/Class/CDC/usbd_ncm.c ****     }
 362:USBDevice/Class/CDC/usbd_ncm.c ****     return str;
 363:USBDevice/Class/CDC/usbd_ncm.c **** }
 364:USBDevice/Class/CDC/usbd_ncm.c **** 
 365:USBDevice/Class/CDC/usbd_ncm.c **** /**
 366:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Initializes the interface by opening its notification endpoint
 367:USBDevice/Class/CDC/usbd_ncm.c ****  *        and initializing the attached application (only if alt selector == 1).
 368:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 369:USBDevice/Class/CDC/usbd_ncm.c ****  */
 370:USBDevice/Class/CDC/usbd_ncm.c **** static void ncm_init(USBD_NCM_IfHandleType *itf)
 371:USBDevice/Class/CDC/usbd_ncm.c **** {
ARM GAS  /tmp/ccWJL6at.s 			page 8


 372:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Base.AltSelector == 1)
 373:USBDevice/Class/CDC/usbd_ncm.c ****     {
 374:USBDevice/Class/CDC/usbd_ncm.c ****         /* Open notification EP */
 375:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpOpen(itf->Base.Device, itf->Config.NotEpNum,
 376:USBDevice/Class/CDC/usbd_ncm.c ****                 USB_EP_TYPE_INTERRUPT, NCM_NOT_PACKET_SIZE);
 377:USBDevice/Class/CDC/usbd_ncm.c **** 
 378:USBDevice/Class/CDC/usbd_ncm.c ****         /* Initialize application */
 379:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_SAFE_CALLBACK(NCM_APP(itf)->Init, itf);
 380:USBDevice/Class/CDC/usbd_ncm.c ****     }
 381:USBDevice/Class/CDC/usbd_ncm.c ****     else
 382:USBDevice/Class/CDC/usbd_ncm.c ****     {
 383:USBDevice/Class/CDC/usbd_ncm.c ****         /* Set initial max IN NTB size */
 384:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.MaxSize = sizeof(itf->In.Data[0]);
 385:USBDevice/Class/CDC/usbd_ncm.c **** 
 386:USBDevice/Class/CDC/usbd_ncm.c ****         /* TODO reset MAC address to default */
 387:USBDevice/Class/CDC/usbd_ncm.c ****     }
 388:USBDevice/Class/CDC/usbd_ncm.c **** }
 389:USBDevice/Class/CDC/usbd_ncm.c **** 
 390:USBDevice/Class/CDC/usbd_ncm.c **** /**
 391:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Deinitializes the interface by closing its endpoints
 392:USBDevice/Class/CDC/usbd_ncm.c ****  *        and deinitializing the attached application (only if alt selector == 1).
 393:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 394:USBDevice/Class/CDC/usbd_ncm.c ****  */
 395:USBDevice/Class/CDC/usbd_ncm.c **** static void ncm_deinit(USBD_NCM_IfHandleType *itf)
 396:USBDevice/Class/CDC/usbd_ncm.c **** {
 397:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Notify.Connection.Value = 0;
 398:USBDevice/Class/CDC/usbd_ncm.c **** 
 399:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Base.AltSelector == 1)
 400:USBDevice/Class/CDC/usbd_ncm.c ****     {
 401:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_HandleType *dev = itf->Base.Device;
 402:USBDevice/Class/CDC/usbd_ncm.c **** 
 403:USBDevice/Class/CDC/usbd_ncm.c ****         /* Close all EPs */
 404:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.InEpNum);
 405:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.OutEpNum);
 406:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.NotEpNum);
 407:USBDevice/Class/CDC/usbd_ncm.c **** 
 408:USBDevice/Class/CDC/usbd_ncm.c ****         /* Deinitialize application */
 409:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_SAFE_CALLBACK(NCM_APP(itf)->Deinit, itf);
 410:USBDevice/Class/CDC/usbd_ncm.c **** 
 411:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_HS_SUPPORT == 1)
 412:USBDevice/Class/CDC/usbd_ncm.c ****         /* Reset the endpoint MPS to the desired size */
 413:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpAddr2Ref(dev, itf->Config.InEpNum)->MaxPacketSize  = NCM_DATA_PACKET_SIZE;
 414:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpAddr2Ref(dev, itf->Config.OutEpNum)->MaxPacketSize = NCM_DATA_PACKET_SIZE;
 415:USBDevice/Class/CDC/usbd_ncm.c **** #endif
 416:USBDevice/Class/CDC/usbd_ncm.c ****     }
 417:USBDevice/Class/CDC/usbd_ncm.c **** }
 418:USBDevice/Class/CDC/usbd_ncm.c **** 
 419:USBDevice/Class/CDC/usbd_ncm.c **** /**
 420:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Performs the interface-specific setup request handling.
 421:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 422:USBDevice/Class/CDC/usbd_ncm.c ****  * @return OK if the setup request is accepted, INVALID otherwise
 423:USBDevice/Class/CDC/usbd_ncm.c ****  */
 424:USBDevice/Class/CDC/usbd_ncm.c **** static USBD_ReturnType ncm_setupStage(USBD_NCM_IfHandleType *itf)
 425:USBDevice/Class/CDC/usbd_ncm.c **** {
 426:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 427:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_HandleType *dev = itf->Base.Device;
 428:USBDevice/Class/CDC/usbd_ncm.c **** 
ARM GAS  /tmp/ccWJL6at.s 			page 9


 429:USBDevice/Class/CDC/usbd_ncm.c ****     if (dev->Setup.RequestType.Type == USB_REQ_TYPE_CLASS)
 430:USBDevice/Class/CDC/usbd_ncm.c ****     {
 431:USBDevice/Class/CDC/usbd_ncm.c ****         switch (dev->Setup.Request)
 432:USBDevice/Class/CDC/usbd_ncm.c ****         {
 433:USBDevice/Class/CDC/usbd_ncm.c ****             /* Mandatory requests */
 434:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_GET_NTB_PARAMETERS:
 435:USBDevice/Class/CDC/usbd_ncm.c ****             {
 436:USBDevice/Class/CDC/usbd_ncm.c ****                 USBD_NCM_ParametersType* param  = (void*)dev->CtrlData;
 437:USBDevice/Class/CDC/usbd_ncm.c **** 
 438:USBDevice/Class/CDC/usbd_ncm.c ****                 param->Length                   = sizeof(USBD_NCM_ParametersType);
 439:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbFormatsSupported      = 1; /* only 16 bit NTB for now */
 440:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbInMaxSize             = USBD_NCM_MAX_IN_SIZE;
 441:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInDivisor             = 4;
 442:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInAlignment           = 4;
 443:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInPayloadRemainder    = 0;
 444:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbOutMaxSize            = USBD_NCM_MAX_OUT_SIZE;
 445:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutDivisor            = 4;
 446:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutAlignment          = 4;
 447:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutPayloadRemainder   = 0;
 448:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbOutMaxDatagrams       = 20; /* Number is arbitrary, any number is support
 449:USBDevice/Class/CDC/usbd_ncm.c ****                 param->reserved                 = 0;
 450:USBDevice/Class/CDC/usbd_ncm.c **** 
 451:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, sizeof(*param));
 452:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 453:USBDevice/Class/CDC/usbd_ncm.c ****             }
 454:USBDevice/Class/CDC/usbd_ncm.c **** 
 455:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_GET_NTB_INPUT_SIZE:
 456:USBDevice/Class/CDC/usbd_ncm.c ****             {
 457:USBDevice/Class/CDC/usbd_ncm.c ****                 struct {
 458:USBDevice/Class/CDC/usbd_ncm.c ****                     uint32_t size;
 459:USBDevice/Class/CDC/usbd_ncm.c ****                 }__packed *insize = (void*)dev->CtrlData;
 460:USBDevice/Class/CDC/usbd_ncm.c ****                 insize->size = itf->In.MaxSize;
 461:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, sizeof(*insize));
 462:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 463:USBDevice/Class/CDC/usbd_ncm.c ****             }
 464:USBDevice/Class/CDC/usbd_ncm.c **** 
 465:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_SET_NTB_INPUT_SIZE:
 466:USBDevice/Class/CDC/usbd_ncm.c ****             {
 467:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlReceiveData(dev, dev->CtrlData);
 468:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 469:USBDevice/Class/CDC/usbd_ncm.c ****             }
 470:USBDevice/Class/CDC/usbd_ncm.c **** 
 471:USBDevice/Class/CDC/usbd_ncm.c **** #if 0
 472:USBDevice/Class/CDC/usbd_ncm.c ****             /* Optional requests */
 473:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_GET_NET_ADDRESS:
 474:USBDevice/Class/CDC/usbd_ncm.c ****                 /* TODO */
 475:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 476:USBDevice/Class/CDC/usbd_ncm.c **** 
 477:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_SET_NET_ADDRESS:
 478:USBDevice/Class/CDC/usbd_ncm.c ****                 /* Only accepted while data interface alt sel = 0
 479:USBDevice/Class/CDC/usbd_ncm.c ****                  * doesn't change iMACAddress value */
 480:USBDevice/Class/CDC/usbd_ncm.c ****                 if (itf->Base.AltSelector == 0)
 481:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 482:USBDevice/Class/CDC/usbd_ncm.c ****                     retval = USBD_CtrlReceiveData(dev, dev->CtrlData);
 483:USBDevice/Class/CDC/usbd_ncm.c ****                 }
 484:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 485:USBDevice/Class/CDC/usbd_ncm.c **** 
ARM GAS  /tmp/ccWJL6at.s 			page 10


 486:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_GET_NTB_FORMAT:
 487:USBDevice/Class/CDC/usbd_ncm.c ****                 *((__packed uint16_t*)dev->CtrlData) = 0;
 488:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, 2);
 489:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 490:USBDevice/Class/CDC/usbd_ncm.c **** 
 491:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_SET_NTB_FORMAT:
 492:USBDevice/Class/CDC/usbd_ncm.c ****                 /* Value = 1 for 32 bit format */
 493:USBDevice/Class/CDC/usbd_ncm.c ****                 if (dev->Setup.Value == 0)
 494:USBDevice/Class/CDC/usbd_ncm.c ****                 {   retval = USBD_E_OK; }
 495:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 496:USBDevice/Class/CDC/usbd_ncm.c **** #endif
 497:USBDevice/Class/CDC/usbd_ncm.c ****             default:
 498:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 499:USBDevice/Class/CDC/usbd_ncm.c ****         }
 500:USBDevice/Class/CDC/usbd_ncm.c ****     }
 501:USBDevice/Class/CDC/usbd_ncm.c **** 
 502:USBDevice/Class/CDC/usbd_ncm.c ****     return retval;
 503:USBDevice/Class/CDC/usbd_ncm.c **** }
 504:USBDevice/Class/CDC/usbd_ncm.c **** 
 505:USBDevice/Class/CDC/usbd_ncm.c **** /**
 506:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Updates interface from data received through the control pipe.
 507:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 508:USBDevice/Class/CDC/usbd_ncm.c ****  */
 509:USBDevice/Class/CDC/usbd_ncm.c **** static void ncm_dataStage(USBD_NCM_IfHandleType *itf)
 510:USBDevice/Class/CDC/usbd_ncm.c **** {
  30              		.loc 1 510 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
 511:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_HandleType *dev = itf->Base.Device;
  35              		.loc 1 511 5 view .LVU1
  36              		.loc 1 511 22 is_stmt 0 view .LVU2
  37 0000 0368     		ldr	r3, [r0]
  38              	.LVL1:
 512:USBDevice/Class/CDC/usbd_ncm.c **** 
 513:USBDevice/Class/CDC/usbd_ncm.c ****     if (dev->Setup.RequestType.Direction == USB_DIRECTION_OUT)
  39              		.loc 1 513 5 is_stmt 1 view .LVU3
  40              		.loc 1 513 8 is_stmt 0 view .LVU4
  41 0002 93F90420 		ldrsb	r2, [r3, #4]
  42 0006 002A     		cmp	r2, #0
  43 0008 02DB     		blt	.L1
 514:USBDevice/Class/CDC/usbd_ncm.c ****     {
 515:USBDevice/Class/CDC/usbd_ncm.c ****         switch (dev->Setup.Request)
  44              		.loc 1 515 9 is_stmt 1 view .LVU5
  45 000a 5A79     		ldrb	r2, [r3, #5]	@ zero_extendqisi2
  46 000c 862A     		cmp	r2, #134
  47 000e 00D0     		beq	.L4
  48              	.LVL2:
  49              	.L1:
 516:USBDevice/Class/CDC/usbd_ncm.c ****         {
 517:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_SET_NTB_INPUT_SIZE:
 518:USBDevice/Class/CDC/usbd_ncm.c ****             {
 519:USBDevice/Class/CDC/usbd_ncm.c ****                 struct {
 520:USBDevice/Class/CDC/usbd_ncm.c ****                     uint32_t size;
 521:USBDevice/Class/CDC/usbd_ncm.c ****                 }__packed *insize = (void*)dev->CtrlData;
 522:USBDevice/Class/CDC/usbd_ncm.c ****                 /* Sanity check */
ARM GAS  /tmp/ccWJL6at.s 			page 11


 523:USBDevice/Class/CDC/usbd_ncm.c ****                 if (insize->size > (sizeof(((USBD_NCM_TransferHeaderType*)0)->V16) +
 524:USBDevice/Class/CDC/usbd_ncm.c ****                                     sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16)))
 525:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 526:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->In.MaxSize = insize->size;
 527:USBDevice/Class/CDC/usbd_ncm.c ****                 }
 528:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 529:USBDevice/Class/CDC/usbd_ncm.c ****             }
 530:USBDevice/Class/CDC/usbd_ncm.c **** #if 0
 531:USBDevice/Class/CDC/usbd_ncm.c ****             case CDC_REQ_SET_NET_ADDRESS:
 532:USBDevice/Class/CDC/usbd_ncm.c ****                 /* TODO */
 533:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 534:USBDevice/Class/CDC/usbd_ncm.c **** #endif
 535:USBDevice/Class/CDC/usbd_ncm.c ****             default:
 536:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 537:USBDevice/Class/CDC/usbd_ncm.c ****         }
 538:USBDevice/Class/CDC/usbd_ncm.c ****     }
 539:USBDevice/Class/CDC/usbd_ncm.c **** }
  50              		.loc 1 539 1 is_stmt 0 view .LVU6
  51 0010 7047     		bx	lr
  52              	.LVL3:
  53              	.L4:
  54              	.LBB75:
 519:USBDevice/Class/CDC/usbd_ncm.c ****                     uint32_t size;
  55              		.loc 1 519 17 is_stmt 1 view .LVU7
 523:USBDevice/Class/CDC/usbd_ncm.c ****                                     sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16)))
  56              		.loc 1 523 17 view .LVU8
 523:USBDevice/Class/CDC/usbd_ncm.c ****                                     sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16)))
  57              		.loc 1 523 27 is_stmt 0 view .LVU9
  58 0012 D3F80C31 		ldr	r3, [r3, #268]	@ unaligned
  59              	.LVL4:
 523:USBDevice/Class/CDC/usbd_ncm.c ****                                     sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16)))
  60              		.loc 1 523 20 view .LVU10
  61 0016 182B     		cmp	r3, #24
  62 0018 FAD9     		bls	.L1
 526:USBDevice/Class/CDC/usbd_ncm.c ****                 }
  63              		.loc 1 526 21 is_stmt 1 view .LVU11
 526:USBDevice/Class/CDC/usbd_ncm.c ****                 }
  64              		.loc 1 526 37 is_stmt 0 view .LVU12
  65 001a 42F23402 		movw	r2, #8244
  66 001e 8350     		str	r3, [r0, r2]
  67              	.LBE75:
  68              		.loc 1 539 1 view .LVU13
  69 0020 7047     		bx	lr
  70              		.cfi_endproc
  71              	.LFE154:
  73 0022 00BF     		.section	.text.ncm_sendNTB,"ax",%progbits
  74              		.align	1
  75              		.p2align 2,,3
  76              		.syntax unified
  77              		.thumb
  78              		.thumb_func
  79              		.fpu fpv4-sp-d16
  81              	ncm_sendNTB:
  82              	.LVL5:
  83              	.LFB156:
 540:USBDevice/Class/CDC/usbd_ncm.c **** 
 541:USBDevice/Class/CDC/usbd_ncm.c **** /**
ARM GAS  /tmp/ccWJL6at.s 			page 12


 542:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Starts another NTB OUT transfer if the other buffer page is empty
 543:USBDevice/Class/CDC/usbd_ncm.c ****  *        and sets the ready flag for the current page for application consumption.
 544:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 545:USBDevice/Class/CDC/usbd_ncm.c ****  * @param ep: reference to the endpoint structure
 546:USBDevice/Class/CDC/usbd_ncm.c ****  */
 547:USBDevice/Class/CDC/usbd_ncm.c **** static void ncm_outData(USBD_NCM_IfHandleType *itf, USBD_EpHandleType *ep)
 548:USBDevice/Class/CDC/usbd_ncm.c **** {
 549:USBDevice/Class/CDC/usbd_ncm.c ****     /* Save transfer details */
 550:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth = (void*)ep->Transfer.Data - ep->Transfer.Length;
 551:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t rxPage = ((void*)itf->Out.Data[0] == (void*)nth) ? 0 : 1, page = rxPage;
 552:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Out.State[rxPage] = NTB_EMPTY;
 553:USBDevice/Class/CDC/usbd_ncm.c **** 
 554:USBDevice/Class/CDC/usbd_ncm.c ****     /* Verify header */
 555:USBDevice/Class/CDC/usbd_ncm.c ****     if ((nth->V16.BlockLength  == ep->Transfer.Length) &&
 556:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.HeaderLength == sizeof(nth->V16)) &&
 557:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.Signature    == nth16_sign.dw))
 558:USBDevice/Class/CDC/usbd_ncm.c ****     {
 559:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t ndpIndex = nth->V16.NdpIndex;
 560:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_NCM_DatagramPointerTableType* pt = (void*)nth + ndpIndex;
 561:USBDevice/Class/CDC/usbd_ncm.c **** 
 562:USBDevice/Class/CDC/usbd_ncm.c ****         /* Verify all tables in advance */
 563:USBDevice/Class/CDC/usbd_ncm.c ****         while ((ndpIndex > sizeof(nth->V16)) &&
 564:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 565:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Signature == ndp16_sign.dw) &&
 566:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Length > sizeof(pt->V16)))
 567:USBDevice/Class/CDC/usbd_ncm.c ****         {
 568:USBDevice/Class/CDC/usbd_ncm.c ****             ndpIndex = pt->V16.NextNdpIndex;
 569:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + ndpIndex;
 570:USBDevice/Class/CDC/usbd_ncm.c **** 
 571:USBDevice/Class/CDC/usbd_ncm.c ****             /* Indicates last NDP */
 572:USBDevice/Class/CDC/usbd_ncm.c ****             if (ndpIndex == 0)
 573:USBDevice/Class/CDC/usbd_ncm.c ****             {
 574:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.State[rxPage] = NTB_READY;
 575:USBDevice/Class/CDC/usbd_ncm.c ****                 page = 1 - rxPage;
 576:USBDevice/Class/CDC/usbd_ncm.c **** 
 577:USBDevice/Class/CDC/usbd_ncm.c ****                 /* If the previous buffer is processed, pass the newly received */
 578:USBDevice/Class/CDC/usbd_ncm.c ****                 if (itf->Out.State[page] == NTB_EMPTY)
 579:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 580:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.Page = rxPage;
 581:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.PT = (void*)nth + nth->V16.NdpIndex;
 582:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.Dx = 0;
 583:USBDevice/Class/CDC/usbd_ncm.c ****                 }
 584:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 585:USBDevice/Class/CDC/usbd_ncm.c ****             }
 586:USBDevice/Class/CDC/usbd_ncm.c ****         }
 587:USBDevice/Class/CDC/usbd_ncm.c ****     }
 588:USBDevice/Class/CDC/usbd_ncm.c **** 
 589:USBDevice/Class/CDC/usbd_ncm.c ****     /* Receive to empty page */
 590:USBDevice/Class/CDC/usbd_ncm.c ****     if ((itf->Out.State[page] == NTB_EMPTY) &&
 591:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Notify.Connection.Value != 0))
 592:USBDevice/Class/CDC/usbd_ncm.c ****     {
 593:USBDevice/Class/CDC/usbd_ncm.c ****         /* Start receiving in other buffer */
 594:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpReceive(itf->Base.Device, itf->Config.OutEpNum,
 595:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 596:USBDevice/Class/CDC/usbd_ncm.c **** 
 597:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.State[page] = NTB_TRANSFERRING;
 598:USBDevice/Class/CDC/usbd_ncm.c ****     }
ARM GAS  /tmp/ccWJL6at.s 			page 13


 599:USBDevice/Class/CDC/usbd_ncm.c **** 
 600:USBDevice/Class/CDC/usbd_ncm.c ****     /* Signal the availability of new datagram(s) */
 601:USBDevice/Class/CDC/usbd_ncm.c ****     if ((NCM_APP(itf)->Received != NULL) &&
 602:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Out.State[rxPage] == NTB_READY))
 603:USBDevice/Class/CDC/usbd_ncm.c ****     {
 604:USBDevice/Class/CDC/usbd_ncm.c ****         NCM_APP(itf)->Received(itf);
 605:USBDevice/Class/CDC/usbd_ncm.c ****     }
 606:USBDevice/Class/CDC/usbd_ncm.c **** }
 607:USBDevice/Class/CDC/usbd_ncm.c **** 
 608:USBDevice/Class/CDC/usbd_ncm.c **** /**
 609:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Sets the missing NTB fields and sends it through the data IN endpoint.
 610:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 611:USBDevice/Class/CDC/usbd_ncm.c ****  * @param page: the IN buffer page to send
 612:USBDevice/Class/CDC/usbd_ncm.c ****  */
 613:USBDevice/Class/CDC/usbd_ncm.c **** static void ncm_sendNTB(USBD_NCM_IfHandleType *itf, uint8_t page)
 614:USBDevice/Class/CDC/usbd_ncm.c **** {
  84              		.loc 1 614 1 is_stmt 1 view -0
  85              		.cfi_startproc
  86              		@ args = 0, pretend = 0, frame = 0
  87              		@ frame_needed = 0, uses_anonymous_args = 0
 615:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth = (void*)itf->In.Data[page];
  88              		.loc 1 615 5 view .LVU15
 614:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth = (void*)itf->In.Data[page];
  89              		.loc 1 614 1 is_stmt 0 view .LVU16
  90 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  91              	.LCFI0:
  92              		.cfi_def_cfa_offset 32
  93              		.cfi_offset 3, -32
  94              		.cfi_offset 4, -28
  95              		.cfi_offset 5, -24
  96              		.cfi_offset 6, -20
  97              		.cfi_offset 7, -16
  98              		.cfi_offset 8, -12
  99              		.cfi_offset 9, -8
 100              		.cfi_offset 14, -4
 101              		.loc 1 615 34 view .LVU17
 102 0004 41F23404 		movw	r4, #4148
 614:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth = (void*)itf->In.Data[page];
 103              		.loc 1 614 1 view .LVU18
 104 0008 0646     		mov	r6, r0
 616:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DatagramPointerTableType* pt = (void*)nth + itf->In.Index;
 105              		.loc 1 616 65 view .LVU19
 106 000a 42F23C02 		movw	r2, #8252
 617:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 618:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t length;
 619:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t reserved;
 620:USBDevice/Class/CDC/usbd_ncm.c ****     }*dp = (void*)nth + sizeof(itf->In.Data[0]) - sizeof(*dp);
 621:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_Datagram16 *dg = &pt->V16.Datagram[0];
 622:USBDevice/Class/CDC/usbd_ncm.c ****     int i;
 623:USBDevice/Class/CDC/usbd_ncm.c **** 
 624:USBDevice/Class/CDC/usbd_ncm.c ****     /* Set table header */
 625:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.Signature       = ndp16_sign.dw;
 107              		.loc 1 625 41 view .LVU20
 108 000e 404B     		ldr	r3, .L14
 614:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth = (void*)itf->In.Data[page];
 109              		.loc 1 614 1 view .LVU21
 110 0010 0F46     		mov	r7, r1
ARM GAS  /tmp/ccWJL6at.s 			page 14


 615:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DatagramPointerTableType* pt = (void*)nth + itf->In.Index;
 111              		.loc 1 615 34 view .LVU22
 112 0012 04EBC121 		add	r1, r4, r1, lsl #11
 113              	.LVL6:
 616:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 114              		.loc 1 616 65 view .LVU23
 115 0016 36F802C0 		ldrh	ip, [r6, r2]
 626:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.Length          = sizeof(pt->V16) + (itf->In.DgCount * sizeof(pt->V16.Datagram[0]));
 116              		.loc 1 626 57 view .LVU24
 117 001a 42F23F00 		movw	r0, #8255
 118              	.LVL7:
 615:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DatagramPointerTableType* pt = (void*)nth + itf->In.Index;
 119              		.loc 1 615 34 view .LVU25
 120 001e 06EB0108 		add	r8, r6, r1
 121              	.LVL8:
 616:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 122              		.loc 1 616 5 is_stmt 1 view .LVU26
 625:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.Length          = sizeof(pt->V16) + (itf->In.DgCount * sizeof(pt->V16.Datagram[0]));
 123              		.loc 1 625 29 is_stmt 0 view .LVU27
 124 0022 1D68     		ldr	r5, [r3]
 627:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 628:USBDevice/Class/CDC/usbd_ncm.c **** 
 629:USBDevice/Class/CDC/usbd_ncm.c ****     /* Set header fields */
 630:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.Signature      = nth16_sign.dw;
 631:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.HeaderLength   = sizeof(nth->V16);
 632:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.BlockLength    = sizeof(nth->V16) + itf->In.Index + pt->V16.Length;
 125              		.loc 1 632 64 view .LVU28
 126 0024 0CF10C02 		add	r2, ip, #12
 630:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.HeaderLength   = sizeof(nth->V16);
 127              		.loc 1 630 41 view .LVU29
 128 0028 3A4B     		ldr	r3, .L14+4
 625:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.Length          = sizeof(pt->V16) + (itf->In.DgCount * sizeof(pt->V16.Datagram[0]));
 129              		.loc 1 625 29 view .LVU30
 130 002a 48F80C50 		str	r5, [r8, ip]	@ unaligned
 627:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 131              		.loc 1 627 29 view .LVU31
 132 002e 0024     		movs	r4, #0
 626:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 133              		.loc 1 626 57 view .LVU32
 134 0030 305C     		ldrb	r0, [r6, r0]	@ zero_extendqisi2
 616:USBDevice/Class/CDC/usbd_ncm.c ****     struct {
 135              		.loc 1 616 40 view .LVU33
 136 0032 08EB0C05 		add	r5, r8, ip
 137              	.LVL9:
 617:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t length;
 138              		.loc 1 617 5 is_stmt 1 view .LVU34
 621:USBDevice/Class/CDC/usbd_ncm.c ****     int i;
 139              		.loc 1 621 5 view .LVU35
 630:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.HeaderLength   = sizeof(nth->V16);
 140              		.loc 1 630 29 is_stmt 0 view .LVU36
 141 0036 1B68     		ldr	r3, [r3]
 631:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.BlockLength    = sizeof(nth->V16) + itf->In.Index + pt->V16.Length;
 142              		.loc 1 631 29 view .LVU37
 143 0038 4FF00C0E 		mov	lr, #12
 626:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 144              		.loc 1 626 47 view .LVU38
 145 003c 00F10309 		add	r9, r0, #3
ARM GAS  /tmp/ccWJL6at.s 			page 15


 627:USBDevice/Class/CDC/usbd_ncm.c **** 
 146              		.loc 1 627 29 view .LVU39
 147 0040 AC71     		strb	r4, [r5, #6]
 148 0042 EC71     		strb	r4, [r5, #7]
 626:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 149              		.loc 1 626 29 view .LVU40
 150 0044 4FEA8909 		lsl	r9, r9, #2
 151              		.loc 1 632 64 view .LVU41
 152 0048 4A44     		add	r2, r2, r9
 626:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 153              		.loc 1 626 29 view .LVU42
 154 004a A5F80490 		strh	r9, [r5, #4]	@ unaligned
 630:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.HeaderLength   = sizeof(nth->V16);
 155              		.loc 1 630 29 view .LVU43
 156 004e 7350     		str	r3, [r6, r1]	@ unaligned
 621:USBDevice/Class/CDC/usbd_ncm.c ****     int i;
 157              		.loc 1 621 26 view .LVU44
 158 0050 05F10801 		add	r1, r5, #8
 159              	.LVL10:
 622:USBDevice/Class/CDC/usbd_ncm.c **** 
 160              		.loc 1 622 5 is_stmt 1 view .LVU45
 625:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.Length          = sizeof(pt->V16) + (itf->In.DgCount * sizeof(pt->V16.Datagram[0]));
 161              		.loc 1 625 5 view .LVU46
 626:USBDevice/Class/CDC/usbd_ncm.c ****     pt->V16.NextNdpIndex    = 0;
 162              		.loc 1 626 5 view .LVU47
 627:USBDevice/Class/CDC/usbd_ncm.c **** 
 163              		.loc 1 627 5 view .LVU48
 630:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.HeaderLength   = sizeof(nth->V16);
 164              		.loc 1 630 5 view .LVU49
 631:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.BlockLength    = sizeof(nth->V16) + itf->In.Index + pt->V16.Length;
 165              		.loc 1 631 5 view .LVU50
 166              		.loc 1 632 64 is_stmt 0 view .LVU51
 167 0054 93B2     		uxth	r3, r2
 631:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.BlockLength    = sizeof(nth->V16) + itf->In.Index + pt->V16.Length;
 168              		.loc 1 631 29 view .LVU52
 169 0056 88F80540 		strb	r4, [r8, #5]
 170              		.loc 1 632 5 is_stmt 1 view .LVU53
 633:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.NdpIndex       = itf->In.Index;
 171              		.loc 1 633 29 is_stmt 0 view .LVU54
 172 005a A8F80AC0 		strh	ip, [r8, #10]	@ unaligned
 632:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.NdpIndex       = itf->In.Index;
 173              		.loc 1 632 29 view .LVU55
 174 005e A8F80820 		strh	r2, [r8, #8]	@ unaligned
 175              		.loc 1 633 5 is_stmt 1 view .LVU56
 634:USBDevice/Class/CDC/usbd_ncm.c **** 
 635:USBDevice/Class/CDC/usbd_ncm.c ****     /* 2 rounds are used so the dp list entries aren't overwritten */
 636:USBDevice/Class/CDC/usbd_ncm.c ****     for (i = 0; i < itf->In.DgCount; i++)
 176              		.loc 1 636 5 view .LVU57
 177              	.LVL11:
 178              		.loc 1 636 17 view .LVU58
 631:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.BlockLength    = sizeof(nth->V16) + itf->In.Index + pt->V16.Length;
 179              		.loc 1 631 29 is_stmt 0 view .LVU59
 180 0062 88F804E0 		strb	lr, [r8, #4]
 181              		.loc 1 636 5 view .LVU60
 182 0066 0028     		cmp	r0, #0
 183 0068 4DD0     		beq	.L6
 184 006a 4246     		mov	r2, r8
ARM GAS  /tmp/ccWJL6at.s 			page 16


 185              	.LVL12:
 186              	.L7:
 637:USBDevice/Class/CDC/usbd_ncm.c ****     {
 638:USBDevice/Class/CDC/usbd_ncm.c ****         pt->V16.Datagram[i].Length = dp[-i].length;
 187              		.loc 1 638 9 is_stmt 1 discriminator 3 view .LVU61
 188              		.loc 1 638 36 is_stmt 0 discriminator 3 view .LVU62
 189 006c 05EB840C 		add	ip, r5, r4, lsl #2
 636:USBDevice/Class/CDC/usbd_ncm.c ****     {
 190              		.loc 1 636 39 discriminator 3 view .LVU63
 191 0070 0134     		adds	r4, r4, #1
 192              	.LVL13:
 193              		.loc 1 638 36 discriminator 3 view .LVU64
 194 0072 B2F8FCE7 		ldrh	lr, [r2, #2044]
 195 0076 043A     		subs	r2, r2, #4
 636:USBDevice/Class/CDC/usbd_ncm.c ****     {
 196              		.loc 1 636 5 discriminator 3 view .LVU65
 197 0078 8442     		cmp	r4, r0
 198              		.loc 1 638 36 discriminator 3 view .LVU66
 199 007a ACF80AE0 		strh	lr, [ip, #10]	@ unaligned
 636:USBDevice/Class/CDC/usbd_ncm.c ****     {
 200              		.loc 1 636 38 is_stmt 1 discriminator 3 view .LVU67
 201              	.LVL14:
 636:USBDevice/Class/CDC/usbd_ncm.c ****     {
 202              		.loc 1 636 17 discriminator 3 view .LVU68
 636:USBDevice/Class/CDC/usbd_ncm.c ****     {
 203              		.loc 1 636 5 is_stmt 0 discriminator 3 view .LVU69
 204 007e F5D1     		bne	.L7
 639:USBDevice/Class/CDC/usbd_ncm.c ****     }
 640:USBDevice/Class/CDC/usbd_ncm.c **** 
 641:USBDevice/Class/CDC/usbd_ncm.c ****     dg->Index = sizeof(nth->V16);
 205              		.loc 1 641 5 is_stmt 1 view .LVU70
 206              		.loc 1 641 15 is_stmt 0 view .LVU71
 207 0080 0024     		movs	r4, #0
 208              	.LVL15:
 209              		.loc 1 641 15 view .LVU72
 210 0082 0C22     		movs	r2, #12
 642:USBDevice/Class/CDC/usbd_ncm.c ****     for (i = 1; i < itf->In.DgCount; i++, dg++)
 211              		.loc 1 642 5 view .LVU73
 212 0084 0128     		cmp	r0, #1
 641:USBDevice/Class/CDC/usbd_ncm.c ****     for (i = 1; i < itf->In.DgCount; i++, dg++)
 213              		.loc 1 641 15 view .LVU74
 214 0086 6C72     		strb	r4, [r5, #9]
 215              		.loc 1 642 5 is_stmt 1 view .LVU75
 216              	.LVL16:
 217              		.loc 1 642 17 view .LVU76
 641:USBDevice/Class/CDC/usbd_ncm.c ****     for (i = 1; i < itf->In.DgCount; i++, dg++)
 218              		.loc 1 641 15 is_stmt 0 view .LVU77
 219 0088 2A72     		strb	r2, [r5, #8]
 220              		.loc 1 642 5 view .LVU78
 221 008a 12DD     		ble	.L8
 222 008c 00F1010C 		add	ip, r0, #1
 223 0090 2C89     		ldrh	r4, [r5, #8]	@ unaligned
 621:USBDevice/Class/CDC/usbd_ncm.c ****     int i;
 224              		.loc 1 621 26 view .LVU79
 225 0092 0A46     		mov	r2, r1
 226 0094 05EB8C0C 		add	ip, r5, ip, lsl #2
 227              	.LVL17:
ARM GAS  /tmp/ccWJL6at.s 			page 17


 228              	.L9:
 643:USBDevice/Class/CDC/usbd_ncm.c ****     {
 644:USBDevice/Class/CDC/usbd_ncm.c ****         (dg + 1)->Index = (dg->Index + dg->Length + 3) & (~3);
 229              		.loc 1 644 9 is_stmt 1 discriminator 3 view .LVU80
 230              		.loc 1 644 51 is_stmt 0 discriminator 3 view .LVU81
 231 0098 E51C     		adds	r5, r4, #3
 232              		.loc 1 644 42 discriminator 3 view .LVU82
 233 009a 5488     		ldrh	r4, [r2, #2]	@ unaligned
 234              		.loc 1 644 51 discriminator 3 view .LVU83
 235 009c 2C44     		add	r4, r4, r5
 236              		.loc 1 644 56 discriminator 3 view .LVU84
 237 009e 24F00304 		bic	r4, r4, #3
 238 00a2 A4B2     		uxth	r4, r4
 239              		.loc 1 644 25 discriminator 3 view .LVU85
 240 00a4 22F8044F 		strh	r4, [r2, #4]!	@ unaligned
 241              	.LVL18:
 642:USBDevice/Class/CDC/usbd_ncm.c ****     {
 242              		.loc 1 642 38 is_stmt 1 discriminator 3 view .LVU86
 642:USBDevice/Class/CDC/usbd_ncm.c ****     {
 243              		.loc 1 642 17 discriminator 3 view .LVU87
 642:USBDevice/Class/CDC/usbd_ncm.c ****     {
 244              		.loc 1 642 5 is_stmt 0 discriminator 3 view .LVU88
 245 00a8 6245     		cmp	r2, ip
 246 00aa F5D1     		bne	.L9
 247 00ac 0138     		subs	r0, r0, #1
 248 00ae 01EB8001 		add	r1, r1, r0, lsl #2
 249              	.LVL19:
 250              	.L8:
 645:USBDevice/Class/CDC/usbd_ncm.c ****     }
 646:USBDevice/Class/CDC/usbd_ncm.c **** 
 647:USBDevice/Class/CDC/usbd_ncm.c ****     /* A null element ends the table */
 648:USBDevice/Class/CDC/usbd_ncm.c ****     dg++;
 251              		.loc 1 648 5 is_stmt 1 view .LVU89
 649:USBDevice/Class/CDC/usbd_ncm.c ****     dg->Index = 0;
 252              		.loc 1 649 5 view .LVU90
 650:USBDevice/Class/CDC/usbd_ncm.c ****     dg->Length = 0;
 253              		.loc 1 650 5 view .LVU91
 649:USBDevice/Class/CDC/usbd_ncm.c ****     dg->Index = 0;
 254              		.loc 1 649 15 is_stmt 0 view .LVU92
 255 00b2 0024     		movs	r4, #0
 651:USBDevice/Class/CDC/usbd_ncm.c **** 
 652:USBDevice/Class/CDC/usbd_ncm.c ****     /* This should never fail */
 653:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_EpSend(itf->Base.Device, itf->Config.InEpNum,
 256              		.loc 1 653 5 view .LVU93
 257 00b4 4246     		mov	r2, r8
 258 00b6 3068     		ldr	r0, [r6]
 654:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Data[page], nth->V16.BlockLength);
 655:USBDevice/Class/CDC/usbd_ncm.c **** 
 656:USBDevice/Class/CDC/usbd_ncm.c ****     /* Switch to the other page */
 657:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.Page    = 1 - page;
 259              		.loc 1 657 25 view .LVU94
 260 00b8 C7F10107 		rsb	r7, r7, #1
 649:USBDevice/Class/CDC/usbd_ncm.c ****     dg->Length = 0;
 261              		.loc 1 649 15 view .LVU95
 262 00bc 4C60     		str	r4, [r1, #4]	@ unaligned
 263              	.LVL20:
 653:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Data[page], nth->V16.BlockLength);
ARM GAS  /tmp/ccWJL6at.s 			page 18


 264              		.loc 1 653 5 is_stmt 1 view .LVU96
 658:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.DgCount = 0;
 659:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.Index   = sizeof(nth->V16);
 265              		.loc 1 659 21 is_stmt 0 view .LVU97
 266 00be 0C25     		movs	r5, #12
 653:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Data[page], nth->V16.BlockLength);
 267              		.loc 1 653 5 view .LVU98
 268 00c0 717C     		ldrb	r1, [r6, #17]	@ zero_extendqisi2
 269              	.LVL21:
 653:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Data[page], nth->V16.BlockLength);
 270              		.loc 1 653 5 view .LVU99
 271 00c2 FFF7FEFF 		bl	USBD_EpSend
 272              	.LVL22:
 657:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.DgCount = 0;
 273              		.loc 1 657 5 is_stmt 1 view .LVU100
 660:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.RemSize = itf->In.MaxSize - itf->In.Index - sizeof(pt->V16);
 274              		.loc 1 660 30 is_stmt 0 view .LVU101
 275 00c6 42F23403 		movw	r3, #8244
 657:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.DgCount = 0;
 276              		.loc 1 657 21 view .LVU102
 277 00ca 42F23E00 		movw	r0, #8254
 658:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.DgCount = 0;
 278              		.loc 1 658 21 view .LVU103
 279 00ce 42F23F02 		movw	r2, #8255
 280              		.loc 1 660 55 view .LVU104
 281 00d2 F358     		ldr	r3, [r6, r3]
 661:USBDevice/Class/CDC/usbd_ncm.c **** 
 662:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.FillState = NTB_EMPTY;
 663:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.SendState = NTB_TRANSFERRING;
 282              		.loc 1 663 23 view .LVU105
 283 00d4 0221     		movs	r1, #2
 657:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.DgCount = 0;
 284              		.loc 1 657 21 view .LVU106
 285 00d6 3754     		strb	r7, [r6, r0]
 658:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.Index   = sizeof(nth->V16);
 286              		.loc 1 658 5 is_stmt 1 view .LVU107
 662:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.SendState = NTB_TRANSFERRING;
 287              		.loc 1 662 23 is_stmt 0 view .LVU108
 288 00d8 42F2410E 		movw	lr, #8257
 658:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.Index   = sizeof(nth->V16);
 289              		.loc 1 658 21 view .LVU109
 290 00dc B454     		strb	r4, [r6, r2]
 659:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.RemSize = itf->In.MaxSize - itf->In.Index - sizeof(pt->V16);
 291              		.loc 1 659 5 is_stmt 1 view .LVU110
 660:USBDevice/Class/CDC/usbd_ncm.c **** 
 292              		.loc 1 660 55 is_stmt 0 view .LVU111
 293 00de 183B     		subs	r3, r3, #24
 660:USBDevice/Class/CDC/usbd_ncm.c **** 
 294              		.loc 1 660 21 view .LVU112
 295 00e0 42F2380C 		movw	ip, #8248
 659:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.RemSize = itf->In.MaxSize - itf->In.Index - sizeof(pt->V16);
 296              		.loc 1 659 21 view .LVU113
 297 00e4 42F23C00 		movw	r0, #8252
 298              		.loc 1 663 23 view .LVU114
 299 00e8 06F50152 		add	r2, r6, #8256
 662:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.SendState = NTB_TRANSFERRING;
 300              		.loc 1 662 23 view .LVU115
ARM GAS  /tmp/ccWJL6at.s 			page 19


 301 00ec 06F80E40 		strb	r4, [r6, lr]
 660:USBDevice/Class/CDC/usbd_ncm.c **** 
 302              		.loc 1 660 21 view .LVU116
 303 00f0 46F80C30 		str	r3, [r6, ip]
 659:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.RemSize = itf->In.MaxSize - itf->In.Index - sizeof(pt->V16);
 304              		.loc 1 659 21 view .LVU117
 305 00f4 3552     		strh	r5, [r6, r0]	@ movhi
 660:USBDevice/Class/CDC/usbd_ncm.c **** 
 306              		.loc 1 660 5 is_stmt 1 view .LVU118
 662:USBDevice/Class/CDC/usbd_ncm.c ****     itf->In.SendState = NTB_TRANSFERRING;
 307              		.loc 1 662 5 view .LVU119
 308              		.loc 1 663 5 view .LVU120
 309              		.loc 1 663 23 is_stmt 0 view .LVU121
 310 00f6 1170     		strb	r1, [r2]
 664:USBDevice/Class/CDC/usbd_ncm.c **** 
 665:USBDevice/Class/CDC/usbd_ncm.c ****     /* Increment sequence number by 2 (double buffering) */
 666:USBDevice/Class/CDC/usbd_ncm.c ****     nth->V16.Sequence += 2;
 311              		.loc 1 666 5 is_stmt 1 view .LVU122
 312              		.loc 1 666 23 is_stmt 0 view .LVU123
 313 00f8 B8F80630 		ldrh	r3, [r8, #6]	@ unaligned
 314 00fc 0B44     		add	r3, r3, r1
 315 00fe A8F80630 		strh	r3, [r8, #6]	@ unaligned
 667:USBDevice/Class/CDC/usbd_ncm.c **** }
 316              		.loc 1 667 1 view .LVU124
 317 0102 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 318              	.LVL23:
 319              	.L6:
 641:USBDevice/Class/CDC/usbd_ncm.c ****     for (i = 1; i < itf->In.DgCount; i++, dg++)
 320              		.loc 1 641 5 is_stmt 1 view .LVU125
 641:USBDevice/Class/CDC/usbd_ncm.c ****     for (i = 1; i < itf->In.DgCount; i++, dg++)
 321              		.loc 1 641 15 is_stmt 0 view .LVU126
 322 0106 85F808E0 		strb	lr, [r5, #8]
 323 010a 6872     		strb	r0, [r5, #9]
 642:USBDevice/Class/CDC/usbd_ncm.c ****     {
 324              		.loc 1 642 5 is_stmt 1 view .LVU127
 325              	.LVL24:
 642:USBDevice/Class/CDC/usbd_ncm.c ****     {
 326              		.loc 1 642 17 view .LVU128
 327 010c D1E7     		b	.L8
 328              	.L15:
 329 010e 00BF     		.align	2
 330              	.L14:
 331 0110 00000000 		.word	.LANCHOR0
 332 0114 00000000 		.word	.LANCHOR1
 333              		.cfi_endproc
 334              	.LFE156:
 336              		.section	.text.ncm_outData,"ax",%progbits
 337              		.align	1
 338              		.p2align 2,,3
 339              		.syntax unified
 340              		.thumb
 341              		.thumb_func
 342              		.fpu fpv4-sp-d16
 344              	ncm_outData:
 345              	.LVL25:
 346              	.LFB155:
 548:USBDevice/Class/CDC/usbd_ncm.c ****     /* Save transfer details */
ARM GAS  /tmp/ccWJL6at.s 			page 20


 347              		.loc 1 548 1 view -0
 348              		.cfi_startproc
 349              		@ args = 0, pretend = 0, frame = 0
 350              		@ frame_needed = 0, uses_anonymous_args = 0
 550:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t rxPage = ((void*)itf->Out.Data[0] == (void*)nth) ? 0 : 1, page = rxPage;
 351              		.loc 1 550 5 view .LVU130
 550:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t rxPage = ((void*)itf->Out.Data[0] == (void*)nth) ? 0 : 1, page = rxPage;
 352              		.loc 1 550 79 is_stmt 0 view .LVU131
 353 0000 8A88     		ldrh	r2, [r1, #4]
 550:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t rxPage = ((void*)itf->Out.Data[0] == (void*)nth) ? 0 : 1, page = rxPage;
 354              		.loc 1 550 34 view .LVU132
 355 0002 0B68     		ldr	r3, [r1]
 548:USBDevice/Class/CDC/usbd_ncm.c ****     /* Save transfer details */
 356              		.loc 1 548 1 view .LVU133
 357 0004 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 358              	.LCFI1:
 359              		.cfi_def_cfa_offset 24
 360              		.cfi_offset 4, -24
 361              		.cfi_offset 5, -20
 362              		.cfi_offset 6, -16
 363              		.cfi_offset 7, -12
 364              		.cfi_offset 8, -8
 365              		.cfi_offset 14, -4
 550:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t rxPage = ((void*)itf->Out.Data[0] == (void*)nth) ? 0 : 1, page = rxPage;
 366              		.loc 1 550 34 view .LVU134
 367 0008 9B1A     		subs	r3, r3, r2
 368              	.LVL26:
 551:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Out.State[rxPage] = NTB_EMPTY;
 369              		.loc 1 551 5 is_stmt 1 view .LVU135
 548:USBDevice/Class/CDC/usbd_ncm.c ****     /* Save transfer details */
 370              		.loc 1 548 1 is_stmt 0 view .LVU136
 371 000a 0446     		mov	r4, r0
 551:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Out.State[rxPage] = NTB_EMPTY;
 372              		.loc 1 551 30 view .LVU137
 373 000c 2C30     		adds	r0, r0, #44
 374              	.LVL27:
 552:USBDevice/Class/CDC/usbd_ncm.c **** 
 375              		.loc 1 552 28 view .LVU138
 376 000e 41F23206 		movw	r6, #4146
 377 0012 0027     		movs	r7, #0
 551:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Out.State[rxPage] = NTB_EMPTY;
 378              		.loc 1 551 66 view .LVU139
 379 0014 181A     		subs	r0, r3, r0
 380 0016 18BF     		it	ne
 381 0018 0120     		movne	r0, #1
 382              	.LVL28:
 552:USBDevice/Class/CDC/usbd_ncm.c **** 
 383              		.loc 1 552 5 is_stmt 1 view .LVU140
 552:USBDevice/Class/CDC/usbd_ncm.c **** 
 384              		.loc 1 552 28 is_stmt 0 view .LVU141
 385 001a 2518     		adds	r5, r4, r0
 386 001c AF55     		strb	r7, [r5, r6]
 555:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.HeaderLength == sizeof(nth->V16)) &&
 387              		.loc 1 555 5 is_stmt 1 view .LVU142
 555:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.HeaderLength == sizeof(nth->V16)) &&
 388              		.loc 1 555 18 is_stmt 0 view .LVU143
 389 001e 1989     		ldrh	r1, [r3, #8]	@ unaligned
ARM GAS  /tmp/ccWJL6at.s 			page 21


 390              	.LVL29:
 555:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.HeaderLength == sizeof(nth->V16)) &&
 391              		.loc 1 555 8 view .LVU144
 392 0020 8A42     		cmp	r2, r1
 393 0022 15D0     		beq	.L41
 394              	.L24:
 395              	.LBB76:
 396 0024 0246     		mov	r2, r0
 397 0026 2F46     		mov	r7, r5
 398              	.LVL30:
 399              	.L17:
 555:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.HeaderLength == sizeof(nth->V16)) &&
 400              		.loc 1 555 8 view .LVU145
 401              	.LBE76:
 590:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Notify.Connection.Value != 0))
 402              		.loc 1 590 5 is_stmt 1 view .LVU146
 590:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Notify.Connection.Value != 0))
 403              		.loc 1 590 24 is_stmt 0 view .LVU147
 404 0028 41F23206 		movw	r6, #4146
 405 002c BB5D     		ldrb	r3, [r7, r6]	@ zero_extendqisi2
 590:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Notify.Connection.Value != 0))
 406              		.loc 1 590 8 view .LVU148
 407 002e 0BB9     		cbnz	r3, .L20
 590:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Notify.Connection.Value != 0))
 408              		.loc 1 590 45 discriminator 1 view .LVU149
 409 0030 E38C     		ldrh	r3, [r4, #38]
 410 0032 63BB     		cbnz	r3, .L42
 411              	.LVL31:
 412              	.L20:
 601:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Out.State[rxPage] == NTB_READY))
 413              		.loc 1 601 5 is_stmt 1 view .LVU150
 601:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Out.State[rxPage] == NTB_READY))
 414              		.loc 1 601 22 is_stmt 0 view .LVU151
 415 0034 E368     		ldr	r3, [r4, #12]
 416 0036 1B69     		ldr	r3, [r3, #16]
 601:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Out.State[rxPage] == NTB_READY))
 417              		.loc 1 601 8 view .LVU152
 418 0038 23B1     		cbz	r3, .L16
 602:USBDevice/Class/CDC/usbd_ncm.c ****     {
 419              		.loc 1 602 24 discriminator 1 view .LVU153
 420 003a 41F23202 		movw	r2, #4146
 421 003e AA5C     		ldrb	r2, [r5, r2]	@ zero_extendqisi2
 601:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->Out.State[rxPage] == NTB_READY))
 422              		.loc 1 601 42 discriminator 1 view .LVU154
 423 0040 032A     		cmp	r2, #3
 424 0042 01D0     		beq	.L43
 425              	.L16:
 606:USBDevice/Class/CDC/usbd_ncm.c **** 
 426              		.loc 1 606 1 view .LVU155
 427 0044 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 428              	.LVL32:
 429              	.L43:
 604:USBDevice/Class/CDC/usbd_ncm.c ****     }
 430              		.loc 1 604 9 is_stmt 1 view .LVU156
 431 0048 2046     		mov	r0, r4
 606:USBDevice/Class/CDC/usbd_ncm.c **** 
 432              		.loc 1 606 1 is_stmt 0 view .LVU157
ARM GAS  /tmp/ccWJL6at.s 			page 22


 433 004a BDE8F041 		pop	{r4, r5, r6, r7, r8, lr}
 434              	.LCFI2:
 435              		.cfi_remember_state
 436              		.cfi_restore 14
 437              		.cfi_restore 8
 438              		.cfi_restore 7
 439              		.cfi_restore 6
 440              		.cfi_restore 5
 441              		.cfi_restore 4
 442              		.cfi_def_cfa_offset 0
 443              	.LVL33:
 604:USBDevice/Class/CDC/usbd_ncm.c ****     }
 444              		.loc 1 604 9 view .LVU158
 445 004e 1847     		bx	r3	@ indirect register sibling call
 446              	.LVL34:
 447              	.L41:
 448              	.LCFI3:
 449              		.cfi_restore_state
 555:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.HeaderLength == sizeof(nth->V16)) &&
 450              		.loc 1 555 56 discriminator 1 view .LVU159
 451 0050 9A88     		ldrh	r2, [r3, #4]	@ unaligned
 452 0052 0C2A     		cmp	r2, #12
 453 0054 E6D1     		bne	.L24
 557:USBDevice/Class/CDC/usbd_ncm.c ****     {
 454              		.loc 1 557 45 view .LVU160
 455 0056 1F4A     		ldr	r2, .L46
 557:USBDevice/Class/CDC/usbd_ncm.c ****     {
 456              		.loc 1 557 18 view .LVU161
 457 0058 1E68     		ldr	r6, [r3]	@ unaligned
 556:USBDevice/Class/CDC/usbd_ncm.c ****         (nth->V16.Signature    == nth16_sign.dw))
 458              		.loc 1 556 53 view .LVU162
 459 005a 1268     		ldr	r2, [r2]
 460 005c 9642     		cmp	r6, r2
 461 005e E1D1     		bne	.L24
 462              	.LBB77:
 559:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_NCM_DatagramPointerTableType* pt = (void*)nth + ndpIndex;
 463              		.loc 1 559 9 is_stmt 1 view .LVU163
 559:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_NCM_DatagramPointerTableType* pt = (void*)nth + ndpIndex;
 464              		.loc 1 559 18 is_stmt 0 view .LVU164
 465 0060 5E89     		ldrh	r6, [r3, #10]	@ unaligned
 466              	.LVL35:
 560:USBDevice/Class/CDC/usbd_ncm.c **** 
 467              		.loc 1 560 9 is_stmt 1 view .LVU165
 565:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Length > sizeof(pt->V16)))
 468              		.loc 1 565 48 is_stmt 0 view .LVU166
 469 0062 1D4A     		ldr	r2, .L46+4
 560:USBDevice/Class/CDC/usbd_ncm.c **** 
 470              		.loc 1 560 44 view .LVU167
 471 0064 03EB060C 		add	ip, r3, r6
 472              	.LVL36:
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 473              		.loc 1 563 9 is_stmt 1 view .LVU168
 565:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Length > sizeof(pt->V16)))
 474              		.loc 1 565 48 is_stmt 0 view .LVU169
 475 0068 1768     		ldr	r7, [r2]
 560:USBDevice/Class/CDC/usbd_ncm.c **** 
 476              		.loc 1 560 44 view .LVU170
ARM GAS  /tmp/ccWJL6at.s 			page 23


 477 006a 6246     		mov	r2, ip
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 478              		.loc 1 563 15 view .LVU171
 479 006c 0AE0     		b	.L18
 480              	.LVL37:
 481              	.L45:
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 482              		.loc 1 563 46 view .LVU172
 483 006e 0C2E     		cmp	r6, #12
 484 0070 0AD9     		bls	.L26
 565:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Length > sizeof(pt->V16)))
 485              		.loc 1 565 24 view .LVU173
 486 0072 1668     		ldr	r6, [r2]	@ unaligned
 487              	.LVL38:
 564:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Signature == ndp16_sign.dw) &&
 488              		.loc 1 564 50 view .LVU174
 489 0074 BE42     		cmp	r6, r7
 490 0076 07D1     		bne	.L26
 565:USBDevice/Class/CDC/usbd_ncm.c ****                (pt->V16.Length > sizeof(pt->V16)))
 491              		.loc 1 565 53 view .LVU175
 492 0078 9688     		ldrh	r6, [r2, #4]	@ unaligned
 493 007a 0C2E     		cmp	r6, #12
 494 007c 04D9     		bls	.L26
 568:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + ndpIndex;
 495              		.loc 1 568 22 view .LVU176
 496 007e D688     		ldrh	r6, [r2, #6]	@ unaligned
 497              	.LVL39:
 569:USBDevice/Class/CDC/usbd_ncm.c **** 
 498              		.loc 1 569 13 is_stmt 1 view .LVU177
 569:USBDevice/Class/CDC/usbd_ncm.c **** 
 499              		.loc 1 569 16 is_stmt 0 view .LVU178
 500 0080 9A19     		adds	r2, r3, r6
 501              	.LVL40:
 572:USBDevice/Class/CDC/usbd_ncm.c ****             {
 502              		.loc 1 572 13 is_stmt 1 view .LVU179
 572:USBDevice/Class/CDC/usbd_ncm.c ****             {
 503              		.loc 1 572 16 is_stmt 0 view .LVU180
 504 0082 86B1     		cbz	r6, .L44
 505              	.L18:
 568:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + ndpIndex;
 506              		.loc 1 568 13 is_stmt 1 view .LVU181
 507              	.LVL41:
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 508              		.loc 1 563 15 view .LVU182
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 509              		.loc 1 563 46 is_stmt 0 view .LVU183
 510 0084 B142     		cmp	r1, r6
 511 0086 F2D8     		bhi	.L45
 512              	.LVL42:
 513              	.L26:
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 514              		.loc 1 563 46 view .LVU184
 515 0088 0246     		mov	r2, r0
 516              	.LVL43:
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 517              		.loc 1 563 46 view .LVU185
 518 008a 2718     		adds	r7, r4, r0
ARM GAS  /tmp/ccWJL6at.s 			page 24


 519 008c CCE7     		b	.L17
 520              	.LVL44:
 521              	.L42:
 563:USBDevice/Class/CDC/usbd_ncm.c ****                (ndpIndex < nth->V16.BlockLength) &&
 522              		.loc 1 563 46 view .LVU186
 523              	.LBE77:
 594:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 524              		.loc 1 594 9 is_stmt 1 view .LVU187
 595:USBDevice/Class/CDC/usbd_ncm.c **** 
 525              		.loc 1 595 30 is_stmt 0 view .LVU188
 526 008e 04EBC222 		add	r2, r4, r2, lsl #11
 594:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 527              		.loc 1 594 9 view .LVU189
 528 0092 4FF40063 		mov	r3, #2048
 529 0096 217C     		ldrb	r1, [r4, #16]	@ zero_extendqisi2
 530 0098 2C32     		adds	r2, r2, #44
 531 009a 2068     		ldr	r0, [r4]
 532              	.LVL45:
 594:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 533              		.loc 1 594 9 view .LVU190
 534 009c FFF7FEFF 		bl	USBD_EpReceive
 535              	.LVL46:
 597:USBDevice/Class/CDC/usbd_ncm.c ****     }
 536              		.loc 1 597 9 is_stmt 1 view .LVU191
 597:USBDevice/Class/CDC/usbd_ncm.c ****     }
 537              		.loc 1 597 30 is_stmt 0 view .LVU192
 538 00a0 0223     		movs	r3, #2
 539 00a2 BB55     		strb	r3, [r7, r6]
 540 00a4 C6E7     		b	.L20
 541              	.LVL47:
 542              	.L44:
 543              	.LBB78:
 574:USBDevice/Class/CDC/usbd_ncm.c ****                 page = 1 - rxPage;
 544              		.loc 1 574 17 is_stmt 1 view .LVU193
 578:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 545              		.loc 1 578 35 is_stmt 0 view .LVU194
 546 00a6 80F00102 		eor	r2, r0, #1
 547              	.LVL48:
 574:USBDevice/Class/CDC/usbd_ncm.c ****                 page = 1 - rxPage;
 548              		.loc 1 574 40 view .LVU195
 549 00aa 41F23203 		movw	r3, #4146
 550              	.LVL49:
 574:USBDevice/Class/CDC/usbd_ncm.c ****                 page = 1 - rxPage;
 551              		.loc 1 574 40 view .LVU196
 552 00ae 0321     		movs	r1, #3
 578:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 553              		.loc 1 578 35 view .LVU197
 554 00b0 A718     		adds	r7, r4, r2
 574:USBDevice/Class/CDC/usbd_ncm.c ****                 page = 1 - rxPage;
 555              		.loc 1 574 40 view .LVU198
 556 00b2 E954     		strb	r1, [r5, r3]
 575:USBDevice/Class/CDC/usbd_ncm.c **** 
 557              		.loc 1 575 17 is_stmt 1 view .LVU199
 558              	.LVL50:
 578:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 559              		.loc 1 578 17 view .LVU200
 578:USBDevice/Class/CDC/usbd_ncm.c ****                 {
ARM GAS  /tmp/ccWJL6at.s 			page 25


 560              		.loc 1 578 35 is_stmt 0 view .LVU201
 561 00b4 FB5C     		ldrb	r3, [r7, r3]	@ zero_extendqisi2
 578:USBDevice/Class/CDC/usbd_ncm.c ****                 {
 562              		.loc 1 578 20 view .LVU202
 563 00b6 002B     		cmp	r3, #0
 564 00b8 B6D1     		bne	.L17
 580:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.PT = (void*)nth + nth->V16.NdpIndex;
 565              		.loc 1 580 21 is_stmt 1 view .LVU203
 580:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.PT = (void*)nth + nth->V16.NdpIndex;
 566              		.loc 1 580 35 is_stmt 0 view .LVU204
 567 00ba 41F2300E 		movw	lr, #4144
 581:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.Dx = 0;
 568              		.loc 1 581 33 view .LVU205
 569 00be 41F22C01 		movw	r1, #4140
 582:USBDevice/Class/CDC/usbd_ncm.c ****                 }
 570              		.loc 1 582 33 view .LVU206
 571 00c2 41F23103 		movw	r3, #4145
 580:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.PT = (void*)nth + nth->V16.NdpIndex;
 572              		.loc 1 580 35 view .LVU207
 573 00c6 04F80E00 		strb	r0, [r4, lr]
 581:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.Dx = 0;
 574              		.loc 1 581 21 is_stmt 1 view .LVU208
 581:USBDevice/Class/CDC/usbd_ncm.c ****                     itf->Out.Dx = 0;
 575              		.loc 1 581 33 is_stmt 0 view .LVU209
 576 00ca 44F801C0 		str	ip, [r4, r1]
 582:USBDevice/Class/CDC/usbd_ncm.c ****                 }
 577              		.loc 1 582 21 is_stmt 1 view .LVU210
 582:USBDevice/Class/CDC/usbd_ncm.c ****                 }
 578              		.loc 1 582 33 is_stmt 0 view .LVU211
 579 00ce E654     		strb	r6, [r4, r3]
 580 00d0 AAE7     		b	.L17
 581              	.L47:
 582 00d2 00BF     		.align	2
 583              	.L46:
 584 00d4 00000000 		.word	.LANCHOR1
 585 00d8 00000000 		.word	.LANCHOR0
 586              	.LBE78:
 587              		.cfi_endproc
 588              	.LFE155:
 590              		.section	.text.ncm_setupStage,"ax",%progbits
 591              		.align	1
 592              		.p2align 2,,3
 593              		.syntax unified
 594              		.thumb
 595              		.thumb_func
 596              		.fpu fpv4-sp-d16
 598              	ncm_setupStage:
 599              	.LVL51:
 600              	.LFB153:
 425:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 601              		.loc 1 425 1 is_stmt 1 view -0
 602              		.cfi_startproc
 603              		@ args = 0, pretend = 0, frame = 0
 604              		@ frame_needed = 0, uses_anonymous_args = 0
 605              		@ link register save eliminated.
 426:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_HandleType *dev = itf->Base.Device;
 606              		.loc 1 426 5 view .LVU213
ARM GAS  /tmp/ccWJL6at.s 			page 26


 427:USBDevice/Class/CDC/usbd_ncm.c **** 
 607              		.loc 1 427 5 view .LVU214
 427:USBDevice/Class/CDC/usbd_ncm.c **** 
 608              		.loc 1 427 22 is_stmt 0 view .LVU215
 609 0000 0368     		ldr	r3, [r0]
 610              	.LVL52:
 429:USBDevice/Class/CDC/usbd_ncm.c ****     {
 611              		.loc 1 429 5 is_stmt 1 view .LVU216
 429:USBDevice/Class/CDC/usbd_ncm.c ****     {
 612              		.loc 1 429 37 is_stmt 0 view .LVU217
 613 0002 1A79     		ldrb	r2, [r3, #4]	@ zero_extendqisi2
 429:USBDevice/Class/CDC/usbd_ncm.c ****     {
 614              		.loc 1 429 8 view .LVU218
 615 0004 02F06002 		and	r2, r2, #96
 616 0008 202A     		cmp	r2, #32
 617 000a 01D0     		beq	.L58
 618              	.LVL53:
 502:USBDevice/Class/CDC/usbd_ncm.c **** }
 619              		.loc 1 502 5 is_stmt 1 view .LVU219
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 620              		.loc 1 503 1 is_stmt 0 view .LVU220
 621 000c 0320     		movs	r0, #3
 622              	.LVL54:
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 623              		.loc 1 503 1 view .LVU221
 624 000e 7047     		bx	lr
 625              	.LVL55:
 626              	.L58:
 431:USBDevice/Class/CDC/usbd_ncm.c ****         {
 627              		.loc 1 431 9 is_stmt 1 view .LVU222
 425:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 628              		.loc 1 425 1 is_stmt 0 view .LVU223
 629 0010 30B4     		push	{r4, r5}
 630              	.LCFI4:
 631              		.cfi_def_cfa_offset 8
 632              		.cfi_offset 4, -8
 633              		.cfi_offset 5, -4
 431:USBDevice/Class/CDC/usbd_ncm.c ****         {
 634              		.loc 1 431 27 view .LVU224
 635 0012 5A79     		ldrb	r2, [r3, #5]	@ zero_extendqisi2
 431:USBDevice/Class/CDC/usbd_ncm.c ****         {
 636              		.loc 1 431 9 view .LVU225
 637 0014 852A     		cmp	r2, #133
 638 0016 06D0     		beq	.L50
 639 0018 862A     		cmp	r2, #134
 640 001a 37D0     		beq	.L51
 641 001c 802A     		cmp	r2, #128
 642 001e 0FD0     		beq	.L59
 643              	.LVL56:
 502:USBDevice/Class/CDC/usbd_ncm.c **** }
 644              		.loc 1 502 5 is_stmt 1 view .LVU226
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 645              		.loc 1 503 1 is_stmt 0 view .LVU227
 646 0020 0320     		movs	r0, #3
 647              	.LVL57:
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 648              		.loc 1 503 1 view .LVU228
ARM GAS  /tmp/ccWJL6at.s 			page 27


 649 0022 30BC     		pop	{r4, r5}
 650              	.LCFI5:
 651              		.cfi_remember_state
 652              		.cfi_restore 5
 653              		.cfi_restore 4
 654              		.cfi_def_cfa_offset 0
 655 0024 7047     		bx	lr
 656              	.LVL58:
 657              	.L50:
 658              	.LCFI6:
 659              		.cfi_restore_state
 660              	.LBB79:
 457:USBDevice/Class/CDC/usbd_ncm.c ****                     uint32_t size;
 661              		.loc 1 457 17 is_stmt 1 view .LVU229
 460:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, sizeof(*insize));
 662              		.loc 1 460 17 view .LVU230
 663 0026 0446     		mov	r4, r0
 460:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, sizeof(*insize));
 664              		.loc 1 460 39 is_stmt 0 view .LVU231
 665 0028 42F23405 		movw	r5, #8244
 461:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 666              		.loc 1 461 26 view .LVU232
 667 002c 0422     		movs	r2, #4
 668 002e 03F58671 		add	r1, r3, #268
 669              	.LVL59:
 460:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, sizeof(*insize));
 670              		.loc 1 460 30 view .LVU233
 671 0032 6459     		ldr	r4, [r4, r5]
 461:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 672              		.loc 1 461 26 view .LVU234
 673 0034 1846     		mov	r0, r3
 674              	.LVL60:
 460:USBDevice/Class/CDC/usbd_ncm.c ****                 retval = USBD_CtrlSendData(dev, dev->CtrlData, sizeof(*insize));
 675              		.loc 1 460 30 view .LVU235
 676 0036 C3F80C41 		str	r4, [r3, #268]	@ unaligned
 461:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 677              		.loc 1 461 17 is_stmt 1 view .LVU236
 678              	.LBE79:
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 679              		.loc 1 503 1 is_stmt 0 view .LVU237
 680 003a 30BC     		pop	{r4, r5}
 681              	.LCFI7:
 682              		.cfi_remember_state
 683              		.cfi_restore 5
 684              		.cfi_restore 4
 685              		.cfi_def_cfa_offset 0
 686              	.LBB80:
 461:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 687              		.loc 1 461 26 view .LVU238
 688 003c FFF7FEBF 		b	USBD_CtrlSendData
 689              	.LVL61:
 690              	.L59:
 691              	.LCFI8:
 692              		.cfi_restore_state
 461:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 693              		.loc 1 461 26 view .LVU239
 694              	.LBE80:
ARM GAS  /tmp/ccWJL6at.s 			page 28


 695              	.LBB81:
 436:USBDevice/Class/CDC/usbd_ncm.c **** 
 696              		.loc 1 436 17 is_stmt 1 view .LVU240
 438:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbFormatsSupported      = 1; /* only 16 bit NTB for now */
 697              		.loc 1 438 17 view .LVU241
 439:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbInMaxSize             = USBD_NCM_MAX_IN_SIZE;
 698              		.loc 1 439 17 view .LVU242
 440:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInDivisor             = 4;
 699              		.loc 1 440 49 is_stmt 0 view .LVU243
 700 0040 0021     		movs	r1, #0
 445:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutAlignment          = 4;
 701              		.loc 1 445 49 view .LVU244
 702 0042 0424     		movs	r4, #4
 440:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInDivisor             = 4;
 703              		.loc 1 440 49 view .LVU245
 704 0044 0820     		movs	r0, #8
 705              	.LVL62:
 438:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbFormatsSupported      = 1; /* only 16 bit NTB for now */
 706              		.loc 1 438 49 view .LVU246
 707 0046 144A     		ldr	r2, .L60
 445:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutAlignment          = 4;
 708              		.loc 1 445 49 view .LVU247
 709 0048 144D     		ldr	r5, .L60+4
 438:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbFormatsSupported      = 1; /* only 16 bit NTB for now */
 710              		.loc 1 438 49 view .LVU248
 711 004a C3F80C21 		str	r2, [r3, #268]	@ unaligned
 440:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInDivisor             = 4;
 712              		.loc 1 440 17 is_stmt 1 view .LVU249
 451:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 713              		.loc 1 451 26 is_stmt 0 view .LVU250
 714 004e 1C22     		movs	r2, #28
 440:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInDivisor             = 4;
 715              		.loc 1 440 49 view .LVU251
 716 0050 83F81011 		strb	r1, [r3, #272]
 717 0054 83F81211 		strb	r1, [r3, #274]
 718 0058 83F81311 		strb	r1, [r3, #275]
 441:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInAlignment           = 4;
 719              		.loc 1 441 17 is_stmt 1 view .LVU252
 442:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInPayloadRemainder    = 0;
 720              		.loc 1 442 17 view .LVU253
 443:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbOutMaxSize            = USBD_NCM_MAX_OUT_SIZE;
 721              		.loc 1 443 17 view .LVU254
 444:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutDivisor            = 4;
 722              		.loc 1 444 17 view .LVU255
 444:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutDivisor            = 4;
 723              		.loc 1 444 49 is_stmt 0 view .LVU256
 724 005c 83F81C11 		strb	r1, [r3, #284]
 725 0060 83F81E11 		strb	r1, [r3, #286]
 726 0064 83F81F11 		strb	r1, [r3, #287]
 445:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutAlignment          = 4;
 727              		.loc 1 445 17 is_stmt 1 view .LVU257
 446:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutPayloadRemainder   = 0;
 728              		.loc 1 446 17 view .LVU258
 447:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NtbOutMaxDatagrams       = 20; /* Number is arbitrary, any number is support
 729              		.loc 1 447 17 view .LVU259
 448:USBDevice/Class/CDC/usbd_ncm.c ****                 param->reserved                 = 0;
 730              		.loc 1 448 17 view .LVU260
ARM GAS  /tmp/ccWJL6at.s 			page 29


 451:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 731              		.loc 1 451 26 is_stmt 0 view .LVU261
 732 0068 03F58671 		add	r1, r3, #268
 733              	.LVL63:
 440:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInDivisor             = 4;
 734              		.loc 1 440 49 view .LVU262
 735 006c 83F81101 		strb	r0, [r3, #273]
 444:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutDivisor            = 4;
 736              		.loc 1 444 49 view .LVU263
 737 0070 83F81D01 		strb	r0, [r3, #285]
 451:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 738              		.loc 1 451 26 view .LVU264
 739 0074 1846     		mov	r0, r3
 445:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutAlignment          = 4;
 740              		.loc 1 445 49 view .LVU265
 741 0076 C3F82041 		str	r4, [r3, #288]	@ unaligned
 441:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpInAlignment           = 4;
 742              		.loc 1 441 49 view .LVU266
 743 007a C3F81441 		str	r4, [r3, #276]	@ unaligned
 744 007e C3F81841 		str	r4, [r3, #280]	@ unaligned
 445:USBDevice/Class/CDC/usbd_ncm.c ****                 param->NdpOutAlignment          = 4;
 745              		.loc 1 445 49 view .LVU267
 746 0082 C3F82451 		str	r5, [r3, #292]	@ unaligned
 449:USBDevice/Class/CDC/usbd_ncm.c **** 
 747              		.loc 1 449 17 is_stmt 1 view .LVU268
 451:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 748              		.loc 1 451 17 view .LVU269
 749              	.LBE81:
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 750              		.loc 1 503 1 is_stmt 0 view .LVU270
 751 0086 30BC     		pop	{r4, r5}
 752              	.LCFI9:
 753              		.cfi_remember_state
 754              		.cfi_restore 5
 755              		.cfi_restore 4
 756              		.cfi_def_cfa_offset 0
 757              	.LBB82:
 451:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 758              		.loc 1 451 26 view .LVU271
 759 0088 FFF7FEBF 		b	USBD_CtrlSendData
 760              	.LVL64:
 761              	.L51:
 762              	.LCFI10:
 763              		.cfi_restore_state
 451:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 764              		.loc 1 451 26 view .LVU272
 765              	.LBE82:
 467:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 766              		.loc 1 467 17 is_stmt 1 view .LVU273
 467:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 767              		.loc 1 467 26 is_stmt 0 view .LVU274
 768 008c 03F58671 		add	r1, r3, #268
 769 0090 1846     		mov	r0, r3
 770              	.LVL65:
 503:USBDevice/Class/CDC/usbd_ncm.c **** 
 771              		.loc 1 503 1 view .LVU275
 772 0092 30BC     		pop	{r4, r5}
ARM GAS  /tmp/ccWJL6at.s 			page 30


 773              	.LCFI11:
 774              		.cfi_restore 5
 775              		.cfi_restore 4
 776              		.cfi_def_cfa_offset 0
 467:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 777              		.loc 1 467 26 view .LVU276
 778 0094 FFF7FEBF 		b	USBD_CtrlReceiveData
 779              	.LVL66:
 780              	.L61:
 467:USBDevice/Class/CDC/usbd_ncm.c ****                 break;
 781              		.loc 1 467 26 view .LVU277
 782              		.align	2
 783              	.L60:
 784 0098 1C000100 		.word	65564
 785 009c 04001400 		.word	1310724
 786              		.cfi_endproc
 787              	.LFE153:
 789              		.section	.text.ncm_getDesc,"ax",%progbits
 790              		.align	1
 791              		.p2align 2,,3
 792              		.syntax unified
 793              		.thumb
 794              		.thumb_func
 795              		.fpu fpv4-sp-d16
 797              	ncm_getDesc:
 798              	.LVL67:
 799              	.LFB149:
 301:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DescType *desc = (USBD_NCM_DescType*)dest;
 800              		.loc 1 301 1 is_stmt 1 view -0
 801              		.cfi_startproc
 802              		@ args = 0, pretend = 0, frame = 0
 803              		@ frame_needed = 0, uses_anonymous_args = 0
 302:USBDevice/Class/CDC/usbd_ncm.c ****     uint16_t len = sizeof(ncm_desc);
 804              		.loc 1 302 5 view .LVU279
 301:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DescType *desc = (USBD_NCM_DescType*)dest;
 805              		.loc 1 301 1 is_stmt 0 view .LVU280
 806 0000 70B5     		push	{r4, r5, r6, lr}
 807              	.LCFI12:
 808              		.cfi_def_cfa_offset 16
 809              		.cfi_offset 4, -16
 810              		.cfi_offset 5, -12
 811              		.cfi_offset 6, -8
 812              		.cfi_offset 14, -4
 301:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DescType *desc = (USBD_NCM_DescType*)dest;
 813              		.loc 1 301 1 view .LVU281
 814 0002 1446     		mov	r4, r2
 815 0004 0D46     		mov	r5, r1
 816 0006 0646     		mov	r6, r0
 305:USBDevice/Class/CDC/usbd_ncm.c **** 
 817              		.loc 1 305 5 view .LVU282
 818 0008 4722     		movs	r2, #71
 819              	.LVL68:
 303:USBDevice/Class/CDC/usbd_ncm.c **** 
 820              		.loc 1 303 5 is_stmt 1 view .LVU283
 305:USBDevice/Class/CDC/usbd_ncm.c **** 
 821              		.loc 1 305 5 view .LVU284
 822 000a 1449     		ldr	r1, .L64
ARM GAS  /tmp/ccWJL6at.s 			page 31


 823              	.LVL69:
 305:USBDevice/Class/CDC/usbd_ncm.c **** 
 824              		.loc 1 305 5 is_stmt 0 view .LVU285
 825 000c 2046     		mov	r0, r4
 826              	.LVL70:
 305:USBDevice/Class/CDC/usbd_ncm.c **** 
 827              		.loc 1 305 5 view .LVU286
 828 000e FFF7FEFF 		bl	memcpy
 829              	.LVL71:
 309:USBDevice/Class/CDC/usbd_ncm.c ****     desc->IAD.iFunction = USBD_IIF_INDEX(ifNum, 0);
 830              		.loc 1 309 5 is_stmt 1 view .LVU287
 310:USBDevice/Class/CDC/usbd_ncm.c **** 
 831              		.loc 1 310 27 is_stmt 0 view .LVU288
 832 0012 6B1C     		adds	r3, r5, #1
 321:USBDevice/Class/CDC/usbd_ncm.c **** #endif /* (USBD_MAX_IF_COUNT > 2) */
 833              		.loc 1 321 30 view .LVU289
 834 0014 05F11101 		add	r1, r5, #17
 309:USBDevice/Class/CDC/usbd_ncm.c ****     desc->IAD.iFunction = USBD_IIF_INDEX(ifNum, 0);
 835              		.loc 1 309 32 view .LVU290
 836 0018 A570     		strb	r5, [r4, #2]
 310:USBDevice/Class/CDC/usbd_ncm.c **** 
 837              		.loc 1 310 5 is_stmt 1 view .LVU291
 310:USBDevice/Class/CDC/usbd_ncm.c **** 
 838              		.loc 1 310 27 is_stmt 0 view .LVU292
 839 001a DBB2     		uxtb	r3, r3
 312:USBDevice/Class/CDC/usbd_ncm.c ****     desc->UFD.bMasterInterface = ifNum;
 840              		.loc 1 312 32 view .LVU293
 841 001c A572     		strb	r5, [r4, #10]
 313:USBDevice/Class/CDC/usbd_ncm.c **** 
 842              		.loc 1 313 32 view .LVU294
 843 001e 6576     		strb	r5, [r4, #25]
 326:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.InEpNum, &dest[len]);
 844              		.loc 1 326 12 view .LVU295
 845 0020 04F14702 		add	r2, r4, #71
 321:USBDevice/Class/CDC/usbd_ncm.c **** #endif /* (USBD_MAX_IF_COUNT > 2) */
 846              		.loc 1 321 28 view .LVU296
 847 0024 A177     		strb	r1, [r4, #30]
 310:USBDevice/Class/CDC/usbd_ncm.c **** 
 848              		.loc 1 310 25 view .LVU297
 849 0026 E371     		strb	r3, [r4, #7]
 312:USBDevice/Class/CDC/usbd_ncm.c ****     desc->UFD.bMasterInterface = ifNum;
 850              		.loc 1 312 5 is_stmt 1 view .LVU298
 313:USBDevice/Class/CDC/usbd_ncm.c **** 
 851              		.loc 1 313 5 view .LVU299
 315:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID.bInterfaceNumber = ifNum + 1;
 852              		.loc 1 315 5 view .LVU300
 315:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID.bInterfaceNumber = ifNum + 1;
 853              		.loc 1 315 33 is_stmt 0 view .LVU301
 854 0028 84F83730 		strb	r3, [r4, #55]
 316:USBDevice/Class/CDC/usbd_ncm.c ****     desc->UFD.bSlaveInterface0 = ifNum + 1;
 855              		.loc 1 316 5 is_stmt 1 view .LVU302
 316:USBDevice/Class/CDC/usbd_ncm.c ****     desc->UFD.bSlaveInterface0 = ifNum + 1;
 856              		.loc 1 316 32 is_stmt 0 view .LVU303
 857 002c 84F84030 		strb	r3, [r4, #64]
 317:USBDevice/Class/CDC/usbd_ncm.c **** 
 858              		.loc 1 317 5 is_stmt 1 view .LVU304
 317:USBDevice/Class/CDC/usbd_ncm.c **** 
ARM GAS  /tmp/ccWJL6at.s 			page 32


 859              		.loc 1 317 32 is_stmt 0 view .LVU305
 860 0030 A376     		strb	r3, [r4, #26]
 319:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID.iInterface = USBD_IIF_INDEX(ifNum, 0);
 861              		.loc 1 319 5 is_stmt 1 view .LVU306
 319:USBDevice/Class/CDC/usbd_ncm.c ****     desc->DID.iInterface = USBD_IIF_INDEX(ifNum, 0);
 862              		.loc 1 319 26 is_stmt 0 view .LVU307
 863 0032 2374     		strb	r3, [r4, #16]
 320:USBDevice/Class/CDC/usbd_ncm.c ****     desc->ENFD.iMACAddress = USBD_IIF_INDEX(ifNum, 1);
 864              		.loc 1 320 5 is_stmt 1 view .LVU308
 320:USBDevice/Class/CDC/usbd_ncm.c ****     desc->ENFD.iMACAddress = USBD_IIF_INDEX(ifNum, 1);
 865              		.loc 1 320 26 is_stmt 0 view .LVU309
 866 0034 84F84630 		strb	r3, [r4, #70]
 321:USBDevice/Class/CDC/usbd_ncm.c **** #endif /* (USBD_MAX_IF_COUNT > 2) */
 867              		.loc 1 321 5 is_stmt 1 view .LVU310
 324:USBDevice/Class/CDC/usbd_ncm.c **** 
 868              		.loc 1 324 5 view .LVU311
 324:USBDevice/Class/CDC/usbd_ncm.c **** 
 869              		.loc 1 324 32 is_stmt 0 view .LVU312
 870 0038 B37C     		ldrb	r3, [r6, #18]	@ zero_extendqisi2
 871 003a 84F83030 		strb	r3, [r4, #48]
 326:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.InEpNum, &dest[len]);
 872              		.loc 1 326 5 is_stmt 1 view .LVU313
 326:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.InEpNum, &dest[len]);
 873              		.loc 1 326 12 is_stmt 0 view .LVU314
 874 003e 317C     		ldrb	r1, [r6, #16]	@ zero_extendqisi2
 875 0040 3068     		ldr	r0, [r6]
 876 0042 FFF7FEFF 		bl	USBD_EpDesc
 877              	.LVL72:
 326:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.InEpNum, &dest[len]);
 878              		.loc 1 326 9 view .LVU315
 879 0046 00F14705 		add	r5, r0, #71
 327:USBDevice/Class/CDC/usbd_ncm.c **** 
 880              		.loc 1 327 12 view .LVU316
 881 004a 717C     		ldrb	r1, [r6, #17]	@ zero_extendqisi2
 326:USBDevice/Class/CDC/usbd_ncm.c ****     len += USBD_EpDesc(itf->Base.Device, itf->Config.InEpNum, &dest[len]);
 882              		.loc 1 326 9 view .LVU317
 883 004c ADB2     		uxth	r5, r5
 884              	.LVL73:
 327:USBDevice/Class/CDC/usbd_ncm.c **** 
 885              		.loc 1 327 5 is_stmt 1 view .LVU318
 327:USBDevice/Class/CDC/usbd_ncm.c **** 
 886              		.loc 1 327 12 is_stmt 0 view .LVU319
 887 004e 3068     		ldr	r0, [r6]
 888 0050 6219     		adds	r2, r4, r5
 889 0052 FFF7FEFF 		bl	USBD_EpDesc
 890              	.LVL74:
 338:USBDevice/Class/CDC/usbd_ncm.c **** }
 891              		.loc 1 338 5 is_stmt 1 view .LVU320
 327:USBDevice/Class/CDC/usbd_ncm.c **** 
 892              		.loc 1 327 9 is_stmt 0 view .LVU321
 893 0056 2844     		add	r0, r0, r5
 894              	.LVL75:
 339:USBDevice/Class/CDC/usbd_ncm.c **** 
 895              		.loc 1 339 1 view .LVU322
 896 0058 80B2     		uxth	r0, r0
 897 005a 70BD     		pop	{r4, r5, r6, pc}
 898              	.LVL76:
ARM GAS  /tmp/ccWJL6at.s 			page 33


 899              	.L65:
 339:USBDevice/Class/CDC/usbd_ncm.c **** 
 900              		.loc 1 339 1 view .LVU323
 901              		.align	2
 902              	.L64:
 903 005c 00000000 		.word	.LANCHOR2
 904              		.cfi_endproc
 905              	.LFE149:
 907              		.section	.text.ncm_inData,"ax",%progbits
 908              		.align	1
 909              		.p2align 2,,3
 910              		.syntax unified
 911              		.thumb
 912              		.thumb_func
 913              		.fpu fpv4-sp-d16
 915              	ncm_inData:
 916              	.LVL77:
 917              	.LFB157:
 668:USBDevice/Class/CDC/usbd_ncm.c **** 
 669:USBDevice/Class/CDC/usbd_ncm.c **** /**
 670:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Transmits the other IN NTB page if it's ready.
 671:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 672:USBDevice/Class/CDC/usbd_ncm.c ****  * @param ep: reference to the endpoint structure
 673:USBDevice/Class/CDC/usbd_ncm.c ****  */
 674:USBDevice/Class/CDC/usbd_ncm.c **** static void ncm_inData(USBD_NCM_IfHandleType *itf, USBD_EpHandleType *ep)
 675:USBDevice/Class/CDC/usbd_ncm.c **** {
 918              		.loc 1 675 1 is_stmt 1 view -0
 919              		.cfi_startproc
 920              		@ args = 0, pretend = 0, frame = 0
 921              		@ frame_needed = 0, uses_anonymous_args = 0
 922              		@ link register save eliminated.
 676:USBDevice/Class/CDC/usbd_ncm.c ****     /* NTB sending is considered at the end of both notification
 677:USBDevice/Class/CDC/usbd_ncm.c ****      * and data EP transfer, this is done to ensure the connect
 678:USBDevice/Class/CDC/usbd_ncm.c ****      * notification reaches the host before any NTBs */
 679:USBDevice/Class/CDC/usbd_ncm.c ****     {
 680:USBDevice/Class/CDC/usbd_ncm.c ****         /* Set the state of this buffer to empty */
 681:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.SendState = NTB_EMPTY;
 923              		.loc 1 681 9 view .LVU325
 675:USBDevice/Class/CDC/usbd_ncm.c ****     /* NTB sending is considered at the end of both notification
 924              		.loc 1 675 1 is_stmt 0 view .LVU326
 925 0000 30B4     		push	{r4, r5}
 926              	.LCFI13:
 927              		.cfi_def_cfa_offset 8
 928              		.cfi_offset 4, -8
 929              		.cfi_offset 5, -4
 682:USBDevice/Class/CDC/usbd_ncm.c **** 
 683:USBDevice/Class/CDC/usbd_ncm.c ****         /* Send the other page if it's ready */
 684:USBDevice/Class/CDC/usbd_ncm.c ****         if (itf->In.FillState == NTB_READY)
 930              		.loc 1 684 20 view .LVU327
 931 0002 42F24102 		movw	r2, #8257
 681:USBDevice/Class/CDC/usbd_ncm.c **** 
 932              		.loc 1 681 27 view .LVU328
 933 0006 0025     		movs	r5, #0
 934 0008 00F50154 		add	r4, r0, #8256
 935 000c 2570     		strb	r5, [r4]
 936              		.loc 1 684 9 is_stmt 1 view .LVU329
 937              		.loc 1 684 20 is_stmt 0 view .LVU330
ARM GAS  /tmp/ccWJL6at.s 			page 34


 938 000e 825C     		ldrb	r2, [r0, r2]	@ zero_extendqisi2
 939              		.loc 1 684 12 view .LVU331
 940 0010 032A     		cmp	r2, #3
 941 0012 01D0     		beq	.L69
 685:USBDevice/Class/CDC/usbd_ncm.c ****         {
 686:USBDevice/Class/CDC/usbd_ncm.c ****             void* nth = ep->Transfer.Data - ep->Transfer.Length;
 687:USBDevice/Class/CDC/usbd_ncm.c ****             uint8_t page = ((void*)itf->In.Data[0] == nth) ? 1 : 0;
 688:USBDevice/Class/CDC/usbd_ncm.c ****             ncm_sendNTB(itf, page);
 689:USBDevice/Class/CDC/usbd_ncm.c ****         }
 690:USBDevice/Class/CDC/usbd_ncm.c ****     }
 691:USBDevice/Class/CDC/usbd_ncm.c **** }
 942              		.loc 1 691 1 view .LVU332
 943 0014 30BC     		pop	{r4, r5}
 944              	.LCFI14:
 945              		.cfi_remember_state
 946              		.cfi_restore 5
 947              		.cfi_restore 4
 948              		.cfi_def_cfa_offset 0
 949 0016 7047     		bx	lr
 950              	.L69:
 951              	.LCFI15:
 952              		.cfi_restore_state
 953              	.LVL78:
 954              	.LBB86:
 955              	.LBI86:
 674:USBDevice/Class/CDC/usbd_ncm.c **** {
 956              		.loc 1 674 13 is_stmt 1 view .LVU333
 957              	.LBB87:
 958              	.LBB88:
 686:USBDevice/Class/CDC/usbd_ncm.c ****             uint8_t page = ((void*)itf->In.Data[0] == nth) ? 1 : 0;
 959              		.loc 1 686 13 view .LVU334
 687:USBDevice/Class/CDC/usbd_ncm.c ****             ncm_sendNTB(itf, page);
 960              		.loc 1 687 13 view .LVU335
 688:USBDevice/Class/CDC/usbd_ncm.c ****         }
 961              		.loc 1 688 13 view .LVU336
 686:USBDevice/Class/CDC/usbd_ncm.c ****             uint8_t page = ((void*)itf->In.Data[0] == nth) ? 1 : 0;
 962              		.loc 1 686 57 is_stmt 0 view .LVU337
 963 0018 8C88     		ldrh	r4, [r1, #4]
 687:USBDevice/Class/CDC/usbd_ncm.c ****             ncm_sendNTB(itf, page);
 964              		.loc 1 687 36 view .LVU338
 965 001a 41F23402 		movw	r2, #4148
 686:USBDevice/Class/CDC/usbd_ncm.c ****             uint8_t page = ((void*)itf->In.Data[0] == nth) ? 1 : 0;
 966              		.loc 1 686 19 view .LVU339
 967 001e 0968     		ldr	r1, [r1]
 968              	.LVL79:
 687:USBDevice/Class/CDC/usbd_ncm.c ****             ncm_sendNTB(itf, page);
 969              		.loc 1 687 36 view .LVU340
 970 0020 0244     		add	r2, r2, r0
 686:USBDevice/Class/CDC/usbd_ncm.c ****             uint8_t page = ((void*)itf->In.Data[0] == nth) ? 1 : 0;
 971              		.loc 1 686 19 view .LVU341
 972 0022 091B     		subs	r1, r1, r4
 973              	.LVL80:
 688:USBDevice/Class/CDC/usbd_ncm.c ****         }
 974              		.loc 1 688 13 view .LVU342
 975 0024 891A     		subs	r1, r1, r2
 976              	.LVL81:
 688:USBDevice/Class/CDC/usbd_ncm.c ****         }
ARM GAS  /tmp/ccWJL6at.s 			page 35


 977              		.loc 1 688 13 view .LVU343
 978 0026 B1FA81F1 		clz	r1, r1
 979              	.LBE88:
 980              	.LBE87:
 981              	.LBE86:
 982              		.loc 1 691 1 view .LVU344
 983 002a 30BC     		pop	{r4, r5}
 984              	.LCFI16:
 985              		.cfi_restore 5
 986              		.cfi_restore 4
 987              		.cfi_def_cfa_offset 0
 988              	.LVL82:
 989              	.LBB91:
 990              	.LBB90:
 991              	.LBB89:
 688:USBDevice/Class/CDC/usbd_ncm.c ****         }
 992              		.loc 1 688 13 view .LVU345
 993 002c 4909     		lsrs	r1, r1, #5
 994 002e FFF7FEBF 		b	ncm_sendNTB
 995              	.LVL83:
 688:USBDevice/Class/CDC/usbd_ncm.c ****         }
 996              		.loc 1 688 13 view .LVU346
 997              	.LBE89:
 998              	.LBE90:
 999              	.LBE91:
 1000              		.cfi_endproc
 1001              	.LFE157:
 1003 0032 00BF     		.section	.text.ncm_deinit,"ax",%progbits
 1004              		.align	1
 1005              		.p2align 2,,3
 1006              		.syntax unified
 1007              		.thumb
 1008              		.thumb_func
 1009              		.fpu fpv4-sp-d16
 1011              	ncm_deinit:
 1012              	.LVL84:
 1013              	.LFB152:
 396:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Notify.Connection.Value = 0;
 1014              		.loc 1 396 1 is_stmt 1 view -0
 1015              		.cfi_startproc
 1016              		@ args = 0, pretend = 0, frame = 0
 1017              		@ frame_needed = 0, uses_anonymous_args = 0
 397:USBDevice/Class/CDC/usbd_ncm.c **** 
 1018              		.loc 1 397 5 view .LVU348
 399:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1019              		.loc 1 399 8 is_stmt 0 view .LVU349
 1020 0000 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 397:USBDevice/Class/CDC/usbd_ncm.c **** 
 1021              		.loc 1 397 34 view .LVU350
 1022 0002 0022     		movs	r2, #0
 399:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1023              		.loc 1 399 8 view .LVU351
 1024 0004 012B     		cmp	r3, #1
 397:USBDevice/Class/CDC/usbd_ncm.c **** 
 1025              		.loc 1 397 34 view .LVU352
 1026 0006 C284     		strh	r2, [r0, #38]	@ movhi
 399:USBDevice/Class/CDC/usbd_ncm.c ****     {
ARM GAS  /tmp/ccWJL6at.s 			page 36


 1027              		.loc 1 399 5 is_stmt 1 view .LVU353
 399:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1028              		.loc 1 399 8 is_stmt 0 view .LVU354
 1029 0008 00D0     		beq	.L87
 1030 000a 7047     		bx	lr
 1031              	.L87:
 1032              	.LVL85:
 1033              	.LBB108:
 1034              	.LBI108:
 395:USBDevice/Class/CDC/usbd_ncm.c **** {
 1035              		.loc 1 395 13 is_stmt 1 view .LVU355
 1036              	.LBB109:
 401:USBDevice/Class/CDC/usbd_ncm.c **** 
 1037              		.loc 1 401 9 view .LVU356
 1038              	.LBE109:
 1039              	.LBE108:
 396:USBDevice/Class/CDC/usbd_ncm.c ****     itf->Notify.Connection.Value = 0;
 1040              		.loc 1 396 1 is_stmt 0 view .LVU357
 1041 000c 70B5     		push	{r4, r5, r6, lr}
 1042              	.LCFI17:
 1043              		.cfi_def_cfa_offset 16
 1044              		.cfi_offset 4, -16
 1045              		.cfi_offset 5, -12
 1046              		.cfi_offset 6, -8
 1047              		.cfi_offset 14, -4
 1048              	.LBB145:
 1049              	.LBB142:
 401:USBDevice/Class/CDC/usbd_ncm.c **** 
 1050              		.loc 1 401 26 view .LVU358
 1051 000e 0568     		ldr	r5, [r0]
 1052              	.LVL86:
 404:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.OutEpNum);
 1053              		.loc 1 404 9 is_stmt 1 view .LVU359
 1054 0010 0446     		mov	r4, r0
 1055 0012 467C     		ldrb	r6, [r0, #17]	@ zero_extendqisi2
 1056              	.LVL87:
 1057              	.LBB110:
 1058              	.LBI110:
 1059              		.file 2 "USBDevice/Include/private/usbd_internal.h"
   1:USBDevice/Include/private/usbd_internal.h **** /**
   2:USBDevice/Include/private/usbd_internal.h ****   ******************************************************************************
   3:USBDevice/Include/private/usbd_internal.h ****   * @file    usbd_internal.h
   4:USBDevice/Include/private/usbd_internal.h ****   * @author  Benedek Kupper
   5:USBDevice/Include/private/usbd_internal.h ****   * @version 0.1
   6:USBDevice/Include/private/usbd_internal.h ****   * @date    2018-01-31
   7:USBDevice/Include/private/usbd_internal.h ****   * @brief   Universal Serial Bus Device Driver
   8:USBDevice/Include/private/usbd_internal.h ****   *          Services accessible by (class) interfaces
   9:USBDevice/Include/private/usbd_internal.h ****   *
  10:USBDevice/Include/private/usbd_internal.h ****   * Copyright (c) 2018 Benedek Kupper
  11:USBDevice/Include/private/usbd_internal.h ****   *
  12:USBDevice/Include/private/usbd_internal.h ****   * Licensed under the Apache License, Version 2.0 (the "License");
  13:USBDevice/Include/private/usbd_internal.h ****   * you may not use this file except in compliance with the License.
  14:USBDevice/Include/private/usbd_internal.h ****   * You may obtain a copy of the License at
  15:USBDevice/Include/private/usbd_internal.h ****   *
  16:USBDevice/Include/private/usbd_internal.h ****   *     http://www.apache.org/licenses/LICENSE-2.0
  17:USBDevice/Include/private/usbd_internal.h ****   *
  18:USBDevice/Include/private/usbd_internal.h ****   * Unless required by applicable law or agreed to in writing, software
ARM GAS  /tmp/ccWJL6at.s 			page 37


  19:USBDevice/Include/private/usbd_internal.h ****   * distributed under the License is distributed on an "AS IS" BASIS,
  20:USBDevice/Include/private/usbd_internal.h ****   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  21:USBDevice/Include/private/usbd_internal.h ****   * See the License for the specific language governing permissions and
  22:USBDevice/Include/private/usbd_internal.h ****   * limitations under the License.
  23:USBDevice/Include/private/usbd_internal.h ****   */
  24:USBDevice/Include/private/usbd_internal.h **** #ifndef __USBD_INTERNAL_H_
  25:USBDevice/Include/private/usbd_internal.h **** #define __USBD_INTERNAL_H_
  26:USBDevice/Include/private/usbd_internal.h **** 
  27:USBDevice/Include/private/usbd_internal.h **** #ifdef __cplusplus
  28:USBDevice/Include/private/usbd_internal.h **** extern "C"
  29:USBDevice/Include/private/usbd_internal.h **** {
  30:USBDevice/Include/private/usbd_internal.h **** #endif
  31:USBDevice/Include/private/usbd_internal.h **** 
  32:USBDevice/Include/private/usbd_internal.h **** #include <usbd.h>
  33:USBDevice/Include/private/usbd_internal.h **** #include <usbd_pd_if.h>
  34:USBDevice/Include/private/usbd_internal.h **** 
  35:USBDevice/Include/private/usbd_internal.h **** /* strlen(), memcpy() */
  36:USBDevice/Include/private/usbd_internal.h **** #include <string.h>
  37:USBDevice/Include/private/usbd_internal.h **** 
  38:USBDevice/Include/private/usbd_internal.h **** /** @ingroup USBD
  39:USBDevice/Include/private/usbd_internal.h ****  * @addtogroup USBD_Internal_Functions
  40:USBDevice/Include/private/usbd_internal.h ****  * @{ */
  41:USBDevice/Include/private/usbd_internal.h **** 
  42:USBDevice/Include/private/usbd_internal.h **** USBD_ReturnType USBD_CtrlSendData       (USBD_HandleType *dev,
  43:USBDevice/Include/private/usbd_internal.h ****                                          void *data,
  44:USBDevice/Include/private/usbd_internal.h ****                                          uint16_t len);
  45:USBDevice/Include/private/usbd_internal.h **** 
  46:USBDevice/Include/private/usbd_internal.h **** USBD_ReturnType USBD_CtrlReceiveData    (USBD_HandleType *dev,
  47:USBDevice/Include/private/usbd_internal.h ****                                          void *data);
  48:USBDevice/Include/private/usbd_internal.h **** 
  49:USBDevice/Include/private/usbd_internal.h **** uint16_t        USBD_EpDesc             (USBD_HandleType *dev,
  50:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
  51:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t *data);
  52:USBDevice/Include/private/usbd_internal.h **** 
  53:USBDevice/Include/private/usbd_internal.h **** uint8_t         USBD_EpHsInterval       (uint32_t interval_ms);
  54:USBDevice/Include/private/usbd_internal.h **** 
  55:USBDevice/Include/private/usbd_internal.h **** USBD_ReturnType USBD_EpSend             (USBD_HandleType *dev,
  56:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
  57:USBDevice/Include/private/usbd_internal.h ****                                          void *data,
  58:USBDevice/Include/private/usbd_internal.h ****                                          uint16_t len);
  59:USBDevice/Include/private/usbd_internal.h **** 
  60:USBDevice/Include/private/usbd_internal.h **** USBD_ReturnType USBD_EpReceive          (USBD_HandleType *dev,
  61:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
  62:USBDevice/Include/private/usbd_internal.h ****                                          void *data,
  63:USBDevice/Include/private/usbd_internal.h ****                                          uint16_t len);
  64:USBDevice/Include/private/usbd_internal.h **** 
  65:USBDevice/Include/private/usbd_internal.h **** /**
  66:USBDevice/Include/private/usbd_internal.h ****  * @brief Converts the USBD endpoint address to its reference.
  67:USBDevice/Include/private/usbd_internal.h ****  * @param dev: USB Device handle reference
  68:USBDevice/Include/private/usbd_internal.h ****  * @param epAddr: endpoint address
  69:USBDevice/Include/private/usbd_internal.h ****  * @return The endpoint's reference
  70:USBDevice/Include/private/usbd_internal.h ****  */
  71:USBDevice/Include/private/usbd_internal.h **** static inline
  72:USBDevice/Include/private/usbd_internal.h **** USBD_EpHandleType* USBD_EpAddr2Ref      (USBD_HandleType *dev,
  73:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
  74:USBDevice/Include/private/usbd_internal.h **** {
  75:USBDevice/Include/private/usbd_internal.h ****     return (epAddr > 0x7F) ? &dev->EP.IN[epAddr & 0xF] : &dev->EP.OUT[epAddr];
ARM GAS  /tmp/ccWJL6at.s 			page 38


  76:USBDevice/Include/private/usbd_internal.h **** }
  77:USBDevice/Include/private/usbd_internal.h **** 
  78:USBDevice/Include/private/usbd_internal.h **** /**
  79:USBDevice/Include/private/usbd_internal.h ****  * @brief Converts the USBD endpoint reference to its address.
  80:USBDevice/Include/private/usbd_internal.h ****  * @param dev: USB Device handle reference
  81:USBDevice/Include/private/usbd_internal.h ****  * @param ep: USB endpoint handle reference
  82:USBDevice/Include/private/usbd_internal.h ****  * @return The endpoint's address
  83:USBDevice/Include/private/usbd_internal.h ****  */
  84:USBDevice/Include/private/usbd_internal.h **** static inline uint8_t USBD_EpRef2Addr   (USBD_HandleType *dev,
  85:USBDevice/Include/private/usbd_internal.h ****                                          USBD_EpHandleType *ep)
  86:USBDevice/Include/private/usbd_internal.h **** {
  87:USBDevice/Include/private/usbd_internal.h ****     uint8_t epAddr = (((uint32_t)ep - (uint32_t)&dev->EP.IN[0])
  88:USBDevice/Include/private/usbd_internal.h ****             / sizeof(USBD_EpHandleType));
  89:USBDevice/Include/private/usbd_internal.h ****     return (epAddr < USBD_MAX_EP_COUNT) ?
  90:USBDevice/Include/private/usbd_internal.h ****             (0x80 | epAddr) :                   /* IN endpoint */
  91:USBDevice/Include/private/usbd_internal.h ****             (epAddr - USBD_MAX_EP_COUNT); /* OUT endpoint */
  92:USBDevice/Include/private/usbd_internal.h **** }
  93:USBDevice/Include/private/usbd_internal.h **** 
  94:USBDevice/Include/private/usbd_internal.h **** /**
  95:USBDevice/Include/private/usbd_internal.h ****  * @brief Opens the device endpoint.
  96:USBDevice/Include/private/usbd_internal.h ****  * @param dev: USB Device handle reference
  97:USBDevice/Include/private/usbd_internal.h ****  * @param epAddr: endpoint address
  98:USBDevice/Include/private/usbd_internal.h ****  * @param type: endpoint type
  99:USBDevice/Include/private/usbd_internal.h ****  * @param mps: endpoint maximal packet size
 100:USBDevice/Include/private/usbd_internal.h ****  */
 101:USBDevice/Include/private/usbd_internal.h **** static inline void USBD_EpOpen          (USBD_HandleType *dev,
 102:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
 103:USBDevice/Include/private/usbd_internal.h ****                                          USB_EndPointType type,
 104:USBDevice/Include/private/usbd_internal.h ****                                          uint16_t mps)
 105:USBDevice/Include/private/usbd_internal.h **** {
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_PD_EpOpen(dev, epAddr, type, mps);
 107:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 108:USBDevice/Include/private/usbd_internal.h **** }
 109:USBDevice/Include/private/usbd_internal.h **** 
 110:USBDevice/Include/private/usbd_internal.h **** /**
 111:USBDevice/Include/private/usbd_internal.h ****  * @brief Closes the device endpoint.
 112:USBDevice/Include/private/usbd_internal.h ****  * @param dev: USB Device handle reference
 113:USBDevice/Include/private/usbd_internal.h ****  * @param epAddr: endpoint address
 114:USBDevice/Include/private/usbd_internal.h ****  */
 115:USBDevice/Include/private/usbd_internal.h **** static inline void USBD_EpClose         (USBD_HandleType *dev,
 1060              		.loc 2 115 20 view .LVU360
 1061              	.LBB111:
 116:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 117:USBDevice/Include/private/usbd_internal.h **** {
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_PD_EpClose(dev, epAddr);
 1062              		.loc 2 118 5 view .LVU361
 1063 0014 2846     		mov	r0, r5
 1064              	.LVL88:
 1065              		.loc 2 118 5 is_stmt 0 view .LVU362
 1066 0016 3146     		mov	r1, r6
 1067 0018 FFF7FEFF 		bl	USB_vEpClose
 1068              	.LVL89:
 119:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 1069              		.loc 2 119 5 is_stmt 1 view .LVU363
 1070              	.LBB112:
 1071              	.LBI112:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
ARM GAS  /tmp/ccWJL6at.s 			page 39


 1072              		.loc 2 72 20 view .LVU364
 1073              	.LBB113:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1074              		.loc 2 75 5 view .LVU365
  75:USBDevice/Include/private/usbd_internal.h **** }
 1075              		.loc 2 75 56 is_stmt 0 view .LVU366
 1076 001c 3106     		lsls	r1, r6, #24
 1077 001e 23D4     		bmi	.L88
  75:USBDevice/Include/private/usbd_internal.h **** }
 1078              		.loc 2 75 56 view .LVU367
 1079 0020 05EB0616 		add	r6, r5, r6, lsl #4
 1080              	.LVL90:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1081              		.loc 2 75 56 view .LVU368
 1082 0024 AC36     		adds	r6, r6, #172
 1083              	.L74:
 1084              	.LVL91:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1085              		.loc 2 75 56 view .LVU369
 1086              	.LBE113:
 1087              	.LBE112:
 1088              		.loc 2 119 41 view .LVU370
 1089 0026 0023     		movs	r3, #0
 1090              	.LBE111:
 1091              	.LBE110:
 1092              	.LBB118:
 1093              	.LBB119:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 1094              		.loc 2 118 5 view .LVU371
 1095 0028 2846     		mov	r0, r5
 1096              	.LBE119:
 1097              	.LBE118:
 1098              	.LBB127:
 1099              	.LBB116:
 1100              		.loc 2 119 41 view .LVU372
 1101 002a F372     		strb	r3, [r6, #11]
 1102              	.LVL92:
 1103              		.loc 2 119 41 view .LVU373
 1104              	.LBE116:
 1105              	.LBE127:
 405:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.NotEpNum);
 1106              		.loc 1 405 9 is_stmt 1 view .LVU374
 1107 002c 267C     		ldrb	r6, [r4, #16]	@ zero_extendqisi2
 1108              	.LVL93:
 1109              	.LBB128:
 1110              	.LBI118:
 115:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1111              		.loc 2 115 20 view .LVU375
 1112              	.LBB124:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 1113              		.loc 2 118 5 view .LVU376
 1114 002e 3146     		mov	r1, r6
 1115 0030 FFF7FEFF 		bl	USB_vEpClose
 1116              	.LVL94:
 1117              		.loc 2 119 5 view .LVU377
 1118              	.LBB120:
 1119              	.LBI120:
ARM GAS  /tmp/ccWJL6at.s 			page 40


  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1120              		.loc 2 72 20 view .LVU378
 1121              	.LBB121:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1122              		.loc 2 75 5 view .LVU379
  75:USBDevice/Include/private/usbd_internal.h **** }
 1123              		.loc 2 75 56 is_stmt 0 view .LVU380
 1124 0034 3206     		lsls	r2, r6, #24
 1125 0036 24D4     		bmi	.L89
 1126 0038 05EB0616 		add	r6, r5, r6, lsl #4
 1127              	.LVL95:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1128              		.loc 2 75 56 view .LVU381
 1129 003c AC36     		adds	r6, r6, #172
 1130              	.L76:
 1131              	.LVL96:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1132              		.loc 2 75 56 view .LVU382
 1133              	.LBE121:
 1134              	.LBE120:
 1135              		.loc 2 119 41 view .LVU383
 1136 003e 0023     		movs	r3, #0
 1137              	.LBE124:
 1138              	.LBE128:
 1139              	.LBB129:
 1140              	.LBB130:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 1141              		.loc 2 118 5 view .LVU384
 1142 0040 2846     		mov	r0, r5
 1143              	.LBE130:
 1144              	.LBE129:
 1145              	.LBB137:
 1146              	.LBB125:
 1147              		.loc 2 119 41 view .LVU385
 1148 0042 F372     		strb	r3, [r6, #11]
 1149              	.LVL97:
 1150              		.loc 2 119 41 view .LVU386
 1151              	.LBE125:
 1152              	.LBE137:
 406:USBDevice/Class/CDC/usbd_ncm.c **** 
 1153              		.loc 1 406 9 is_stmt 1 view .LVU387
 1154 0044 A67C     		ldrb	r6, [r4, #18]	@ zero_extendqisi2
 1155              	.LVL98:
 1156              	.LBB138:
 1157              	.LBI129:
 115:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1158              		.loc 2 115 20 view .LVU388
 1159              	.LBB135:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 1160              		.loc 2 118 5 view .LVU389
 1161 0046 3146     		mov	r1, r6
 1162 0048 FFF7FEFF 		bl	USB_vEpClose
 1163              	.LVL99:
 1164              		.loc 2 119 5 view .LVU390
 1165              	.LBB131:
 1166              	.LBI131:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
ARM GAS  /tmp/ccWJL6at.s 			page 41


 1167              		.loc 2 72 20 view .LVU391
 1168              	.LBB132:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1169              		.loc 2 75 5 view .LVU392
  75:USBDevice/Include/private/usbd_internal.h **** }
 1170              		.loc 2 75 56 is_stmt 0 view .LVU393
 1171 004c 3306     		lsls	r3, r6, #24
 1172 004e 12D4     		bmi	.L90
 1173 0050 05EB0615 		add	r5, r5, r6, lsl #4
 1174              	.LVL100:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1175              		.loc 2 75 56 view .LVU394
 1176 0054 AC35     		adds	r5, r5, #172
 1177              	.LVL101:
 1178              	.L78:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1179              		.loc 2 75 56 view .LVU395
 1180              	.LBE132:
 1181              	.LBE131:
 1182              		.loc 2 119 41 view .LVU396
 1183 0056 0023     		movs	r3, #0
 1184 0058 EB72     		strb	r3, [r5, #11]
 1185              		.loc 2 119 41 view .LVU397
 1186              	.LBE135:
 1187              	.LBE138:
 409:USBDevice/Class/CDC/usbd_ncm.c **** 
 1188              		.loc 1 409 9 is_stmt 1 view .LVU398
 409:USBDevice/Class/CDC/usbd_ncm.c **** 
 1189              		.loc 1 409 9 view .LVU399
 1190 005a E368     		ldr	r3, [r4, #12]
 1191 005c DB68     		ldr	r3, [r3, #12]
 1192 005e 4BB1     		cbz	r3, .L70
 409:USBDevice/Class/CDC/usbd_ncm.c **** 
 1193              		.loc 1 409 9 view .LVU400
 1194 0060 2046     		mov	r0, r4
 1195              	.LBE142:
 1196              	.LBE145:
 417:USBDevice/Class/CDC/usbd_ncm.c **** 
 1197              		.loc 1 417 1 is_stmt 0 view .LVU401
 1198 0062 BDE87040 		pop	{r4, r5, r6, lr}
 1199              	.LCFI18:
 1200              		.cfi_remember_state
 1201              		.cfi_restore 14
 1202              		.cfi_restore 6
 1203              		.cfi_restore 5
 1204              		.cfi_restore 4
 1205              		.cfi_def_cfa_offset 0
 1206              	.LVL102:
 1207              	.LBB146:
 1208              	.LBB143:
 409:USBDevice/Class/CDC/usbd_ncm.c **** 
 1209              		.loc 1 409 9 view .LVU402
 1210 0066 1847     		bx	r3	@ indirect register sibling call
 1211              	.LVL103:
 1212              	.L88:
 1213              	.LCFI19:
 1214              		.cfi_restore_state
ARM GAS  /tmp/ccWJL6at.s 			page 42


 1215              	.LBB139:
 1216              	.LBB117:
 1217              	.LBB115:
 1218              	.LBB114:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1219              		.loc 2 75 56 view .LVU403
 1220 0068 06F00F06 		and	r6, r6, #15
 1221              	.LVL104:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1222              		.loc 2 75 56 view .LVU404
 1223 006c 05EB0616 		add	r6, r5, r6, lsl #4
 1224 0070 4C36     		adds	r6, r6, #76
 1225 0072 D8E7     		b	.L74
 1226              	.LVL105:
 1227              	.L70:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1228              		.loc 2 75 56 view .LVU405
 1229              	.LBE114:
 1230              	.LBE115:
 1231              	.LBE117:
 1232              	.LBE139:
 1233              	.LBE143:
 1234              	.LBE146:
 417:USBDevice/Class/CDC/usbd_ncm.c **** 
 1235              		.loc 1 417 1 view .LVU406
 1236 0074 70BD     		pop	{r4, r5, r6, pc}
 1237              	.LVL106:
 1238              	.L90:
 1239              	.LBB147:
 1240              	.LBB144:
 1241              	.LBB140:
 1242              	.LBB136:
 1243              	.LBB134:
 1244              	.LBB133:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1245              		.loc 2 75 56 view .LVU407
 1246 0076 06F00F06 		and	r6, r6, #15
 1247              	.LVL107:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1248              		.loc 2 75 56 view .LVU408
 1249 007a 05EB0615 		add	r5, r5, r6, lsl #4
 1250              	.LVL108:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1251              		.loc 2 75 56 view .LVU409
 1252 007e 4C35     		adds	r5, r5, #76
 1253 0080 E9E7     		b	.L78
 1254              	.LVL109:
 1255              	.L89:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1256              		.loc 2 75 56 view .LVU410
 1257              	.LBE133:
 1258              	.LBE134:
 1259              	.LBE136:
 1260              	.LBE140:
 1261              	.LBB141:
 1262              	.LBB126:
 1263              	.LBB123:
ARM GAS  /tmp/ccWJL6at.s 			page 43


 1264              	.LBB122:
 1265 0082 06F00F06 		and	r6, r6, #15
 1266              	.LVL110:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1267              		.loc 2 75 56 view .LVU411
 1268 0086 05EB0616 		add	r6, r5, r6, lsl #4
 1269 008a 4C36     		adds	r6, r6, #76
 1270 008c D7E7     		b	.L76
 1271              	.LBE122:
 1272              	.LBE123:
 1273              	.LBE126:
 1274              	.LBE141:
 1275              	.LBE144:
 1276              	.LBE147:
 1277              		.cfi_endproc
 1278              	.LFE152:
 1280 008e 00BF     		.section	.text.ncm_init,"ax",%progbits
 1281              		.align	1
 1282              		.p2align 2,,3
 1283              		.syntax unified
 1284              		.thumb
 1285              		.thumb_func
 1286              		.fpu fpv4-sp-d16
 1288              	ncm_init:
 1289              	.LVL111:
 1290              	.LFB151:
 371:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Base.AltSelector == 1)
 1291              		.loc 1 371 1 is_stmt 1 view -0
 1292              		.cfi_startproc
 1293              		@ args = 0, pretend = 0, frame = 0
 1294              		@ frame_needed = 0, uses_anonymous_args = 0
 372:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1295              		.loc 1 372 5 view .LVU413
 371:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Base.AltSelector == 1)
 1296              		.loc 1 371 1 is_stmt 0 view .LVU414
 1297 0000 70B5     		push	{r4, r5, r6, lr}
 1298              	.LCFI20:
 1299              		.cfi_def_cfa_offset 16
 1300              		.cfi_offset 4, -16
 1301              		.cfi_offset 5, -12
 1302              		.cfi_offset 6, -8
 1303              		.cfi_offset 14, -4
 372:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1304              		.loc 1 372 8 view .LVU415
 1305 0002 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 371:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Base.AltSelector == 1)
 1306              		.loc 1 371 1 view .LVU416
 1307 0004 0446     		mov	r4, r0
 372:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1308              		.loc 1 372 8 view .LVU417
 1309 0006 012B     		cmp	r3, #1
 1310 0008 05D0     		beq	.L100
 384:USBDevice/Class/CDC/usbd_ncm.c **** 
 1311              		.loc 1 384 9 is_stmt 1 view .LVU418
 384:USBDevice/Class/CDC/usbd_ncm.c **** 
 1312              		.loc 1 384 25 is_stmt 0 view .LVU419
 1313 000a 42F23403 		movw	r3, #8244
ARM GAS  /tmp/ccWJL6at.s 			page 44


 1314 000e 4FF40062 		mov	r2, #2048
 1315 0012 C250     		str	r2, [r0, r3]
 1316              	.LVL112:
 1317              	.L91:
 388:USBDevice/Class/CDC/usbd_ncm.c **** 
 1318              		.loc 1 388 1 view .LVU420
 1319 0014 70BD     		pop	{r4, r5, r6, pc}
 1320              	.LVL113:
 1321              	.L100:
 1322              	.LBB154:
 1323              	.LBI154:
 370:USBDevice/Class/CDC/usbd_ncm.c **** {
 1324              		.loc 1 370 13 is_stmt 1 view .LVU421
 1325              	.LBB155:
 375:USBDevice/Class/CDC/usbd_ncm.c ****                 USB_EP_TYPE_INTERRUPT, NCM_NOT_PACKET_SIZE);
 1326              		.loc 1 375 9 view .LVU422
 1327 0016 867C     		ldrb	r6, [r0, #18]	@ zero_extendqisi2
 1328              	.LBB156:
 1329              	.LBB157:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1330              		.loc 2 106 5 is_stmt 0 view .LVU423
 1331 0018 0823     		movs	r3, #8
 1332              	.LBE157:
 1333              	.LBE156:
 375:USBDevice/Class/CDC/usbd_ncm.c ****                 USB_EP_TYPE_INTERRUPT, NCM_NOT_PACKET_SIZE);
 1334              		.loc 1 375 30 view .LVU424
 1335 001a 0568     		ldr	r5, [r0]
 1336              	.LVL114:
 1337              	.LBB164:
 1338              	.LBI156:
 101:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
 1339              		.loc 2 101 20 is_stmt 1 view .LVU425
 1340              	.LBB162:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1341              		.loc 2 106 5 view .LVU426
 1342 001c 0322     		movs	r2, #3
 1343 001e 3146     		mov	r1, r6
 1344 0020 2846     		mov	r0, r5
 1345              	.LVL115:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1346              		.loc 2 106 5 is_stmt 0 view .LVU427
 1347 0022 FFF7FEFF 		bl	USB_vEpOpen
 1348              	.LVL116:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1349              		.loc 2 107 5 is_stmt 1 view .LVU428
 1350              	.LBB158:
 1351              	.LBI158:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1352              		.loc 2 72 20 view .LVU429
 1353              	.LBB159:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1354              		.loc 2 75 5 view .LVU430
  75:USBDevice/Include/private/usbd_internal.h **** }
 1355              		.loc 2 75 56 is_stmt 0 view .LVU431
 1356 0026 3306     		lsls	r3, r6, #24
 1357 0028 0CD4     		bmi	.L101
 1358 002a 05EB0615 		add	r5, r5, r6, lsl #4
ARM GAS  /tmp/ccWJL6at.s 			page 45


 1359              	.LVL117:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1360              		.loc 2 75 56 view .LVU432
 1361 002e AC35     		adds	r5, r5, #172
 1362              	.LVL118:
 1363              	.L94:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1364              		.loc 2 75 56 view .LVU433
 1365              	.LBE159:
 1366              	.LBE158:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1367              		.loc 2 107 41 view .LVU434
 1368 0030 0123     		movs	r3, #1
 1369 0032 EB72     		strb	r3, [r5, #11]
 1370              	.LVL119:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1371              		.loc 2 107 41 view .LVU435
 1372              	.LBE162:
 1373              	.LBE164:
 379:USBDevice/Class/CDC/usbd_ncm.c ****     }
 1374              		.loc 1 379 9 is_stmt 1 view .LVU436
 379:USBDevice/Class/CDC/usbd_ncm.c ****     }
 1375              		.loc 1 379 9 view .LVU437
 1376 0034 E368     		ldr	r3, [r4, #12]
 1377 0036 9B68     		ldr	r3, [r3, #8]
 1378 0038 002B     		cmp	r3, #0
 1379 003a EBD0     		beq	.L91
 379:USBDevice/Class/CDC/usbd_ncm.c ****     }
 1380              		.loc 1 379 9 view .LVU438
 1381 003c 2046     		mov	r0, r4
 1382              	.LBE155:
 1383              	.LBE154:
 388:USBDevice/Class/CDC/usbd_ncm.c **** 
 1384              		.loc 1 388 1 is_stmt 0 view .LVU439
 1385 003e BDE87040 		pop	{r4, r5, r6, lr}
 1386              	.LCFI21:
 1387              		.cfi_remember_state
 1388              		.cfi_restore 14
 1389              		.cfi_restore 6
 1390              		.cfi_restore 5
 1391              		.cfi_restore 4
 1392              		.cfi_def_cfa_offset 0
 1393              	.LVL120:
 1394              	.LBB167:
 1395              	.LBB166:
 379:USBDevice/Class/CDC/usbd_ncm.c ****     }
 1396              		.loc 1 379 9 view .LVU440
 1397 0042 1847     		bx	r3	@ indirect register sibling call
 1398              	.LVL121:
 1399              	.L101:
 1400              	.LCFI22:
 1401              		.cfi_restore_state
 1402              	.LBB165:
 1403              	.LBB163:
 1404              	.LBB161:
 1405              	.LBB160:
  75:USBDevice/Include/private/usbd_internal.h **** }
ARM GAS  /tmp/ccWJL6at.s 			page 46


 1406              		.loc 2 75 56 view .LVU441
 1407 0044 06F00F06 		and	r6, r6, #15
 1408              	.LVL122:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1409              		.loc 2 75 56 view .LVU442
 1410 0048 05EB0615 		add	r5, r5, r6, lsl #4
 1411              	.LVL123:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1412              		.loc 2 75 56 view .LVU443
 1413 004c 4C35     		adds	r5, r5, #76
 1414 004e EFE7     		b	.L94
 1415              	.LBE160:
 1416              	.LBE161:
 1417              	.LBE163:
 1418              	.LBE165:
 1419              	.LBE166:
 1420              	.LBE167:
 1421              		.cfi_endproc
 1422              	.LFE151:
 1424              		.section	.text.ncm_getString,"ax",%progbits
 1425              		.align	1
 1426              		.p2align 2,,3
 1427              		.syntax unified
 1428              		.thumb
 1429              		.thumb_func
 1430              		.fpu fpv4-sp-d16
 1432              	ncm_getString:
 1433              	.LVL124:
 1434              	.LFB150:
 348:USBDevice/Class/CDC/usbd_ncm.c ****     const char* str;
 1435              		.loc 1 348 1 is_stmt 1 view -0
 1436              		.cfi_startproc
 1437              		@ args = 0, pretend = 0, frame = 0
 1438              		@ frame_needed = 0, uses_anonymous_args = 0
 349:USBDevice/Class/CDC/usbd_ncm.c ****     if (intNum == 0)
 1439              		.loc 1 349 5 view .LVU445
 350:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1440              		.loc 1 350 5 view .LVU446
 1441 0000 C368     		ldr	r3, [r0, #12]
 348:USBDevice/Class/CDC/usbd_ncm.c ****     const char* str;
 1442              		.loc 1 348 1 is_stmt 0 view .LVU447
 1443 0002 10B5     		push	{r4, lr}
 1444              	.LCFI23:
 1445              		.cfi_def_cfa_offset 8
 1446              		.cfi_offset 4, -8
 1447              		.cfi_offset 14, -4
 350:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1448              		.loc 1 350 8 view .LVU448
 1449 0004 11B9     		cbnz	r1, .L103
 352:USBDevice/Class/CDC/usbd_ncm.c ****     }
 1450              		.loc 1 352 9 is_stmt 1 view .LVU449
 352:USBDevice/Class/CDC/usbd_ncm.c ****     }
 1451              		.loc 1 352 13 is_stmt 0 view .LVU450
 1452 0006 1C68     		ldr	r4, [r3]
 1453              	.LVL125:
 363:USBDevice/Class/CDC/usbd_ncm.c **** 
 1454              		.loc 1 363 1 view .LVU451
ARM GAS  /tmp/ccWJL6at.s 			page 47


 1455 0008 2046     		mov	r0, r4
 1456              	.LVL126:
 363:USBDevice/Class/CDC/usbd_ncm.c **** 
 1457              		.loc 1 363 1 view .LVU452
 1458 000a 10BD     		pop	{r4, pc}
 1459              	.LVL127:
 1460              	.L103:
 1461              	.LBB170:
 1462              	.LBI170:
 347:USBDevice/Class/CDC/usbd_ncm.c **** {
 1463              		.loc 1 347 20 is_stmt 1 view .LVU453
 1464              	.LBB171:
 357:USBDevice/Class/CDC/usbd_ncm.c ****                 sizeof(*NCM_APP(itf)->NetAddress) * 4;
 1465              		.loc 1 357 9 view .LVU454
 357:USBDevice/Class/CDC/usbd_ncm.c ****                 sizeof(*NCM_APP(itf)->NetAddress) * 4;
 1466              		.loc 1 357 13 is_stmt 0 view .LVU455
 1467 000c 0468     		ldr	r4, [r0]
 359:USBDevice/Class/CDC/usbd_ncm.c ****                 2 * sizeof(*NCM_APP(itf)->NetAddress));
 1468              		.loc 1 359 9 view .LVU456
 1469 000e 0C22     		movs	r2, #12
 1470 0010 5868     		ldr	r0, [r3, #4]
 1471              	.LVL128:
 357:USBDevice/Class/CDC/usbd_ncm.c ****                 sizeof(*NCM_APP(itf)->NetAddress) * 4;
 1472              		.loc 1 357 13 view .LVU457
 1473 0012 04F59374 		add	r4, r4, #294
 1474              	.LVL129:
 359:USBDevice/Class/CDC/usbd_ncm.c ****                 2 * sizeof(*NCM_APP(itf)->NetAddress));
 1475              		.loc 1 359 9 is_stmt 1 view .LVU458
 1476 0016 2146     		mov	r1, r4
 1477              	.LVL130:
 359:USBDevice/Class/CDC/usbd_ncm.c ****                 2 * sizeof(*NCM_APP(itf)->NetAddress));
 1478              		.loc 1 359 9 is_stmt 0 view .LVU459
 1479 0018 FFF7FEFF 		bl	Uint2Unicode
 1480              	.LVL131:
 362:USBDevice/Class/CDC/usbd_ncm.c **** }
 1481              		.loc 1 362 5 is_stmt 1 view .LVU460
 362:USBDevice/Class/CDC/usbd_ncm.c **** }
 1482              		.loc 1 362 5 is_stmt 0 view .LVU461
 1483              	.LBE171:
 1484              	.LBE170:
 362:USBDevice/Class/CDC/usbd_ncm.c **** }
 1485              		.loc 1 362 5 is_stmt 1 view .LVU462
 363:USBDevice/Class/CDC/usbd_ncm.c **** 
 1486              		.loc 1 363 1 is_stmt 0 view .LVU463
 1487 001c 2046     		mov	r0, r4
 1488 001e 10BD     		pop	{r4, pc}
 363:USBDevice/Class/CDC/usbd_ncm.c **** 
 1489              		.loc 1 363 1 view .LVU464
 1490              		.cfi_endproc
 1491              	.LFE150:
 1493              		.section	.text.USBD_NCM_MountInterface,"ax",%progbits
 1494              		.align	1
 1495              		.p2align 2,,3
 1496              		.global	USBD_NCM_MountInterface
 1497              		.syntax unified
 1498              		.thumb
 1499              		.thumb_func
ARM GAS  /tmp/ccWJL6at.s 			page 48


 1500              		.fpu fpv4-sp-d16
 1502              	USBD_NCM_MountInterface:
 1503              	.LVL132:
 1504              	.LFB158:
 692:USBDevice/Class/CDC/usbd_ncm.c **** 
 693:USBDevice/Class/CDC/usbd_ncm.c **** /** @} */
 694:USBDevice/Class/CDC/usbd_ncm.c **** 
 695:USBDevice/Class/CDC/usbd_ncm.c **** /** @defgroup USBD_NCM_Exported_Functions NCM Exported Functions
 696:USBDevice/Class/CDC/usbd_ncm.c ****  * @{ */
 697:USBDevice/Class/CDC/usbd_ncm.c **** 
 698:USBDevice/Class/CDC/usbd_ncm.c **** /**
 699:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Mounts the NCM interface to the USB Device at the next two interface slots.
 700:USBDevice/Class/CDC/usbd_ncm.c ****  * @note  The NCM class uses two device interface slots per software interface.
 701:USBDevice/Class/CDC/usbd_ncm.c ****  * @note  The interface reference shall have its @ref USBD_NCM_IfHandleType::Config structure
 702:USBDevice/Class/CDC/usbd_ncm.c ****  *        and @ref USBD_NCM_IfHandleType::App reference properly set before this function is called
 703:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 704:USBDevice/Class/CDC/usbd_ncm.c ****  * @param dev: reference of the USB Device
 705:USBDevice/Class/CDC/usbd_ncm.c ****  * @return OK if the mounting was successful,
 706:USBDevice/Class/CDC/usbd_ncm.c ****  *         ERROR if it failed due to insufficient device interface slots
 707:USBDevice/Class/CDC/usbd_ncm.c ****  */
 708:USBDevice/Class/CDC/usbd_ncm.c **** USBD_ReturnType USBD_NCM_MountInterface(USBD_NCM_IfHandleType *itf, USBD_HandleType *dev)
 709:USBDevice/Class/CDC/usbd_ncm.c **** {
 1505              		.loc 1 709 1 is_stmt 1 view -0
 1506              		.cfi_startproc
 1507              		@ args = 0, pretend = 0, frame = 0
 1508              		@ frame_needed = 0, uses_anonymous_args = 0
 1509              		@ link register save eliminated.
 710:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_ERROR;
 1510              		.loc 1 710 5 view .LVU466
 711:USBDevice/Class/CDC/usbd_ncm.c **** 
 712:USBDevice/Class/CDC/usbd_ncm.c ****     /* Note: NCM uses 2 interfaces */
 713:USBDevice/Class/CDC/usbd_ncm.c ****     if (dev->IfCount < (USBD_MAX_IF_COUNT - 1))
 1511              		.loc 1 713 5 view .LVU467
 1512              		.loc 1 713 12 is_stmt 0 view .LVU468
 1513 0000 91F82920 		ldrb	r2, [r1, #41]	@ zero_extendqisi2
 1514              		.loc 1 713 8 view .LVU469
 1515 0004 062A     		cmp	r2, #6
 1516 0006 4FD8     		bhi	.L114
 1517 0008 0346     		mov	r3, r0
 714:USBDevice/Class/CDC/usbd_ncm.c ****     {
 715:USBDevice/Class/CDC/usbd_ncm.c ****         /* Binding interfaces */
 716:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.Device = dev;
 1518              		.loc 1 716 9 is_stmt 1 view .LVU470
 717:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.Class  = &ncm_cbks;
 718:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.AltCount = 2;
 719:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.AltSelector = 0;
 720:USBDevice/Class/CDC/usbd_ncm.c **** 
 721:USBDevice/Class/CDC/usbd_ncm.c ****         /* Configure static elements of notification messages */
 722:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.RequestType     = 0xA1;
 1519              		.loc 1 722 49 is_stmt 0 view .LVU471
 1520 000a 42F6A120 		movw	r0, #10913
 1521              	.LVL133:
 723:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.NotificationType= CDC_NOT_CONNECTION_SPEED_CHANGE;
 724:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.Index           = dev->IfCount;
 1522              		.loc 1 724 54 view .LVU472
 1523 000e 92B2     		uxth	r2, r2
 709:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_ERROR;
ARM GAS  /tmp/ccWJL6at.s 			page 49


 1524              		.loc 1 709 1 view .LVU473
 1525 0010 F0B4     		push	{r4, r5, r6, r7}
 1526              	.LCFI24:
 1527              		.cfi_def_cfa_offset 16
 1528              		.cfi_offset 4, -16
 1529              		.cfi_offset 5, -12
 1530              		.cfi_offset 6, -8
 1531              		.cfi_offset 7, -4
 722:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.NotificationType= CDC_NOT_CONNECTION_SPEED_CHANGE;
 1532              		.loc 1 722 49 view .LVU474
 1533 0012 9882     		strh	r0, [r3, #20]	@ movhi
 719:USBDevice/Class/CDC/usbd_ncm.c **** 
 1534              		.loc 1 719 31 view .LVU475
 1535 0014 4FF40076 		mov	r6, #512
 1536              	.LBB172:
 1537              	.LBB173:
 1538              	.LBB174:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1539              		.loc 2 75 56 view .LVU476
 1540 0018 93F91200 		ldrsb	r0, [r3, #18]
 1541              	.LBE174:
 1542              	.LBE173:
 1543              	.LBE172:
 725:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.Length          = sizeof(itf->Notify.SpeedData);
 1544              		.loc 1 725 49 view .LVU477
 1545 001c 0825     		movs	r5, #8
 717:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.AltCount = 2;
 1546              		.loc 1 717 26 view .LVU478
 1547 001e 2C4F     		ldr	r7, .L122
 726:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.RequestType      = 0xA1;
 1548              		.loc 1 726 49 view .LVU479
 1549 0020 A124     		movs	r4, #161
 724:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.Length          = sizeof(itf->Notify.SpeedData);
 1550              		.loc 1 724 49 view .LVU480
 1551 0022 1A83     		strh	r2, [r3, #24]	@ movhi
 1552              	.LBB193:
 1553              	.LBB178:
 1554              	.LBB175:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1555              		.loc 2 75 56 view .LVU481
 1556 0024 0028     		cmp	r0, #0
 1557              	.LBE175:
 1558              	.LBE178:
 1559              	.LBE193:
 727:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.NotificationType = CDC_NOT_NETWORK_CONNECTION;
 728:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Index            = dev->IfCount;
 1560              		.loc 1 728 49 view .LVU482
 1561 0026 1A85     		strh	r2, [r3, #40]	@ movhi
 729:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value            = 0;
 730:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Length           = 0;
 1562              		.loc 1 730 49 view .LVU483
 1563 0028 4FF00002 		mov	r2, #0
 716:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.Class  = &ncm_cbks;
 1564              		.loc 1 716 26 view .LVU484
 1565 002c 1960     		str	r1, [r3]
 717:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.AltCount = 2;
 1566              		.loc 1 717 9 is_stmt 1 view .LVU485
ARM GAS  /tmp/ccWJL6at.s 			page 50


 1567              		.loc 1 730 49 is_stmt 0 view .LVU486
 1568 002e 5A85     		strh	r2, [r3, #42]	@ movhi
 717:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.AltCount = 2;
 1569              		.loc 1 717 26 view .LVU487
 1570 0030 5F60     		str	r7, [r3, #4]
 718:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Base.AltSelector = 0;
 1571              		.loc 1 718 9 is_stmt 1 view .LVU488
 719:USBDevice/Class/CDC/usbd_ncm.c **** 
 1572              		.loc 1 719 9 view .LVU489
 1573              	.LBB194:
 731:USBDevice/Class/CDC/usbd_ncm.c **** 
 732:USBDevice/Class/CDC/usbd_ncm.c ****         /* Set endpoint types and max packet sizes */
 733:USBDevice/Class/CDC/usbd_ncm.c ****         {
 734:USBDevice/Class/CDC/usbd_ncm.c ****             USBD_EpHandleType *ep;
 735:USBDevice/Class/CDC/usbd_ncm.c **** 
 736:USBDevice/Class/CDC/usbd_ncm.c ****             ep = USBD_EpAddr2Ref(dev, itf->Config.NotEpNum);
 1574              		.loc 1 736 18 is_stmt 0 view .LVU490
 1575 0032 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 1576              	.LBE194:
 719:USBDevice/Class/CDC/usbd_ncm.c **** 
 1577              		.loc 1 719 31 view .LVU491
 1578 0034 1E81     		strh	r6, [r3, #8]	@ movhi
 722:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.NotificationType= CDC_NOT_CONNECTION_SPEED_CHANGE;
 1579              		.loc 1 722 9 is_stmt 1 view .LVU492
 723:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.Index           = dev->IfCount;
 1580              		.loc 1 723 9 view .LVU493
 724:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedChange.Length          = sizeof(itf->Notify.SpeedData);
 1581              		.loc 1 724 9 view .LVU494
 725:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.RequestType      = 0xA1;
 1582              		.loc 1 725 9 view .LVU495
 725:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.RequestType      = 0xA1;
 1583              		.loc 1 725 49 is_stmt 0 view .LVU496
 1584 0036 5D83     		strh	r5, [r3, #26]	@ movhi
 726:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.NotificationType = CDC_NOT_NETWORK_CONNECTION;
 1585              		.loc 1 726 9 is_stmt 1 view .LVU497
 727:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Index            = dev->IfCount;
 1586              		.loc 1 727 9 view .LVU498
 728:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value            = 0;
 1587              		.loc 1 728 9 view .LVU499
 729:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Length           = 0;
 1588              		.loc 1 729 9 view .LVU500
 726:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.NotificationType = CDC_NOT_NETWORK_CONNECTION;
 1589              		.loc 1 726 49 is_stmt 0 view .LVU501
 1590 0038 5C62     		str	r4, [r3, #36]
 730:USBDevice/Class/CDC/usbd_ncm.c **** 
 1591              		.loc 1 730 9 is_stmt 1 view .LVU502
 1592              	.LBB195:
 734:USBDevice/Class/CDC/usbd_ncm.c **** 
 1593              		.loc 1 734 13 view .LVU503
 1594              		.loc 1 736 13 view .LVU504
 1595              	.LVL134:
 1596              	.LBB179:
 1597              	.LBI173:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1598              		.loc 2 72 20 view .LVU505
 1599              	.LBB176:
  75:USBDevice/Include/private/usbd_internal.h **** }
ARM GAS  /tmp/ccWJL6at.s 			page 51


 1600              		.loc 2 75 5 view .LVU506
  75:USBDevice/Include/private/usbd_internal.h **** }
 1601              		.loc 2 75 56 is_stmt 0 view .LVU507
 1602 003a 37DB     		blt	.L119
 1603 003c 01EB0212 		add	r2, r1, r2, lsl #4
 1604              	.LVL135:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1605              		.loc 2 75 56 view .LVU508
 1606 0040 AC32     		adds	r2, r2, #172
 1607              	.L109:
 1608              	.LVL136:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1609              		.loc 2 75 56 view .LVU509
 1610              	.LBE176:
 1611              	.LBE179:
 737:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_INTERRUPT;
 1612              		.loc 1 737 13 is_stmt 1 view .LVU510
 738:USBDevice/Class/CDC/usbd_ncm.c ****             ep->MaxPacketSize   = NCM_NOT_PACKET_SIZE;
 1613              		.loc 1 738 33 is_stmt 0 view .LVU511
 1614 0042 0820     		movs	r0, #8
 737:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_INTERRUPT;
 1615              		.loc 1 737 33 view .LVU512
 1616 0044 0324     		movs	r4, #3
 1617              		.loc 1 738 33 view .LVU513
 1618 0046 1081     		strh	r0, [r2, #8]	@ movhi
 737:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_INTERRUPT;
 1619              		.loc 1 737 33 view .LVU514
 1620 0048 9472     		strb	r4, [r2, #10]
 1621              		.loc 1 738 13 is_stmt 1 view .LVU515
 739:USBDevice/Class/CDC/usbd_ncm.c ****             ep->IfNum           = dev->IfCount;
 1622              		.loc 1 739 13 view .LVU516
 1623              		.loc 1 739 38 is_stmt 0 view .LVU517
 1624 004a 91F82900 		ldrb	r0, [r1, #41]	@ zero_extendqisi2
 1625              		.loc 1 739 33 view .LVU518
 1626 004e 1073     		strb	r0, [r2, #12]
 740:USBDevice/Class/CDC/usbd_ncm.c **** 
 741:USBDevice/Class/CDC/usbd_ncm.c ****             ep = USBD_EpAddr2Ref(dev, itf->Config.InEpNum);
 1627              		.loc 1 741 13 is_stmt 1 view .LVU519
 1628              	.LBB180:
 1629              	.LBB181:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1630              		.loc 2 75 56 is_stmt 0 view .LVU520
 1631 0050 93F91100 		ldrsb	r0, [r3, #17]
 1632              	.LBE181:
 1633              	.LBE180:
 1634              		.loc 1 741 18 view .LVU521
 1635 0054 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 1636              	.LVL137:
 1637              	.LBB184:
 1638              	.LBI180:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1639              		.loc 2 72 20 is_stmt 1 view .LVU522
 1640              	.LBB182:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1641              		.loc 2 75 5 view .LVU523
  75:USBDevice/Include/private/usbd_internal.h **** }
 1642              		.loc 2 75 56 is_stmt 0 view .LVU524
ARM GAS  /tmp/ccWJL6at.s 			page 52


 1643 0056 0028     		cmp	r0, #0
 1644 0058 34DB     		blt	.L120
 1645 005a 01EB0212 		add	r2, r1, r2, lsl #4
 1646              	.LVL138:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1647              		.loc 2 75 56 view .LVU525
 1648 005e AC32     		adds	r2, r2, #172
 1649              	.L111:
 1650              	.LVL139:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1651              		.loc 2 75 56 view .LVU526
 1652              	.LBE182:
 1653              	.LBE184:
 742:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_BULK;
 1654              		.loc 1 742 13 is_stmt 1 view .LVU527
 743:USBDevice/Class/CDC/usbd_ncm.c ****             ep->MaxPacketSize   = NCM_DATA_PACKET_SIZE;
 1655              		.loc 1 743 33 is_stmt 0 view .LVU528
 1656 0060 4020     		movs	r0, #64
 742:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_BULK;
 1657              		.loc 1 742 33 view .LVU529
 1658 0062 0224     		movs	r4, #2
 1659              		.loc 1 743 33 view .LVU530
 1660 0064 1081     		strh	r0, [r2, #8]	@ movhi
 742:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_BULK;
 1661              		.loc 1 742 33 view .LVU531
 1662 0066 9472     		strb	r4, [r2, #10]
 1663              		.loc 1 743 13 is_stmt 1 view .LVU532
 744:USBDevice/Class/CDC/usbd_ncm.c ****             ep->IfNum           = dev->IfCount;
 1664              		.loc 1 744 13 view .LVU533
 1665              		.loc 1 744 38 is_stmt 0 view .LVU534
 1666 0068 91F82900 		ldrb	r0, [r1, #41]	@ zero_extendqisi2
 1667              		.loc 1 744 33 view .LVU535
 1668 006c 1073     		strb	r0, [r2, #12]
 745:USBDevice/Class/CDC/usbd_ncm.c **** 
 746:USBDevice/Class/CDC/usbd_ncm.c ****             ep = USBD_EpAddr2Ref(dev, itf->Config.OutEpNum);
 1669              		.loc 1 746 13 is_stmt 1 view .LVU536
 1670              	.LBB185:
 1671              	.LBB186:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1672              		.loc 2 75 56 is_stmt 0 view .LVU537
 1673 006e 93F91000 		ldrsb	r0, [r3, #16]
 1674              	.LBE186:
 1675              	.LBE185:
 1676              		.loc 1 746 18 view .LVU538
 1677 0072 1A7C     		ldrb	r2, [r3, #16]	@ zero_extendqisi2
 1678              	.LVL140:
 1679              	.LBB189:
 1680              	.LBI185:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1681              		.loc 2 72 20 is_stmt 1 view .LVU539
 1682              	.LBB187:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1683              		.loc 2 75 5 view .LVU540
  75:USBDevice/Include/private/usbd_internal.h **** }
 1684              		.loc 2 75 56 is_stmt 0 view .LVU541
 1685 0074 0028     		cmp	r0, #0
 1686 0076 1FDB     		blt	.L121
ARM GAS  /tmp/ccWJL6at.s 			page 53


 1687 0078 01EB0212 		add	r2, r1, r2, lsl #4
 1688              	.LVL141:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1689              		.loc 2 75 56 view .LVU542
 1690 007c AC32     		adds	r2, r2, #172
 1691              	.L113:
 1692              	.LVL142:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1693              		.loc 2 75 56 view .LVU543
 1694              	.LBE187:
 1695              	.LBE189:
 747:USBDevice/Class/CDC/usbd_ncm.c ****             ep->Type            = USB_EP_TYPE_BULK;
 1696              		.loc 1 747 13 is_stmt 1 view .LVU544
 1697              		.loc 1 747 33 is_stmt 0 view .LVU545
 1698 007e 0225     		movs	r5, #2
 748:USBDevice/Class/CDC/usbd_ncm.c ****             ep->MaxPacketSize   = NCM_DATA_PACKET_SIZE;
 1699              		.loc 1 748 33 view .LVU546
 1700 0080 4024     		movs	r4, #64
 1701              	.LBE195:
 749:USBDevice/Class/CDC/usbd_ncm.c ****             ep->IfNum           = dev->IfCount;
 750:USBDevice/Class/CDC/usbd_ncm.c ****         }
 751:USBDevice/Class/CDC/usbd_ncm.c **** 
 752:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IF[dev->IfCount] = (USBD_IfHandleType*)itf;
 753:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 754:USBDevice/Class/CDC/usbd_ncm.c **** 
 755:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IF[dev->IfCount] = (USBD_IfHandleType*)itf;
 756:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 757:USBDevice/Class/CDC/usbd_ncm.c **** 
 758:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_E_OK;
 1702              		.loc 1 758 16 view .LVU547
 1703 0082 0020     		movs	r0, #0
 1704              	.LBB196:
 747:USBDevice/Class/CDC/usbd_ncm.c ****             ep->MaxPacketSize   = NCM_DATA_PACKET_SIZE;
 1705              		.loc 1 747 33 view .LVU548
 1706 0084 9572     		strb	r5, [r2, #10]
 748:USBDevice/Class/CDC/usbd_ncm.c ****             ep->MaxPacketSize   = NCM_DATA_PACKET_SIZE;
 1707              		.loc 1 748 13 is_stmt 1 view .LVU549
 748:USBDevice/Class/CDC/usbd_ncm.c ****             ep->MaxPacketSize   = NCM_DATA_PACKET_SIZE;
 1708              		.loc 1 748 33 is_stmt 0 view .LVU550
 1709 0086 1481     		strh	r4, [r2, #8]	@ movhi
 749:USBDevice/Class/CDC/usbd_ncm.c ****             ep->IfNum           = dev->IfCount;
 1710              		.loc 1 749 13 is_stmt 1 view .LVU551
 749:USBDevice/Class/CDC/usbd_ncm.c ****             ep->IfNum           = dev->IfCount;
 1711              		.loc 1 749 38 is_stmt 0 view .LVU552
 1712 0088 91F82940 		ldrb	r4, [r1, #41]	@ zero_extendqisi2
 1713              	.LBE196:
 753:USBDevice/Class/CDC/usbd_ncm.c **** 
 1714              		.loc 1 753 21 view .LVU553
 1715 008c 651C     		adds	r5, r4, #1
 1716              	.LBB197:
 749:USBDevice/Class/CDC/usbd_ncm.c ****             ep->IfNum           = dev->IfCount;
 1717              		.loc 1 749 33 view .LVU554
 1718 008e 1473     		strb	r4, [r2, #12]
 1719              	.LBE197:
 752:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 1720              		.loc 1 752 9 is_stmt 1 view .LVU555
 752:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
ARM GAS  /tmp/ccWJL6at.s 			page 54


 1721              		.loc 1 752 31 is_stmt 0 view .LVU556
 1722 0090 01EB8406 		add	r6, r1, r4, lsl #2
 756:USBDevice/Class/CDC/usbd_ncm.c **** 
 1723              		.loc 1 756 21 view .LVU557
 1724 0094 0234     		adds	r4, r4, #2
 755:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 1725              		.loc 1 755 20 view .LVU558
 1726 0096 EAB2     		uxtb	r2, r5
 1727              	.LVL143:
 752:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 1728              		.loc 1 752 31 view .LVU559
 1729 0098 F362     		str	r3, [r6, #44]
 753:USBDevice/Class/CDC/usbd_ncm.c **** 
 1730              		.loc 1 753 9 is_stmt 1 view .LVU560
 755:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 1731              		.loc 1 755 9 view .LVU561
 755:USBDevice/Class/CDC/usbd_ncm.c ****         dev->IfCount++;
 1732              		.loc 1 755 31 is_stmt 0 view .LVU562
 1733 009a 01EB8202 		add	r2, r1, r2, lsl #2
 1734 009e D362     		str	r3, [r2, #44]
 756:USBDevice/Class/CDC/usbd_ncm.c **** 
 1735              		.loc 1 756 9 is_stmt 1 view .LVU563
 756:USBDevice/Class/CDC/usbd_ncm.c **** 
 1736              		.loc 1 756 21 is_stmt 0 view .LVU564
 1737 00a0 81F82940 		strb	r4, [r1, #41]
 1738              		.loc 1 758 9 is_stmt 1 view .LVU565
 1739              	.LVL144:
 759:USBDevice/Class/CDC/usbd_ncm.c ****     }
 760:USBDevice/Class/CDC/usbd_ncm.c **** 
 761:USBDevice/Class/CDC/usbd_ncm.c ****     return retval;
 1740              		.loc 1 761 5 view .LVU566
 762:USBDevice/Class/CDC/usbd_ncm.c **** }
 1741              		.loc 1 762 1 is_stmt 0 view .LVU567
 1742 00a4 F0BC     		pop	{r4, r5, r6, r7}
 1743              	.LCFI25:
 1744              		.cfi_restore 7
 1745              		.cfi_restore 6
 1746              		.cfi_restore 5
 1747              		.cfi_restore 4
 1748              		.cfi_def_cfa_offset 0
 1749 00a6 7047     		bx	lr
 1750              	.LVL145:
 1751              	.L114:
 710:USBDevice/Class/CDC/usbd_ncm.c **** 
 1752              		.loc 1 710 21 view .LVU568
 1753 00a8 0120     		movs	r0, #1
 1754              	.LVL146:
 761:USBDevice/Class/CDC/usbd_ncm.c **** }
 1755              		.loc 1 761 5 is_stmt 1 view .LVU569
 1756              		.loc 1 762 1 is_stmt 0 view .LVU570
 1757 00aa 7047     		bx	lr
 1758              	.LVL147:
 1759              	.L119:
 1760              	.LCFI26:
 1761              		.cfi_def_cfa_offset 16
 1762              		.cfi_offset 4, -16
 1763              		.cfi_offset 5, -12
ARM GAS  /tmp/ccWJL6at.s 			page 55


 1764              		.cfi_offset 6, -8
 1765              		.cfi_offset 7, -4
 1766              	.LBB198:
 1767              	.LBB190:
 1768              	.LBB177:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1769              		.loc 2 75 56 view .LVU571
 1770 00ac 02F00F02 		and	r2, r2, #15
 1771              	.LVL148:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1772              		.loc 2 75 56 view .LVU572
 1773 00b0 01EB0212 		add	r2, r1, r2, lsl #4
 1774 00b4 4C32     		adds	r2, r2, #76
 1775 00b6 C4E7     		b	.L109
 1776              	.LVL149:
 1777              	.L121:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1778              		.loc 2 75 56 view .LVU573
 1779              	.LBE177:
 1780              	.LBE190:
 1781              	.LBB191:
 1782              	.LBB188:
 1783 00b8 02F00F02 		and	r2, r2, #15
 1784              	.LVL150:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1785              		.loc 2 75 56 view .LVU574
 1786 00bc 01EB0212 		add	r2, r1, r2, lsl #4
 1787 00c0 4C32     		adds	r2, r2, #76
 1788 00c2 DCE7     		b	.L113
 1789              	.LVL151:
 1790              	.L120:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1791              		.loc 2 75 56 view .LVU575
 1792              	.LBE188:
 1793              	.LBE191:
 1794              	.LBB192:
 1795              	.LBB183:
 1796 00c4 02F00F02 		and	r2, r2, #15
 1797              	.LVL152:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1798              		.loc 2 75 56 view .LVU576
 1799 00c8 01EB0212 		add	r2, r1, r2, lsl #4
 1800 00cc 4C32     		adds	r2, r2, #76
 1801 00ce C7E7     		b	.L111
 1802              	.L123:
 1803              		.align	2
 1804              	.L122:
 1805 00d0 00000000 		.word	.LANCHOR3
 1806              	.LBE183:
 1807              	.LBE192:
 1808              	.LBE198:
 1809              		.cfi_endproc
 1810              	.LFE158:
 1812              		.section	.text.USBD_NCM_Connect,"ax",%progbits
 1813              		.align	1
 1814              		.p2align 2,,3
 1815              		.global	USBD_NCM_Connect
ARM GAS  /tmp/ccWJL6at.s 			page 56


 1816              		.syntax unified
 1817              		.thumb
 1818              		.thumb_func
 1819              		.fpu fpv4-sp-d16
 1821              	USBD_NCM_Connect:
 1822              	.LVL153:
 1823              	.LFB159:
 763:USBDevice/Class/CDC/usbd_ncm.c **** 
 764:USBDevice/Class/CDC/usbd_ncm.c **** /**
 765:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Notifies the host of connected medium and its speed,
 766:USBDevice/Class/CDC/usbd_ncm.c ****  *        and sets up the data interface for NTB transfers.
 767:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 768:USBDevice/Class/CDC/usbd_ncm.c ****  * @param bitrate: bitrate of the connected medium in bits per second
 769:USBDevice/Class/CDC/usbd_ncm.c ****  * @return INVALID if the interface isn't ready or already connected,
 770:USBDevice/Class/CDC/usbd_ncm.c ****  *         BUSY if the notification endpoint is processing a previous transfer,
 771:USBDevice/Class/CDC/usbd_ncm.c ****  *         OK if successful
 772:USBDevice/Class/CDC/usbd_ncm.c ****  */
 773:USBDevice/Class/CDC/usbd_ncm.c **** USBD_ReturnType USBD_NCM_Connect(USBD_NCM_IfHandleType *itf, uint32_t bitrate)
 774:USBDevice/Class/CDC/usbd_ncm.c **** {
 1824              		.loc 1 774 1 is_stmt 1 view -0
 1825              		.cfi_startproc
 1826              		@ args = 0, pretend = 0, frame = 0
 1827              		@ frame_needed = 0, uses_anonymous_args = 0
 775:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 1828              		.loc 1 775 5 view .LVU578
 776:USBDevice/Class/CDC/usbd_ncm.c **** 
 777:USBDevice/Class/CDC/usbd_ncm.c ****     if ((itf->Base.AltSelector == 1) && (itf->Notify.Connection.Value == 0))
 1829              		.loc 1 777 5 view .LVU579
 1830              		.loc 1 777 8 is_stmt 0 view .LVU580
 1831 0000 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 1832 0002 012B     		cmp	r3, #1
 1833 0004 01D0     		beq	.L136
 1834              	.LVL154:
 778:USBDevice/Class/CDC/usbd_ncm.c ****     {
 779:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_HandleType *dev = itf->Base.Device;
 780:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t mps;
 781:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_HS_SUPPORT == 1)
 782:USBDevice/Class/CDC/usbd_ncm.c ****         if (dev->Speed == USB_SPEED_HIGH)
 783:USBDevice/Class/CDC/usbd_ncm.c ****         {   mps = USB_EP_BULK_HS_MPS; }
 784:USBDevice/Class/CDC/usbd_ncm.c ****         else
 785:USBDevice/Class/CDC/usbd_ncm.c **** #endif
 786:USBDevice/Class/CDC/usbd_ncm.c ****         {   mps = USB_EP_BULK_FS_MPS; }
 787:USBDevice/Class/CDC/usbd_ncm.c **** 
 788:USBDevice/Class/CDC/usbd_ncm.c ****         /* Open data interface EPs */
 789:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpOpen(dev, itf->Config.InEpNum , USB_EP_TYPE_BULK, mps);
 790:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpOpen(dev, itf->Config.OutEpNum, USB_EP_TYPE_BULK, mps);
 791:USBDevice/Class/CDC/usbd_ncm.c **** 
 792:USBDevice/Class/CDC/usbd_ncm.c ****         /* IN setup */
 793:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[0])->V16.Sequence = 0;
 794:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[1])->V16.Sequence = 1;
 795:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 796:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.SendState = NTB_READY;
 797:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.Page    = 0;
 798:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.DgCount = 0;
 799:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.Index   = sizeof(((USBD_NCM_TransferHeaderType*)0)->V16);
 800:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.RemSize = itf->In.MaxSize - itf->In.Index -
 801:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
ARM GAS  /tmp/ccWJL6at.s 			page 57


 802:USBDevice/Class/CDC/usbd_ncm.c **** 
 803:USBDevice/Class/CDC/usbd_ncm.c ****         /* OUT setup and start reception */
 804:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.State[0] = itf->Out.State[1] = NTB_EMPTY;
 805:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.Page = 0;
 806:USBDevice/Class/CDC/usbd_ncm.c **** 
 807:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpReceive(dev, itf->Config.OutEpNum,
 808:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[1], sizeof(itf->Out.Data[0]));
 809:USBDevice/Class/CDC/usbd_ncm.c **** 
 810:USBDevice/Class/CDC/usbd_ncm.c ****         /* Send notification */
 811:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedData.DLBitRate = bitrate;
 812:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedData.ULBitRate = bitrate;
 813:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value = 1;
 814:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_EpSend(dev, itf->Config.NotEpNum,
 815:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify, sizeof(itf->Notify));
 816:USBDevice/Class/CDC/usbd_ncm.c ****     }
 817:USBDevice/Class/CDC/usbd_ncm.c **** 
 818:USBDevice/Class/CDC/usbd_ncm.c ****     return retval;
 1835              		.loc 1 818 5 is_stmt 1 view .LVU581
 819:USBDevice/Class/CDC/usbd_ncm.c **** }
 1836              		.loc 1 819 1 is_stmt 0 view .LVU582
 1837 0006 0320     		movs	r0, #3
 1838              	.LVL155:
 1839              		.loc 1 819 1 view .LVU583
 1840 0008 7047     		bx	lr
 1841              	.LVL156:
 1842              	.L136:
 777:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1843              		.loc 1 777 38 discriminator 1 view .LVU584
 1844 000a C38C     		ldrh	r3, [r0, #38]
 774:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 1845              		.loc 1 774 1 discriminator 1 view .LVU585
 1846 000c 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1847              	.LCFI27:
 1848              		.cfi_def_cfa_offset 24
 1849              		.cfi_offset 4, -24
 1850              		.cfi_offset 5, -20
 1851              		.cfi_offset 6, -16
 1852              		.cfi_offset 7, -12
 1853              		.cfi_offset 8, -8
 1854              		.cfi_offset 14, -4
 1855 0010 0446     		mov	r4, r0
 777:USBDevice/Class/CDC/usbd_ncm.c ****     {
 1856              		.loc 1 777 38 discriminator 1 view .LVU586
 1857 0012 002B     		cmp	r3, #0
 1858 0014 5ED1     		bne	.L125
 1859              	.LBB199:
 779:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t mps;
 1860              		.loc 1 779 9 is_stmt 1 view .LVU587
 789:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpOpen(dev, itf->Config.OutEpNum, USB_EP_TYPE_BULK, mps);
 1861              		.loc 1 789 9 is_stmt 0 view .LVU588
 1862 0016 467C     		ldrb	r6, [r0, #17]	@ zero_extendqisi2
 1863              	.LBB200:
 1864              	.LBB201:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1865              		.loc 2 106 5 view .LVU589
 1866 0018 0222     		movs	r2, #2
 1867              	.LBE201:
ARM GAS  /tmp/ccWJL6at.s 			page 58


 1868              	.LBE200:
 779:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t mps;
 1869              		.loc 1 779 26 view .LVU590
 1870 001a 0768     		ldr	r7, [r0]
 1871              	.LVL157:
 780:USBDevice/Class/CDC/usbd_ncm.c **** #if (USBD_HS_SUPPORT == 1)
 1872              		.loc 1 780 9 is_stmt 1 view .LVU591
 786:USBDevice/Class/CDC/usbd_ncm.c **** 
 1873              		.loc 1 786 13 view .LVU592
 789:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpOpen(dev, itf->Config.OutEpNum, USB_EP_TYPE_BULK, mps);
 1874              		.loc 1 789 9 view .LVU593
 1875              	.LBB209:
 1876              	.LBI200:
 101:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
 1877              		.loc 2 101 20 view .LVU594
 1878              	.LBB206:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1879              		.loc 2 106 5 view .LVU595
 1880 001c 0D46     		mov	r5, r1
 1881 001e 4023     		movs	r3, #64
 1882 0020 3146     		mov	r1, r6
 1883              	.LVL158:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1884              		.loc 2 106 5 is_stmt 0 view .LVU596
 1885 0022 3846     		mov	r0, r7
 1886              	.LVL159:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1887              		.loc 2 106 5 view .LVU597
 1888 0024 FFF7FEFF 		bl	USB_vEpOpen
 1889              	.LVL160:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1890              		.loc 2 107 5 is_stmt 1 view .LVU598
 1891              	.LBB202:
 1892              	.LBI202:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1893              		.loc 2 72 20 view .LVU599
 1894              	.LBB203:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1895              		.loc 2 75 5 view .LVU600
  75:USBDevice/Include/private/usbd_internal.h **** }
 1896              		.loc 2 75 56 is_stmt 0 view .LVU601
 1897 0028 3206     		lsls	r2, r6, #24
 1898 002a 56D4     		bmi	.L137
  75:USBDevice/Include/private/usbd_internal.h **** }
 1899              		.loc 2 75 56 view .LVU602
 1900 002c 07EB0616 		add	r6, r7, r6, lsl #4
 1901              	.LVL161:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1902              		.loc 2 75 56 view .LVU603
 1903 0030 AC36     		adds	r6, r6, #172
 1904              	.L127:
 1905              	.LVL162:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1906              		.loc 2 75 56 view .LVU604
 1907              	.LBE203:
 1908              	.LBE202:
 107:USBDevice/Include/private/usbd_internal.h **** }
ARM GAS  /tmp/ccWJL6at.s 			page 59


 1909              		.loc 2 107 41 view .LVU605
 1910 0032 0121     		movs	r1, #1
 1911              	.LBE206:
 1912              	.LBE209:
 1913              	.LBB210:
 1914              	.LBB211:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1915              		.loc 2 106 5 view .LVU606
 1916 0034 4023     		movs	r3, #64
 1917 0036 0222     		movs	r2, #2
 1918 0038 3846     		mov	r0, r7
 1919              	.LBE211:
 1920              	.LBE210:
 1921              	.LBB219:
 1922              	.LBB207:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1923              		.loc 2 107 41 view .LVU607
 1924 003a F172     		strb	r1, [r6, #11]
 1925              	.LVL163:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1926              		.loc 2 107 41 view .LVU608
 1927              	.LBE207:
 1928              	.LBE219:
 790:USBDevice/Class/CDC/usbd_ncm.c **** 
 1929              		.loc 1 790 9 is_stmt 1 view .LVU609
 1930 003c 267C     		ldrb	r6, [r4, #16]	@ zero_extendqisi2
 1931              	.LVL164:
 1932              	.LBB220:
 1933              	.LBI210:
 101:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr,
 1934              		.loc 2 101 20 view .LVU610
 1935              	.LBB216:
 106:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_IDLE;
 1936              		.loc 2 106 5 view .LVU611
 1937 003e 3146     		mov	r1, r6
 1938 0040 FFF7FEFF 		bl	USB_vEpOpen
 1939              	.LVL165:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1940              		.loc 2 107 5 view .LVU612
 1941              	.LBB212:
 1942              	.LBI212:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 1943              		.loc 2 72 20 view .LVU613
 1944              	.LBB213:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1945              		.loc 2 75 5 view .LVU614
  75:USBDevice/Include/private/usbd_internal.h **** }
 1946              		.loc 2 75 56 is_stmt 0 view .LVU615
 1947 0044 3306     		lsls	r3, r6, #24
 1948 0046 4ED4     		bmi	.L138
 1949 0048 07EB0616 		add	r6, r7, r6, lsl #4
 1950              	.LVL166:
  75:USBDevice/Include/private/usbd_internal.h **** }
 1951              		.loc 2 75 56 view .LVU616
 1952 004c AC36     		adds	r6, r6, #172
 1953              	.L129:
 1954              	.LVL167:
ARM GAS  /tmp/ccWJL6at.s 			page 60


  75:USBDevice/Include/private/usbd_internal.h **** }
 1955              		.loc 2 75 56 view .LVU617
 1956              	.LBE213:
 1957              	.LBE212:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1958              		.loc 2 107 41 view .LVU618
 1959 004e 4FF00108 		mov	r8, #1
 1960              	.LBE216:
 1961              	.LBE220:
 793:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[1])->V16.Sequence = 1;
 1962              		.loc 1 793 71 view .LVU619
 1963 0052 41F23401 		movw	r1, #4148
 794:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 1964              		.loc 1 794 71 view .LVU620
 1965 0056 41F63402 		movw	r2, #6196
 793:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[1])->V16.Sequence = 1;
 1966              		.loc 1 793 71 view .LVU621
 1967 005a 0023     		movs	r3, #0
 1968              	.LBB221:
 1969              	.LBB217:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1970              		.loc 2 107 41 view .LVU622
 1971 005c 86F80B80 		strb	r8, [r6, #11]
 1972              	.LVL168:
 107:USBDevice/Include/private/usbd_internal.h **** }
 1973              		.loc 2 107 41 view .LVU623
 1974              	.LBE217:
 1975              	.LBE221:
 793:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[1])->V16.Sequence = 1;
 1976              		.loc 1 793 9 is_stmt 1 view .LVU624
 793:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[1])->V16.Sequence = 1;
 1977              		.loc 1 793 71 is_stmt 0 view .LVU625
 1978 0060 2144     		add	r1, r1, r4
 794:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 1979              		.loc 1 794 71 view .LVU626
 1980 0062 2244     		add	r2, r2, r4
 795:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.SendState = NTB_READY;
 1981              		.loc 1 795 27 view .LVU627
 1982 0064 42F2410E 		movw	lr, #8257
 796:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.Page    = 0;
 1983              		.loc 1 796 27 view .LVU628
 1984 0068 04F50150 		add	r0, r4, #8256
 1985 006c 4FF0030C 		mov	ip, #3
 800:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
 1986              		.loc 1 800 34 view .LVU629
 1987 0070 42F23406 		movw	r6, #8244
 793:USBDevice/Class/CDC/usbd_ncm.c ****         ((USBD_NCM_TransferHeaderType*)itf->In.Data[1])->V16.Sequence = 1;
 1988              		.loc 1 793 71 view .LVU630
 1989 0074 8B71     		strb	r3, [r1, #6]
 1990 0076 CB71     		strb	r3, [r1, #7]
 794:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 1991              		.loc 1 794 9 is_stmt 1 view .LVU631
 804:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.Page = 0;
 1992              		.loc 1 804 47 is_stmt 0 view .LVU632
 1993 0078 41F23301 		movw	r1, #4147
 794:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 1994              		.loc 1 794 71 view .LVU633
ARM GAS  /tmp/ccWJL6at.s 			page 61


 1995 007c 82F80680 		strb	r8, [r2, #6]
 1996 0080 D371     		strb	r3, [r2, #7]
 795:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.SendState = NTB_READY;
 1997              		.loc 1 795 9 is_stmt 1 view .LVU634
 795:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.SendState = NTB_READY;
 1998              		.loc 1 795 27 is_stmt 0 view .LVU635
 1999 0082 04F80E30 		strb	r3, [r4, lr]
 796:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.Page    = 0;
 2000              		.loc 1 796 9 is_stmt 1 view .LVU636
 796:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.Page    = 0;
 2001              		.loc 1 796 27 is_stmt 0 view .LVU637
 2002 0086 80F800C0 		strb	ip, [r0]
 797:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.DgCount = 0;
 2003              		.loc 1 797 9 is_stmt 1 view .LVU638
 798:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.Index   = sizeof(((USBD_NCM_TransferHeaderType*)0)->V16);
 2004              		.loc 1 798 9 view .LVU639
 799:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.RemSize = itf->In.MaxSize - itf->In.Index -
 2005              		.loc 1 799 9 view .LVU640
 804:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.Page = 0;
 2006              		.loc 1 804 27 is_stmt 0 view .LVU641
 2007 008a 41F23200 		movw	r0, #4146
 800:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
 2008              		.loc 1 800 59 view .LVU642
 2009 008e A259     		ldr	r2, [r4, r6]
 805:USBDevice/Class/CDC/usbd_ncm.c **** 
 2010              		.loc 1 805 23 view .LVU643
 2011 0090 41F23006 		movw	r6, #4144
 804:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.Page = 0;
 2012              		.loc 1 804 47 view .LVU644
 2013 0094 6354     		strb	r3, [r4, r1]
 800:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
 2014              		.loc 1 800 25 view .LVU645
 2015 0096 42F23801 		movw	r1, #8248
 804:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.Page = 0;
 2016              		.loc 1 804 27 view .LVU646
 2017 009a 2354     		strb	r3, [r4, r0]
 800:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
 2018              		.loc 1 800 59 view .LVU647
 2019 009c 183A     		subs	r2, r2, #24
 805:USBDevice/Class/CDC/usbd_ncm.c **** 
 2020              		.loc 1 805 23 view .LVU648
 2021 009e A355     		strb	r3, [r4, r6]
 799:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.RemSize = itf->In.MaxSize - itf->In.Index -
 2022              		.loc 1 799 25 view .LVU649
 2023 00a0 42F23C00 		movw	r0, #8252
 2024 00a4 0C26     		movs	r6, #12
 800:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
 2025              		.loc 1 800 25 view .LVU650
 2026 00a6 6250     		str	r2, [r4, r1]
 807:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[1], sizeof(itf->Out.Data[0]));
 2027              		.loc 1 807 9 view .LVU651
 2028 00a8 4FF40063 		mov	r3, #2048
 2029 00ac 217C     		ldrb	r1, [r4, #16]	@ zero_extendqisi2
 2030 00ae 04F62C02 		addw	r2, r4, #2092
 799:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.RemSize = itf->In.MaxSize - itf->In.Index -
 2031              		.loc 1 799 25 view .LVU652
 2032 00b2 2650     		str	r6, [r4, r0]
ARM GAS  /tmp/ccWJL6at.s 			page 62


 800:USBDevice/Class/CDC/usbd_ncm.c ****                           sizeof(((USBD_NCM_DatagramPointerTableType*)0)->V16);
 2033              		.loc 1 800 9 is_stmt 1 view .LVU653
 804:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.Page = 0;
 2034              		.loc 1 804 9 view .LVU654
 805:USBDevice/Class/CDC/usbd_ncm.c **** 
 2035              		.loc 1 805 9 view .LVU655
 807:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Data[1], sizeof(itf->Out.Data[0]));
 2036              		.loc 1 807 9 view .LVU656
 2037 00b4 3846     		mov	r0, r7
 2038 00b6 FFF7FEFF 		bl	USBD_EpReceive
 2039              	.LVL169:
 811:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedData.ULBitRate = bitrate;
 2040              		.loc 1 811 9 view .LVU657
 814:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify, sizeof(itf->Notify));
 2041              		.loc 1 814 18 is_stmt 0 view .LVU658
 2042 00ba 3846     		mov	r0, r7
 2043 00bc 04F11402 		add	r2, r4, #20
 2044 00c0 A17C     		ldrb	r1, [r4, #18]	@ zero_extendqisi2
 813:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_EpSend(dev, itf->Config.NotEpNum,
 2045              		.loc 1 813 38 view .LVU659
 2046 00c2 A4F82680 		strh	r8, [r4, #38]	@ movhi
 814:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify, sizeof(itf->Notify));
 2047              		.loc 1 814 18 view .LVU660
 2048 00c6 1823     		movs	r3, #24
 811:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.SpeedData.ULBitRate = bitrate;
 2049              		.loc 1 811 41 view .LVU661
 2050 00c8 E561     		str	r5, [r4, #28]
 812:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value = 1;
 2051              		.loc 1 812 9 is_stmt 1 view .LVU662
 812:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value = 1;
 2052              		.loc 1 812 41 is_stmt 0 view .LVU663
 2053 00ca 2562     		str	r5, [r4, #32]
 813:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_EpSend(dev, itf->Config.NotEpNum,
 2054              		.loc 1 813 9 is_stmt 1 view .LVU664
 814:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify, sizeof(itf->Notify));
 2055              		.loc 1 814 9 view .LVU665
 2056              	.LBE199:
 2057              		.loc 1 819 1 is_stmt 0 view .LVU666
 2058 00cc BDE8F041 		pop	{r4, r5, r6, r7, r8, lr}
 2059              	.LCFI28:
 2060              		.cfi_remember_state
 2061              		.cfi_restore 14
 2062              		.cfi_restore 8
 2063              		.cfi_restore 7
 2064              		.cfi_restore 6
 2065              		.cfi_restore 5
 2066              		.cfi_restore 4
 2067              		.cfi_def_cfa_offset 0
 2068              	.LVL170:
 2069              	.LBB224:
 814:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify, sizeof(itf->Notify));
 2070              		.loc 1 814 18 view .LVU667
 2071 00d0 FFF7FEBF 		b	USBD_EpSend
 2072              	.LVL171:
 2073              	.L125:
 2074              	.LCFI29:
 2075              		.cfi_restore_state
ARM GAS  /tmp/ccWJL6at.s 			page 63


 814:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify, sizeof(itf->Notify));
 2076              		.loc 1 814 18 view .LVU668
 2077              	.LBE224:
 818:USBDevice/Class/CDC/usbd_ncm.c **** }
 2078              		.loc 1 818 5 is_stmt 1 view .LVU669
 2079              		.loc 1 819 1 is_stmt 0 view .LVU670
 2080 00d4 0320     		movs	r0, #3
 2081              	.LVL172:
 2082              		.loc 1 819 1 view .LVU671
 2083 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2084              	.LVL173:
 2085              	.L137:
 2086              	.LBB225:
 2087              	.LBB222:
 2088              	.LBB208:
 2089              	.LBB205:
 2090              	.LBB204:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2091              		.loc 2 75 56 view .LVU672
 2092 00da 06F00F06 		and	r6, r6, #15
 2093              	.LVL174:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2094              		.loc 2 75 56 view .LVU673
 2095 00de 07EB0616 		add	r6, r7, r6, lsl #4
 2096 00e2 4C36     		adds	r6, r6, #76
 2097 00e4 A5E7     		b	.L127
 2098              	.LVL175:
 2099              	.L138:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2100              		.loc 2 75 56 view .LVU674
 2101              	.LBE204:
 2102              	.LBE205:
 2103              	.LBE208:
 2104              	.LBE222:
 2105              	.LBB223:
 2106              	.LBB218:
 2107              	.LBB215:
 2108              	.LBB214:
 2109 00e6 06F00F06 		and	r6, r6, #15
 2110              	.LVL176:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2111              		.loc 2 75 56 view .LVU675
 2112 00ea 07EB0616 		add	r6, r7, r6, lsl #4
 2113 00ee 4C36     		adds	r6, r6, #76
 2114 00f0 ADE7     		b	.L129
 2115              	.LBE214:
 2116              	.LBE215:
 2117              	.LBE218:
 2118              	.LBE223:
 2119              	.LBE225:
 2120              		.cfi_endproc
 2121              	.LFE159:
 2123 00f2 00BF     		.section	.text.USBD_NCM_Disconnect,"ax",%progbits
 2124              		.align	1
 2125              		.p2align 2,,3
 2126              		.global	USBD_NCM_Disconnect
 2127              		.syntax unified
ARM GAS  /tmp/ccWJL6at.s 			page 64


 2128              		.thumb
 2129              		.thumb_func
 2130              		.fpu fpv4-sp-d16
 2132              	USBD_NCM_Disconnect:
 2133              	.LVL177:
 2134              	.LFB160:
 820:USBDevice/Class/CDC/usbd_ncm.c **** 
 821:USBDevice/Class/CDC/usbd_ncm.c **** /**
 822:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Notifies the host of medium disconnection and closes data endpoints.
 823:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 824:USBDevice/Class/CDC/usbd_ncm.c ****  * @return INVALID if the interface isn't ready or already disconnected,
 825:USBDevice/Class/CDC/usbd_ncm.c ****  *         BUSY if the notification endpoint is processing a previous transfer,
 826:USBDevice/Class/CDC/usbd_ncm.c ****  *         OK if successful
 827:USBDevice/Class/CDC/usbd_ncm.c ****  */
 828:USBDevice/Class/CDC/usbd_ncm.c **** USBD_ReturnType USBD_NCM_Disconnect(USBD_NCM_IfHandleType *itf)
 829:USBDevice/Class/CDC/usbd_ncm.c **** {
 2135              		.loc 1 829 1 is_stmt 1 view -0
 2136              		.cfi_startproc
 2137              		@ args = 0, pretend = 0, frame = 8
 2138              		@ frame_needed = 0, uses_anonymous_args = 0
 830:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2139              		.loc 1 830 5 view .LVU677
 831:USBDevice/Class/CDC/usbd_ncm.c **** 
 832:USBDevice/Class/CDC/usbd_ncm.c ****     if ((itf->Base.AltSelector == 1) && (itf->Notify.Connection.Value != 0))
 2140              		.loc 1 832 5 view .LVU678
 2141              		.loc 1 832 8 is_stmt 0 view .LVU679
 2142 0000 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 2143 0002 012B     		cmp	r3, #1
 2144 0004 01D0     		beq	.L152
 2145              	.LVL178:
 833:USBDevice/Class/CDC/usbd_ncm.c ****     {
 834:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_HandleType *dev = itf->Base.Device;
 835:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value = 0;
 836:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 837:USBDevice/Class/CDC/usbd_ncm.c **** 
 838:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.InEpNum);
 839:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.OutEpNum);
 840:USBDevice/Class/CDC/usbd_ncm.c **** 
 841:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_EpSend(dev, itf->Config.NotEpNum,
 842:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify.Connection, sizeof(itf->Notify.Connection));
 843:USBDevice/Class/CDC/usbd_ncm.c ****     }
 844:USBDevice/Class/CDC/usbd_ncm.c **** 
 845:USBDevice/Class/CDC/usbd_ncm.c ****     return retval;
 2146              		.loc 1 845 5 is_stmt 1 view .LVU680
 846:USBDevice/Class/CDC/usbd_ncm.c **** }
 2147              		.loc 1 846 1 is_stmt 0 view .LVU681
 2148 0006 0320     		movs	r0, #3
 2149              	.LVL179:
 2150              		.loc 1 846 1 view .LVU682
 2151 0008 7047     		bx	lr
 2152              	.LVL180:
 2153              	.L152:
 832:USBDevice/Class/CDC/usbd_ncm.c ****     {
 2154              		.loc 1 832 38 discriminator 1 view .LVU683
 2155 000a C38C     		ldrh	r3, [r0, #38]
 829:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2156              		.loc 1 829 1 discriminator 1 view .LVU684
ARM GAS  /tmp/ccWJL6at.s 			page 65


 2157 000c 30B5     		push	{r4, r5, lr}
 2158              	.LCFI30:
 2159              		.cfi_def_cfa_offset 12
 2160              		.cfi_offset 4, -12
 2161              		.cfi_offset 5, -8
 2162              		.cfi_offset 14, -4
 2163 000e 0446     		mov	r4, r0
 2164 0010 83B0     		sub	sp, sp, #12
 2165              	.LCFI31:
 2166              		.cfi_def_cfa_offset 24
 832:USBDevice/Class/CDC/usbd_ncm.c ****     {
 2167              		.loc 1 832 38 discriminator 1 view .LVU685
 2168 0012 53B3     		cbz	r3, .L140
 2169              	.LBB226:
 834:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value = 0;
 2170              		.loc 1 834 9 is_stmt 1 view .LVU686
 838:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.OutEpNum);
 2171              		.loc 1 838 9 is_stmt 0 view .LVU687
 2172 0014 657C     		ldrb	r5, [r4, #17]	@ zero_extendqisi2
 835:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 2173              		.loc 1 835 38 view .LVU688
 2174 0016 0023     		movs	r3, #0
 836:USBDevice/Class/CDC/usbd_ncm.c **** 
 2175              		.loc 1 836 27 view .LVU689
 2176 0018 42F24102 		movw	r2, #8257
 834:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Notify.Connection.Value = 0;
 2177              		.loc 1 834 26 view .LVU690
 2178 001c 0068     		ldr	r0, [r0]
 2179              	.LVL181:
 835:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 2180              		.loc 1 835 9 is_stmt 1 view .LVU691
 2181              	.LBB227:
 2182              	.LBB228:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 2183              		.loc 2 118 5 is_stmt 0 view .LVU692
 2184 001e 2946     		mov	r1, r5
 2185              	.LBE228:
 2186              	.LBE227:
 835:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_EMPTY;
 2187              		.loc 1 835 38 view .LVU693
 2188 0020 E384     		strh	r3, [r4, #38]	@ movhi
 836:USBDevice/Class/CDC/usbd_ncm.c **** 
 2189              		.loc 1 836 9 is_stmt 1 view .LVU694
 836:USBDevice/Class/CDC/usbd_ncm.c **** 
 2190              		.loc 1 836 27 is_stmt 0 view .LVU695
 2191 0022 A354     		strb	r3, [r4, r2]
 838:USBDevice/Class/CDC/usbd_ncm.c ****         USBD_EpClose(dev, itf->Config.OutEpNum);
 2192              		.loc 1 838 9 is_stmt 1 view .LVU696
 2193              	.LVL182:
 2194              	.LBB236:
 2195              	.LBI227:
 115:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 2196              		.loc 2 115 20 view .LVU697
 2197              	.LBB233:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 2198              		.loc 2 118 5 view .LVU698
 2199 0024 0190     		str	r0, [sp, #4]
ARM GAS  /tmp/ccWJL6at.s 			page 66


 2200              	.LVL183:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 2201              		.loc 2 118 5 is_stmt 0 view .LVU699
 2202 0026 FFF7FEFF 		bl	USB_vEpClose
 2203              	.LVL184:
 2204              		.loc 2 119 5 is_stmt 1 view .LVU700
 2205              	.LBB229:
 2206              	.LBI229:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 2207              		.loc 2 72 20 view .LVU701
 2208              	.LBB230:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2209              		.loc 2 75 5 view .LVU702
  75:USBDevice/Include/private/usbd_internal.h **** }
 2210              		.loc 2 75 56 is_stmt 0 view .LVU703
 2211 002a 15F0800F 		tst	r5, #128
 2212 002e 0198     		ldr	r0, [sp, #4]
 2213 0030 1ED1     		bne	.L153
 2214 0032 00EB0515 		add	r5, r0, r5, lsl #4
 2215              	.LVL185:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2216              		.loc 2 75 56 view .LVU704
 2217 0036 AC35     		adds	r5, r5, #172
 2218              	.L142:
 2219              	.LVL186:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2220              		.loc 2 75 56 view .LVU705
 2221              	.LBE230:
 2222              	.LBE229:
 2223              		.loc 2 119 41 view .LVU706
 2224 0038 0023     		movs	r3, #0
 2225              	.LBE233:
 2226              	.LBE236:
 2227              	.LBB237:
 2228              	.LBB238:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 2229              		.loc 2 118 5 view .LVU707
 2230 003a 0190     		str	r0, [sp, #4]
 2231              	.LVL187:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 2232              		.loc 2 118 5 view .LVU708
 2233              	.LBE238:
 2234              	.LBE237:
 2235              	.LBB246:
 2236              	.LBB234:
 2237              		.loc 2 119 41 view .LVU709
 2238 003c EB72     		strb	r3, [r5, #11]
 2239              		.loc 2 119 41 view .LVU710
 2240              	.LBE234:
 2241              	.LBE246:
 839:USBDevice/Class/CDC/usbd_ncm.c **** 
 2242              		.loc 1 839 9 is_stmt 1 view .LVU711
 2243 003e 257C     		ldrb	r5, [r4, #16]	@ zero_extendqisi2
 2244              	.LVL188:
 2245              	.LBB247:
 2246              	.LBI237:
 115:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
ARM GAS  /tmp/ccWJL6at.s 			page 67


 2247              		.loc 2 115 20 view .LVU712
 2248              	.LBB243:
 118:USBDevice/Include/private/usbd_internal.h ****     USBD_EpAddr2Ref(dev, epAddr)->State = USB_EP_STATE_CLOSED;
 2249              		.loc 2 118 5 view .LVU713
 2250 0040 2946     		mov	r1, r5
 2251 0042 FFF7FEFF 		bl	USB_vEpClose
 2252              	.LVL189:
 2253              		.loc 2 119 5 view .LVU714
 2254              	.LBB239:
 2255              	.LBI239:
  72:USBDevice/Include/private/usbd_internal.h ****                                          uint8_t epAddr)
 2256              		.loc 2 72 20 view .LVU715
 2257              	.LBB240:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2258              		.loc 2 75 5 view .LVU716
  75:USBDevice/Include/private/usbd_internal.h **** }
 2259              		.loc 2 75 56 is_stmt 0 view .LVU717
 2260 0046 15F0800F 		tst	r5, #128
 2261 004a 0198     		ldr	r0, [sp, #4]
 2262 004c 16D1     		bne	.L154
  75:USBDevice/Include/private/usbd_internal.h **** }
 2263              		.loc 2 75 56 view .LVU718
 2264 004e 00EB0515 		add	r5, r0, r5, lsl #4
 2265              	.LVL190:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2266              		.loc 2 75 56 view .LVU719
 2267 0052 AC35     		adds	r5, r5, #172
 2268              	.L144:
 2269              	.LVL191:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2270              		.loc 2 75 56 view .LVU720
 2271              	.LBE240:
 2272              	.LBE239:
 2273              		.loc 2 119 41 view .LVU721
 2274 0054 0021     		movs	r1, #0
 2275              	.LBE243:
 2276              	.LBE247:
 841:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify.Connection, sizeof(itf->Notify.Connection));
 2277              		.loc 1 841 18 view .LVU722
 2278 0056 04F12402 		add	r2, r4, #36
 2279 005a 0823     		movs	r3, #8
 2280              	.LBB248:
 2281              	.LBB244:
 2282              		.loc 2 119 41 view .LVU723
 2283 005c E972     		strb	r1, [r5, #11]
 2284              	.LVL192:
 2285              		.loc 2 119 41 view .LVU724
 2286              	.LBE244:
 2287              	.LBE248:
 841:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify.Connection, sizeof(itf->Notify.Connection));
 2288              		.loc 1 841 9 is_stmt 1 view .LVU725
 841:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify.Connection, sizeof(itf->Notify.Connection));
 2289              		.loc 1 841 18 is_stmt 0 view .LVU726
 2290 005e A17C     		ldrb	r1, [r4, #18]	@ zero_extendqisi2
 2291              	.LBE226:
 2292              		.loc 1 846 1 view .LVU727
 2293 0060 03B0     		add	sp, sp, #12
ARM GAS  /tmp/ccWJL6at.s 			page 68


 2294              	.LCFI32:
 2295              		.cfi_remember_state
 2296              		.cfi_def_cfa_offset 12
 2297              		@ sp needed
 2298 0062 BDE83040 		pop	{r4, r5, lr}
 2299              	.LCFI33:
 2300              		.cfi_restore 14
 2301              		.cfi_restore 5
 2302              		.cfi_restore 4
 2303              		.cfi_def_cfa_offset 0
 2304              	.LVL193:
 2305              	.LBB251:
 841:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify.Connection, sizeof(itf->Notify.Connection));
 2306              		.loc 1 841 18 view .LVU728
 2307 0066 FFF7FEBF 		b	USBD_EpSend
 2308              	.LVL194:
 2309              	.L140:
 2310              	.LCFI34:
 2311              		.cfi_restore_state
 841:USBDevice/Class/CDC/usbd_ncm.c ****                 &itf->Notify.Connection, sizeof(itf->Notify.Connection));
 2312              		.loc 1 841 18 view .LVU729
 2313              	.LBE251:
 845:USBDevice/Class/CDC/usbd_ncm.c **** }
 2314              		.loc 1 845 5 is_stmt 1 view .LVU730
 2315              		.loc 1 846 1 is_stmt 0 view .LVU731
 2316 006a 0320     		movs	r0, #3
 2317              	.LVL195:
 2318              		.loc 1 846 1 view .LVU732
 2319 006c 03B0     		add	sp, sp, #12
 2320              	.LCFI35:
 2321              		.cfi_remember_state
 2322              		.cfi_def_cfa_offset 12
 2323              		@ sp needed
 2324 006e 30BD     		pop	{r4, r5, pc}
 2325              	.LVL196:
 2326              	.L153:
 2327              	.LCFI36:
 2328              		.cfi_restore_state
 2329              	.LBB252:
 2330              	.LBB249:
 2331              	.LBB235:
 2332              	.LBB232:
 2333              	.LBB231:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2334              		.loc 2 75 56 view .LVU733
 2335 0070 05F00F05 		and	r5, r5, #15
 2336              	.LVL197:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2337              		.loc 2 75 56 view .LVU734
 2338 0074 00EB0515 		add	r5, r0, r5, lsl #4
 2339 0078 4C35     		adds	r5, r5, #76
 2340 007a DDE7     		b	.L142
 2341              	.LVL198:
 2342              	.L154:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2343              		.loc 2 75 56 view .LVU735
 2344              	.LBE231:
ARM GAS  /tmp/ccWJL6at.s 			page 69


 2345              	.LBE232:
 2346              	.LBE235:
 2347              	.LBE249:
 2348              	.LBB250:
 2349              	.LBB245:
 2350              	.LBB242:
 2351              	.LBB241:
 2352 007c 05F00F05 		and	r5, r5, #15
 2353              	.LVL199:
  75:USBDevice/Include/private/usbd_internal.h **** }
 2354              		.loc 2 75 56 view .LVU736
 2355 0080 00EB0515 		add	r5, r0, r5, lsl #4
 2356 0084 4C35     		adds	r5, r5, #76
 2357 0086 E5E7     		b	.L144
 2358              	.LBE241:
 2359              	.LBE242:
 2360              	.LBE245:
 2361              	.LBE250:
 2362              	.LBE252:
 2363              		.cfi_endproc
 2364              	.LFE160:
 2366              		.section	.text.USBD_NCM_GetDatagram,"ax",%progbits
 2367              		.align	1
 2368              		.p2align 2,,3
 2369              		.global	USBD_NCM_GetDatagram
 2370              		.syntax unified
 2371              		.thumb
 2372              		.thumb_func
 2373              		.fpu fpv4-sp-d16
 2375              	USBD_NCM_GetDatagram:
 2376              	.LVL200:
 2377              	.LFB161:
 847:USBDevice/Class/CDC/usbd_ncm.c **** 
 848:USBDevice/Class/CDC/usbd_ncm.c **** /**
 849:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Reads the next datagram from the received queue and initiates a NTB transfer.
 850:USBDevice/Class/CDC/usbd_ncm.c ****  *        if one of the buffer pages is empty.
 851:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 852:USBDevice/Class/CDC/usbd_ncm.c ****  * @param length: the length of the datagram is assigned
 853:USBDevice/Class/CDC/usbd_ncm.c ****  * @return The datagram's start addresss
 854:USBDevice/Class/CDC/usbd_ncm.c ****  */
 855:USBDevice/Class/CDC/usbd_ncm.c **** uint8_t* USBD_NCM_GetDatagram(USBD_NCM_IfHandleType *itf, uint16_t *length)
 856:USBDevice/Class/CDC/usbd_ncm.c **** {
 2378              		.loc 1 856 1 is_stmt 1 view -0
 2379              		.cfi_startproc
 2380              		@ args = 0, pretend = 0, frame = 0
 2381              		@ frame_needed = 0, uses_anonymous_args = 0
 857:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth;
 2382              		.loc 1 857 5 view .LVU738
 858:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DatagramPointerTableType* pt = itf->Out.PT;
 2383              		.loc 1 858 5 view .LVU739
 856:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth;
 2384              		.loc 1 856 1 is_stmt 0 view .LVU740
 2385 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 2386              	.LCFI37:
 2387              		.cfi_def_cfa_offset 32
 2388              		.cfi_offset 3, -32
 2389              		.cfi_offset 4, -28
ARM GAS  /tmp/ccWJL6at.s 			page 70


 2390              		.cfi_offset 5, -24
 2391              		.cfi_offset 6, -20
 2392              		.cfi_offset 7, -16
 2393              		.cfi_offset 8, -12
 2394              		.cfi_offset 9, -8
 2395              		.cfi_offset 14, -4
 856:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth;
 2396              		.loc 1 856 1 view .LVU741
 2397 0004 0446     		mov	r4, r0
 859:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* data = NULL, page = itf->Out.Page;
 2398              		.loc 1 859 27 view .LVU742
 2399 0006 41F23003 		movw	r3, #4144
 858:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_DatagramPointerTableType* pt = itf->Out.PT;
 2400              		.loc 1 858 40 view .LVU743
 2401 000a 41F22C0E 		movw	lr, #4140
 860:USBDevice/Class/CDC/usbd_ncm.c ****     *length = 0;
 2402              		.loc 1 860 13 view .LVU744
 2403 000e 0020     		movs	r0, #0
 2404              	.LVL201:
 859:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* data = NULL, page = itf->Out.Page;
 2405              		.loc 1 859 27 view .LVU745
 2406 0010 E25C     		ldrb	r2, [r4, r3]	@ zero_extendqisi2
 861:USBDevice/Class/CDC/usbd_ncm.c **** 
 862:USBDevice/Class/CDC/usbd_ncm.c ****     /* If fresh NTB, just mark it */
 863:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Out.State[page] == NTB_READY)
 2407              		.loc 1 863 23 view .LVU746
 2408 0012 41F2320C 		movw	ip, #4146
 856:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_NCM_TransferHeaderType* nth;
 2409              		.loc 1 856 1 view .LVU747
 2410 0016 0D46     		mov	r5, r1
 858:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* data = NULL, page = itf->Out.Page;
 2411              		.loc 1 858 40 view .LVU748
 2412 0018 54F80E60 		ldr	r6, [r4, lr]
 2413              	.LVL202:
 859:USBDevice/Class/CDC/usbd_ncm.c ****     *length = 0;
 2414              		.loc 1 859 5 is_stmt 1 view .LVU749
 860:USBDevice/Class/CDC/usbd_ncm.c **** 
 2415              		.loc 1 860 5 view .LVU750
 2416              		.loc 1 863 23 is_stmt 0 view .LVU751
 2417 001c A718     		adds	r7, r4, r2
 860:USBDevice/Class/CDC/usbd_ncm.c **** 
 2418              		.loc 1 860 13 view .LVU752
 2419 001e 0880     		strh	r0, [r1]	@ movhi
 2420              		.loc 1 863 5 is_stmt 1 view .LVU753
 2421              		.loc 1 863 23 is_stmt 0 view .LVU754
 2422 0020 17F80C10 		ldrb	r1, [r7, ip]	@ zero_extendqisi2
 2423              	.LVL203:
 2424              		.loc 1 863 8 view .LVU755
 2425 0024 0329     		cmp	r1, #3
 2426 0026 66D0     		beq	.L170
 864:USBDevice/Class/CDC/usbd_ncm.c ****     {
 865:USBDevice/Class/CDC/usbd_ncm.c ****         itf->Out.State[page] = NTB_PROCESSING;
 866:USBDevice/Class/CDC/usbd_ncm.c ****     }
 867:USBDevice/Class/CDC/usbd_ncm.c ****     else
 868:USBDevice/Class/CDC/usbd_ncm.c ****     {
 869:USBDevice/Class/CDC/usbd_ncm.c ****         /* A datagram has already been popped from this NTB */
 870:USBDevice/Class/CDC/usbd_ncm.c ****         if (itf->Out.State[page] == NTB_PROCESSING)
ARM GAS  /tmp/ccWJL6at.s 			page 71


 2427              		.loc 1 870 9 is_stmt 1 view .LVU756
 2428              		.loc 1 870 27 is_stmt 0 view .LVU757
 2429 0028 17F80C30 		ldrb	r3, [r7, ip]	@ zero_extendqisi2
 2430              		.loc 1 870 12 view .LVU758
 2431 002c 012B     		cmp	r3, #1
 2432 002e 4ED0     		beq	.L171
 2433              	.L158:
 871:USBDevice/Class/CDC/usbd_ncm.c ****         {
 872:USBDevice/Class/CDC/usbd_ncm.c ****             /* First advance to the next datagram */
 873:USBDevice/Class/CDC/usbd_ncm.c ****             if (pt->V16.Datagram[itf->Out.Dx + 1].Index != 0)
 874:USBDevice/Class/CDC/usbd_ncm.c ****             {
 875:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Dx++;
 876:USBDevice/Class/CDC/usbd_ncm.c ****             }
 877:USBDevice/Class/CDC/usbd_ncm.c ****             else if (pt->V16.NextNdpIndex != 0)
 878:USBDevice/Class/CDC/usbd_ncm.c ****             {
 879:USBDevice/Class/CDC/usbd_ncm.c ****                 nth = (void*)itf->Out.Data[page];
 880:USBDevice/Class/CDC/usbd_ncm.c ****                 pt = (void*)nth + pt->V16.NextNdpIndex;
 881:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.PT = pt;
 882:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Dx = 0;
 883:USBDevice/Class/CDC/usbd_ncm.c ****             }
 884:USBDevice/Class/CDC/usbd_ncm.c ****             else
 885:USBDevice/Class/CDC/usbd_ncm.c ****             {
 886:USBDevice/Class/CDC/usbd_ncm.c ****                 /* NTB is fully processed */
 887:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.State[page] = NTB_EMPTY;
 888:USBDevice/Class/CDC/usbd_ncm.c ****             }
 889:USBDevice/Class/CDC/usbd_ncm.c ****         }
 890:USBDevice/Class/CDC/usbd_ncm.c **** 
 891:USBDevice/Class/CDC/usbd_ncm.c ****         /* Switch to other NTB if available */
 892:USBDevice/Class/CDC/usbd_ncm.c ****         if ((itf->Out.State[page] == NTB_EMPTY) &&
 2434              		.loc 1 892 9 is_stmt 1 view .LVU759
 2435              		.loc 1 892 28 is_stmt 0 view .LVU760
 2436 0030 41F23208 		movw	r8, #4146
 2437 0034 17F80830 		ldrb	r3, [r7, r8]	@ zero_extendqisi2
 2438              		.loc 1 892 12 view .LVU761
 2439 0038 03F0FF01 		and	r1, r3, #255
 2440 003c B3B1     		cbz	r3, .L161
 2441              	.L169:
 2442              		.loc 1 892 12 view .LVU762
 2443 003e 41F23003 		movw	r3, #4144
 2444 0042 E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 2445              	.LVL204:
 2446              	.L157:
 893:USBDevice/Class/CDC/usbd_ncm.c ****             (itf->Out.State[1 - page] == NTB_READY))
 894:USBDevice/Class/CDC/usbd_ncm.c ****         {
 895:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.Page = 1 - page;
 896:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.State[itf->Out.Page] = NTB_PROCESSING;
 897:USBDevice/Class/CDC/usbd_ncm.c ****             nth = (void*)itf->Out.Data[itf->Out.Page];
 898:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + nth->V16.NdpIndex;
 899:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.PT = pt;
 900:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.Dx = 0;
 901:USBDevice/Class/CDC/usbd_ncm.c **** 
 902:USBDevice/Class/CDC/usbd_ncm.c ****             /* Receive to empty NTB */
 903:USBDevice/Class/CDC/usbd_ncm.c ****             if (itf->Notify.Connection.Value != 0)
 904:USBDevice/Class/CDC/usbd_ncm.c ****             {
 905:USBDevice/Class/CDC/usbd_ncm.c ****                 USBD_EpReceive(itf->Base.Device, itf->Config.OutEpNum,
 906:USBDevice/Class/CDC/usbd_ncm.c ****                         itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 907:USBDevice/Class/CDC/usbd_ncm.c **** 
ARM GAS  /tmp/ccWJL6at.s 			page 72


 908:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.State[page] = NTB_TRANSFERRING;
 909:USBDevice/Class/CDC/usbd_ncm.c ****             }
 910:USBDevice/Class/CDC/usbd_ncm.c ****         }
 911:USBDevice/Class/CDC/usbd_ncm.c ****     }
 912:USBDevice/Class/CDC/usbd_ncm.c **** 
 913:USBDevice/Class/CDC/usbd_ncm.c ****     /* Set the return parameters if there's datagram available */
 914:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->Out.State[itf->Out.Page] == NTB_PROCESSING)
 2447              		.loc 1 914 5 is_stmt 1 view .LVU763
 2448              		.loc 1 914 23 is_stmt 0 view .LVU764
 2449 0044 2318     		adds	r3, r4, r0
 2450 0046 41F23202 		movw	r2, #4146
 2451 004a 9B5C     		ldrb	r3, [r3, r2]	@ zero_extendqisi2
 2452              		.loc 1 914 8 view .LVU765
 2453 004c 012B     		cmp	r3, #1
 2454 004e 4FD1     		bne	.L164
 915:USBDevice/Class/CDC/usbd_ncm.c ****     {
 916:USBDevice/Class/CDC/usbd_ncm.c ****         data = (uint8_t*)itf->Out.Data[itf->Out.Page]
 2455              		.loc 1 916 9 is_stmt 1 view .LVU766
 917:USBDevice/Class/CDC/usbd_ncm.c ****                 + pt->V16.Datagram[itf->Out.Dx].Index;
 2456              		.loc 1 917 44 is_stmt 0 view .LVU767
 2457 0050 41F23103 		movw	r3, #4145
 916:USBDevice/Class/CDC/usbd_ncm.c ****                 + pt->V16.Datagram[itf->Out.Dx].Index;
 2458              		.loc 1 916 14 view .LVU768
 2459 0054 C002     		lsls	r0, r0, #11
 2460 0056 E35C     		ldrb	r3, [r4, r3]	@ zero_extendqisi2
 2461 0058 2C30     		adds	r0, r0, #44
 2462 005a 06EB8306 		add	r6, r6, r3, lsl #2
 2463              	.LVL205:
 2464              		.loc 1 917 48 view .LVU769
 2465 005e 3289     		ldrh	r2, [r6, #8]	@ unaligned
 918:USBDevice/Class/CDC/usbd_ncm.c ****         *length = pt->V16.Datagram[itf->Out.Dx].Length;
 2466              		.loc 1 918 48 view .LVU770
 2467 0060 7389     		ldrh	r3, [r6, #10]	@ unaligned
 916:USBDevice/Class/CDC/usbd_ncm.c ****                 + pt->V16.Datagram[itf->Out.Dx].Index;
 2468              		.loc 1 916 14 view .LVU771
 2469 0062 1044     		add	r0, r0, r2
 2470              		.loc 1 918 17 view .LVU772
 2471 0064 2B80     		strh	r3, [r5]	@ movhi
 916:USBDevice/Class/CDC/usbd_ncm.c ****                 + pt->V16.Datagram[itf->Out.Dx].Index;
 2472              		.loc 1 916 14 view .LVU773
 2473 0066 2044     		add	r0, r0, r4
 2474              	.LVL206:
 2475              		.loc 1 918 9 is_stmt 1 view .LVU774
 919:USBDevice/Class/CDC/usbd_ncm.c ****     }
 920:USBDevice/Class/CDC/usbd_ncm.c **** 
 921:USBDevice/Class/CDC/usbd_ncm.c ****     return data;
 922:USBDevice/Class/CDC/usbd_ncm.c **** }
 2476              		.loc 1 922 1 is_stmt 0 view .LVU775
 2477 0068 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 2478              	.LVL207:
 2479              	.L161:
 893:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2480              		.loc 1 893 31 discriminator 1 view .LVU776
 2481 006c C2F10100 		rsb	r0, r2, #1
 893:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2482              		.loc 1 893 28 discriminator 1 view .LVU777
 2483 0070 2318     		adds	r3, r4, r0
ARM GAS  /tmp/ccWJL6at.s 			page 73


 2484 0072 13F80830 		ldrb	r3, [r3, r8]	@ zero_extendqisi2
 892:USBDevice/Class/CDC/usbd_ncm.c ****             (itf->Out.State[1 - page] == NTB_READY))
 2485              		.loc 1 892 49 discriminator 1 view .LVU778
 2486 0076 032B     		cmp	r3, #3
 2487 0078 E1D1     		bne	.L169
 895:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.State[itf->Out.Page] = NTB_PROCESSING;
 2488              		.loc 1 895 13 is_stmt 1 view .LVU779
 895:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.State[itf->Out.Page] = NTB_PROCESSING;
 2489              		.loc 1 895 31 is_stmt 0 view .LVU780
 2490 007a C0B2     		uxtb	r0, r0
 896:USBDevice/Class/CDC/usbd_ncm.c ****             nth = (void*)itf->Out.Data[itf->Out.Page];
 2491              		.loc 1 896 43 view .LVU781
 2492 007c 4FF0010E 		mov	lr, #1
 895:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.State[itf->Out.Page] = NTB_PROCESSING;
 2493              		.loc 1 895 27 view .LVU782
 2494 0080 41F23009 		movw	r9, #4144
 899:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.Dx = 0;
 2495              		.loc 1 899 25 view .LVU783
 2496 0084 41F22C0C 		movw	ip, #4140
 896:USBDevice/Class/CDC/usbd_ncm.c ****             nth = (void*)itf->Out.Data[itf->Out.Page];
 2497              		.loc 1 896 43 view .LVU784
 2498 0088 2618     		adds	r6, r4, r0
 2499              	.LVL208:
 897:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + nth->V16.NdpIndex;
 2500              		.loc 1 897 17 view .LVU785
 2501 008a 04EBC023 		add	r3, r4, r0, lsl #11
 895:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.State[itf->Out.Page] = NTB_PROCESSING;
 2502              		.loc 1 895 27 view .LVU786
 2503 008e 04F80900 		strb	r0, [r4, r9]
 896:USBDevice/Class/CDC/usbd_ncm.c ****             nth = (void*)itf->Out.Data[itf->Out.Page];
 2504              		.loc 1 896 13 is_stmt 1 view .LVU787
 896:USBDevice/Class/CDC/usbd_ncm.c ****             nth = (void*)itf->Out.Data[itf->Out.Page];
 2505              		.loc 1 896 43 is_stmt 0 view .LVU788
 2506 0092 06F808E0 		strb	lr, [r6, r8]
 897:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + nth->V16.NdpIndex;
 2507              		.loc 1 897 13 is_stmt 1 view .LVU789
 897:USBDevice/Class/CDC/usbd_ncm.c ****             pt = (void*)nth + nth->V16.NdpIndex;
 2508              		.loc 1 897 17 is_stmt 0 view .LVU790
 2509 0096 03F12C06 		add	r6, r3, #44
 2510              	.LVL209:
 898:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.PT = pt;
 2511              		.loc 1 898 13 is_stmt 1 view .LVU791
 898:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.PT = pt;
 2512              		.loc 1 898 39 is_stmt 0 view .LVU792
 2513 009a DB8E     		ldrh	r3, [r3, #54]	@ unaligned
 900:USBDevice/Class/CDC/usbd_ncm.c **** 
 2514              		.loc 1 900 25 view .LVU793
 2515 009c 41F2310E 		movw	lr, #4145
 898:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.PT = pt;
 2516              		.loc 1 898 16 view .LVU794
 2517 00a0 1E44     		add	r6, r6, r3
 2518              	.LVL210:
 899:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.Dx = 0;
 2519              		.loc 1 899 13 is_stmt 1 view .LVU795
 903:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2520              		.loc 1 903 16 is_stmt 0 view .LVU796
 2521 00a2 E38C     		ldrh	r3, [r4, #38]
ARM GAS  /tmp/ccWJL6at.s 			page 74


 900:USBDevice/Class/CDC/usbd_ncm.c **** 
 2522              		.loc 1 900 25 view .LVU797
 2523 00a4 04F80E10 		strb	r1, [r4, lr]
 899:USBDevice/Class/CDC/usbd_ncm.c ****             itf->Out.Dx = 0;
 2524              		.loc 1 899 25 view .LVU798
 2525 00a8 44F80C60 		str	r6, [r4, ip]
 900:USBDevice/Class/CDC/usbd_ncm.c **** 
 2526              		.loc 1 900 13 is_stmt 1 view .LVU799
 903:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2527              		.loc 1 903 13 view .LVU800
 903:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2528              		.loc 1 903 16 is_stmt 0 view .LVU801
 2529 00ac 002B     		cmp	r3, #0
 2530 00ae C9D0     		beq	.L157
 905:USBDevice/Class/CDC/usbd_ncm.c ****                         itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 2531              		.loc 1 905 17 is_stmt 1 view .LVU802
 906:USBDevice/Class/CDC/usbd_ncm.c **** 
 2532              		.loc 1 906 38 is_stmt 0 view .LVU803
 2533 00b0 04EBC222 		add	r2, r4, r2, lsl #11
 2534              	.LVL211:
 905:USBDevice/Class/CDC/usbd_ncm.c ****                         itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 2535              		.loc 1 905 17 view .LVU804
 2536 00b4 4FF40063 		mov	r3, #2048
 2537 00b8 217C     		ldrb	r1, [r4, #16]	@ zero_extendqisi2
 2538 00ba 2C32     		adds	r2, r2, #44
 2539 00bc 2068     		ldr	r0, [r4]
 2540              	.LVL212:
 905:USBDevice/Class/CDC/usbd_ncm.c ****                         itf->Out.Data[page], sizeof(itf->Out.Data[0]));
 2541              		.loc 1 905 17 view .LVU805
 2542 00be FFF7FEFF 		bl	USBD_EpReceive
 2543              	.LVL213:
 908:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2544              		.loc 1 908 17 is_stmt 1 view .LVU806
 908:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2545              		.loc 1 908 38 is_stmt 0 view .LVU807
 2546 00c2 0223     		movs	r3, #2
 2547 00c4 07F80830 		strb	r3, [r7, r8]
 2548 00c8 14F80900 		ldrb	r0, [r4, r9]	@ zero_extendqisi2
 2549 00cc BAE7     		b	.L157
 2550              	.LVL214:
 2551              	.L171:
 873:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2552              		.loc 1 873 13 is_stmt 1 view .LVU808
 873:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2553              		.loc 1 873 42 is_stmt 0 view .LVU809
 2554 00ce 41F23101 		movw	r1, #4145
 2555 00d2 635C     		ldrb	r3, [r4, r1]	@ zero_extendqisi2
 873:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2556              		.loc 1 873 50 view .LVU810
 2557 00d4 D81C     		adds	r0, r3, #3
 873:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2558              		.loc 1 873 16 view .LVU811
 2559 00d6 36F82000 		ldrh	r0, [r6, r0, lsl #2]	@ unaligned
 2560 00da 88B9     		cbnz	r0, .L172
 877:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2561              		.loc 1 877 18 is_stmt 1 view .LVU812
 877:USBDevice/Class/CDC/usbd_ncm.c ****             {
ARM GAS  /tmp/ccWJL6at.s 			page 75


 2562              		.loc 1 877 29 is_stmt 0 view .LVU813
 2563 00dc F388     		ldrh	r3, [r6, #6]	@ unaligned
 877:USBDevice/Class/CDC/usbd_ncm.c ****             {
 2564              		.loc 1 877 21 view .LVU814
 2565 00de D3B1     		cbz	r3, .L160
 879:USBDevice/Class/CDC/usbd_ncm.c ****                 pt = (void*)nth + pt->V16.NextNdpIndex;
 2566              		.loc 1 879 17 is_stmt 1 view .LVU815
 2567              	.LVL215:
 880:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.PT = pt;
 2568              		.loc 1 880 17 view .LVU816
 880:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.PT = pt;
 2569              		.loc 1 880 20 is_stmt 0 view .LVU817
 2570 00e0 03EBC226 		add	r6, r3, r2, lsl #11
 2571              	.LVL216:
 882:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2572              		.loc 1 882 29 view .LVU818
 2573 00e4 6054     		strb	r0, [r4, r1]
 2574              	.LVL217:
 880:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.PT = pt;
 2575              		.loc 1 880 20 view .LVU819
 2576 00e6 2C36     		adds	r6, r6, #44
 2577 00e8 2644     		add	r6, r6, r4
 2578              	.LVL218:
 881:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Dx = 0;
 2579              		.loc 1 881 17 is_stmt 1 view .LVU820
 881:USBDevice/Class/CDC/usbd_ncm.c ****                 itf->Out.Dx = 0;
 2580              		.loc 1 881 29 is_stmt 0 view .LVU821
 2581 00ea 44F80E60 		str	r6, [r4, lr]
 882:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2582              		.loc 1 882 17 is_stmt 1 view .LVU822
 2583 00ee 9FE7     		b	.L158
 2584              	.LVL219:
 2585              	.L164:
 859:USBDevice/Class/CDC/usbd_ncm.c ****     *length = 0;
 2586              		.loc 1 859 14 is_stmt 0 view .LVU823
 2587 00f0 0020     		movs	r0, #0
 921:USBDevice/Class/CDC/usbd_ncm.c **** }
 2588              		.loc 1 921 5 is_stmt 1 view .LVU824
 2589              		.loc 1 922 1 is_stmt 0 view .LVU825
 2590 00f2 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 2591              	.LVL220:
 2592              	.L170:
 865:USBDevice/Class/CDC/usbd_ncm.c ****     }
 2593              		.loc 1 865 9 is_stmt 1 view .LVU826
 865:USBDevice/Class/CDC/usbd_ncm.c ****     }
 2594              		.loc 1 865 30 is_stmt 0 view .LVU827
 2595 00f6 0122     		movs	r2, #1
 2596              	.LVL221:
 865:USBDevice/Class/CDC/usbd_ncm.c ****     }
 2597              		.loc 1 865 30 view .LVU828
 2598 00f8 07F80C20 		strb	r2, [r7, ip]
 2599 00fc E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 2600 00fe A1E7     		b	.L157
 2601              	.LVL222:
 2602              	.L172:
 875:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2603              		.loc 1 875 17 is_stmt 1 view .LVU829
ARM GAS  /tmp/ccWJL6at.s 			page 76


 875:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2604              		.loc 1 875 28 is_stmt 0 view .LVU830
 2605 0100 0133     		adds	r3, r3, #1
 892:USBDevice/Class/CDC/usbd_ncm.c ****             (itf->Out.State[1 - page] == NTB_READY))
 2606              		.loc 1 892 28 view .LVU831
 2607 0102 41F23208 		movw	r8, #4146
 875:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2608              		.loc 1 875 28 view .LVU832
 2609 0106 6354     		strb	r3, [r4, r1]
 892:USBDevice/Class/CDC/usbd_ncm.c ****             (itf->Out.State[1 - page] == NTB_READY))
 2610              		.loc 1 892 9 is_stmt 1 view .LVU833
 892:USBDevice/Class/CDC/usbd_ncm.c ****             (itf->Out.State[1 - page] == NTB_READY))
 2611              		.loc 1 892 28 is_stmt 0 view .LVU834
 2612 0108 17F80830 		ldrb	r3, [r7, r8]	@ zero_extendqisi2
 892:USBDevice/Class/CDC/usbd_ncm.c ****             (itf->Out.State[1 - page] == NTB_READY))
 2613              		.loc 1 892 12 view .LVU835
 2614 010c 03F0FF01 		and	r1, r3, #255
 2615 0110 002B     		cmp	r3, #0
 2616 0112 ABD0     		beq	.L161
 2617 0114 93E7     		b	.L169
 2618              	.L160:
 887:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2619              		.loc 1 887 17 is_stmt 1 view .LVU836
 887:USBDevice/Class/CDC/usbd_ncm.c ****             }
 2620              		.loc 1 887 38 is_stmt 0 view .LVU837
 2621 0116 07F80C30 		strb	r3, [r7, ip]
 2622 011a 89E7     		b	.L158
 2623              		.cfi_endproc
 2624              	.LFE161:
 2626              		.section	.text.USBD_NCM_AllocDatagram,"ax",%progbits
 2627              		.align	1
 2628              		.p2align 2,,3
 2629              		.global	USBD_NCM_AllocDatagram
 2630              		.syntax unified
 2631              		.thumb
 2632              		.thumb_func
 2633              		.fpu fpv4-sp-d16
 2635              	USBD_NCM_AllocDatagram:
 2636              	.LVL223:
 2637              	.LFB162:
 923:USBDevice/Class/CDC/usbd_ncm.c **** 
 924:USBDevice/Class/CDC/usbd_ncm.c **** /**
 925:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Attempts to allocate a datagram in the transmit NTB buffer.
 926:USBDevice/Class/CDC/usbd_ncm.c ****  *        When the buffer is filled, the @ref USBD_NCM_SetDatagram function
 927:USBDevice/Class/CDC/usbd_ncm.c ****  *        must be called to complete the placement of the datagram.
 928:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 929:USBDevice/Class/CDC/usbd_ncm.c ****  * @param length: total size of the datagram
 930:USBDevice/Class/CDC/usbd_ncm.c ****  * @return pointer to word-aligned buffer if available, NULL otherwise
 931:USBDevice/Class/CDC/usbd_ncm.c ****  */
 932:USBDevice/Class/CDC/usbd_ncm.c **** uint8_t* USBD_NCM_AllocDatagram(USBD_NCM_IfHandleType *itf, uint16_t length)
 933:USBDevice/Class/CDC/usbd_ncm.c **** {
 2638              		.loc 1 933 1 is_stmt 1 view -0
 2639              		.cfi_startproc
 2640              		@ args = 0, pretend = 0, frame = 0
 2641              		@ frame_needed = 0, uses_anonymous_args = 0
 934:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* data = NULL;
 2642              		.loc 1 934 5 view .LVU839
ARM GAS  /tmp/ccWJL6at.s 			page 77


 935:USBDevice/Class/CDC/usbd_ncm.c **** 
 936:USBDevice/Class/CDC/usbd_ncm.c ****     if ((itf->Notify.Connection.Value != 0) &&
 2643              		.loc 1 936 5 view .LVU840
 2644              		.loc 1 936 8 is_stmt 0 view .LVU841
 2645 0000 C28C     		ldrh	r2, [r0, #38]
 2646              		.loc 1 936 45 view .LVU842
 2647 0002 002A     		cmp	r2, #0
 2648 0004 3CD0     		beq	.L185
 2649 0006 40F2EA52 		movw	r2, #1514
 2650 000a 9142     		cmp	r1, r2
 2651 000c 38D8     		bhi	.L185
 2652 000e 0346     		mov	r3, r0
 933:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* data = NULL;
 2653              		.loc 1 933 1 view .LVU843
 2654 0010 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2655              	.LCFI38:
 2656              		.cfi_def_cfa_offset 24
 2657              		.cfi_offset 4, -24
 2658              		.cfi_offset 5, -20
 2659              		.cfi_offset 6, -16
 2660              		.cfi_offset 7, -12
 2661              		.cfi_offset 8, -8
 2662              		.cfi_offset 14, -4
 937:USBDevice/Class/CDC/usbd_ncm.c ****         (length <= NCM_MAX_SEGMENT_SIZE) &&
 938:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->In.FillState != NTB_PROCESSING))
 2663              		.loc 1 938 17 view .LVU844
 2664 0014 42F24104 		movw	r4, #8257
 2665 0018 025D     		ldrb	r2, [r0, r4]	@ zero_extendqisi2
 937:USBDevice/Class/CDC/usbd_ncm.c ****         (length <= NCM_MAX_SEGMENT_SIZE) &&
 2666              		.loc 1 937 42 view .LVU845
 2667 001a 012A     		cmp	r2, #1
 2668 001c 2DD0     		beq	.L177
 2669              	.LVL224:
 2670              	.LBB259:
 2671              	.LBI259:
 932:USBDevice/Class/CDC/usbd_ncm.c **** {
 2672              		.loc 1 932 10 is_stmt 1 view .LVU846
 2673              	.LBB260:
 2674              	.LBB261:
 939:USBDevice/Class/CDC/usbd_ncm.c ****     {
 940:USBDevice/Class/CDC/usbd_ncm.c ****         /* Datagrams are inserted starting from the header
 941:USBDevice/Class/CDC/usbd_ncm.c ****          * Datagram lengths are saved backwards starting from the end of the buffer
 942:USBDevice/Class/CDC/usbd_ncm.c ****          * and get ordered only at the time of NTB transmission */
 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t wlen = (length + 3) & (~3);
 2675              		.loc 1 943 9 view .LVU847
 2676              		.loc 1 943 33 is_stmt 0 view .LVU848
 2677 001e CA1C     		adds	r2, r1, #3
 944:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 945:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t page;
 946:USBDevice/Class/CDC/usbd_ncm.c **** 
 947:USBDevice/Class/CDC/usbd_ncm.c ****         /* Set syncronization state */
 948:USBDevice/Class/CDC/usbd_ncm.c ****         itf->In.FillState = NTB_PROCESSING;
 2678              		.loc 1 948 27 view .LVU849
 2679 0020 0120     		movs	r0, #1
 2680              	.LVL225:
 949:USBDevice/Class/CDC/usbd_ncm.c **** 
 950:USBDevice/Class/CDC/usbd_ncm.c ****         page = itf->In.Page;
ARM GAS  /tmp/ccWJL6at.s 			page 78


 951:USBDevice/Class/CDC/usbd_ncm.c **** 
 952:USBDevice/Class/CDC/usbd_ncm.c ****         /* If the current page has enough free space */
 953:USBDevice/Class/CDC/usbd_ncm.c ****         if (addlen <= itf->In.RemSize)
 2681              		.loc 1 953 30 view .LVU850
 2682 0022 42F23805 		movw	r5, #8248
 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2683              		.loc 1 943 18 view .LVU851
 2684 0026 22F00302 		bic	r2, r2, #3
 2685              		.loc 1 953 30 view .LVU852
 2686 002a 5E59     		ldr	r6, [r3, r5]
 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2687              		.loc 1 943 18 view .LVU853
 2688 002c 92B2     		uxth	r2, r2
 2689              	.LVL226:
 944:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2690              		.loc 1 944 9 is_stmt 1 view .LVU854
 945:USBDevice/Class/CDC/usbd_ncm.c **** 
 2691              		.loc 1 945 9 view .LVU855
 948:USBDevice/Class/CDC/usbd_ncm.c **** 
 2692              		.loc 1 948 9 view .LVU856
 950:USBDevice/Class/CDC/usbd_ncm.c **** 
 2693              		.loc 1 950 9 view .LVU857
 2694              		.loc 1 953 9 view .LVU858
 948:USBDevice/Class/CDC/usbd_ncm.c **** 
 2695              		.loc 1 948 27 is_stmt 0 view .LVU859
 2696 002e 1855     		strb	r0, [r3, r4]
 2697              	.LVL227:
 944:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t page;
 2698              		.loc 1 944 18 view .LVU860
 2699 0030 101D     		adds	r0, r2, #4
 2700              		.loc 1 953 20 view .LVU861
 2701 0032 80B2     		uxth	r0, r0
 2702              		.loc 1 953 12 view .LVU862
 2703 0034 B042     		cmp	r0, r6
 2704 0036 20D8     		bhi	.L177
 2705              	.LBB262:
 954:USBDevice/Class/CDC/usbd_ncm.c ****         {
 955:USBDevice/Class/CDC/usbd_ncm.c ****             USBD_NCM_TransferHeaderType* nth = (void*)itf->In.Data[page];
 2706              		.loc 1 955 13 is_stmt 1 view .LVU863
 956:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 957:USBDevice/Class/CDC/usbd_ncm.c ****                 uint16_t length;
 958:USBDevice/Class/CDC/usbd_ncm.c ****                 uint16_t reserved;
 959:USBDevice/Class/CDC/usbd_ncm.c ****             }*dp = (void*)nth + sizeof(itf->In.Data[0])
 960:USBDevice/Class/CDC/usbd_ncm.c ****                     - (sizeof(*dp) * (++itf->In.DgCount));
 2707              		.loc 1 960 48 is_stmt 0 view .LVU864
 2708 0038 42F23F0E 		movw	lr, #8255
 2709              	.LBE262:
 950:USBDevice/Class/CDC/usbd_ncm.c **** 
 2710              		.loc 1 950 14 view .LVU865
 2711 003c 42F23E08 		movw	r8, #8254
 2712              	.LBB263:
 961:USBDevice/Class/CDC/usbd_ncm.c **** 
 962:USBDevice/Class/CDC/usbd_ncm.c ****             data = (void*)nth + itf->In.Index;
 2713              		.loc 1 962 40 view .LVU866
 2714 0040 42F23C0C 		movw	ip, #8252
 963:USBDevice/Class/CDC/usbd_ncm.c **** 
 964:USBDevice/Class/CDC/usbd_ncm.c ****             dp->length = length;
ARM GAS  /tmp/ccWJL6at.s 			page 79


 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Index += wlen;
 966:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 2715              		.loc 1 966 29 view .LVU867
 2716 0044 361A     		subs	r6, r6, r0
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2717              		.loc 1 960 39 view .LVU868
 2718 0046 13F80E40 		ldrb	r4, [r3, lr]	@ zero_extendqisi2
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 2719              		.loc 1 955 42 view .LVU869
 2720 004a 41F23407 		movw	r7, #4148
 2721 004e 13F80880 		ldrb	r8, [r3, r8]	@ zero_extendqisi2
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2722              		.loc 1 960 39 view .LVU870
 2723 0052 0134     		adds	r4, r4, #1
 962:USBDevice/Class/CDC/usbd_ncm.c **** 
 2724              		.loc 1 962 40 view .LVU871
 2725 0054 33F80C00 		ldrh	r0, [r3, ip]
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 2726              		.loc 1 955 42 view .LVU872
 2727 0058 03EBC828 		add	r8, r3, r8, lsl #11
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2728              		.loc 1 960 39 view .LVU873
 2729 005c E4B2     		uxtb	r4, r4
 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 2730              		.loc 1 965 27 view .LVU874
 2731 005e 0244     		add	r2, r2, r0
 2732              	.LVL228:
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 2733              		.loc 1 955 42 view .LVU875
 2734 0060 4744     		add	r7, r7, r8
 2735              	.LVL229:
 956:USBDevice/Class/CDC/usbd_ncm.c ****                 uint16_t length;
 2736              		.loc 1 956 13 is_stmt 1 view .LVU876
 959:USBDevice/Class/CDC/usbd_ncm.c ****                     - (sizeof(*dp) * (++itf->In.DgCount));
 2737              		.loc 1 959 15 is_stmt 0 view .LVU877
 2738 0062 03F80E40 		strb	r4, [r3, lr]
 2739              	.LVL230:
 962:USBDevice/Class/CDC/usbd_ncm.c **** 
 2740              		.loc 1 962 13 is_stmt 1 view .LVU878
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2741              		.loc 1 960 21 is_stmt 0 view .LVU879
 2742 0066 C4F50074 		rsb	r4, r4, #512
 2743              	.LVL231:
 962:USBDevice/Class/CDC/usbd_ncm.c **** 
 2744              		.loc 1 962 18 view .LVU880
 2745 006a 3844     		add	r0, r0, r7
 2746              	.LVL232:
 964:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Index += wlen;
 2747              		.loc 1 964 13 is_stmt 1 view .LVU881
 964:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Index += wlen;
 2748              		.loc 1 964 24 is_stmt 0 view .LVU882
 2749 006c 27F82410 		strh	r1, [r7, r4, lsl #2]	@ movhi
 2750              	.LVL233:
 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 2751              		.loc 1 965 13 is_stmt 1 view .LVU883
 2752              		.loc 1 966 29 is_stmt 0 view .LVU884
 2753 0070 5E51     		str	r6, [r3, r5]
ARM GAS  /tmp/ccWJL6at.s 			page 80


 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 2754              		.loc 1 965 27 view .LVU885
 2755 0072 23F80C20 		strh	r2, [r3, ip]	@ movhi
 2756              		.loc 1 966 13 is_stmt 1 view .LVU886
 2757              	.LVL234:
 2758              		.loc 1 966 13 is_stmt 0 view .LVU887
 2759              	.LBE263:
 2760              	.LBE261:
 2761              	.LBE260:
 2762              	.LBE259:
 967:USBDevice/Class/CDC/usbd_ncm.c ****         }
 968:USBDevice/Class/CDC/usbd_ncm.c ****     }
 969:USBDevice/Class/CDC/usbd_ncm.c **** 
 970:USBDevice/Class/CDC/usbd_ncm.c ****     return data;
 2763              		.loc 1 970 5 is_stmt 1 view .LVU888
 971:USBDevice/Class/CDC/usbd_ncm.c **** }
 2764              		.loc 1 971 1 is_stmt 0 view .LVU889
 2765 0076 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2766              	.LVL235:
 2767              	.L177:
 934:USBDevice/Class/CDC/usbd_ncm.c **** 
 2768              		.loc 1 934 14 view .LVU890
 2769 007a 0020     		movs	r0, #0
 2770              		.loc 1 971 1 view .LVU891
 2771 007c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2772              	.LVL236:
 2773              	.L185:
 2774              	.LCFI39:
 2775              		.cfi_def_cfa_offset 0
 2776              		.cfi_restore 4
 2777              		.cfi_restore 5
 2778              		.cfi_restore 6
 2779              		.cfi_restore 7
 2780              		.cfi_restore 8
 2781              		.cfi_restore 14
 934:USBDevice/Class/CDC/usbd_ncm.c **** 
 2782              		.loc 1 934 14 view .LVU892
 2783 0080 0020     		movs	r0, #0
 2784              	.LVL237:
 2785              		.loc 1 971 1 view .LVU893
 2786 0082 7047     		bx	lr
 2787              		.cfi_endproc
 2788              	.LFE162:
 2790              		.section	.text.USBD_NCM_SetDatagram,"ax",%progbits
 2791              		.align	1
 2792              		.p2align 2,,3
 2793              		.global	USBD_NCM_SetDatagram
 2794              		.syntax unified
 2795              		.thumb
 2796              		.thumb_func
 2797              		.fpu fpv4-sp-d16
 2799              	USBD_NCM_SetDatagram:
 2800              	.LVL238:
 2801              	.LFB163:
 972:USBDevice/Class/CDC/usbd_ncm.c **** 
 973:USBDevice/Class/CDC/usbd_ncm.c **** /**
 974:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Called after @ref USBD_NCM_AllocDatagram and after the datagram is
ARM GAS  /tmp/ccWJL6at.s 			page 81


 975:USBDevice/Class/CDC/usbd_ncm.c ****  *        copied to the buffer. Completes the operation and attempts an NTB IN transfer.
 976:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
 977:USBDevice/Class/CDC/usbd_ncm.c ****  * @return OK if called in the right sequence, INVALID otherwise
 978:USBDevice/Class/CDC/usbd_ncm.c ****  */
 979:USBDevice/Class/CDC/usbd_ncm.c **** USBD_ReturnType USBD_NCM_SetDatagram(USBD_NCM_IfHandleType *itf)
 980:USBDevice/Class/CDC/usbd_ncm.c **** {
 2802              		.loc 1 980 1 is_stmt 1 view -0
 2803              		.cfi_startproc
 2804              		@ args = 0, pretend = 0, frame = 0
 2805              		@ frame_needed = 0, uses_anonymous_args = 0
 981:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2806              		.loc 1 981 5 view .LVU895
 982:USBDevice/Class/CDC/usbd_ncm.c **** 
 983:USBDevice/Class/CDC/usbd_ncm.c ****     if (itf->In.FillState == NTB_PROCESSING)
 2807              		.loc 1 983 5 view .LVU896
 2808              		.loc 1 983 16 is_stmt 0 view .LVU897
 2809 0000 42F24102 		movw	r2, #8257
 980:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2810              		.loc 1 980 1 view .LVU898
 2811 0004 10B5     		push	{r4, lr}
 2812              	.LCFI40:
 2813              		.cfi_def_cfa_offset 8
 2814              		.cfi_offset 4, -8
 2815              		.cfi_offset 14, -4
 2816              		.loc 1 983 16 view .LVU899
 2817 0006 815C     		ldrb	r1, [r0, r2]	@ zero_extendqisi2
 2818              		.loc 1 983 8 view .LVU900
 2819 0008 0129     		cmp	r1, #1
 2820 000a 02D0     		beq	.L192
 981:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2821              		.loc 1 981 21 view .LVU901
 2822 000c 0324     		movs	r4, #3
 2823              	.LVL239:
 984:USBDevice/Class/CDC/usbd_ncm.c ****     {
 985:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t page = itf->In.Page;
 986:USBDevice/Class/CDC/usbd_ncm.c **** 
 987:USBDevice/Class/CDC/usbd_ncm.c ****         /* Clear syncronization state */
 988:USBDevice/Class/CDC/usbd_ncm.c ****         if (itf->In.SendState != NTB_EMPTY)
 989:USBDevice/Class/CDC/usbd_ncm.c ****         {
 990:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.FillState = NTB_READY;
 991:USBDevice/Class/CDC/usbd_ncm.c ****         }
 992:USBDevice/Class/CDC/usbd_ncm.c ****         else /* If the other page is empty, we can transmit this one */
 993:USBDevice/Class/CDC/usbd_ncm.c ****         {
 994:USBDevice/Class/CDC/usbd_ncm.c ****             ncm_sendNTB(itf, page);
 995:USBDevice/Class/CDC/usbd_ncm.c ****         }
 996:USBDevice/Class/CDC/usbd_ncm.c **** 
 997:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_E_OK;
 998:USBDevice/Class/CDC/usbd_ncm.c ****     }
 999:USBDevice/Class/CDC/usbd_ncm.c ****     return retval;
 2824              		.loc 1 999 5 is_stmt 1 view .LVU902
1000:USBDevice/Class/CDC/usbd_ncm.c **** }
 2825              		.loc 1 1000 1 is_stmt 0 view .LVU903
 2826 000e 2046     		mov	r0, r4
 2827              	.LVL240:
 2828              		.loc 1 1000 1 view .LVU904
 2829 0010 10BD     		pop	{r4, pc}
 2830              	.LVL241:
ARM GAS  /tmp/ccWJL6at.s 			page 82


 2831              	.L192:
 2832              	.LBB267:
 2833              	.LBI267:
 979:USBDevice/Class/CDC/usbd_ncm.c **** {
 2834              		.loc 1 979 17 is_stmt 1 view .LVU905
 2835              	.LBB268:
 2836              	.LBB269:
 985:USBDevice/Class/CDC/usbd_ncm.c **** 
 2837              		.loc 1 985 9 view .LVU906
 988:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2838              		.loc 1 988 9 view .LVU907
 988:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2839              		.loc 1 988 20 is_stmt 0 view .LVU908
 2840 0012 00F50151 		add	r1, r0, #8256
 2841 0016 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 988:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2842              		.loc 1 988 12 view .LVU909
 2843 0018 01F0FF04 		and	r4, r1, #255
 2844 001c 21B1     		cbz	r1, .L189
 990:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2845              		.loc 1 990 13 is_stmt 1 view .LVU910
 990:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2846              		.loc 1 990 31 is_stmt 0 view .LVU911
 2847 001e 0321     		movs	r1, #3
 2848 0020 0024     		movs	r4, #0
 2849 0022 8154     		strb	r1, [r0, r2]
 2850              	.LVL242:
 990:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2851              		.loc 1 990 31 view .LVU912
 2852              	.LBE269:
 2853              	.LBE268:
 2854              	.LBE267:
 999:USBDevice/Class/CDC/usbd_ncm.c **** }
 2855              		.loc 1 999 5 is_stmt 1 view .LVU913
 2856              		.loc 1 1000 1 is_stmt 0 view .LVU914
 2857 0024 2046     		mov	r0, r4
 2858              	.LVL243:
 2859              		.loc 1 1000 1 view .LVU915
 2860 0026 10BD     		pop	{r4, pc}
 2861              	.LVL244:
 2862              	.L189:
 2863              	.LBB272:
 2864              	.LBB271:
 2865              	.LBB270:
 994:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2866              		.loc 1 994 13 is_stmt 1 view .LVU916
 985:USBDevice/Class/CDC/usbd_ncm.c **** 
 2867              		.loc 1 985 17 is_stmt 0 view .LVU917
 2868 0028 42F23E02 		movw	r2, #8254
 994:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2869              		.loc 1 994 13 view .LVU918
 2870 002c 815C     		ldrb	r1, [r0, r2]	@ zero_extendqisi2
 2871 002e FFF7FEFF 		bl	ncm_sendNTB
 2872              	.LVL245:
 994:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2873              		.loc 1 994 13 view .LVU919
 2874              	.LBE270:
ARM GAS  /tmp/ccWJL6at.s 			page 83


 2875              	.LBE271:
 2876              	.LBE272:
 999:USBDevice/Class/CDC/usbd_ncm.c **** }
 2877              		.loc 1 999 5 is_stmt 1 view .LVU920
 2878              		.loc 1 1000 1 is_stmt 0 view .LVU921
 2879 0032 2046     		mov	r0, r4
 2880 0034 10BD     		pop	{r4, pc}
 2881              		.loc 1 1000 1 view .LVU922
 2882              		.cfi_endproc
 2883              	.LFE163:
 2885 0036 00BF     		.section	.text.USBD_NCM_PutDatagram,"ax",%progbits
 2886              		.align	1
 2887              		.p2align 2,,3
 2888              		.global	USBD_NCM_PutDatagram
 2889              		.syntax unified
 2890              		.thumb
 2891              		.thumb_func
 2892              		.fpu fpv4-sp-d16
 2894              	USBD_NCM_PutDatagram:
 2895              	.LVL246:
 2896              	.LFB164:
1001:USBDevice/Class/CDC/usbd_ncm.c **** 
1002:USBDevice/Class/CDC/usbd_ncm.c **** /**
1003:USBDevice/Class/CDC/usbd_ncm.c ****  * @brief Writes a datagram to the current block and initiates a NTB transfer
1004:USBDevice/Class/CDC/usbd_ncm.c ****  *        if the current IN pipe is idle.
1005:USBDevice/Class/CDC/usbd_ncm.c ****  * @param itf: reference of the NCM interface
1006:USBDevice/Class/CDC/usbd_ncm.c ****  * @param data: pointer to the data to send
1007:USBDevice/Class/CDC/usbd_ncm.c ****  * @param length: length of the data
1008:USBDevice/Class/CDC/usbd_ncm.c ****  * @return INVALID if the datagram size is higher than the limit or if disconnected,
1009:USBDevice/Class/CDC/usbd_ncm.c ****  *         OK if successful
1010:USBDevice/Class/CDC/usbd_ncm.c ****  */
1011:USBDevice/Class/CDC/usbd_ncm.c **** USBD_ReturnType USBD_NCM_PutDatagram(USBD_NCM_IfHandleType *itf, uint8_t *data, uint16_t length)
1012:USBDevice/Class/CDC/usbd_ncm.c **** {
 2897              		.loc 1 1012 1 is_stmt 1 view -0
 2898              		.cfi_startproc
 2899              		@ args = 0, pretend = 0, frame = 8
 2900              		@ frame_needed = 0, uses_anonymous_args = 0
1013:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2901              		.loc 1 1013 5 view .LVU924
1014:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* dst = USBD_NCM_AllocDatagram(itf, length);
 2902              		.loc 1 1014 5 view .LVU925
1012:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2903              		.loc 1 1012 1 is_stmt 0 view .LVU926
 2904 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 2905              	.LCFI41:
 2906              		.cfi_def_cfa_offset 36
 2907              		.cfi_offset 4, -36
 2908              		.cfi_offset 5, -32
 2909              		.cfi_offset 6, -28
 2910              		.cfi_offset 7, -24
 2911              		.cfi_offset 8, -20
 2912              		.cfi_offset 9, -16
 2913              		.cfi_offset 10, -12
 2914              		.cfi_offset 11, -8
 2915              		.cfi_offset 14, -4
 2916 0004 0446     		mov	r4, r0
 2917              	.LVL247:
ARM GAS  /tmp/ccWJL6at.s 			page 84


 2918              	.LBB286:
 2919              	.LBI286:
 932:USBDevice/Class/CDC/usbd_ncm.c **** {
 2920              		.loc 1 932 10 is_stmt 1 view .LVU927
 2921              	.LBB287:
 934:USBDevice/Class/CDC/usbd_ncm.c **** 
 2922              		.loc 1 934 5 view .LVU928
 936:USBDevice/Class/CDC/usbd_ncm.c ****         (length <= NCM_MAX_SEGMENT_SIZE) &&
 2923              		.loc 1 936 5 view .LVU929
 936:USBDevice/Class/CDC/usbd_ncm.c ****         (length <= NCM_MAX_SEGMENT_SIZE) &&
 2924              		.loc 1 936 8 is_stmt 0 view .LVU930
 2925 0006 C08C     		ldrh	r0, [r0, #38]
 2926              	.LVL248:
 936:USBDevice/Class/CDC/usbd_ncm.c ****         (length <= NCM_MAX_SEGMENT_SIZE) &&
 2927              		.loc 1 936 8 view .LVU931
 2928              	.LBE287:
 2929              	.LBE286:
1012:USBDevice/Class/CDC/usbd_ncm.c ****     USBD_ReturnType retval = USBD_E_INVALID;
 2930              		.loc 1 1012 1 view .LVU932
 2931 0008 83B0     		sub	sp, sp, #12
 2932              	.LCFI42:
 2933              		.cfi_def_cfa_offset 48
 2934              	.LBB299:
 2935              	.LBB297:
 936:USBDevice/Class/CDC/usbd_ncm.c ****         (length <= NCM_MAX_SEGMENT_SIZE) &&
 2936              		.loc 1 936 45 view .LVU933
 2937 000a 0028     		cmp	r0, #0
 2938 000c 40D0     		beq	.L197
 2939 000e 40F2EA50 		movw	r0, #1514
 2940 0012 8242     		cmp	r2, r0
 2941 0014 3CD8     		bhi	.L197
 938:USBDevice/Class/CDC/usbd_ncm.c ****     {
 2942              		.loc 1 938 17 view .LVU934
 2943 0016 42F24107 		movw	r7, #8257
 2944 001a E05D     		ldrb	r0, [r4, r7]	@ zero_extendqisi2
 937:USBDevice/Class/CDC/usbd_ncm.c ****         (itf->In.FillState != NTB_PROCESSING))
 2945              		.loc 1 937 42 view .LVU935
 2946 001c 0128     		cmp	r0, #1
 2947 001e 37D0     		beq	.L197
 2948              	.LVL249:
 2949              	.LBB288:
 2950              	.LBI288:
 932:USBDevice/Class/CDC/usbd_ncm.c **** {
 2951              		.loc 1 932 10 is_stmt 1 view .LVU936
 2952              	.LBB289:
 2953              	.LBB290:
 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2954              		.loc 1 943 9 view .LVU937
 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2955              		.loc 1 943 33 is_stmt 0 view .LVU938
 2956 0020 D51C     		adds	r5, r2, #3
 953:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2957              		.loc 1 953 30 view .LVU939
 2958 0022 42F23808 		movw	r8, #8248
 948:USBDevice/Class/CDC/usbd_ncm.c **** 
 2959              		.loc 1 948 27 view .LVU940
 2960 0026 0126     		movs	r6, #1
ARM GAS  /tmp/ccWJL6at.s 			page 85


 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2961              		.loc 1 943 18 view .LVU941
 2962 0028 25F00305 		bic	r5, r5, #3
 953:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2963              		.loc 1 953 30 view .LVU942
 2964 002c 54F80800 		ldr	r0, [r4, r8]
 948:USBDevice/Class/CDC/usbd_ncm.c **** 
 2965              		.loc 1 948 27 view .LVU943
 2966 0030 E655     		strb	r6, [r4, r7]
 943:USBDevice/Class/CDC/usbd_ncm.c ****         uint16_t addlen = wlen + sizeof(USBD_NCM_Datagram16);
 2967              		.loc 1 943 18 view .LVU944
 2968 0032 ADB2     		uxth	r5, r5
 2969              	.LVL250:
 944:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t page;
 2970              		.loc 1 944 9 is_stmt 1 view .LVU945
 945:USBDevice/Class/CDC/usbd_ncm.c **** 
 2971              		.loc 1 945 9 view .LVU946
 948:USBDevice/Class/CDC/usbd_ncm.c **** 
 2972              		.loc 1 948 9 view .LVU947
 950:USBDevice/Class/CDC/usbd_ncm.c **** 
 2973              		.loc 1 950 9 view .LVU948
 953:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2974              		.loc 1 953 9 view .LVU949
 944:USBDevice/Class/CDC/usbd_ncm.c ****         uint8_t page;
 2975              		.loc 1 944 18 is_stmt 0 view .LVU950
 2976 0034 05F1040E 		add	lr, r5, #4
 953:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2977              		.loc 1 953 20 view .LVU951
 2978 0038 1FFA8EFE 		uxth	lr, lr
 953:USBDevice/Class/CDC/usbd_ncm.c ****         {
 2979              		.loc 1 953 12 view .LVU952
 2980 003c 8645     		cmp	lr, r0
 2981 003e 27D8     		bhi	.L197
 2982              	.LBB291:
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 2983              		.loc 1 955 13 is_stmt 1 view .LVU953
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2984              		.loc 1 960 48 is_stmt 0 view .LVU954
 2985 0040 42F23F0B 		movw	fp, #8255
 2986              	.LBE291:
 950:USBDevice/Class/CDC/usbd_ncm.c **** 
 2987              		.loc 1 950 14 view .LVU955
 2988 0044 42F23E09 		movw	r9, #8254
 2989              	.LBB292:
 966:USBDevice/Class/CDC/usbd_ncm.c ****         }
 2990              		.loc 1 966 29 view .LVU956
 2991 0048 A0EB0E00 		sub	r0, r0, lr
 962:USBDevice/Class/CDC/usbd_ncm.c **** 
 2992              		.loc 1 962 40 view .LVU957
 2993 004c 42F23C0A 		movw	r10, #8252
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2994              		.loc 1 960 39 view .LVU958
 2995 0050 14F80B60 		ldrb	r6, [r4, fp]	@ zero_extendqisi2
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 2996              		.loc 1 955 42 view .LVU959
 2997 0054 41F2340C 		movw	ip, #4148
 2998 0058 14F809E0 		ldrb	lr, [r4, r9]	@ zero_extendqisi2
ARM GAS  /tmp/ccWJL6at.s 			page 86


 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 2999              		.loc 1 960 39 view .LVU960
 3000 005c 0136     		adds	r6, r6, #1
 966:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3001              		.loc 1 966 29 view .LVU961
 3002 005e 0190     		str	r0, [sp, #4]
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 3003              		.loc 1 955 42 view .LVU962
 3004 0060 04EBCE2E 		add	lr, r4, lr, lsl #11
 962:USBDevice/Class/CDC/usbd_ncm.c **** 
 3005              		.loc 1 962 40 view .LVU963
 3006 0064 34F80A00 		ldrh	r0, [r4, r10]
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 3007              		.loc 1 960 39 view .LVU964
 3008 0068 F6B2     		uxtb	r6, r6
 966:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3009              		.loc 1 966 29 view .LVU965
 3010 006a 019B     		ldr	r3, [sp, #4]
 955:USBDevice/Class/CDC/usbd_ncm.c ****             struct {
 3011              		.loc 1 955 42 view .LVU966
 3012 006c F444     		add	ip, ip, lr
 3013              	.LVL251:
 956:USBDevice/Class/CDC/usbd_ncm.c ****                 uint16_t length;
 3014              		.loc 1 956 13 is_stmt 1 view .LVU967
 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 3015              		.loc 1 965 27 is_stmt 0 view .LVU968
 3016 006e 0544     		add	r5, r5, r0
 3017              	.LVL252:
 959:USBDevice/Class/CDC/usbd_ncm.c ****                     - (sizeof(*dp) * (++itf->In.DgCount));
 3018              		.loc 1 959 15 view .LVU969
 3019 0070 04F80B60 		strb	r6, [r4, fp]
 3020              	.LVL253:
 962:USBDevice/Class/CDC/usbd_ncm.c **** 
 3021              		.loc 1 962 13 is_stmt 1 view .LVU970
 964:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Index += wlen;
 3022              		.loc 1 964 13 view .LVU971
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 3023              		.loc 1 960 21 is_stmt 0 view .LVU972
 3024 0074 C6F50076 		rsb	r6, r6, #512
 3025              	.LVL254:
 960:USBDevice/Class/CDC/usbd_ncm.c **** 
 3026              		.loc 1 960 21 view .LVU973
 3027              	.LBE292:
 3028              	.LBE290:
 3029              	.LBE289:
 3030              	.LBE288:
 3031              	.LBE297:
 3032              	.LBE299:
1015:USBDevice/Class/CDC/usbd_ncm.c **** 
1016:USBDevice/Class/CDC/usbd_ncm.c ****     if (dst != NULL)
1017:USBDevice/Class/CDC/usbd_ncm.c ****     {
1018:USBDevice/Class/CDC/usbd_ncm.c ****         memcpy(dst, data, length);
 3033              		.loc 1 1018 9 view .LVU974
 3034 0078 6044     		add	r0, r0, ip
 3035              	.LVL255:
 3036              	.LBB300:
 3037              	.LBB298:
ARM GAS  /tmp/ccWJL6at.s 			page 87


 3038              	.LBB296:
 3039              	.LBB295:
 3040              	.LBB294:
 3041              	.LBB293:
 964:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.Index += wlen;
 3042              		.loc 1 964 24 view .LVU975
 3043 007a 2CF82620 		strh	r2, [ip, r6, lsl #2]	@ movhi
 3044              	.LVL256:
 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 3045              		.loc 1 965 13 is_stmt 1 view .LVU976
 966:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3046              		.loc 1 966 29 is_stmt 0 view .LVU977
 3047 007e 44F80830 		str	r3, [r4, r8]
 965:USBDevice/Class/CDC/usbd_ncm.c ****             itf->In.RemSize -= addlen;
 3048              		.loc 1 965 27 view .LVU978
 3049 0082 24F80A50 		strh	r5, [r4, r10]	@ movhi
 3050              	.LVL257:
 966:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3051              		.loc 1 966 13 is_stmt 1 view .LVU979
 966:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3052              		.loc 1 966 13 is_stmt 0 view .LVU980
 3053              	.LBE293:
 3054              	.LBE294:
 970:USBDevice/Class/CDC/usbd_ncm.c **** }
 3055              		.loc 1 970 5 is_stmt 1 view .LVU981
 970:USBDevice/Class/CDC/usbd_ncm.c **** }
 3056              		.loc 1 970 5 is_stmt 0 view .LVU982
 3057              	.LBE295:
 3058              	.LBE296:
 970:USBDevice/Class/CDC/usbd_ncm.c **** }
 3059              		.loc 1 970 5 is_stmt 1 view .LVU983
 970:USBDevice/Class/CDC/usbd_ncm.c **** }
 3060              		.loc 1 970 5 is_stmt 0 view .LVU984
 3061              	.LBE298:
 3062              	.LBE300:
1016:USBDevice/Class/CDC/usbd_ncm.c ****     {
 3063              		.loc 1 1016 5 is_stmt 1 view .LVU985
 3064              		.loc 1 1018 9 view .LVU986
 3065 0086 FFF7FEFF 		bl	memcpy
 3066              	.LVL258:
1019:USBDevice/Class/CDC/usbd_ncm.c **** 
1020:USBDevice/Class/CDC/usbd_ncm.c ****         retval = USBD_NCM_SetDatagram(itf);
 3067              		.loc 1 1020 9 view .LVU987
 3068              	.LBB301:
 3069              	.LBI301:
 979:USBDevice/Class/CDC/usbd_ncm.c **** {
 3070              		.loc 1 979 17 view .LVU988
 3071              	.LBB302:
 981:USBDevice/Class/CDC/usbd_ncm.c **** 
 3072              		.loc 1 981 5 view .LVU989
 983:USBDevice/Class/CDC/usbd_ncm.c ****     {
 3073              		.loc 1 983 5 view .LVU990
 983:USBDevice/Class/CDC/usbd_ncm.c ****     {
 3074              		.loc 1 983 16 is_stmt 0 view .LVU991
 3075 008a E35D     		ldrb	r3, [r4, r7]	@ zero_extendqisi2
 983:USBDevice/Class/CDC/usbd_ncm.c ****     {
 3076              		.loc 1 983 8 view .LVU992
ARM GAS  /tmp/ccWJL6at.s 			page 88


 3077 008c 012B     		cmp	r3, #1
 3078 008e 04D0     		beq	.L206
 3079              	.LVL259:
 3080              	.L197:
 983:USBDevice/Class/CDC/usbd_ncm.c ****     {
 3081              		.loc 1 983 8 view .LVU993
 3082              	.LBE302:
 3083              	.LBE301:
1013:USBDevice/Class/CDC/usbd_ncm.c ****     uint8_t* dst = USBD_NCM_AllocDatagram(itf, length);
 3084              		.loc 1 1013 21 view .LVU994
 3085 0090 0325     		movs	r5, #3
 3086              	.L196:
 3087              	.LVL260:
1021:USBDevice/Class/CDC/usbd_ncm.c ****     }
1022:USBDevice/Class/CDC/usbd_ncm.c **** 
1023:USBDevice/Class/CDC/usbd_ncm.c ****     return retval;
 3088              		.loc 1 1023 5 is_stmt 1 view .LVU995
1024:USBDevice/Class/CDC/usbd_ncm.c **** }
 3089              		.loc 1 1024 1 is_stmt 0 view .LVU996
 3090 0092 2846     		mov	r0, r5
 3091 0094 03B0     		add	sp, sp, #12
 3092              	.LCFI43:
 3093              		.cfi_remember_state
 3094              		.cfi_def_cfa_offset 36
 3095              		@ sp needed
 3096 0096 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3097              	.LVL261:
 3098              	.L206:
 3099              	.LCFI44:
 3100              		.cfi_restore_state
 3101              	.LBB307:
 3102              	.LBB306:
 3103              	.LBB303:
 3104              	.LBI303:
 979:USBDevice/Class/CDC/usbd_ncm.c **** {
 3105              		.loc 1 979 17 is_stmt 1 view .LVU997
 3106              	.LBB304:
 3107              	.LBB305:
 985:USBDevice/Class/CDC/usbd_ncm.c **** 
 3108              		.loc 1 985 9 view .LVU998
 988:USBDevice/Class/CDC/usbd_ncm.c ****         {
 3109              		.loc 1 988 9 view .LVU999
 988:USBDevice/Class/CDC/usbd_ncm.c ****         {
 3110              		.loc 1 988 20 is_stmt 0 view .LVU1000
 3111 009a 04F50153 		add	r3, r4, #8256
 3112 009e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 988:USBDevice/Class/CDC/usbd_ncm.c ****         {
 3113              		.loc 1 988 12 view .LVU1001
 3114 00a0 03F0FF05 		and	r5, r3, #255
 3115 00a4 1BB1     		cbz	r3, .L198
 990:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3116              		.loc 1 990 13 is_stmt 1 view .LVU1002
 990:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3117              		.loc 1 990 31 is_stmt 0 view .LVU1003
 3118 00a6 0323     		movs	r3, #3
 3119 00a8 0025     		movs	r5, #0
 3120 00aa E355     		strb	r3, [r4, r7]
ARM GAS  /tmp/ccWJL6at.s 			page 89


 3121              	.LVL262:
 990:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3122              		.loc 1 990 31 view .LVU1004
 3123 00ac F1E7     		b	.L196
 3124              	.LVL263:
 3125              	.L198:
 994:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3126              		.loc 1 994 13 is_stmt 1 view .LVU1005
 3127 00ae 14F80910 		ldrb	r1, [r4, r9]	@ zero_extendqisi2
 3128 00b2 2046     		mov	r0, r4
 3129 00b4 FFF7FEFF 		bl	ncm_sendNTB
 3130              	.LVL264:
 994:USBDevice/Class/CDC/usbd_ncm.c ****         }
 3131              		.loc 1 994 13 is_stmt 0 view .LVU1006
 3132 00b8 EBE7     		b	.L196
 3133              	.LBE305:
 3134              	.LBE304:
 3135              	.LBE303:
 3136              	.LBE306:
 3137              	.LBE307:
 3138              		.cfi_endproc
 3139              	.LFE164:
 3141 00ba 00BF     		.section	.rodata.ncm_cbks,"a"
 3142              		.align	2
 3143              		.set	.LANCHOR3,. + 0
 3146              	ncm_cbks:
 3147 0000 00000000 		.word	ncm_getDesc
 3148 0004 00000000 		.word	ncm_getString
 3149 0008 00000000 		.word	ncm_init
 3150 000c 00000000 		.word	ncm_deinit
 3151 0010 00000000 		.word	ncm_setupStage
 3152 0014 00000000 		.word	ncm_dataStage
 3153 0018 00000000 		.word	ncm_outData
 3154 001c 00000000 		.word	ncm_inData
 3155              		.section	.rodata.ncm_desc,"a"
 3156              		.align	2
 3157              		.set	.LANCHOR2,. + 0
 3160              	ncm_desc:
 3161 0000 08       		.byte	8
 3162 0001 0B       		.byte	11
 3163 0002 00       		.byte	0
 3164 0003 02       		.byte	2
 3165 0004 02       		.byte	2
 3166 0005 0D       		.byte	13
 3167 0006 00       		.byte	0
 3168 0007 01       		.byte	1
 3169 0008 09       		.byte	9
 3170 0009 04       		.byte	4
 3171 000a 00       		.byte	0
 3172 000b 00       		.byte	0
 3173 000c 01       		.byte	1
 3174 000d 02       		.byte	2
 3175 000e 0D       		.byte	13
 3176 000f 00       		.byte	0
 3177 0010 01       		.byte	1
 3178 0011 05       		.byte	5
 3179 0012 24       		.byte	36
ARM GAS  /tmp/ccWJL6at.s 			page 90


 3180 0013 00       		.byte	0
 3181 0014 1001     		.2byte	272
 3182 0016 05       		.byte	5
 3183 0017 24       		.byte	36
 3184 0018 06       		.byte	6
 3185 0019 00       		.byte	0
 3186 001a 01       		.byte	1
 3187 001b 0D       		.byte	13
 3188 001c 24       		.byte	36
 3189 001d 0F       		.byte	15
 3190 001e 11       		.byte	17
 3191 001f 00000000 		.4byte	0
 3192 0023 EA05     		.2byte	1514
 3193 0025 0000     		.2byte	0
 3194 0027 00       		.byte	0
 3195 0028 06       		.byte	6
 3196 0029 24       		.byte	36
 3197 002a 1A       		.byte	26
 3198 002b 0001     		.2byte	256
 3199 002d 00       		.byte	0
 3200 002e 07       		.byte	7
 3201 002f 05       		.byte	5
 3202 0030 82       		.byte	-126
 3203 0031 03       		.byte	3
 3204 0032 0800     		.short	8
 3205 0034 14       		.byte	20
 3206 0035 09       		.byte	9
 3207 0036 04       		.byte	4
 3208 0037 01       		.byte	1
 3209 0038 00       		.byte	0
 3210 0039 00       		.byte	0
 3211 003a 0A       		.byte	10
 3212 003b 00       		.byte	0
 3213 003c 01       		.byte	1
 3214 003d 00       		.byte	0
 3215 003e 09       		.byte	9
 3216 003f 04       		.byte	4
 3217 0040 01       		.byte	1
 3218 0041 01       		.byte	1
 3219 0042 02       		.byte	2
 3220 0043 0A       		.byte	10
 3221 0044 00       		.byte	0
 3222 0045 01       		.byte	1
 3223 0046 01       		.byte	1
 3224              		.section	.rodata.ndp16_sign,"a"
 3225              		.align	2
 3226              		.set	.LANCHOR0,. + 0
 3229              	ndp16_sign:
 3230 0000 4E       		.byte	78
 3231 0001 43       		.byte	67
 3232 0002 4D       		.byte	77
 3233 0003 30       		.byte	48
 3234              		.section	.rodata.nth16_sign,"a"
 3235              		.align	2
 3236              		.set	.LANCHOR1,. + 0
 3239              	nth16_sign:
 3240 0000 4E       		.byte	78
ARM GAS  /tmp/ccWJL6at.s 			page 91


 3241 0001 43       		.byte	67
 3242 0002 4D       		.byte	77
 3243 0003 48       		.byte	72
 3244              		.text
 3245              	.Letext0:
 3246              		.file 3 "/usr/arm-none-eabi/include/machine/_default_types.h"
 3247              		.file 4 "/usr/arm-none-eabi/include/sys/_stdint.h"
 3248              		.file 5 "USBDevice/Include/usb_types.h"
 3249              		.file 6 "STM32_XPD/STM32H7_XPD/inc/xpd_common.h"
 3250              		.file 7 "STM32_XPD/CMSIS/Include/core_cm7.h"
 3251              		.file 8 "STM32_XPD/CMSIS/Device/ST/STM32H7xx/Include/system_stm32h7xx.h"
 3252              		.file 9 "STM32_XPD/CMSIS/Device/ST/STM32H7xx/Include/stm32h743xx.h"
 3253              		.file 10 "USBDevice/PDs/STM32_XPD/usbd_pd_def.h"
 3254              		.file 11 "USBDevice/Include/usbd_types.h"
 3255              		.file 12 "/usr/arm-none-eabi/include/sys/lock.h"
 3256              		.file 13 "/usr/arm-none-eabi/include/sys/_types.h"
 3257              		.file 14 "/usr/lib/gcc/arm-none-eabi/9.2.0/include/stddef.h"
 3258              		.file 15 "/usr/arm-none-eabi/include/sys/reent.h"
 3259              		.file 16 "USBDevice/Include/usbd_cdc.h"
 3260              		.file 17 "USBDevice/Include/usbd_ncm.h"
 3261              		.file 18 "STM32_XPD/STM32H7_XPD/inc/xpd_usb_otg.h"
 3262              		.file 19 "USBDevice/Include/usbd_utils.h"
 3263              		.file 20 "<built-in>"
ARM GAS  /tmp/ccWJL6at.s 			page 92


DEFINED SYMBOLS
                            *ABS*:0000000000000000 usbd_ncm.c
     /tmp/ccWJL6at.s:18     .text.ncm_dataStage:0000000000000000 $t
     /tmp/ccWJL6at.s:26     .text.ncm_dataStage:0000000000000000 ncm_dataStage
     /tmp/ccWJL6at.s:74     .text.ncm_sendNTB:0000000000000000 $t
     /tmp/ccWJL6at.s:81     .text.ncm_sendNTB:0000000000000000 ncm_sendNTB
     /tmp/ccWJL6at.s:331    .text.ncm_sendNTB:0000000000000110 $d
     /tmp/ccWJL6at.s:337    .text.ncm_outData:0000000000000000 $t
     /tmp/ccWJL6at.s:344    .text.ncm_outData:0000000000000000 ncm_outData
     /tmp/ccWJL6at.s:584    .text.ncm_outData:00000000000000d4 $d
     /tmp/ccWJL6at.s:591    .text.ncm_setupStage:0000000000000000 $t
     /tmp/ccWJL6at.s:598    .text.ncm_setupStage:0000000000000000 ncm_setupStage
     /tmp/ccWJL6at.s:784    .text.ncm_setupStage:0000000000000098 $d
     /tmp/ccWJL6at.s:790    .text.ncm_getDesc:0000000000000000 $t
     /tmp/ccWJL6at.s:797    .text.ncm_getDesc:0000000000000000 ncm_getDesc
     /tmp/ccWJL6at.s:903    .text.ncm_getDesc:000000000000005c $d
     /tmp/ccWJL6at.s:908    .text.ncm_inData:0000000000000000 $t
     /tmp/ccWJL6at.s:915    .text.ncm_inData:0000000000000000 ncm_inData
     /tmp/ccWJL6at.s:1004   .text.ncm_deinit:0000000000000000 $t
     /tmp/ccWJL6at.s:1011   .text.ncm_deinit:0000000000000000 ncm_deinit
     /tmp/ccWJL6at.s:1281   .text.ncm_init:0000000000000000 $t
     /tmp/ccWJL6at.s:1288   .text.ncm_init:0000000000000000 ncm_init
     /tmp/ccWJL6at.s:1425   .text.ncm_getString:0000000000000000 $t
     /tmp/ccWJL6at.s:1432   .text.ncm_getString:0000000000000000 ncm_getString
     /tmp/ccWJL6at.s:1494   .text.USBD_NCM_MountInterface:0000000000000000 $t
     /tmp/ccWJL6at.s:1502   .text.USBD_NCM_MountInterface:0000000000000000 USBD_NCM_MountInterface
     /tmp/ccWJL6at.s:1805   .text.USBD_NCM_MountInterface:00000000000000d0 $d
     /tmp/ccWJL6at.s:1813   .text.USBD_NCM_Connect:0000000000000000 $t
     /tmp/ccWJL6at.s:1821   .text.USBD_NCM_Connect:0000000000000000 USBD_NCM_Connect
     /tmp/ccWJL6at.s:2124   .text.USBD_NCM_Disconnect:0000000000000000 $t
     /tmp/ccWJL6at.s:2132   .text.USBD_NCM_Disconnect:0000000000000000 USBD_NCM_Disconnect
     /tmp/ccWJL6at.s:2367   .text.USBD_NCM_GetDatagram:0000000000000000 $t
     /tmp/ccWJL6at.s:2375   .text.USBD_NCM_GetDatagram:0000000000000000 USBD_NCM_GetDatagram
     /tmp/ccWJL6at.s:2627   .text.USBD_NCM_AllocDatagram:0000000000000000 $t
     /tmp/ccWJL6at.s:2635   .text.USBD_NCM_AllocDatagram:0000000000000000 USBD_NCM_AllocDatagram
     /tmp/ccWJL6at.s:2791   .text.USBD_NCM_SetDatagram:0000000000000000 $t
     /tmp/ccWJL6at.s:2799   .text.USBD_NCM_SetDatagram:0000000000000000 USBD_NCM_SetDatagram
     /tmp/ccWJL6at.s:2886   .text.USBD_NCM_PutDatagram:0000000000000000 $t
     /tmp/ccWJL6at.s:2894   .text.USBD_NCM_PutDatagram:0000000000000000 USBD_NCM_PutDatagram
     /tmp/ccWJL6at.s:3142   .rodata.ncm_cbks:0000000000000000 $d
     /tmp/ccWJL6at.s:3146   .rodata.ncm_cbks:0000000000000000 ncm_cbks
     /tmp/ccWJL6at.s:3156   .rodata.ncm_desc:0000000000000000 $d
     /tmp/ccWJL6at.s:3160   .rodata.ncm_desc:0000000000000000 ncm_desc
     /tmp/ccWJL6at.s:3225   .rodata.ndp16_sign:0000000000000000 $d
     /tmp/ccWJL6at.s:3229   .rodata.ndp16_sign:0000000000000000 ndp16_sign
     /tmp/ccWJL6at.s:3235   .rodata.nth16_sign:0000000000000000 $d
     /tmp/ccWJL6at.s:3239   .rodata.nth16_sign:0000000000000000 nth16_sign

UNDEFINED SYMBOLS
USBD_EpSend
USBD_EpReceive
USBD_CtrlSendData
USBD_CtrlReceiveData
memcpy
USBD_EpDesc
USB_vEpClose
USB_vEpOpen
ARM GAS  /tmp/ccWJL6at.s 			page 93


Uint2Unicode
