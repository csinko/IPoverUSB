ARM GAS  /tmp/ccQlnpyR.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 2
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"httpd.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.http_accept,"ax",%progbits
  18              		.align	1
  19              		.p2align 2,,3
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	http_accept:
  27              	.LVL0:
  28              	.LFB124:
  29              		.file 1 "lwIP/src/apps/http/httpd.c"
   1:lwIP/src/apps/http/httpd.c **** /**
   2:lwIP/src/apps/http/httpd.c ****  * @file
   3:lwIP/src/apps/http/httpd.c ****  * LWIP HTTP server implementation
   4:lwIP/src/apps/http/httpd.c ****  */
   5:lwIP/src/apps/http/httpd.c **** 
   6:lwIP/src/apps/http/httpd.c **** /*
   7:lwIP/src/apps/http/httpd.c ****  * Copyright (c) 2001-2003 Swedish Institute of Computer Science.
   8:lwIP/src/apps/http/httpd.c ****  * All rights reserved.
   9:lwIP/src/apps/http/httpd.c ****  *
  10:lwIP/src/apps/http/httpd.c ****  * Redistribution and use in source and binary forms, with or without modification,
  11:lwIP/src/apps/http/httpd.c ****  * are permitted provided that the following conditions are met:
  12:lwIP/src/apps/http/httpd.c ****  *
  13:lwIP/src/apps/http/httpd.c ****  * 1. Redistributions of source code must retain the above copyright notice,
  14:lwIP/src/apps/http/httpd.c ****  *    this list of conditions and the following disclaimer.
  15:lwIP/src/apps/http/httpd.c ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  16:lwIP/src/apps/http/httpd.c ****  *    this list of conditions and the following disclaimer in the documentation
  17:lwIP/src/apps/http/httpd.c ****  *    and/or other materials provided with the distribution.
  18:lwIP/src/apps/http/httpd.c ****  * 3. The name of the author may not be used to endorse or promote products
  19:lwIP/src/apps/http/httpd.c ****  *    derived from this software without specific prior written permission.
  20:lwIP/src/apps/http/httpd.c ****  *
  21:lwIP/src/apps/http/httpd.c ****  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
  22:lwIP/src/apps/http/httpd.c ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  23:lwIP/src/apps/http/httpd.c ****  * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
  24:lwIP/src/apps/http/httpd.c ****  * SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  25:lwIP/src/apps/http/httpd.c ****  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
  26:lwIP/src/apps/http/httpd.c ****  * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  27:lwIP/src/apps/http/httpd.c ****  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  28:lwIP/src/apps/http/httpd.c ****  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
  29:lwIP/src/apps/http/httpd.c ****  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY
ARM GAS  /tmp/ccQlnpyR.s 			page 2


  30:lwIP/src/apps/http/httpd.c ****  * OF SUCH DAMAGE.
  31:lwIP/src/apps/http/httpd.c ****  *
  32:lwIP/src/apps/http/httpd.c ****  * This file is part of the lwIP TCP/IP stack.
  33:lwIP/src/apps/http/httpd.c ****  *
  34:lwIP/src/apps/http/httpd.c ****  * Author: Adam Dunkels <adam@sics.se>
  35:lwIP/src/apps/http/httpd.c ****  *         Simon Goldschmidt
  36:lwIP/src/apps/http/httpd.c ****  *
  37:lwIP/src/apps/http/httpd.c ****  */
  38:lwIP/src/apps/http/httpd.c **** 
  39:lwIP/src/apps/http/httpd.c **** /**
  40:lwIP/src/apps/http/httpd.c ****  * @defgroup httpd HTTP server
  41:lwIP/src/apps/http/httpd.c ****  * @ingroup apps
  42:lwIP/src/apps/http/httpd.c ****  *
  43:lwIP/src/apps/http/httpd.c ****  * This httpd supports for a
  44:lwIP/src/apps/http/httpd.c ****  * rudimentary server-side-include facility which will replace tags of the form
  45:lwIP/src/apps/http/httpd.c ****  * <!--#tag--> in any file whose extension is .shtml, .shtm or .ssi with
  46:lwIP/src/apps/http/httpd.c ****  * strings provided by an include handler whose pointer is provided to the
  47:lwIP/src/apps/http/httpd.c ****  * module via function http_set_ssi_handler().
  48:lwIP/src/apps/http/httpd.c ****  * Additionally, a simple common
  49:lwIP/src/apps/http/httpd.c ****  * gateway interface (CGI) handling mechanism has been added to allow clients
  50:lwIP/src/apps/http/httpd.c ****  * to hook functions to particular request URIs.
  51:lwIP/src/apps/http/httpd.c ****  *
  52:lwIP/src/apps/http/httpd.c ****  * To enable SSI support, define label LWIP_HTTPD_SSI in lwipopts.h.
  53:lwIP/src/apps/http/httpd.c ****  * To enable CGI support, define label LWIP_HTTPD_CGI in lwipopts.h.
  54:lwIP/src/apps/http/httpd.c ****  *
  55:lwIP/src/apps/http/httpd.c ****  * By default, the server assumes that HTTP headers are already present in
  56:lwIP/src/apps/http/httpd.c ****  * each file stored in the file system.  By defining LWIP_HTTPD_DYNAMIC_HEADERS in
  57:lwIP/src/apps/http/httpd.c ****  * lwipopts.h, this behavior can be changed such that the server inserts the
  58:lwIP/src/apps/http/httpd.c ****  * headers automatically based on the extension of the file being served.  If
  59:lwIP/src/apps/http/httpd.c ****  * this mode is used, be careful to ensure that the file system image used
  60:lwIP/src/apps/http/httpd.c ****  * does not already contain the header information.
  61:lwIP/src/apps/http/httpd.c ****  *
  62:lwIP/src/apps/http/httpd.c ****  * File system images without headers can be created using the makefsfile
  63:lwIP/src/apps/http/httpd.c ****  * tool with the -h command line option.
  64:lwIP/src/apps/http/httpd.c ****  *
  65:lwIP/src/apps/http/httpd.c ****  *
  66:lwIP/src/apps/http/httpd.c ****  * Notes about valid SSI tags
  67:lwIP/src/apps/http/httpd.c ****  * --------------------------
  68:lwIP/src/apps/http/httpd.c ****  *
  69:lwIP/src/apps/http/httpd.c ****  * The following assumptions are made about tags used in SSI markers:
  70:lwIP/src/apps/http/httpd.c ****  *
  71:lwIP/src/apps/http/httpd.c ****  * 1. No tag may contain '-' or whitespace characters within the tag name.
  72:lwIP/src/apps/http/httpd.c ****  * 2. Whitespace is allowed between the tag leadin "<!--#" and the start of
  73:lwIP/src/apps/http/httpd.c ****  *    the tag name and between the tag name and the leadout string "-->".
  74:lwIP/src/apps/http/httpd.c ****  * 3. The maximum tag name length is LWIP_HTTPD_MAX_TAG_NAME_LEN, currently 8 characters.
  75:lwIP/src/apps/http/httpd.c ****  *
  76:lwIP/src/apps/http/httpd.c ****  * Notes on CGI usage
  77:lwIP/src/apps/http/httpd.c ****  * ------------------
  78:lwIP/src/apps/http/httpd.c ****  *
  79:lwIP/src/apps/http/httpd.c ****  * The simple CGI support offered here works with GET method requests only
  80:lwIP/src/apps/http/httpd.c ****  * and can handle up to 16 parameters encoded into the URI. The handler
  81:lwIP/src/apps/http/httpd.c ****  * function may not write directly to the HTTP output but must return a
  82:lwIP/src/apps/http/httpd.c ****  * filename that the HTTP server will send to the browser as a response to
  83:lwIP/src/apps/http/httpd.c ****  * the incoming CGI request.
  84:lwIP/src/apps/http/httpd.c ****  *
  85:lwIP/src/apps/http/httpd.c ****  *
  86:lwIP/src/apps/http/httpd.c ****  *
ARM GAS  /tmp/ccQlnpyR.s 			page 3


  87:lwIP/src/apps/http/httpd.c ****  * The list of supported file types is quite short, so if makefsdata complains
  88:lwIP/src/apps/http/httpd.c ****  * about an unknown extension, make sure to add it (and its doctype) to
  89:lwIP/src/apps/http/httpd.c ****  * the 'g_psHTTPHeaders' list.
  90:lwIP/src/apps/http/httpd.c ****  */
  91:lwIP/src/apps/http/httpd.c **** #include "lwip/init.h"
  92:lwIP/src/apps/http/httpd.c **** #include "lwip/apps/httpd.h"
  93:lwIP/src/apps/http/httpd.c **** #include "lwip/debug.h"
  94:lwIP/src/apps/http/httpd.c **** #include "lwip/stats.h"
  95:lwIP/src/apps/http/httpd.c **** #include "lwip/apps/fs.h"
  96:lwIP/src/apps/http/httpd.c **** #include "httpd_structs.h"
  97:lwIP/src/apps/http/httpd.c **** #include "lwip/def.h"
  98:lwIP/src/apps/http/httpd.c **** 
  99:lwIP/src/apps/http/httpd.c **** #include "lwip/altcp.h"
 100:lwIP/src/apps/http/httpd.c **** #include "lwip/altcp_tcp.h"
 101:lwIP/src/apps/http/httpd.c **** #if HTTPD_ENABLE_HTTPS
 102:lwIP/src/apps/http/httpd.c **** #include "lwip/altcp_tls.h"
 103:lwIP/src/apps/http/httpd.c **** #endif
 104:lwIP/src/apps/http/httpd.c **** #ifdef LWIP_HOOK_FILENAME
 105:lwIP/src/apps/http/httpd.c **** #include LWIP_HOOK_FILENAME
 106:lwIP/src/apps/http/httpd.c **** #endif
 107:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 108:lwIP/src/apps/http/httpd.c **** #include "lwip/sys.h"
 109:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_TIMING */
 110:lwIP/src/apps/http/httpd.c **** 
 111:lwIP/src/apps/http/httpd.c **** #include <string.h> /* memset */
 112:lwIP/src/apps/http/httpd.c **** #include <stdlib.h> /* atoi */
 113:lwIP/src/apps/http/httpd.c **** #include <stdio.h>
 114:lwIP/src/apps/http/httpd.c **** 
 115:lwIP/src/apps/http/httpd.c **** #if LWIP_TCP && LWIP_CALLBACK_API
 116:lwIP/src/apps/http/httpd.c **** 
 117:lwIP/src/apps/http/httpd.c **** /** Minimum length for a valid HTTP/0.9 request: "GET /\r\n" -> 7 bytes */
 118:lwIP/src/apps/http/httpd.c **** #define MIN_REQ_LEN   7
 119:lwIP/src/apps/http/httpd.c **** 
 120:lwIP/src/apps/http/httpd.c **** #define CRLF "\r\n"
 121:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 122:lwIP/src/apps/http/httpd.c **** #define HTTP11_CONNECTIONKEEPALIVE  "Connection: keep-alive"
 123:lwIP/src/apps/http/httpd.c **** #define HTTP11_CONNECTIONKEEPALIVE2 "Connection: Keep-Alive"
 124:lwIP/src/apps/http/httpd.c **** #endif
 125:lwIP/src/apps/http/httpd.c **** 
 126:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ
 127:lwIP/src/apps/http/httpd.c **** #define HTTP_IS_DYNAMIC_FILE(hs) ((hs)->buf != NULL)
 128:lwIP/src/apps/http/httpd.c **** #else
 129:lwIP/src/apps/http/httpd.c **** #define HTTP_IS_DYNAMIC_FILE(hs) 0
 130:lwIP/src/apps/http/httpd.c **** #endif
 131:lwIP/src/apps/http/httpd.c **** 
 132:lwIP/src/apps/http/httpd.c **** /* This defines checks whether tcp_write has to copy data or not */
 133:lwIP/src/apps/http/httpd.c **** 
 134:lwIP/src/apps/http/httpd.c **** #ifndef HTTP_IS_DATA_VOLATILE
 135:lwIP/src/apps/http/httpd.c **** /** tcp_write does not have to copy data when sent from rom-file-system directly */
 136:lwIP/src/apps/http/httpd.c **** #define HTTP_IS_DATA_VOLATILE(hs)       (HTTP_IS_DYNAMIC_FILE(hs) ? TCP_WRITE_FLAG_COPY : 0)
 137:lwIP/src/apps/http/httpd.c **** #endif
 138:lwIP/src/apps/http/httpd.c **** /** Default: dynamic headers are sent from ROM (non-dynamic headers are handled like file data) */
 139:lwIP/src/apps/http/httpd.c **** #ifndef HTTP_IS_HDR_VOLATILE
 140:lwIP/src/apps/http/httpd.c **** #define HTTP_IS_HDR_VOLATILE(hs, ptr)   0
 141:lwIP/src/apps/http/httpd.c **** #endif
 142:lwIP/src/apps/http/httpd.c **** 
 143:lwIP/src/apps/http/httpd.c **** /* Return values for http_send_*() */
ARM GAS  /tmp/ccQlnpyR.s 			page 4


 144:lwIP/src/apps/http/httpd.c **** #define HTTP_DATA_TO_SEND_FREED    3
 145:lwIP/src/apps/http/httpd.c **** #define HTTP_DATA_TO_SEND_BREAK    2
 146:lwIP/src/apps/http/httpd.c **** #define HTTP_DATA_TO_SEND_CONTINUE 1
 147:lwIP/src/apps/http/httpd.c **** #define HTTP_NO_DATA_TO_SEND       0
 148:lwIP/src/apps/http/httpd.c **** 
 149:lwIP/src/apps/http/httpd.c **** typedef struct {
 150:lwIP/src/apps/http/httpd.c ****   const char *name;
 151:lwIP/src/apps/http/httpd.c ****   u8_t shtml;
 152:lwIP/src/apps/http/httpd.c **** } default_filename;
 153:lwIP/src/apps/http/httpd.c **** 
 154:lwIP/src/apps/http/httpd.c **** static const default_filename httpd_default_filenames[] = {
 155:lwIP/src/apps/http/httpd.c ****   {"/index.shtml", 1 },
 156:lwIP/src/apps/http/httpd.c ****   {"/index.ssi",   1 },
 157:lwIP/src/apps/http/httpd.c ****   {"/index.shtm",  1 },
 158:lwIP/src/apps/http/httpd.c ****   {"/index.html",  0 },
 159:lwIP/src/apps/http/httpd.c ****   {"/index.htm",   0 }
 160:lwIP/src/apps/http/httpd.c **** };
 161:lwIP/src/apps/http/httpd.c **** 
 162:lwIP/src/apps/http/httpd.c **** #define NUM_DEFAULT_FILENAMES LWIP_ARRAYSIZE(httpd_default_filenames)
 163:lwIP/src/apps/http/httpd.c **** 
 164:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
 165:lwIP/src/apps/http/httpd.c **** /** HTTP request is copied here from pbufs for simple parsing */
 166:lwIP/src/apps/http/httpd.c **** static char httpd_req_buf[LWIP_HTTPD_MAX_REQ_LENGTH + 1];
 167:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
 168:lwIP/src/apps/http/httpd.c **** 
 169:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 170:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MAX_RESPONSE_URI_LEN > LWIP_HTTPD_MAX_REQUEST_URI_LEN
 171:lwIP/src/apps/http/httpd.c **** #define LWIP_HTTPD_URI_BUF_LEN LWIP_HTTPD_POST_MAX_RESPONSE_URI_LEN
 172:lwIP/src/apps/http/httpd.c **** #endif
 173:lwIP/src/apps/http/httpd.c **** #endif
 174:lwIP/src/apps/http/httpd.c **** #ifndef LWIP_HTTPD_URI_BUF_LEN
 175:lwIP/src/apps/http/httpd.c **** #define LWIP_HTTPD_URI_BUF_LEN LWIP_HTTPD_MAX_REQUEST_URI_LEN
 176:lwIP/src/apps/http/httpd.c **** #endif
 177:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_URI_BUF_LEN
 178:lwIP/src/apps/http/httpd.c **** /* Filename for response file to send when POST is finished or
 179:lwIP/src/apps/http/httpd.c ****  * search for default files when a directory is requested. */
 180:lwIP/src/apps/http/httpd.c **** static char http_uri_buf[LWIP_HTTPD_URI_BUF_LEN + 1];
 181:lwIP/src/apps/http/httpd.c **** #endif
 182:lwIP/src/apps/http/httpd.c **** 
 183:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
 184:lwIP/src/apps/http/httpd.c **** /* The number of individual strings that comprise the headers sent before each
 185:lwIP/src/apps/http/httpd.c ****  * requested file.
 186:lwIP/src/apps/http/httpd.c ****  */
 187:lwIP/src/apps/http/httpd.c **** #define NUM_FILE_HDR_STRINGS 5
 188:lwIP/src/apps/http/httpd.c **** #define HDR_STRINGS_IDX_HTTP_STATUS           0 /* e.g. "HTTP/1.0 200 OK\r\n" */
 189:lwIP/src/apps/http/httpd.c **** #define HDR_STRINGS_IDX_SERVER_NAME           1 /* e.g. "Server: "HTTPD_SERVER_AGENT"\r\n" */
 190:lwIP/src/apps/http/httpd.c **** #define HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE 2 /* e.g. "Content-Length: xy\r\n" and/or "Connection
 191:lwIP/src/apps/http/httpd.c **** #define HDR_STRINGS_IDX_CONTENT_LEN_NR        3 /* the byte count, when content-length is used */
 192:lwIP/src/apps/http/httpd.c **** #define HDR_STRINGS_IDX_CONTENT_TYPE          4 /* the content type (or default answer content type
 193:lwIP/src/apps/http/httpd.c **** 
 194:lwIP/src/apps/http/httpd.c **** /* The dynamically generated Content-Length buffer needs space for CRLF + NULL */
 195:lwIP/src/apps/http/httpd.c **** #define LWIP_HTTPD_MAX_CONTENT_LEN_OFFSET 3
 196:lwIP/src/apps/http/httpd.c **** #ifndef LWIP_HTTPD_MAX_CONTENT_LEN_SIZE
 197:lwIP/src/apps/http/httpd.c **** /* The dynamically generated Content-Length buffer shall be able to work with
 198:lwIP/src/apps/http/httpd.c ****    ~953 MB (9 digits) */
 199:lwIP/src/apps/http/httpd.c **** #define LWIP_HTTPD_MAX_CONTENT_LEN_SIZE   (9 + LWIP_HTTPD_MAX_CONTENT_LEN_OFFSET)
 200:lwIP/src/apps/http/httpd.c **** #endif
ARM GAS  /tmp/ccQlnpyR.s 			page 5


 201:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_HEADERS */
 202:lwIP/src/apps/http/httpd.c **** 
 203:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 204:lwIP/src/apps/http/httpd.c **** 
 205:lwIP/src/apps/http/httpd.c **** #define HTTPD_LAST_TAG_PART 0xFFFF
 206:lwIP/src/apps/http/httpd.c **** 
 207:lwIP/src/apps/http/httpd.c **** enum tag_check_state {
 208:lwIP/src/apps/http/httpd.c ****   TAG_NONE,       /* Not processing an SSI tag */
 209:lwIP/src/apps/http/httpd.c ****   TAG_LEADIN,     /* Tag lead in "<!--#" being processed */
 210:lwIP/src/apps/http/httpd.c ****   TAG_FOUND,      /* Tag name being read, looking for lead-out start */
 211:lwIP/src/apps/http/httpd.c ****   TAG_LEADOUT,    /* Tag lead out "-->" being processed */
 212:lwIP/src/apps/http/httpd.c ****   TAG_SENDING     /* Sending tag replacement string */
 213:lwIP/src/apps/http/httpd.c **** };
 214:lwIP/src/apps/http/httpd.c **** 
 215:lwIP/src/apps/http/httpd.c **** struct http_ssi_state {
 216:lwIP/src/apps/http/httpd.c ****   const char *parsed;     /* Pointer to the first unparsed byte in buf. */
 217:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_INCLUDE_TAG
 218:lwIP/src/apps/http/httpd.c ****   const char *tag_started;/* Pointer to the first opening '<' of the tag. */
 219:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_INCLUDE_TAG */
 220:lwIP/src/apps/http/httpd.c ****   const char *tag_end;    /* Pointer to char after the closing '>' of the tag. */
 221:lwIP/src/apps/http/httpd.c ****   u32_t parse_left; /* Number of unparsed bytes in buf. */
 222:lwIP/src/apps/http/httpd.c ****   u16_t tag_index;   /* Counter used by tag parsing state machine */
 223:lwIP/src/apps/http/httpd.c ****   u16_t tag_insert_len; /* Length of insert in string tag_insert */
 224:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
 225:lwIP/src/apps/http/httpd.c ****   u16_t tag_part; /* Counter passed to and changed by tag insertion function to insert multiple tim
 226:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
 227:lwIP/src/apps/http/httpd.c ****   u8_t tag_type; /* index into http_ssi_tag_desc array */
 228:lwIP/src/apps/http/httpd.c ****   u8_t tag_name_len; /* Length of the tag name in string tag_name */
 229:lwIP/src/apps/http/httpd.c ****   char tag_name[LWIP_HTTPD_MAX_TAG_NAME_LEN + 1]; /* Last tag name extracted */
 230:lwIP/src/apps/http/httpd.c ****   char tag_insert[LWIP_HTTPD_MAX_TAG_INSERT_LEN + 1]; /* Insert string for tag_name */
 231:lwIP/src/apps/http/httpd.c ****   enum tag_check_state tag_state; /* State of the tag processor */
 232:lwIP/src/apps/http/httpd.c **** };
 233:lwIP/src/apps/http/httpd.c **** 
 234:lwIP/src/apps/http/httpd.c **** struct http_ssi_tag_description {
 235:lwIP/src/apps/http/httpd.c ****   const char *lead_in;
 236:lwIP/src/apps/http/httpd.c ****   const char *lead_out; 
 237:lwIP/src/apps/http/httpd.c **** };
 238:lwIP/src/apps/http/httpd.c **** 
 239:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 240:lwIP/src/apps/http/httpd.c **** 
 241:lwIP/src/apps/http/httpd.c **** struct http_state {
 242:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED
 243:lwIP/src/apps/http/httpd.c ****   struct http_state *next;
 244:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED */
 245:lwIP/src/apps/http/httpd.c ****   struct fs_file file_handle;
 246:lwIP/src/apps/http/httpd.c ****   struct fs_file *handle;
 247:lwIP/src/apps/http/httpd.c ****   const char *file;       /* Pointer to first unsent byte in buf. */
 248:lwIP/src/apps/http/httpd.c **** 
 249:lwIP/src/apps/http/httpd.c ****   struct altcp_pcb *pcb;
 250:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
 251:lwIP/src/apps/http/httpd.c ****   struct pbuf *req;
 252:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
 253:lwIP/src/apps/http/httpd.c **** 
 254:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ
 255:lwIP/src/apps/http/httpd.c ****   char *buf;        /* File read buffer. */
 256:lwIP/src/apps/http/httpd.c ****   int buf_len;      /* Size of file read buffer, buf. */
 257:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_FILE_READ */
ARM GAS  /tmp/ccQlnpyR.s 			page 6


 258:lwIP/src/apps/http/httpd.c ****   u32_t left;       /* Number of unsent bytes in buf. */
 259:lwIP/src/apps/http/httpd.c ****   u8_t retries;
 260:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 261:lwIP/src/apps/http/httpd.c ****   u8_t keepalive;
 262:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_11_KEEPALIVE */
 263:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 264:lwIP/src/apps/http/httpd.c ****   struct http_ssi_state *ssi;
 265:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 266:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI
 267:lwIP/src/apps/http/httpd.c ****   char *params[LWIP_HTTPD_MAX_CGI_PARAMETERS]; /* Params extracted from the request URI */
 268:lwIP/src/apps/http/httpd.c ****   char *param_vals[LWIP_HTTPD_MAX_CGI_PARAMETERS]; /* Values for each extracted param */
 269:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CGI */
 270:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
 271:lwIP/src/apps/http/httpd.c ****   const char *hdrs[NUM_FILE_HDR_STRINGS]; /* HTTP headers to be sent. */
 272:lwIP/src/apps/http/httpd.c ****   char hdr_content_len[LWIP_HTTPD_MAX_CONTENT_LEN_SIZE];
 273:lwIP/src/apps/http/httpd.c ****   u16_t hdr_pos;     /* The position of the first unsent header byte in the
 274:lwIP/src/apps/http/httpd.c ****                         current string */
 275:lwIP/src/apps/http/httpd.c ****   u16_t hdr_index;   /* The index of the hdr string currently being sent. */
 276:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_HEADERS */
 277:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 278:lwIP/src/apps/http/httpd.c ****   u32_t time_started;
 279:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_TIMING */
 280:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 281:lwIP/src/apps/http/httpd.c ****   u32_t post_content_len_left;
 282:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MANUAL_WND
 283:lwIP/src/apps/http/httpd.c ****   u32_t unrecved_bytes;
 284:lwIP/src/apps/http/httpd.c ****   u8_t no_auto_wnd;
 285:lwIP/src/apps/http/httpd.c ****   u8_t post_finished;
 286:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_POST_MANUAL_WND */
 287:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST*/
 288:lwIP/src/apps/http/httpd.c **** };
 289:lwIP/src/apps/http/httpd.c **** 
 290:lwIP/src/apps/http/httpd.c **** #if HTTPD_USE_MEM_POOL
 291:lwIP/src/apps/http/httpd.c **** LWIP_MEMPOOL_DECLARE(HTTPD_STATE,     MEMP_NUM_PARALLEL_HTTPD_CONNS,     sizeof(struct http_state),
 292:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 293:lwIP/src/apps/http/httpd.c **** LWIP_MEMPOOL_DECLARE(HTTPD_SSI_STATE, MEMP_NUM_PARALLEL_HTTPD_SSI_CONNS, sizeof(struct http_ssi_sta
 294:lwIP/src/apps/http/httpd.c **** #define HTTP_FREE_SSI_STATE(x)  LWIP_MEMPOOL_FREE(HTTPD_SSI_STATE, (x))
 295:lwIP/src/apps/http/httpd.c **** #define HTTP_ALLOC_SSI_STATE()  (struct http_ssi_state *)LWIP_MEMPOOL_ALLOC(HTTPD_SSI_STATE)
 296:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 297:lwIP/src/apps/http/httpd.c **** #define HTTP_ALLOC_HTTP_STATE() (struct http_state *)LWIP_MEMPOOL_ALLOC(HTTPD_STATE)
 298:lwIP/src/apps/http/httpd.c **** #define HTTP_FREE_HTTP_STATE(x) LWIP_MEMPOOL_FREE(HTTPD_STATE, (x))
 299:lwIP/src/apps/http/httpd.c **** #else /* HTTPD_USE_MEM_POOL */
 300:lwIP/src/apps/http/httpd.c **** #define HTTP_ALLOC_HTTP_STATE() (struct http_state *)mem_malloc(sizeof(struct http_state))
 301:lwIP/src/apps/http/httpd.c **** #define HTTP_FREE_HTTP_STATE(x) mem_free(x)
 302:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 303:lwIP/src/apps/http/httpd.c **** #define HTTP_ALLOC_SSI_STATE()  (struct http_ssi_state *)mem_malloc(sizeof(struct http_ssi_state))
 304:lwIP/src/apps/http/httpd.c **** #define HTTP_FREE_SSI_STATE(x)  mem_free(x)
 305:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 306:lwIP/src/apps/http/httpd.c **** #endif /* HTTPD_USE_MEM_POOL */
 307:lwIP/src/apps/http/httpd.c **** 
 308:lwIP/src/apps/http/httpd.c **** static err_t http_close_conn(struct altcp_pcb *pcb, struct http_state *hs);
 309:lwIP/src/apps/http/httpd.c **** static err_t http_close_or_abort_conn(struct altcp_pcb *pcb, struct http_state *hs, u8_t abort_conn
 310:lwIP/src/apps/http/httpd.c **** static err_t http_find_file(struct http_state *hs, const char *uri, int is_09);
 311:lwIP/src/apps/http/httpd.c **** static err_t http_init_file(struct http_state *hs, struct fs_file *file, int is_09, const char *uri
 312:lwIP/src/apps/http/httpd.c **** static err_t http_poll(void *arg, struct altcp_pcb *pcb);
 313:lwIP/src/apps/http/httpd.c **** static u8_t http_check_eof(struct altcp_pcb *pcb, struct http_state *hs);
 314:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_FS_ASYNC_READ
ARM GAS  /tmp/ccQlnpyR.s 			page 7


 315:lwIP/src/apps/http/httpd.c **** static void http_continue(void *connection);
 316:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_FS_ASYNC_READ */
 317:lwIP/src/apps/http/httpd.c **** 
 318:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 319:lwIP/src/apps/http/httpd.c **** /* SSI insert handler function pointer. */
 320:lwIP/src/apps/http/httpd.c **** static tSSIHandler httpd_ssi_handler;
 321:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_RAW
 322:lwIP/src/apps/http/httpd.c **** static int httpd_num_tags;
 323:lwIP/src/apps/http/httpd.c **** static const char **httpd_tags;
 324:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_RAW */
 325:lwIP/src/apps/http/httpd.c **** 
 326:lwIP/src/apps/http/httpd.c **** /* Define the available tag lead-ins and corresponding lead-outs.
 327:lwIP/src/apps/http/httpd.c ****  * ATTENTION: for the algorithm below using this array, it is essential
 328:lwIP/src/apps/http/httpd.c ****  * that the lead in differs in the first character! */
 329:lwIP/src/apps/http/httpd.c **** const struct http_ssi_tag_description http_ssi_tag_desc[] = {
 330:lwIP/src/apps/http/httpd.c ****   {"<!--#", "-->"},
 331:lwIP/src/apps/http/httpd.c ****   {"/*#", "*/"}
 332:lwIP/src/apps/http/httpd.c **** };
 333:lwIP/src/apps/http/httpd.c **** 
 334:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 335:lwIP/src/apps/http/httpd.c **** 
 336:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI
 337:lwIP/src/apps/http/httpd.c **** /* CGI handler information */
 338:lwIP/src/apps/http/httpd.c **** static const tCGI *httpd_cgis;
 339:lwIP/src/apps/http/httpd.c **** static int httpd_num_cgis;
 340:lwIP/src/apps/http/httpd.c **** static int http_cgi_paramcount;
 341:lwIP/src/apps/http/httpd.c **** #define http_cgi_params     hs->params
 342:lwIP/src/apps/http/httpd.c **** #define http_cgi_param_vals hs->param_vals
 343:lwIP/src/apps/http/httpd.c **** #elif LWIP_HTTPD_CGI_SSI
 344:lwIP/src/apps/http/httpd.c **** static char *http_cgi_params[LWIP_HTTPD_MAX_CGI_PARAMETERS]; /* Params extracted from the request U
 345:lwIP/src/apps/http/httpd.c **** static char *http_cgi_param_vals[LWIP_HTTPD_MAX_CGI_PARAMETERS]; /* Values for each extracted param
 346:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CGI */
 347:lwIP/src/apps/http/httpd.c **** 
 348:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED
 349:lwIP/src/apps/http/httpd.c **** /** global list of active HTTP connections, use to kill the oldest when
 350:lwIP/src/apps/http/httpd.c ****     running out of memory */
 351:lwIP/src/apps/http/httpd.c **** static struct http_state *http_connections;
 352:lwIP/src/apps/http/httpd.c **** 
 353:lwIP/src/apps/http/httpd.c **** static void
 354:lwIP/src/apps/http/httpd.c **** http_add_connection(struct http_state *hs)
 355:lwIP/src/apps/http/httpd.c **** {
 356:lwIP/src/apps/http/httpd.c ****   /* add the connection to the list */
 357:lwIP/src/apps/http/httpd.c ****   hs->next = http_connections;
 358:lwIP/src/apps/http/httpd.c ****   http_connections = hs;
 359:lwIP/src/apps/http/httpd.c **** }
 360:lwIP/src/apps/http/httpd.c **** 
 361:lwIP/src/apps/http/httpd.c **** static void
 362:lwIP/src/apps/http/httpd.c **** http_remove_connection(struct http_state *hs)
 363:lwIP/src/apps/http/httpd.c **** {
 364:lwIP/src/apps/http/httpd.c ****   /* take the connection off the list */
 365:lwIP/src/apps/http/httpd.c ****   if (http_connections) {
 366:lwIP/src/apps/http/httpd.c ****     if (http_connections == hs) {
 367:lwIP/src/apps/http/httpd.c ****       http_connections = hs->next;
 368:lwIP/src/apps/http/httpd.c ****     } else {
 369:lwIP/src/apps/http/httpd.c ****       struct http_state *last;
 370:lwIP/src/apps/http/httpd.c ****       for (last = http_connections; last->next != NULL; last = last->next) {
 371:lwIP/src/apps/http/httpd.c ****         if (last->next == hs) {
ARM GAS  /tmp/ccQlnpyR.s 			page 8


 372:lwIP/src/apps/http/httpd.c ****           last->next = hs->next;
 373:lwIP/src/apps/http/httpd.c ****           break;
 374:lwIP/src/apps/http/httpd.c ****         }
 375:lwIP/src/apps/http/httpd.c ****       }
 376:lwIP/src/apps/http/httpd.c ****     }
 377:lwIP/src/apps/http/httpd.c ****   }
 378:lwIP/src/apps/http/httpd.c **** }
 379:lwIP/src/apps/http/httpd.c **** 
 380:lwIP/src/apps/http/httpd.c **** static void
 381:lwIP/src/apps/http/httpd.c **** http_kill_oldest_connection(u8_t ssi_required)
 382:lwIP/src/apps/http/httpd.c **** {
 383:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = http_connections;
 384:lwIP/src/apps/http/httpd.c ****   struct http_state *hs_free_next = NULL;
 385:lwIP/src/apps/http/httpd.c ****   while (hs && hs->next) {
 386:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 387:lwIP/src/apps/http/httpd.c ****     if (ssi_required) {
 388:lwIP/src/apps/http/httpd.c ****       if (hs->next->ssi != NULL) {
 389:lwIP/src/apps/http/httpd.c ****         hs_free_next = hs;
 390:lwIP/src/apps/http/httpd.c ****       }
 391:lwIP/src/apps/http/httpd.c ****     } else
 392:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SSI */
 393:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(ssi_required);
 394:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 395:lwIP/src/apps/http/httpd.c ****     {
 396:lwIP/src/apps/http/httpd.c ****       hs_free_next = hs;
 397:lwIP/src/apps/http/httpd.c ****     }
 398:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("broken list", hs != hs->next);
 399:lwIP/src/apps/http/httpd.c ****     hs = hs->next;
 400:lwIP/src/apps/http/httpd.c ****   }
 401:lwIP/src/apps/http/httpd.c ****   if (hs_free_next != NULL) {
 402:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("hs_free_next->next != NULL", hs_free_next->next != NULL);
 403:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("hs_free_next->next->pcb != NULL", hs_free_next->next->pcb != NULL);
 404:lwIP/src/apps/http/httpd.c ****     /* send RST when killing a connection because of memory shortage */
 405:lwIP/src/apps/http/httpd.c ****     http_close_or_abort_conn(hs_free_next->next->pcb, hs_free_next->next, 1); /* this also unlinks 
 406:lwIP/src/apps/http/httpd.c ****   }
 407:lwIP/src/apps/http/httpd.c **** }
 408:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED */
 409:lwIP/src/apps/http/httpd.c **** 
 410:lwIP/src/apps/http/httpd.c **** #define http_add_connection(hs)
 411:lwIP/src/apps/http/httpd.c **** #define http_remove_connection(hs)
 412:lwIP/src/apps/http/httpd.c **** 
 413:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED */
 414:lwIP/src/apps/http/httpd.c **** 
 415:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 416:lwIP/src/apps/http/httpd.c **** /** Allocate as struct http_ssi_state. */
 417:lwIP/src/apps/http/httpd.c **** static struct http_ssi_state *
 418:lwIP/src/apps/http/httpd.c **** http_ssi_state_alloc(void)
 419:lwIP/src/apps/http/httpd.c **** {
 420:lwIP/src/apps/http/httpd.c ****   struct http_ssi_state *ret = HTTP_ALLOC_SSI_STATE();
 421:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED
 422:lwIP/src/apps/http/httpd.c ****   if (ret == NULL) {
 423:lwIP/src/apps/http/httpd.c ****     http_kill_oldest_connection(1);
 424:lwIP/src/apps/http/httpd.c ****     ret = HTTP_ALLOC_SSI_STATE();
 425:lwIP/src/apps/http/httpd.c ****   }
 426:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED */
 427:lwIP/src/apps/http/httpd.c ****   if (ret != NULL) {
 428:lwIP/src/apps/http/httpd.c ****     memset(ret, 0, sizeof(struct http_ssi_state));
ARM GAS  /tmp/ccQlnpyR.s 			page 9


 429:lwIP/src/apps/http/httpd.c ****   }
 430:lwIP/src/apps/http/httpd.c ****   return ret;
 431:lwIP/src/apps/http/httpd.c **** }
 432:lwIP/src/apps/http/httpd.c **** 
 433:lwIP/src/apps/http/httpd.c **** /** Free a struct http_ssi_state. */
 434:lwIP/src/apps/http/httpd.c **** static void
 435:lwIP/src/apps/http/httpd.c **** http_ssi_state_free(struct http_ssi_state *ssi)
 436:lwIP/src/apps/http/httpd.c **** {
 437:lwIP/src/apps/http/httpd.c ****   if (ssi != NULL) {
 438:lwIP/src/apps/http/httpd.c ****     HTTP_FREE_SSI_STATE(ssi);
 439:lwIP/src/apps/http/httpd.c ****   }
 440:lwIP/src/apps/http/httpd.c **** }
 441:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 442:lwIP/src/apps/http/httpd.c **** 
 443:lwIP/src/apps/http/httpd.c **** /** Initialize a struct http_state.
 444:lwIP/src/apps/http/httpd.c ****  */
 445:lwIP/src/apps/http/httpd.c **** static void
 446:lwIP/src/apps/http/httpd.c **** http_state_init(struct http_state *hs)
 447:lwIP/src/apps/http/httpd.c **** {
 448:lwIP/src/apps/http/httpd.c ****   /* Initialize the structure. */
 449:lwIP/src/apps/http/httpd.c ****   memset(hs, 0, sizeof(struct http_state));
 450:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
 451:lwIP/src/apps/http/httpd.c ****   /* Indicate that the headers are not yet valid */
 452:lwIP/src/apps/http/httpd.c ****   hs->hdr_index = NUM_FILE_HDR_STRINGS;
 453:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_HEADERS */
 454:lwIP/src/apps/http/httpd.c **** }
 455:lwIP/src/apps/http/httpd.c **** 
 456:lwIP/src/apps/http/httpd.c **** /** Allocate a struct http_state. */
 457:lwIP/src/apps/http/httpd.c **** static struct http_state *
 458:lwIP/src/apps/http/httpd.c **** http_state_alloc(void)
 459:lwIP/src/apps/http/httpd.c **** {
 460:lwIP/src/apps/http/httpd.c ****   struct http_state *ret = HTTP_ALLOC_HTTP_STATE();
 461:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED
 462:lwIP/src/apps/http/httpd.c ****   if (ret == NULL) {
 463:lwIP/src/apps/http/httpd.c ****     http_kill_oldest_connection(0);
 464:lwIP/src/apps/http/httpd.c ****     ret = HTTP_ALLOC_HTTP_STATE();
 465:lwIP/src/apps/http/httpd.c ****   }
 466:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED */
 467:lwIP/src/apps/http/httpd.c ****   if (ret != NULL) {
 468:lwIP/src/apps/http/httpd.c ****     http_state_init(ret);
 469:lwIP/src/apps/http/httpd.c ****     http_add_connection(ret);
 470:lwIP/src/apps/http/httpd.c ****   }
 471:lwIP/src/apps/http/httpd.c ****   return ret;
 472:lwIP/src/apps/http/httpd.c **** }
 473:lwIP/src/apps/http/httpd.c **** 
 474:lwIP/src/apps/http/httpd.c **** /** Free a struct http_state.
 475:lwIP/src/apps/http/httpd.c ****  * Also frees the file data if dynamic.
 476:lwIP/src/apps/http/httpd.c ****  */
 477:lwIP/src/apps/http/httpd.c **** static void
 478:lwIP/src/apps/http/httpd.c **** http_state_eof(struct http_state *hs)
 479:lwIP/src/apps/http/httpd.c **** {
 480:lwIP/src/apps/http/httpd.c ****   if (hs->handle) {
 481:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 482:lwIP/src/apps/http/httpd.c ****     u32_t ms_needed = sys_now() - hs->time_started;
 483:lwIP/src/apps/http/httpd.c ****     u32_t needed = LWIP_MAX(1, (ms_needed / 100));
 484:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG_TIMING, ("httpd: needed %"U32_F" ms to send file of %d bytes -> %"U32_F
 485:lwIP/src/apps/http/httpd.c ****                                      ms_needed, hs->handle->len, ((((u32_t)hs->handle->len) * 10) /
ARM GAS  /tmp/ccQlnpyR.s 			page 10


 486:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_TIMING */
 487:lwIP/src/apps/http/httpd.c ****     fs_close(hs->handle);
 488:lwIP/src/apps/http/httpd.c ****     hs->handle = NULL;
 489:lwIP/src/apps/http/httpd.c ****   }
 490:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ
 491:lwIP/src/apps/http/httpd.c ****   if (hs->buf != NULL) {
 492:lwIP/src/apps/http/httpd.c ****     mem_free(hs->buf);
 493:lwIP/src/apps/http/httpd.c ****     hs->buf = NULL;
 494:lwIP/src/apps/http/httpd.c ****   }
 495:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_FILE_READ */
 496:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 497:lwIP/src/apps/http/httpd.c ****   if (hs->ssi) {
 498:lwIP/src/apps/http/httpd.c ****     http_ssi_state_free(hs->ssi);
 499:lwIP/src/apps/http/httpd.c ****     hs->ssi = NULL;
 500:lwIP/src/apps/http/httpd.c ****   }
 501:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 502:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
 503:lwIP/src/apps/http/httpd.c ****   if (hs->req) {
 504:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
 505:lwIP/src/apps/http/httpd.c ****     hs->req = NULL;
 506:lwIP/src/apps/http/httpd.c ****   }
 507:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
 508:lwIP/src/apps/http/httpd.c **** }
 509:lwIP/src/apps/http/httpd.c **** 
 510:lwIP/src/apps/http/httpd.c **** /** Free a struct http_state.
 511:lwIP/src/apps/http/httpd.c ****  * Also frees the file data if dynamic.
 512:lwIP/src/apps/http/httpd.c ****  */
 513:lwIP/src/apps/http/httpd.c **** static void
 514:lwIP/src/apps/http/httpd.c **** http_state_free(struct http_state *hs)
 515:lwIP/src/apps/http/httpd.c **** {
 516:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
 517:lwIP/src/apps/http/httpd.c ****     http_state_eof(hs);
 518:lwIP/src/apps/http/httpd.c ****     http_remove_connection(hs);
 519:lwIP/src/apps/http/httpd.c ****     HTTP_FREE_HTTP_STATE(hs);
 520:lwIP/src/apps/http/httpd.c ****   }
 521:lwIP/src/apps/http/httpd.c **** }
 522:lwIP/src/apps/http/httpd.c **** 
 523:lwIP/src/apps/http/httpd.c **** /** Call tcp_write() in a loop trying smaller and smaller length
 524:lwIP/src/apps/http/httpd.c ****  *
 525:lwIP/src/apps/http/httpd.c ****  * @param pcb altcp_pcb to send
 526:lwIP/src/apps/http/httpd.c ****  * @param ptr Data to send
 527:lwIP/src/apps/http/httpd.c ****  * @param length Length of data to send (in/out: on return, contains the
 528:lwIP/src/apps/http/httpd.c ****  *        amount of data sent)
 529:lwIP/src/apps/http/httpd.c ****  * @param apiflags directly passed to tcp_write
 530:lwIP/src/apps/http/httpd.c ****  * @return the return value of tcp_write
 531:lwIP/src/apps/http/httpd.c ****  */
 532:lwIP/src/apps/http/httpd.c **** static err_t
 533:lwIP/src/apps/http/httpd.c **** http_write(struct altcp_pcb *pcb, const void *ptr, u16_t *length, u8_t apiflags)
 534:lwIP/src/apps/http/httpd.c **** {
 535:lwIP/src/apps/http/httpd.c ****   u16_t len, max_len;
 536:lwIP/src/apps/http/httpd.c ****   err_t err;
 537:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("length != NULL", length != NULL);
 538:lwIP/src/apps/http/httpd.c ****   len = *length;
 539:lwIP/src/apps/http/httpd.c ****   if (len == 0) {
 540:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
 541:lwIP/src/apps/http/httpd.c ****   }
 542:lwIP/src/apps/http/httpd.c ****   /* We cannot send more data than space available in the send buffer. */
ARM GAS  /tmp/ccQlnpyR.s 			page 11


 543:lwIP/src/apps/http/httpd.c ****   max_len = altcp_sndbuf(pcb);
 544:lwIP/src/apps/http/httpd.c ****   if (max_len < len) {
 545:lwIP/src/apps/http/httpd.c ****     len = max_len;
 546:lwIP/src/apps/http/httpd.c ****   }
 547:lwIP/src/apps/http/httpd.c **** #ifdef HTTPD_MAX_WRITE_LEN
 548:lwIP/src/apps/http/httpd.c ****   /* Additional limitation: e.g. don't enqueue more than 2*mss at once */
 549:lwIP/src/apps/http/httpd.c ****   max_len = HTTPD_MAX_WRITE_LEN(pcb);
 550:lwIP/src/apps/http/httpd.c ****   if (len > max_len) {
 551:lwIP/src/apps/http/httpd.c ****     len = max_len;
 552:lwIP/src/apps/http/httpd.c ****   }
 553:lwIP/src/apps/http/httpd.c **** #endif /* HTTPD_MAX_WRITE_LEN */
 554:lwIP/src/apps/http/httpd.c ****   do {
 555:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Trying to send %d bytes\n", len));
 556:lwIP/src/apps/http/httpd.c ****     err = altcp_write(pcb, ptr, len, apiflags);
 557:lwIP/src/apps/http/httpd.c ****     if (err == ERR_MEM) {
 558:lwIP/src/apps/http/httpd.c ****       if ((altcp_sndbuf(pcb) == 0) ||
 559:lwIP/src/apps/http/httpd.c ****           (altcp_sndqueuelen(pcb) >= TCP_SND_QUEUELEN)) {
 560:lwIP/src/apps/http/httpd.c ****         /* no need to try smaller sizes */
 561:lwIP/src/apps/http/httpd.c ****         len = 1;
 562:lwIP/src/apps/http/httpd.c ****       } else {
 563:lwIP/src/apps/http/httpd.c ****         len /= 2;
 564:lwIP/src/apps/http/httpd.c ****       }
 565:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE,
 566:lwIP/src/apps/http/httpd.c ****                   ("Send failed, trying less (%d bytes)\n", len));
 567:lwIP/src/apps/http/httpd.c ****     }
 568:lwIP/src/apps/http/httpd.c ****   } while ((err == ERR_MEM) && (len > 1));
 569:lwIP/src/apps/http/httpd.c **** 
 570:lwIP/src/apps/http/httpd.c ****   if (err == ERR_OK) {
 571:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Sent %d bytes\n", len));
 572:lwIP/src/apps/http/httpd.c ****     *length = len;
 573:lwIP/src/apps/http/httpd.c ****   } else {
 574:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Send failed with err %d (\"%s\")\n", err, lwip_stre
 575:lwIP/src/apps/http/httpd.c ****     *length = 0;
 576:lwIP/src/apps/http/httpd.c ****   }
 577:lwIP/src/apps/http/httpd.c **** 
 578:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 579:lwIP/src/apps/http/httpd.c ****   /* ensure nagle is normally enabled (only disabled for persistent connections
 580:lwIP/src/apps/http/httpd.c ****      when all data has been enqueued but the connection stays open for the next
 581:lwIP/src/apps/http/httpd.c ****      request */
 582:lwIP/src/apps/http/httpd.c ****   altcp_nagle_enable(pcb);
 583:lwIP/src/apps/http/httpd.c **** #endif
 584:lwIP/src/apps/http/httpd.c **** 
 585:lwIP/src/apps/http/httpd.c ****   return err;
 586:lwIP/src/apps/http/httpd.c **** }
 587:lwIP/src/apps/http/httpd.c **** 
 588:lwIP/src/apps/http/httpd.c **** /**
 589:lwIP/src/apps/http/httpd.c ****  * The connection shall be actively closed (using RST to close from fault states).
 590:lwIP/src/apps/http/httpd.c ****  * Reset the sent- and recv-callbacks.
 591:lwIP/src/apps/http/httpd.c ****  *
 592:lwIP/src/apps/http/httpd.c ****  * @param pcb the tcp pcb to reset callbacks
 593:lwIP/src/apps/http/httpd.c ****  * @param hs connection state to free
 594:lwIP/src/apps/http/httpd.c ****  */
 595:lwIP/src/apps/http/httpd.c **** static err_t
 596:lwIP/src/apps/http/httpd.c **** http_close_or_abort_conn(struct altcp_pcb *pcb, struct http_state *hs, u8_t abort_conn)
 597:lwIP/src/apps/http/httpd.c **** {
 598:lwIP/src/apps/http/httpd.c ****   err_t err;
 599:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("Closing connection %p\n", (void *)pcb));
ARM GAS  /tmp/ccQlnpyR.s 			page 12


 600:lwIP/src/apps/http/httpd.c **** 
 601:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 602:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
 603:lwIP/src/apps/http/httpd.c ****     if ((hs->post_content_len_left != 0)
 604:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MANUAL_WND
 605:lwIP/src/apps/http/httpd.c ****         || ((hs->no_auto_wnd != 0) && (hs->unrecved_bytes != 0))
 606:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_POST_MANUAL_WND */
 607:lwIP/src/apps/http/httpd.c ****        ) {
 608:lwIP/src/apps/http/httpd.c ****       /* make sure the post code knows that the connection is closed */
 609:lwIP/src/apps/http/httpd.c ****       http_uri_buf[0] = 0;
 610:lwIP/src/apps/http/httpd.c ****       httpd_post_finished(hs, http_uri_buf, LWIP_HTTPD_URI_BUF_LEN);
 611:lwIP/src/apps/http/httpd.c ****     }
 612:lwIP/src/apps/http/httpd.c ****   }
 613:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST*/
 614:lwIP/src/apps/http/httpd.c **** 
 615:lwIP/src/apps/http/httpd.c **** 
 616:lwIP/src/apps/http/httpd.c ****   altcp_arg(pcb, NULL);
 617:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 618:lwIP/src/apps/http/httpd.c ****   altcp_err(pcb, NULL);
 619:lwIP/src/apps/http/httpd.c ****   altcp_poll(pcb, NULL, 0);
 620:lwIP/src/apps/http/httpd.c ****   altcp_sent(pcb, NULL);
 621:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
 622:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
 623:lwIP/src/apps/http/httpd.c ****   }
 624:lwIP/src/apps/http/httpd.c **** 
 625:lwIP/src/apps/http/httpd.c ****   if (abort_conn) {
 626:lwIP/src/apps/http/httpd.c ****     altcp_abort(pcb);
 627:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
 628:lwIP/src/apps/http/httpd.c ****   }
 629:lwIP/src/apps/http/httpd.c ****   err = altcp_close(pcb);
 630:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 631:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error %d closing %p\n", err, (void *)pcb));
 632:lwIP/src/apps/http/httpd.c ****     /* error closing, try again later in poll */
 633:lwIP/src/apps/http/httpd.c ****     altcp_poll(pcb, http_poll, HTTPD_POLL_INTERVAL);
 634:lwIP/src/apps/http/httpd.c ****   }
 635:lwIP/src/apps/http/httpd.c ****   return err;
 636:lwIP/src/apps/http/httpd.c **** }
 637:lwIP/src/apps/http/httpd.c **** 
 638:lwIP/src/apps/http/httpd.c **** /**
 639:lwIP/src/apps/http/httpd.c ****  * The connection shall be actively closed.
 640:lwIP/src/apps/http/httpd.c ****  * Reset the sent- and recv-callbacks.
 641:lwIP/src/apps/http/httpd.c ****  *
 642:lwIP/src/apps/http/httpd.c ****  * @param pcb the tcp pcb to reset callbacks
 643:lwIP/src/apps/http/httpd.c ****  * @param hs connection state to free
 644:lwIP/src/apps/http/httpd.c ****  */
 645:lwIP/src/apps/http/httpd.c **** static err_t
 646:lwIP/src/apps/http/httpd.c **** http_close_conn(struct altcp_pcb *pcb, struct http_state *hs)
 647:lwIP/src/apps/http/httpd.c **** {
 648:lwIP/src/apps/http/httpd.c ****   return http_close_or_abort_conn(pcb, hs, 0);
 649:lwIP/src/apps/http/httpd.c **** }
 650:lwIP/src/apps/http/httpd.c **** 
 651:lwIP/src/apps/http/httpd.c **** /** End of file: either close the connection (Connection: close) or
 652:lwIP/src/apps/http/httpd.c ****  * close the file (Connection: keep-alive)
 653:lwIP/src/apps/http/httpd.c ****  */
 654:lwIP/src/apps/http/httpd.c **** static void
 655:lwIP/src/apps/http/httpd.c **** http_eof(struct altcp_pcb *pcb, struct http_state *hs)
 656:lwIP/src/apps/http/httpd.c **** {
ARM GAS  /tmp/ccQlnpyR.s 			page 13


 657:lwIP/src/apps/http/httpd.c ****   /* HTTP/1.1 persistent connection? (Not supported for SSI) */
 658:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 659:lwIP/src/apps/http/httpd.c ****   if (hs->keepalive) {
 660:lwIP/src/apps/http/httpd.c ****     http_remove_connection(hs);
 661:lwIP/src/apps/http/httpd.c **** 
 662:lwIP/src/apps/http/httpd.c ****     http_state_eof(hs);
 663:lwIP/src/apps/http/httpd.c ****     http_state_init(hs);
 664:lwIP/src/apps/http/httpd.c ****     /* restore state: */
 665:lwIP/src/apps/http/httpd.c ****     hs->pcb = pcb;
 666:lwIP/src/apps/http/httpd.c ****     hs->keepalive = 1;
 667:lwIP/src/apps/http/httpd.c ****     http_add_connection(hs);
 668:lwIP/src/apps/http/httpd.c ****     /* ensure nagle doesn't interfere with sending all data as fast as possible: */
 669:lwIP/src/apps/http/httpd.c ****     altcp_nagle_disable(pcb);
 670:lwIP/src/apps/http/httpd.c ****   } else
 671:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_11_KEEPALIVE */
 672:lwIP/src/apps/http/httpd.c ****   {
 673:lwIP/src/apps/http/httpd.c ****     http_close_conn(pcb, hs);
 674:lwIP/src/apps/http/httpd.c ****   }
 675:lwIP/src/apps/http/httpd.c **** }
 676:lwIP/src/apps/http/httpd.c **** 
 677:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI || LWIP_HTTPD_CGI_SSI
 678:lwIP/src/apps/http/httpd.c **** /**
 679:lwIP/src/apps/http/httpd.c ****  * Extract URI parameters from the parameter-part of an URI in the form
 680:lwIP/src/apps/http/httpd.c ****  * "test.cgi?x=y" @todo: better explanation!
 681:lwIP/src/apps/http/httpd.c ****  * Pointers to the parameters are stored in hs->param_vals.
 682:lwIP/src/apps/http/httpd.c ****  *
 683:lwIP/src/apps/http/httpd.c ****  * @param hs http connection state
 684:lwIP/src/apps/http/httpd.c ****  * @param params pointer to the NULL-terminated parameter string from the URI
 685:lwIP/src/apps/http/httpd.c ****  * @return number of parameters extracted
 686:lwIP/src/apps/http/httpd.c ****  */
 687:lwIP/src/apps/http/httpd.c **** static int
 688:lwIP/src/apps/http/httpd.c **** extract_uri_parameters(struct http_state *hs, char *params)
 689:lwIP/src/apps/http/httpd.c **** {
 690:lwIP/src/apps/http/httpd.c ****   char *pair;
 691:lwIP/src/apps/http/httpd.c ****   char *equals;
 692:lwIP/src/apps/http/httpd.c ****   int loop;
 693:lwIP/src/apps/http/httpd.c **** 
 694:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(hs);
 695:lwIP/src/apps/http/httpd.c **** 
 696:lwIP/src/apps/http/httpd.c ****   /* If we have no parameters at all, return immediately. */
 697:lwIP/src/apps/http/httpd.c ****   if (!params || (params[0] == '\0')) {
 698:lwIP/src/apps/http/httpd.c ****     return (0);
 699:lwIP/src/apps/http/httpd.c ****   }
 700:lwIP/src/apps/http/httpd.c **** 
 701:lwIP/src/apps/http/httpd.c ****   /* Get a pointer to our first parameter */
 702:lwIP/src/apps/http/httpd.c ****   pair = params;
 703:lwIP/src/apps/http/httpd.c **** 
 704:lwIP/src/apps/http/httpd.c ****   /* Parse up to LWIP_HTTPD_MAX_CGI_PARAMETERS from the passed string and ignore the
 705:lwIP/src/apps/http/httpd.c ****    * remainder (if any) */
 706:lwIP/src/apps/http/httpd.c ****   for (loop = 0; (loop < LWIP_HTTPD_MAX_CGI_PARAMETERS) && pair; loop++) {
 707:lwIP/src/apps/http/httpd.c **** 
 708:lwIP/src/apps/http/httpd.c ****     /* Save the name of the parameter */
 709:lwIP/src/apps/http/httpd.c ****     http_cgi_params[loop] = pair;
 710:lwIP/src/apps/http/httpd.c **** 
 711:lwIP/src/apps/http/httpd.c ****     /* Remember the start of this name=value pair */
 712:lwIP/src/apps/http/httpd.c ****     equals = pair;
 713:lwIP/src/apps/http/httpd.c **** 
ARM GAS  /tmp/ccQlnpyR.s 			page 14


 714:lwIP/src/apps/http/httpd.c ****     /* Find the start of the next name=value pair and replace the delimiter
 715:lwIP/src/apps/http/httpd.c ****      * with a 0 to terminate the previous pair string. */
 716:lwIP/src/apps/http/httpd.c ****     pair = strchr(pair, '&');
 717:lwIP/src/apps/http/httpd.c ****     if (pair) {
 718:lwIP/src/apps/http/httpd.c ****       *pair = '\0';
 719:lwIP/src/apps/http/httpd.c ****       pair++;
 720:lwIP/src/apps/http/httpd.c ****     } else {
 721:lwIP/src/apps/http/httpd.c ****       /* We didn't find a new parameter so find the end of the URI and
 722:lwIP/src/apps/http/httpd.c ****        * replace the space with a '\0' */
 723:lwIP/src/apps/http/httpd.c ****       pair = strchr(equals, ' ');
 724:lwIP/src/apps/http/httpd.c ****       if (pair) {
 725:lwIP/src/apps/http/httpd.c ****         *pair = '\0';
 726:lwIP/src/apps/http/httpd.c ****       }
 727:lwIP/src/apps/http/httpd.c **** 
 728:lwIP/src/apps/http/httpd.c ****       /* Revert to NULL so that we exit the loop as expected. */
 729:lwIP/src/apps/http/httpd.c ****       pair = NULL;
 730:lwIP/src/apps/http/httpd.c ****     }
 731:lwIP/src/apps/http/httpd.c **** 
 732:lwIP/src/apps/http/httpd.c ****     /* Now find the '=' in the previous pair, replace it with '\0' and save
 733:lwIP/src/apps/http/httpd.c ****      * the parameter value string. */
 734:lwIP/src/apps/http/httpd.c ****     equals = strchr(equals, '=');
 735:lwIP/src/apps/http/httpd.c ****     if (equals) {
 736:lwIP/src/apps/http/httpd.c ****       *equals = '\0';
 737:lwIP/src/apps/http/httpd.c ****       http_cgi_param_vals[loop] = equals + 1;
 738:lwIP/src/apps/http/httpd.c ****     } else {
 739:lwIP/src/apps/http/httpd.c ****       http_cgi_param_vals[loop] = NULL;
 740:lwIP/src/apps/http/httpd.c ****     }
 741:lwIP/src/apps/http/httpd.c ****   }
 742:lwIP/src/apps/http/httpd.c **** 
 743:lwIP/src/apps/http/httpd.c ****   return loop;
 744:lwIP/src/apps/http/httpd.c **** }
 745:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CGI || LWIP_HTTPD_CGI_SSI */
 746:lwIP/src/apps/http/httpd.c **** 
 747:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 748:lwIP/src/apps/http/httpd.c **** /**
 749:lwIP/src/apps/http/httpd.c ****  * Insert a tag (found in an shtml in the form of "<!--#tagname-->" into the file.
 750:lwIP/src/apps/http/httpd.c ****  * The tag's name is stored in ssi->tag_name (NULL-terminated), the replacement
 751:lwIP/src/apps/http/httpd.c ****  * should be written to hs->tag_insert (up to a length of LWIP_HTTPD_MAX_TAG_INSERT_LEN).
 752:lwIP/src/apps/http/httpd.c ****  * The amount of data written is stored to ssi->tag_insert_len.
 753:lwIP/src/apps/http/httpd.c ****  *
 754:lwIP/src/apps/http/httpd.c ****  * @todo: return tag_insert_len - maybe it can be removed from struct http_state?
 755:lwIP/src/apps/http/httpd.c ****  *
 756:lwIP/src/apps/http/httpd.c ****  * @param hs http connection state
 757:lwIP/src/apps/http/httpd.c ****  */
 758:lwIP/src/apps/http/httpd.c **** static void
 759:lwIP/src/apps/http/httpd.c **** get_tag_insert(struct http_state *hs)
 760:lwIP/src/apps/http/httpd.c **** {
 761:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_RAW
 762:lwIP/src/apps/http/httpd.c ****   const char *tag;
 763:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SSI_RAW */
 764:lwIP/src/apps/http/httpd.c ****   int tag;
 765:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_RAW */
 766:lwIP/src/apps/http/httpd.c ****   size_t len;
 767:lwIP/src/apps/http/httpd.c ****   struct http_ssi_state *ssi;
 768:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
 769:lwIP/src/apps/http/httpd.c ****   u16_t current_tag_part;
 770:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
ARM GAS  /tmp/ccQlnpyR.s 			page 15


 771:lwIP/src/apps/http/httpd.c **** 
 772:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("hs != NULL", hs != NULL);
 773:lwIP/src/apps/http/httpd.c ****   ssi = hs->ssi;
 774:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("ssi != NULL", ssi != NULL);
 775:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
 776:lwIP/src/apps/http/httpd.c ****   current_tag_part = ssi->tag_part;
 777:lwIP/src/apps/http/httpd.c ****   ssi->tag_part = HTTPD_LAST_TAG_PART;
 778:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
 779:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_RAW
 780:lwIP/src/apps/http/httpd.c ****   tag = ssi->tag_name;
 781:lwIP/src/apps/http/httpd.c **** #endif
 782:lwIP/src/apps/http/httpd.c **** 
 783:lwIP/src/apps/http/httpd.c ****   if (httpd_ssi_handler
 784:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_RAW
 785:lwIP/src/apps/http/httpd.c ****       && httpd_tags && httpd_num_tags
 786:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_RAW */
 787:lwIP/src/apps/http/httpd.c ****      ) {
 788:lwIP/src/apps/http/httpd.c **** 
 789:lwIP/src/apps/http/httpd.c ****     /* Find this tag in the list we have been provided. */
 790:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_RAW
 791:lwIP/src/apps/http/httpd.c ****     {
 792:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SSI_RAW */
 793:lwIP/src/apps/http/httpd.c ****     for (tag = 0; tag < httpd_num_tags; tag++) {
 794:lwIP/src/apps/http/httpd.c ****       if (strcmp(ssi->tag_name, httpd_tags[tag]) == 0)
 795:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_RAW */
 796:lwIP/src/apps/http/httpd.c ****       {
 797:lwIP/src/apps/http/httpd.c ****         ssi->tag_insert_len = httpd_ssi_handler(tag, ssi->tag_insert,
 798:lwIP/src/apps/http/httpd.c ****                                               LWIP_HTTPD_MAX_TAG_INSERT_LEN
 799:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
 800:lwIP/src/apps/http/httpd.c ****                                               , current_tag_part, &ssi->tag_part
 801:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
 802:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_FILE_STATE
 803:lwIP/src/apps/http/httpd.c ****                                               , (hs->handle ? hs->handle->state : NULL)
 804:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_FILE_STATE */
 805:lwIP/src/apps/http/httpd.c ****                                              );
 806:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_RAW
 807:lwIP/src/apps/http/httpd.c ****         if (ssi->tag_insert_len != HTTPD_SSI_TAG_UNKNOWN)
 808:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_RAW */
 809:lwIP/src/apps/http/httpd.c ****         {
 810:lwIP/src/apps/http/httpd.c ****           return;
 811:lwIP/src/apps/http/httpd.c ****         }
 812:lwIP/src/apps/http/httpd.c ****       }
 813:lwIP/src/apps/http/httpd.c ****     }
 814:lwIP/src/apps/http/httpd.c ****   }
 815:lwIP/src/apps/http/httpd.c **** 
 816:lwIP/src/apps/http/httpd.c ****   /* If we drop out, we were asked to serve a page which contains tags that
 817:lwIP/src/apps/http/httpd.c ****    * we don't have a handler for. Merely echo back the tags with an error
 818:lwIP/src/apps/http/httpd.c ****    * marker. */
 819:lwIP/src/apps/http/httpd.c **** #define UNKNOWN_TAG1_TEXT "<b>***UNKNOWN TAG "
 820:lwIP/src/apps/http/httpd.c **** #define UNKNOWN_TAG1_LEN  18
 821:lwIP/src/apps/http/httpd.c **** #define UNKNOWN_TAG2_TEXT "***</b>"
 822:lwIP/src/apps/http/httpd.c **** #define UNKNOWN_TAG2_LEN  7
 823:lwIP/src/apps/http/httpd.c ****   len = LWIP_MIN(sizeof(ssi->tag_name), LWIP_MIN(strlen(ssi->tag_name),
 824:lwIP/src/apps/http/httpd.c ****                  LWIP_HTTPD_MAX_TAG_INSERT_LEN - (UNKNOWN_TAG1_LEN + UNKNOWN_TAG2_LEN)));
 825:lwIP/src/apps/http/httpd.c ****   MEMCPY(ssi->tag_insert, UNKNOWN_TAG1_TEXT, UNKNOWN_TAG1_LEN);
 826:lwIP/src/apps/http/httpd.c ****   MEMCPY(&ssi->tag_insert[UNKNOWN_TAG1_LEN], ssi->tag_name, len);
 827:lwIP/src/apps/http/httpd.c ****   MEMCPY(&ssi->tag_insert[UNKNOWN_TAG1_LEN + len], UNKNOWN_TAG2_TEXT, UNKNOWN_TAG2_LEN);
ARM GAS  /tmp/ccQlnpyR.s 			page 16


 828:lwIP/src/apps/http/httpd.c ****   ssi->tag_insert[UNKNOWN_TAG1_LEN + len + UNKNOWN_TAG2_LEN] = 0;
 829:lwIP/src/apps/http/httpd.c **** 
 830:lwIP/src/apps/http/httpd.c ****   len = strlen(ssi->tag_insert);
 831:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("len <= 0xffff", len <= 0xffff);
 832:lwIP/src/apps/http/httpd.c ****   ssi->tag_insert_len = (u16_t)len;
 833:lwIP/src/apps/http/httpd.c **** }
 834:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 835:lwIP/src/apps/http/httpd.c **** 
 836:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
 837:lwIP/src/apps/http/httpd.c **** /**
 838:lwIP/src/apps/http/httpd.c ****  * Generate the relevant HTTP headers for the given filename and write
 839:lwIP/src/apps/http/httpd.c ****  * them into the supplied buffer.
 840:lwIP/src/apps/http/httpd.c ****  */
 841:lwIP/src/apps/http/httpd.c **** static void
 842:lwIP/src/apps/http/httpd.c **** get_http_headers(struct http_state *hs, const char *uri)
 843:lwIP/src/apps/http/httpd.c **** {
 844:lwIP/src/apps/http/httpd.c ****   size_t content_type;
 845:lwIP/src/apps/http/httpd.c ****   char *tmp;
 846:lwIP/src/apps/http/httpd.c ****   char *ext;
 847:lwIP/src/apps/http/httpd.c ****   char *vars;
 848:lwIP/src/apps/http/httpd.c **** 
 849:lwIP/src/apps/http/httpd.c ****   /* In all cases, the second header we send is the server identification
 850:lwIP/src/apps/http/httpd.c ****      so set it here. */
 851:lwIP/src/apps/http/httpd.c ****   hs->hdrs[HDR_STRINGS_IDX_SERVER_NAME] = g_psHTTPHeaderStrings[HTTP_HDR_SERVER];
 852:lwIP/src/apps/http/httpd.c ****   hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE] = NULL;
 853:lwIP/src/apps/http/httpd.c ****   hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_NR] = NULL;
 854:lwIP/src/apps/http/httpd.c **** 
 855:lwIP/src/apps/http/httpd.c ****   /* Is this a normal file or the special case we use to send back the
 856:lwIP/src/apps/http/httpd.c ****      default "404: Page not found" response? */
 857:lwIP/src/apps/http/httpd.c ****   if (uri == NULL) {
 858:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_HTTP_STATUS] = g_psHTTPHeaderStrings[HTTP_HDR_NOT_FOUND];
 859:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 860:lwIP/src/apps/http/httpd.c ****     if (hs->keepalive) {
 861:lwIP/src/apps/http/httpd.c ****       hs->hdrs[HDR_STRINGS_IDX_CONTENT_TYPE] = g_psHTTPHeaderStrings[DEFAULT_404_HTML_PERSISTENT];
 862:lwIP/src/apps/http/httpd.c ****     } else
 863:lwIP/src/apps/http/httpd.c **** #endif
 864:lwIP/src/apps/http/httpd.c ****     {
 865:lwIP/src/apps/http/httpd.c ****       hs->hdrs[HDR_STRINGS_IDX_CONTENT_TYPE] = g_psHTTPHeaderStrings[DEFAULT_404_HTML];
 866:lwIP/src/apps/http/httpd.c ****     }
 867:lwIP/src/apps/http/httpd.c **** 
 868:lwIP/src/apps/http/httpd.c ****     /* Set up to send the first header string. */
 869:lwIP/src/apps/http/httpd.c ****     hs->hdr_index = 0;
 870:lwIP/src/apps/http/httpd.c ****     hs->hdr_pos = 0;
 871:lwIP/src/apps/http/httpd.c ****     return;
 872:lwIP/src/apps/http/httpd.c ****   }
 873:lwIP/src/apps/http/httpd.c ****   /* We are dealing with a particular filename. Look for one other
 874:lwIP/src/apps/http/httpd.c ****       special case.  We assume that any filename with "404" in it must be
 875:lwIP/src/apps/http/httpd.c ****       indicative of a 404 server error whereas all other files require
 876:lwIP/src/apps/http/httpd.c ****       the 200 OK header. */
 877:lwIP/src/apps/http/httpd.c ****   if (strstr(uri, "404")) {
 878:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_HTTP_STATUS] = g_psHTTPHeaderStrings[HTTP_HDR_NOT_FOUND];
 879:lwIP/src/apps/http/httpd.c ****   } else if (strstr(uri, "400")) {
 880:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_HTTP_STATUS] = g_psHTTPHeaderStrings[HTTP_HDR_BAD_REQUEST];
 881:lwIP/src/apps/http/httpd.c ****   } else if (strstr(uri, "501")) {
 882:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_HTTP_STATUS] = g_psHTTPHeaderStrings[HTTP_HDR_NOT_IMPL];
 883:lwIP/src/apps/http/httpd.c ****   } else {
 884:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_HTTP_STATUS] = g_psHTTPHeaderStrings[HTTP_HDR_OK];
ARM GAS  /tmp/ccQlnpyR.s 			page 17


 885:lwIP/src/apps/http/httpd.c ****   }
 886:lwIP/src/apps/http/httpd.c **** 
 887:lwIP/src/apps/http/httpd.c ****   /* Determine if the URI has any variables and, if so, temporarily remove
 888:lwIP/src/apps/http/httpd.c ****       them. */
 889:lwIP/src/apps/http/httpd.c ****   vars = strchr(uri, '?');
 890:lwIP/src/apps/http/httpd.c ****   if (vars) {
 891:lwIP/src/apps/http/httpd.c ****     *vars = '\0';
 892:lwIP/src/apps/http/httpd.c ****   }
 893:lwIP/src/apps/http/httpd.c **** 
 894:lwIP/src/apps/http/httpd.c ****   /* Get a pointer to the file extension.  We find this by looking for the
 895:lwIP/src/apps/http/httpd.c ****       last occurrence of "." in the filename passed. */
 896:lwIP/src/apps/http/httpd.c ****   ext = NULL;
 897:lwIP/src/apps/http/httpd.c ****   tmp = strchr(uri, '.');
 898:lwIP/src/apps/http/httpd.c ****   while (tmp) {
 899:lwIP/src/apps/http/httpd.c ****     ext = tmp + 1;
 900:lwIP/src/apps/http/httpd.c ****     tmp = strchr(ext, '.');
 901:lwIP/src/apps/http/httpd.c ****   }
 902:lwIP/src/apps/http/httpd.c ****   if (ext != NULL) {
 903:lwIP/src/apps/http/httpd.c ****     /* Now determine the content type and add the relevant header for that. */
 904:lwIP/src/apps/http/httpd.c ****     for (content_type = 0; content_type < NUM_HTTP_HEADERS; content_type++) {
 905:lwIP/src/apps/http/httpd.c ****       /* Have we found a matching extension? */
 906:lwIP/src/apps/http/httpd.c ****       if (!lwip_stricmp(g_psHTTPHeaders[content_type].extension, ext)) {
 907:lwIP/src/apps/http/httpd.c ****         break;
 908:lwIP/src/apps/http/httpd.c ****       }
 909:lwIP/src/apps/http/httpd.c ****     }
 910:lwIP/src/apps/http/httpd.c ****   } else {
 911:lwIP/src/apps/http/httpd.c ****     content_type = NUM_HTTP_HEADERS;
 912:lwIP/src/apps/http/httpd.c ****   }
 913:lwIP/src/apps/http/httpd.c **** 
 914:lwIP/src/apps/http/httpd.c ****   /* Reinstate the parameter marker if there was one in the original URI. */
 915:lwIP/src/apps/http/httpd.c ****   if (vars) {
 916:lwIP/src/apps/http/httpd.c ****     *vars = '?';
 917:lwIP/src/apps/http/httpd.c ****   }
 918:lwIP/src/apps/http/httpd.c **** 
 919:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_OMIT_HEADER_FOR_EXTENSIONLESS_URI
 920:lwIP/src/apps/http/httpd.c ****   /* Does the URL passed have any file extension?  If not, we assume it
 921:lwIP/src/apps/http/httpd.c ****      is a special-case URL used for control state notification and we do
 922:lwIP/src/apps/http/httpd.c ****      not send any HTTP headers with the response. */
 923:lwIP/src/apps/http/httpd.c ****   if (!ext) {
 924:lwIP/src/apps/http/httpd.c ****     /* Force the header index to a value indicating that all headers
 925:lwIP/src/apps/http/httpd.c ****        have already been sent. */
 926:lwIP/src/apps/http/httpd.c ****     hs->hdr_index = NUM_FILE_HDR_STRINGS;
 927:lwIP/src/apps/http/httpd.c ****     return;
 928:lwIP/src/apps/http/httpd.c ****   }
 929:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_OMIT_HEADER_FOR_EXTENSIONLESS_URI */
 930:lwIP/src/apps/http/httpd.c ****   /* Did we find a matching extension? */
 931:lwIP/src/apps/http/httpd.c ****   if (content_type < NUM_HTTP_HEADERS) {
 932:lwIP/src/apps/http/httpd.c ****     /* yes, store it */
 933:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_CONTENT_TYPE] = g_psHTTPHeaders[content_type].content_type;
 934:lwIP/src/apps/http/httpd.c ****   } else if (!ext) {
 935:lwIP/src/apps/http/httpd.c ****     /* no, no extension found -> use binary transfer to prevent the browser adding '.txt' on save *
 936:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_CONTENT_TYPE] = HTTP_HDR_APP;
 937:lwIP/src/apps/http/httpd.c ****   } else {
 938:lwIP/src/apps/http/httpd.c ****     /* No - use the default, plain text file type. */
 939:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_CONTENT_TYPE] = HTTP_HDR_DEFAULT_TYPE;
 940:lwIP/src/apps/http/httpd.c ****   }
 941:lwIP/src/apps/http/httpd.c ****   /* Set up to send the first header string. */
ARM GAS  /tmp/ccQlnpyR.s 			page 18


 942:lwIP/src/apps/http/httpd.c ****   hs->hdr_index = 0;
 943:lwIP/src/apps/http/httpd.c ****   hs->hdr_pos = 0;
 944:lwIP/src/apps/http/httpd.c **** }
 945:lwIP/src/apps/http/httpd.c **** 
 946:lwIP/src/apps/http/httpd.c **** /* Add content-length header? */
 947:lwIP/src/apps/http/httpd.c **** static void
 948:lwIP/src/apps/http/httpd.c **** get_http_content_length(struct http_state *hs)
 949:lwIP/src/apps/http/httpd.c **** {
 950:lwIP/src/apps/http/httpd.c ****   u8_t add_content_len = 0;
 951:lwIP/src/apps/http/httpd.c **** 
 952:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("already been here?", hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE] == NULL);
 953:lwIP/src/apps/http/httpd.c **** 
 954:lwIP/src/apps/http/httpd.c ****   add_content_len = 0;
 955:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
 956:lwIP/src/apps/http/httpd.c ****   if (hs->ssi == NULL) /* @todo: get maximum file length from SSI */
 957:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 958:lwIP/src/apps/http/httpd.c ****   {
 959:lwIP/src/apps/http/httpd.c ****     if ((hs->handle != NULL) && (hs->handle->flags & FS_FILE_FLAGS_HEADER_PERSISTENT)) {
 960:lwIP/src/apps/http/httpd.c ****       add_content_len = 1;
 961:lwIP/src/apps/http/httpd.c ****     }
 962:lwIP/src/apps/http/httpd.c ****   }
 963:lwIP/src/apps/http/httpd.c ****   if (add_content_len) {
 964:lwIP/src/apps/http/httpd.c ****     size_t len;
 965:lwIP/src/apps/http/httpd.c ****     lwip_itoa(hs->hdr_content_len, (size_t)LWIP_HTTPD_MAX_CONTENT_LEN_SIZE,
 966:lwIP/src/apps/http/httpd.c ****               hs->handle->len);
 967:lwIP/src/apps/http/httpd.c ****     len = strlen(hs->hdr_content_len);
 968:lwIP/src/apps/http/httpd.c ****     if (len <= LWIP_HTTPD_MAX_CONTENT_LEN_SIZE - LWIP_HTTPD_MAX_CONTENT_LEN_OFFSET) {
 969:lwIP/src/apps/http/httpd.c ****       SMEMCPY(&hs->hdr_content_len[len], CRLF, 3);
 970:lwIP/src/apps/http/httpd.c ****       hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_NR] = hs->hdr_content_len;
 971:lwIP/src/apps/http/httpd.c ****     } else {
 972:lwIP/src/apps/http/httpd.c ****       add_content_len = 0;
 973:lwIP/src/apps/http/httpd.c ****     }
 974:lwIP/src/apps/http/httpd.c ****   }
 975:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 976:lwIP/src/apps/http/httpd.c ****   if (add_content_len) {
 977:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE] = g_psHTTPHeaderStrings[HTTP_HDR_KEEPALIVE_LEN]
 978:lwIP/src/apps/http/httpd.c ****   } else {
 979:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE] = g_psHTTPHeaderStrings[HTTP_HDR_CONN_CLOSE];
 980:lwIP/src/apps/http/httpd.c ****     hs->keepalive = 0;
 981:lwIP/src/apps/http/httpd.c ****   }
 982:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SUPPORT_11_KEEPALIVE */
 983:lwIP/src/apps/http/httpd.c ****   if (add_content_len) {
 984:lwIP/src/apps/http/httpd.c ****     hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE] = g_psHTTPHeaderStrings[HTTP_HDR_CONTENT_LENGTH
 985:lwIP/src/apps/http/httpd.c ****   }
 986:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_11_KEEPALIVE */
 987:lwIP/src/apps/http/httpd.c **** }
 988:lwIP/src/apps/http/httpd.c **** 
 989:lwIP/src/apps/http/httpd.c **** /** Sub-function of http_send(): send dynamic headers
 990:lwIP/src/apps/http/httpd.c ****  *
 991:lwIP/src/apps/http/httpd.c ****  * @returns: - HTTP_NO_DATA_TO_SEND: no new data has been enqueued
 992:lwIP/src/apps/http/httpd.c ****  *           - HTTP_DATA_TO_SEND_CONTINUE: continue with sending HTTP body
 993:lwIP/src/apps/http/httpd.c ****  *           - HTTP_DATA_TO_SEND_BREAK: data has been enqueued, headers pending,
 994:lwIP/src/apps/http/httpd.c ****  *                                      so don't send HTTP body yet
 995:lwIP/src/apps/http/httpd.c ****  *           - HTTP_DATA_TO_SEND_FREED: http_state and pcb are already freed
 996:lwIP/src/apps/http/httpd.c ****  */
 997:lwIP/src/apps/http/httpd.c **** static u8_t
 998:lwIP/src/apps/http/httpd.c **** http_send_headers(struct altcp_pcb *pcb, struct http_state *hs)
ARM GAS  /tmp/ccQlnpyR.s 			page 19


 999:lwIP/src/apps/http/httpd.c **** {
1000:lwIP/src/apps/http/httpd.c ****   err_t err;
1001:lwIP/src/apps/http/httpd.c ****   u16_t len;
1002:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = HTTP_NO_DATA_TO_SEND;
1003:lwIP/src/apps/http/httpd.c ****   u16_t hdrlen, sendlen;
1004:lwIP/src/apps/http/httpd.c **** 
1005:lwIP/src/apps/http/httpd.c ****   if (hs->hdrs[HDR_STRINGS_IDX_CONTENT_LEN_KEEPALIVE] == NULL) {
1006:lwIP/src/apps/http/httpd.c ****     /* set up "content-length" and "connection:" headers */
1007:lwIP/src/apps/http/httpd.c ****     get_http_content_length(hs);
1008:lwIP/src/apps/http/httpd.c ****   }
1009:lwIP/src/apps/http/httpd.c **** 
1010:lwIP/src/apps/http/httpd.c ****   /* How much data can we send? */
1011:lwIP/src/apps/http/httpd.c ****   len = altcp_sndbuf(pcb);
1012:lwIP/src/apps/http/httpd.c ****   sendlen = len;
1013:lwIP/src/apps/http/httpd.c **** 
1014:lwIP/src/apps/http/httpd.c ****   while (len && (hs->hdr_index < NUM_FILE_HDR_STRINGS) && sendlen) {
1015:lwIP/src/apps/http/httpd.c ****     const void *ptr;
1016:lwIP/src/apps/http/httpd.c ****     u16_t old_sendlen;
1017:lwIP/src/apps/http/httpd.c ****     u8_t apiflags;
1018:lwIP/src/apps/http/httpd.c ****     /* How much do we have to send from the current header? */
1019:lwIP/src/apps/http/httpd.c ****     hdrlen = (u16_t)strlen(hs->hdrs[hs->hdr_index]);
1020:lwIP/src/apps/http/httpd.c **** 
1021:lwIP/src/apps/http/httpd.c ****     /* How much of this can we send? */
1022:lwIP/src/apps/http/httpd.c ****     sendlen = (len < (hdrlen - hs->hdr_pos)) ? len : (hdrlen - hs->hdr_pos);
1023:lwIP/src/apps/http/httpd.c **** 
1024:lwIP/src/apps/http/httpd.c ****     /* Send this amount of data or as much as we can given memory
1025:lwIP/src/apps/http/httpd.c ****      * constraints. */
1026:lwIP/src/apps/http/httpd.c ****     ptr = (const void *)(hs->hdrs[hs->hdr_index] + hs->hdr_pos);
1027:lwIP/src/apps/http/httpd.c ****     old_sendlen = sendlen;
1028:lwIP/src/apps/http/httpd.c ****     apiflags = HTTP_IS_HDR_VOLATILE(hs, ptr);
1029:lwIP/src/apps/http/httpd.c ****     if (hs->hdr_index == HDR_STRINGS_IDX_CONTENT_LEN_NR) {
1030:lwIP/src/apps/http/httpd.c ****       /* content-length is always volatile */
1031:lwIP/src/apps/http/httpd.c ****       apiflags |= TCP_WRITE_FLAG_COPY;
1032:lwIP/src/apps/http/httpd.c ****     }
1033:lwIP/src/apps/http/httpd.c ****     if (hs->hdr_index < NUM_FILE_HDR_STRINGS - 1) {
1034:lwIP/src/apps/http/httpd.c ****       apiflags |= TCP_WRITE_FLAG_MORE;
1035:lwIP/src/apps/http/httpd.c ****     }
1036:lwIP/src/apps/http/httpd.c ****     err = http_write(pcb, ptr, &sendlen, apiflags);
1037:lwIP/src/apps/http/httpd.c ****     if ((err == ERR_OK) && (old_sendlen != sendlen)) {
1038:lwIP/src/apps/http/httpd.c ****       /* Remember that we added some more data to be transmitted. */
1039:lwIP/src/apps/http/httpd.c ****       data_to_send = HTTP_DATA_TO_SEND_CONTINUE;
1040:lwIP/src/apps/http/httpd.c ****     } else if (err != ERR_OK) {
1041:lwIP/src/apps/http/httpd.c ****       /* special case: http_write does not try to send 1 byte */
1042:lwIP/src/apps/http/httpd.c ****       sendlen = 0;
1043:lwIP/src/apps/http/httpd.c ****     }
1044:lwIP/src/apps/http/httpd.c **** 
1045:lwIP/src/apps/http/httpd.c ****     /* Fix up the header position for the next time round. */
1046:lwIP/src/apps/http/httpd.c ****     hs->hdr_pos += sendlen;
1047:lwIP/src/apps/http/httpd.c ****     len -= sendlen;
1048:lwIP/src/apps/http/httpd.c **** 
1049:lwIP/src/apps/http/httpd.c ****     /* Have we finished sending this string? */
1050:lwIP/src/apps/http/httpd.c ****     if (hs->hdr_pos == hdrlen) {
1051:lwIP/src/apps/http/httpd.c ****       /* Yes - move on to the next one */
1052:lwIP/src/apps/http/httpd.c ****       hs->hdr_index++;
1053:lwIP/src/apps/http/httpd.c ****       /* skip headers that are NULL (not all headers are required) */
1054:lwIP/src/apps/http/httpd.c ****       while ((hs->hdr_index < NUM_FILE_HDR_STRINGS) &&
1055:lwIP/src/apps/http/httpd.c ****              (hs->hdrs[hs->hdr_index] == NULL)) {
ARM GAS  /tmp/ccQlnpyR.s 			page 20


1056:lwIP/src/apps/http/httpd.c ****         hs->hdr_index++;
1057:lwIP/src/apps/http/httpd.c ****       }
1058:lwIP/src/apps/http/httpd.c ****       hs->hdr_pos = 0;
1059:lwIP/src/apps/http/httpd.c ****     }
1060:lwIP/src/apps/http/httpd.c ****   }
1061:lwIP/src/apps/http/httpd.c **** 
1062:lwIP/src/apps/http/httpd.c ****   if ((hs->hdr_index >= NUM_FILE_HDR_STRINGS) && (hs->file == NULL)) {
1063:lwIP/src/apps/http/httpd.c ****     /* When we are at the end of the headers, check for data to send
1064:lwIP/src/apps/http/httpd.c ****      * instead of waiting for ACK from remote side to continue
1065:lwIP/src/apps/http/httpd.c ****      * (which would happen when sending files from async read). */
1066:lwIP/src/apps/http/httpd.c ****     if (http_check_eof(pcb, hs)) {
1067:lwIP/src/apps/http/httpd.c ****       data_to_send = HTTP_DATA_TO_SEND_BREAK;
1068:lwIP/src/apps/http/httpd.c ****     } else {
1069:lwIP/src/apps/http/httpd.c ****       /* At this point, for non-keepalive connections, hs is deallocated an
1070:lwIP/src/apps/http/httpd.c ****          pcb is closed. */
1071:lwIP/src/apps/http/httpd.c ****       return HTTP_DATA_TO_SEND_FREED;
1072:lwIP/src/apps/http/httpd.c ****     }
1073:lwIP/src/apps/http/httpd.c ****   }
1074:lwIP/src/apps/http/httpd.c ****   /* If we get here and there are still header bytes to send, we send
1075:lwIP/src/apps/http/httpd.c ****    * the header information we just wrote immediately. If there are no
1076:lwIP/src/apps/http/httpd.c ****    * more headers to send, but we do have file data to send, drop through
1077:lwIP/src/apps/http/httpd.c ****    * to try to send some file data too. */
1078:lwIP/src/apps/http/httpd.c ****   if ((hs->hdr_index < NUM_FILE_HDR_STRINGS) || !hs->file) {
1079:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("tcp_output\n"));
1080:lwIP/src/apps/http/httpd.c ****     return HTTP_DATA_TO_SEND_BREAK;
1081:lwIP/src/apps/http/httpd.c ****   }
1082:lwIP/src/apps/http/httpd.c ****   return data_to_send;
1083:lwIP/src/apps/http/httpd.c **** }
1084:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_HEADERS */
1085:lwIP/src/apps/http/httpd.c **** 
1086:lwIP/src/apps/http/httpd.c **** /** Sub-function of http_send(): end-of-file (or block) is reached,
1087:lwIP/src/apps/http/httpd.c ****  * either close the file or read the next block (if supported).
1088:lwIP/src/apps/http/httpd.c ****  *
1089:lwIP/src/apps/http/httpd.c ****  * @returns: 0 if the file is finished or no data has been read
1090:lwIP/src/apps/http/httpd.c ****  *           1 if the file is not finished and data has been read
1091:lwIP/src/apps/http/httpd.c ****  */
1092:lwIP/src/apps/http/httpd.c **** static u8_t
1093:lwIP/src/apps/http/httpd.c **** http_check_eof(struct altcp_pcb *pcb, struct http_state *hs)
1094:lwIP/src/apps/http/httpd.c **** {
1095:lwIP/src/apps/http/httpd.c ****   int bytes_left;
1096:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ
1097:lwIP/src/apps/http/httpd.c ****   int count;
1098:lwIP/src/apps/http/httpd.c **** #ifdef HTTPD_MAX_WRITE_LEN
1099:lwIP/src/apps/http/httpd.c ****   int max_write_len;
1100:lwIP/src/apps/http/httpd.c **** #endif /* HTTPD_MAX_WRITE_LEN */
1101:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_FILE_READ */
1102:lwIP/src/apps/http/httpd.c **** 
1103:lwIP/src/apps/http/httpd.c ****   /* Do we have a valid file handle? */
1104:lwIP/src/apps/http/httpd.c ****   if (hs->handle == NULL) {
1105:lwIP/src/apps/http/httpd.c ****     /* No - close the connection. */
1106:lwIP/src/apps/http/httpd.c ****     http_eof(pcb, hs);
1107:lwIP/src/apps/http/httpd.c ****     return 0;
1108:lwIP/src/apps/http/httpd.c ****   }
1109:lwIP/src/apps/http/httpd.c ****   bytes_left = fs_bytes_left(hs->handle);
1110:lwIP/src/apps/http/httpd.c ****   if (bytes_left <= 0) {
1111:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done. */
1112:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("End of file.\n"));
ARM GAS  /tmp/ccQlnpyR.s 			page 21


1113:lwIP/src/apps/http/httpd.c ****     http_eof(pcb, hs);
1114:lwIP/src/apps/http/httpd.c ****     return 0;
1115:lwIP/src/apps/http/httpd.c ****   }
1116:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ
1117:lwIP/src/apps/http/httpd.c ****   /* Do we already have a send buffer allocated? */
1118:lwIP/src/apps/http/httpd.c ****   if (hs->buf) {
1119:lwIP/src/apps/http/httpd.c ****     /* Yes - get the length of the buffer */
1120:lwIP/src/apps/http/httpd.c ****     count = LWIP_MIN(hs->buf_len, bytes_left);
1121:lwIP/src/apps/http/httpd.c ****   } else {
1122:lwIP/src/apps/http/httpd.c ****     /* We don't have a send buffer so allocate one now */
1123:lwIP/src/apps/http/httpd.c ****     count = altcp_sndbuf(pcb);
1124:lwIP/src/apps/http/httpd.c ****     if (bytes_left < count) {
1125:lwIP/src/apps/http/httpd.c ****       count = bytes_left;
1126:lwIP/src/apps/http/httpd.c ****     }
1127:lwIP/src/apps/http/httpd.c **** #ifdef HTTPD_MAX_WRITE_LEN
1128:lwIP/src/apps/http/httpd.c ****     /* Additional limitation: e.g. don't enqueue more than 2*mss at once */
1129:lwIP/src/apps/http/httpd.c ****     max_write_len = HTTPD_MAX_WRITE_LEN(pcb);
1130:lwIP/src/apps/http/httpd.c ****     if (count > max_write_len) {
1131:lwIP/src/apps/http/httpd.c ****       count = max_write_len;
1132:lwIP/src/apps/http/httpd.c ****     }
1133:lwIP/src/apps/http/httpd.c **** #endif /* HTTPD_MAX_WRITE_LEN */
1134:lwIP/src/apps/http/httpd.c ****     do {
1135:lwIP/src/apps/http/httpd.c ****       hs->buf = (char *)mem_malloc((mem_size_t)count);
1136:lwIP/src/apps/http/httpd.c ****       if (hs->buf != NULL) {
1137:lwIP/src/apps/http/httpd.c ****         hs->buf_len = count;
1138:lwIP/src/apps/http/httpd.c ****         break;
1139:lwIP/src/apps/http/httpd.c ****       }
1140:lwIP/src/apps/http/httpd.c ****       count = count / 2;
1141:lwIP/src/apps/http/httpd.c ****     } while (count > 100);
1142:lwIP/src/apps/http/httpd.c **** 
1143:lwIP/src/apps/http/httpd.c ****     /* Did we get a send buffer? If not, return immediately. */
1144:lwIP/src/apps/http/httpd.c ****     if (hs->buf == NULL) {
1145:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("No buff\n"));
1146:lwIP/src/apps/http/httpd.c ****       return 0;
1147:lwIP/src/apps/http/httpd.c ****     }
1148:lwIP/src/apps/http/httpd.c ****   }
1149:lwIP/src/apps/http/httpd.c **** 
1150:lwIP/src/apps/http/httpd.c ****   /* Read a block of data from the file. */
1151:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("Trying to read %d bytes.\n", count));
1152:lwIP/src/apps/http/httpd.c **** 
1153:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_FS_ASYNC_READ
1154:lwIP/src/apps/http/httpd.c ****   count = fs_read_async(hs->handle, hs->buf, count, http_continue, hs);
1155:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_FS_ASYNC_READ */
1156:lwIP/src/apps/http/httpd.c ****   count = fs_read(hs->handle, hs->buf, count);
1157:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_FS_ASYNC_READ */
1158:lwIP/src/apps/http/httpd.c ****   if (count < 0) {
1159:lwIP/src/apps/http/httpd.c ****     if (count == FS_READ_DELAYED) {
1160:lwIP/src/apps/http/httpd.c ****       /* Delayed read, wait for FS to unblock us */
1161:lwIP/src/apps/http/httpd.c ****       return 0;
1162:lwIP/src/apps/http/httpd.c ****     }
1163:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
1164:lwIP/src/apps/http/httpd.c ****      * @todo: close here for HTTP/1.1 when reading file fails */
1165:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("End of file.\n"));
1166:lwIP/src/apps/http/httpd.c ****     http_eof(pcb, hs);
1167:lwIP/src/apps/http/httpd.c ****     return 0;
1168:lwIP/src/apps/http/httpd.c ****   }
1169:lwIP/src/apps/http/httpd.c **** 
ARM GAS  /tmp/ccQlnpyR.s 			page 22


1170:lwIP/src/apps/http/httpd.c ****   /* Set up to send the block of data we just read */
1171:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("Read %d bytes.\n", count));
1172:lwIP/src/apps/http/httpd.c ****   hs->left = count;
1173:lwIP/src/apps/http/httpd.c ****   hs->file = hs->buf;
1174:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
1175:lwIP/src/apps/http/httpd.c ****   if (hs->ssi) {
1176:lwIP/src/apps/http/httpd.c ****     hs->ssi->parse_left = count;
1177:lwIP/src/apps/http/httpd.c ****     hs->ssi->parsed = hs->buf;
1178:lwIP/src/apps/http/httpd.c ****   }
1179:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
1180:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_DYNAMIC_FILE_READ */
1181:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("SSI and DYNAMIC_HEADERS turned off but eof not reached", 0);
1182:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
1183:lwIP/src/apps/http/httpd.c ****   return 1;
1184:lwIP/src/apps/http/httpd.c **** }
1185:lwIP/src/apps/http/httpd.c **** 
1186:lwIP/src/apps/http/httpd.c **** /** Sub-function of http_send(): This is the normal send-routine for non-ssi files
1187:lwIP/src/apps/http/httpd.c ****  *
1188:lwIP/src/apps/http/httpd.c ****  * @returns: - 1: data has been written (so call tcp_ouput)
1189:lwIP/src/apps/http/httpd.c ****  *           - 0: no data has been written (no need to call tcp_output)
1190:lwIP/src/apps/http/httpd.c ****  */
1191:lwIP/src/apps/http/httpd.c **** static u8_t
1192:lwIP/src/apps/http/httpd.c **** http_send_data_nonssi(struct altcp_pcb *pcb, struct http_state *hs)
1193:lwIP/src/apps/http/httpd.c **** {
1194:lwIP/src/apps/http/httpd.c ****   err_t err;
1195:lwIP/src/apps/http/httpd.c ****   u16_t len;
1196:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = 0;
1197:lwIP/src/apps/http/httpd.c **** 
1198:lwIP/src/apps/http/httpd.c ****   /* We are not processing an SHTML file so no tag checking is necessary.
1199:lwIP/src/apps/http/httpd.c ****    * Just send the data as we received it from the file. */
1200:lwIP/src/apps/http/httpd.c ****   len = (u16_t)LWIP_MIN(hs->left, 0xffff);
1201:lwIP/src/apps/http/httpd.c **** 
1202:lwIP/src/apps/http/httpd.c ****   err = http_write(pcb, hs->file, &len, HTTP_IS_DATA_VOLATILE(hs));
1203:lwIP/src/apps/http/httpd.c ****   if (err == ERR_OK) {
1204:lwIP/src/apps/http/httpd.c ****     data_to_send = 1;
1205:lwIP/src/apps/http/httpd.c ****     hs->file += len;
1206:lwIP/src/apps/http/httpd.c ****     hs->left -= len;
1207:lwIP/src/apps/http/httpd.c ****   }
1208:lwIP/src/apps/http/httpd.c **** 
1209:lwIP/src/apps/http/httpd.c ****   return data_to_send;
1210:lwIP/src/apps/http/httpd.c **** }
1211:lwIP/src/apps/http/httpd.c **** 
1212:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
1213:lwIP/src/apps/http/httpd.c **** /** Sub-function of http_send(): This is the send-routine for ssi files
1214:lwIP/src/apps/http/httpd.c ****  *
1215:lwIP/src/apps/http/httpd.c ****  * @returns: - 1: data has been written (so call tcp_ouput)
1216:lwIP/src/apps/http/httpd.c ****  *           - 0: no data has been written (no need to call tcp_output)
1217:lwIP/src/apps/http/httpd.c ****  */
1218:lwIP/src/apps/http/httpd.c **** static u8_t
1219:lwIP/src/apps/http/httpd.c **** http_send_data_ssi(struct altcp_pcb *pcb, struct http_state *hs)
1220:lwIP/src/apps/http/httpd.c **** {
1221:lwIP/src/apps/http/httpd.c ****   err_t err = ERR_OK;
1222:lwIP/src/apps/http/httpd.c ****   u16_t len;
1223:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = 0;
1224:lwIP/src/apps/http/httpd.c ****   u8_t tag_type;
1225:lwIP/src/apps/http/httpd.c **** 
1226:lwIP/src/apps/http/httpd.c ****   struct http_ssi_state *ssi = hs->ssi;
ARM GAS  /tmp/ccQlnpyR.s 			page 23


1227:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("ssi != NULL", ssi != NULL);
1228:lwIP/src/apps/http/httpd.c ****   /* We are processing an SHTML file so need to scan for tags and replace
1229:lwIP/src/apps/http/httpd.c ****    * them with insert strings. We need to be careful here since a tag may
1230:lwIP/src/apps/http/httpd.c ****    * straddle the boundary of two blocks read from the file and we may also
1231:lwIP/src/apps/http/httpd.c ****    * have to split the insert string between two tcp_write operations. */
1232:lwIP/src/apps/http/httpd.c **** 
1233:lwIP/src/apps/http/httpd.c ****   /* How much data could we send? */
1234:lwIP/src/apps/http/httpd.c ****   len = altcp_sndbuf(pcb);
1235:lwIP/src/apps/http/httpd.c **** 
1236:lwIP/src/apps/http/httpd.c ****   /* Do we have remaining data to send before parsing more? */
1237:lwIP/src/apps/http/httpd.c ****   if (ssi->parsed > hs->file) {
1238:lwIP/src/apps/http/httpd.c ****     len = (u16_t)LWIP_MIN(ssi->parsed - hs->file, 0xffff);
1239:lwIP/src/apps/http/httpd.c **** 
1240:lwIP/src/apps/http/httpd.c ****     err = http_write(pcb, hs->file, &len, HTTP_IS_DATA_VOLATILE(hs));
1241:lwIP/src/apps/http/httpd.c ****     if (err == ERR_OK) {
1242:lwIP/src/apps/http/httpd.c ****       data_to_send = 1;
1243:lwIP/src/apps/http/httpd.c ****       hs->file += len;
1244:lwIP/src/apps/http/httpd.c ****       hs->left -= len;
1245:lwIP/src/apps/http/httpd.c ****     }
1246:lwIP/src/apps/http/httpd.c **** 
1247:lwIP/src/apps/http/httpd.c ****     /* If the send buffer is full, return now. */
1248:lwIP/src/apps/http/httpd.c ****     if (altcp_sndbuf(pcb) == 0) {
1249:lwIP/src/apps/http/httpd.c ****       return data_to_send;
1250:lwIP/src/apps/http/httpd.c ****     }
1251:lwIP/src/apps/http/httpd.c ****   }
1252:lwIP/src/apps/http/httpd.c **** 
1253:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("State %d, %d left\n", ssi->tag_state, (int)ssi->parse_left));
1254:lwIP/src/apps/http/httpd.c **** 
1255:lwIP/src/apps/http/httpd.c ****   /* We have sent all the data that was already parsed so continue parsing
1256:lwIP/src/apps/http/httpd.c ****    * the buffer contents looking for SSI tags. */
1257:lwIP/src/apps/http/httpd.c ****   while (((ssi->tag_state == TAG_SENDING) || ssi->parse_left) && (err == ERR_OK)) {
1258:lwIP/src/apps/http/httpd.c ****     if (len == 0) {
1259:lwIP/src/apps/http/httpd.c ****       return data_to_send;
1260:lwIP/src/apps/http/httpd.c ****     }
1261:lwIP/src/apps/http/httpd.c ****     switch (ssi->tag_state) {
1262:lwIP/src/apps/http/httpd.c ****       case TAG_NONE:
1263:lwIP/src/apps/http/httpd.c ****         /* We are not currently processing an SSI tag so scan for the
1264:lwIP/src/apps/http/httpd.c ****          * start of the lead-in marker. */
1265:lwIP/src/apps/http/httpd.c ****         for (tag_type = 0; tag_type < LWIP_ARRAYSIZE(http_ssi_tag_desc); tag_type++) {
1266:lwIP/src/apps/http/httpd.c ****           if (*ssi->parsed == http_ssi_tag_desc[tag_type].lead_in[0]) {
1267:lwIP/src/apps/http/httpd.c ****             /* We found what could be the lead-in for a new tag so change
1268:lwIP/src/apps/http/httpd.c ****              * state appropriately. */
1269:lwIP/src/apps/http/httpd.c ****             ssi->tag_type = tag_type;
1270:lwIP/src/apps/http/httpd.c ****             ssi->tag_state = TAG_LEADIN;
1271:lwIP/src/apps/http/httpd.c ****             ssi->tag_index = 1;
1272:lwIP/src/apps/http/httpd.c ****   #if !LWIP_HTTPD_SSI_INCLUDE_TAG
1273:lwIP/src/apps/http/httpd.c ****             ssi->tag_started = ssi->parsed;
1274:lwIP/src/apps/http/httpd.c ****   #endif /* !LWIP_HTTPD_SSI_INCLUDE_TAG */
1275:lwIP/src/apps/http/httpd.c ****             break;
1276:lwIP/src/apps/http/httpd.c ****           }
1277:lwIP/src/apps/http/httpd.c ****         }
1278:lwIP/src/apps/http/httpd.c **** 
1279:lwIP/src/apps/http/httpd.c ****         /* Move on to the next character in the buffer */
1280:lwIP/src/apps/http/httpd.c ****         ssi->parse_left--;
1281:lwIP/src/apps/http/httpd.c ****         ssi->parsed++;
1282:lwIP/src/apps/http/httpd.c ****         break;
1283:lwIP/src/apps/http/httpd.c **** 
ARM GAS  /tmp/ccQlnpyR.s 			page 24


1284:lwIP/src/apps/http/httpd.c ****       case TAG_LEADIN:
1285:lwIP/src/apps/http/httpd.c ****         /* We are processing the lead-in marker, looking for the start of
1286:lwIP/src/apps/http/httpd.c ****          * the tag name. */
1287:lwIP/src/apps/http/httpd.c **** 
1288:lwIP/src/apps/http/httpd.c ****         /* Have we reached the end of the leadin? */
1289:lwIP/src/apps/http/httpd.c ****         if (http_ssi_tag_desc[ssi->tag_type].lead_in[ssi->tag_index] == 0) {
1290:lwIP/src/apps/http/httpd.c ****           ssi->tag_index = 0;
1291:lwIP/src/apps/http/httpd.c ****           ssi->tag_state = TAG_FOUND;
1292:lwIP/src/apps/http/httpd.c ****         } else {
1293:lwIP/src/apps/http/httpd.c ****           /* Have we found the next character we expect for the tag leadin? */
1294:lwIP/src/apps/http/httpd.c ****           if (*ssi->parsed == http_ssi_tag_desc[ssi->tag_type].lead_in[ssi->tag_index]) {
1295:lwIP/src/apps/http/httpd.c ****             /* Yes - move to the next one unless we have found the complete
1296:lwIP/src/apps/http/httpd.c ****              * leadin, in which case we start looking for the tag itself */
1297:lwIP/src/apps/http/httpd.c ****             ssi->tag_index++;
1298:lwIP/src/apps/http/httpd.c ****           } else {
1299:lwIP/src/apps/http/httpd.c ****             /* We found an unexpected character so this is not a tag. Move
1300:lwIP/src/apps/http/httpd.c ****              * back to idle state. */
1301:lwIP/src/apps/http/httpd.c ****             ssi->tag_state = TAG_NONE;
1302:lwIP/src/apps/http/httpd.c ****           }
1303:lwIP/src/apps/http/httpd.c **** 
1304:lwIP/src/apps/http/httpd.c ****           /* Move on to the next character in the buffer */
1305:lwIP/src/apps/http/httpd.c ****           ssi->parse_left--;
1306:lwIP/src/apps/http/httpd.c ****           ssi->parsed++;
1307:lwIP/src/apps/http/httpd.c ****         }
1308:lwIP/src/apps/http/httpd.c ****         break;
1309:lwIP/src/apps/http/httpd.c **** 
1310:lwIP/src/apps/http/httpd.c ****       case TAG_FOUND:
1311:lwIP/src/apps/http/httpd.c ****         /* We are reading the tag name, looking for the start of the
1312:lwIP/src/apps/http/httpd.c ****          * lead-out marker and removing any whitespace found. */
1313:lwIP/src/apps/http/httpd.c **** 
1314:lwIP/src/apps/http/httpd.c ****         /* Remove leading whitespace between the tag leading and the first
1315:lwIP/src/apps/http/httpd.c ****          * tag name character. */
1316:lwIP/src/apps/http/httpd.c ****         if ((ssi->tag_index == 0) && ((*ssi->parsed == ' ') ||
1317:lwIP/src/apps/http/httpd.c ****                                       (*ssi->parsed == '\t') || (*ssi->parsed == '\n') ||
1318:lwIP/src/apps/http/httpd.c ****                                       (*ssi->parsed == '\r'))) {
1319:lwIP/src/apps/http/httpd.c ****           /* Move on to the next character in the buffer */
1320:lwIP/src/apps/http/httpd.c ****           ssi->parse_left--;
1321:lwIP/src/apps/http/httpd.c ****           ssi->parsed++;
1322:lwIP/src/apps/http/httpd.c ****           break;
1323:lwIP/src/apps/http/httpd.c ****         }
1324:lwIP/src/apps/http/httpd.c **** 
1325:lwIP/src/apps/http/httpd.c ****         /* Have we found the end of the tag name? This is signalled by
1326:lwIP/src/apps/http/httpd.c ****          * us finding the first leadout character or whitespace */
1327:lwIP/src/apps/http/httpd.c ****         if ((*ssi->parsed == http_ssi_tag_desc[ssi->tag_type].lead_out[0]) ||
1328:lwIP/src/apps/http/httpd.c ****             (*ssi->parsed == ' ')  || (*ssi->parsed == '\t') ||
1329:lwIP/src/apps/http/httpd.c ****             (*ssi->parsed == '\n') || (*ssi->parsed == '\r')) {
1330:lwIP/src/apps/http/httpd.c **** 
1331:lwIP/src/apps/http/httpd.c ****           if (ssi->tag_index == 0) {
1332:lwIP/src/apps/http/httpd.c ****             /* We read a zero length tag so ignore it. */
1333:lwIP/src/apps/http/httpd.c ****             ssi->tag_state = TAG_NONE;
1334:lwIP/src/apps/http/httpd.c ****           } else {
1335:lwIP/src/apps/http/httpd.c ****             /* We read a non-empty tag so go ahead and look for the
1336:lwIP/src/apps/http/httpd.c ****              * leadout string. */
1337:lwIP/src/apps/http/httpd.c ****             ssi->tag_state = TAG_LEADOUT;
1338:lwIP/src/apps/http/httpd.c ****             LWIP_ASSERT("ssi->tag_index <= 0xff", ssi->tag_index <= 0xff);
1339:lwIP/src/apps/http/httpd.c ****             ssi->tag_name_len = (u8_t)ssi->tag_index;
1340:lwIP/src/apps/http/httpd.c ****             ssi->tag_name[ssi->tag_index] = '\0';
ARM GAS  /tmp/ccQlnpyR.s 			page 25


1341:lwIP/src/apps/http/httpd.c ****             if (*ssi->parsed == http_ssi_tag_desc[ssi->tag_type].lead_out[0]) {
1342:lwIP/src/apps/http/httpd.c ****               ssi->tag_index = 1;
1343:lwIP/src/apps/http/httpd.c ****             } else {
1344:lwIP/src/apps/http/httpd.c ****               ssi->tag_index = 0;
1345:lwIP/src/apps/http/httpd.c ****             }
1346:lwIP/src/apps/http/httpd.c ****           }
1347:lwIP/src/apps/http/httpd.c ****         } else {
1348:lwIP/src/apps/http/httpd.c ****           /* This character is part of the tag name so save it */
1349:lwIP/src/apps/http/httpd.c ****           if (ssi->tag_index < LWIP_HTTPD_MAX_TAG_NAME_LEN) {
1350:lwIP/src/apps/http/httpd.c ****             ssi->tag_name[ssi->tag_index++] = *ssi->parsed;
1351:lwIP/src/apps/http/httpd.c ****           } else {
1352:lwIP/src/apps/http/httpd.c ****             /* The tag was too long so ignore it. */
1353:lwIP/src/apps/http/httpd.c ****             ssi->tag_state = TAG_NONE;
1354:lwIP/src/apps/http/httpd.c ****           }
1355:lwIP/src/apps/http/httpd.c ****         }
1356:lwIP/src/apps/http/httpd.c **** 
1357:lwIP/src/apps/http/httpd.c ****         /* Move on to the next character in the buffer */
1358:lwIP/src/apps/http/httpd.c ****         ssi->parse_left--;
1359:lwIP/src/apps/http/httpd.c ****         ssi->parsed++;
1360:lwIP/src/apps/http/httpd.c **** 
1361:lwIP/src/apps/http/httpd.c ****         break;
1362:lwIP/src/apps/http/httpd.c **** 
1363:lwIP/src/apps/http/httpd.c ****       /* We are looking for the end of the lead-out marker. */
1364:lwIP/src/apps/http/httpd.c ****       case TAG_LEADOUT:
1365:lwIP/src/apps/http/httpd.c ****         /* Remove leading whitespace between the tag leading and the first
1366:lwIP/src/apps/http/httpd.c ****          * tag leadout character. */
1367:lwIP/src/apps/http/httpd.c ****         if ((ssi->tag_index == 0) && ((*ssi->parsed == ' ') ||
1368:lwIP/src/apps/http/httpd.c ****                                       (*ssi->parsed == '\t') || (*ssi->parsed == '\n') ||
1369:lwIP/src/apps/http/httpd.c ****                                       (*ssi->parsed == '\r'))) {
1370:lwIP/src/apps/http/httpd.c ****           /* Move on to the next character in the buffer */
1371:lwIP/src/apps/http/httpd.c ****           ssi->parse_left--;
1372:lwIP/src/apps/http/httpd.c ****           ssi->parsed++;
1373:lwIP/src/apps/http/httpd.c ****           break;
1374:lwIP/src/apps/http/httpd.c ****         }
1375:lwIP/src/apps/http/httpd.c **** 
1376:lwIP/src/apps/http/httpd.c ****         /* Have we found the next character we expect for the tag leadout? */
1377:lwIP/src/apps/http/httpd.c ****         if (*ssi->parsed == http_ssi_tag_desc[ssi->tag_type].lead_out[ssi->tag_index]) {
1378:lwIP/src/apps/http/httpd.c ****           /* Yes - move to the next one unless we have found the complete
1379:lwIP/src/apps/http/httpd.c ****            * leadout, in which case we need to call the client to process
1380:lwIP/src/apps/http/httpd.c ****            * the tag. */
1381:lwIP/src/apps/http/httpd.c **** 
1382:lwIP/src/apps/http/httpd.c ****           /* Move on to the next character in the buffer */
1383:lwIP/src/apps/http/httpd.c ****           ssi->parse_left--;
1384:lwIP/src/apps/http/httpd.c ****           ssi->parsed++;
1385:lwIP/src/apps/http/httpd.c ****           ssi->tag_index++;
1386:lwIP/src/apps/http/httpd.c **** 
1387:lwIP/src/apps/http/httpd.c ****           if (http_ssi_tag_desc[ssi->tag_type].lead_out[ssi->tag_index] == 0) {
1388:lwIP/src/apps/http/httpd.c ****             /* Call the client to ask for the insert string for the
1389:lwIP/src/apps/http/httpd.c ****              * tag we just found. */
1390:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
1391:lwIP/src/apps/http/httpd.c ****             ssi->tag_part = 0; /* start with tag part 0 */
1392:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
1393:lwIP/src/apps/http/httpd.c ****             get_tag_insert(hs);
1394:lwIP/src/apps/http/httpd.c **** 
1395:lwIP/src/apps/http/httpd.c ****             /* Next time through, we are going to be sending data
1396:lwIP/src/apps/http/httpd.c ****              * immediately, either the end of the block we start
1397:lwIP/src/apps/http/httpd.c ****              * sending here or the insert string. */
ARM GAS  /tmp/ccQlnpyR.s 			page 26


1398:lwIP/src/apps/http/httpd.c ****             ssi->tag_index = 0;
1399:lwIP/src/apps/http/httpd.c ****             ssi->tag_state = TAG_SENDING;
1400:lwIP/src/apps/http/httpd.c ****             ssi->tag_end = ssi->parsed;
1401:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_INCLUDE_TAG
1402:lwIP/src/apps/http/httpd.c ****             ssi->parsed = ssi->tag_started;
1403:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_INCLUDE_TAG*/
1404:lwIP/src/apps/http/httpd.c **** 
1405:lwIP/src/apps/http/httpd.c ****             /* If there is any unsent data in the buffer prior to the
1406:lwIP/src/apps/http/httpd.c ****              * tag, we need to send it now. */
1407:lwIP/src/apps/http/httpd.c ****             if (ssi->tag_end > hs->file) {
1408:lwIP/src/apps/http/httpd.c ****               /* How much of the data can we send? */
1409:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_INCLUDE_TAG
1410:lwIP/src/apps/http/httpd.c ****               len = (u16_t)LWIP_MIN(ssi->tag_end - hs->file, 0xffff);
1411:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SSI_INCLUDE_TAG*/
1412:lwIP/src/apps/http/httpd.c ****               /* we would include the tag in sending */
1413:lwIP/src/apps/http/httpd.c ****               len = (u16_t)LWIP_MIN(ssi->tag_started - hs->file, 0xffff);
1414:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_INCLUDE_TAG*/
1415:lwIP/src/apps/http/httpd.c **** 
1416:lwIP/src/apps/http/httpd.c ****               err = http_write(pcb, hs->file, &len, HTTP_IS_DATA_VOLATILE(hs));
1417:lwIP/src/apps/http/httpd.c ****               if (err == ERR_OK) {
1418:lwIP/src/apps/http/httpd.c ****                 data_to_send = 1;
1419:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_INCLUDE_TAG
1420:lwIP/src/apps/http/httpd.c ****                 if (ssi->tag_started <= hs->file) {
1421:lwIP/src/apps/http/httpd.c ****                   /* pretend to have sent the tag, too */
1422:lwIP/src/apps/http/httpd.c ****                   len += (u16_t)(ssi->tag_end - ssi->tag_started);
1423:lwIP/src/apps/http/httpd.c ****                 }
1424:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_INCLUDE_TAG*/
1425:lwIP/src/apps/http/httpd.c ****                 hs->file += len;
1426:lwIP/src/apps/http/httpd.c ****                 hs->left -= len;
1427:lwIP/src/apps/http/httpd.c ****               }
1428:lwIP/src/apps/http/httpd.c ****             }
1429:lwIP/src/apps/http/httpd.c ****           }
1430:lwIP/src/apps/http/httpd.c ****         } else {
1431:lwIP/src/apps/http/httpd.c ****           /* We found an unexpected character so this is not a tag. Move
1432:lwIP/src/apps/http/httpd.c ****            * back to idle state. */
1433:lwIP/src/apps/http/httpd.c ****           ssi->parse_left--;
1434:lwIP/src/apps/http/httpd.c ****           ssi->parsed++;
1435:lwIP/src/apps/http/httpd.c ****           ssi->tag_state = TAG_NONE;
1436:lwIP/src/apps/http/httpd.c ****         }
1437:lwIP/src/apps/http/httpd.c ****         break;
1438:lwIP/src/apps/http/httpd.c **** 
1439:lwIP/src/apps/http/httpd.c ****       /*
1440:lwIP/src/apps/http/httpd.c ****        * We have found a valid tag and are in the process of sending
1441:lwIP/src/apps/http/httpd.c ****        * data as a result of that discovery. We send either remaining data
1442:lwIP/src/apps/http/httpd.c ****        * from the file prior to the insert point or the insert string itself.
1443:lwIP/src/apps/http/httpd.c ****        */
1444:lwIP/src/apps/http/httpd.c ****       case TAG_SENDING:
1445:lwIP/src/apps/http/httpd.c ****         /* Do we have any remaining file data to send from the buffer prior
1446:lwIP/src/apps/http/httpd.c ****          * to the tag? */
1447:lwIP/src/apps/http/httpd.c ****         if (ssi->tag_end > hs->file) {
1448:lwIP/src/apps/http/httpd.c ****           /* How much of the data can we send? */
1449:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_INCLUDE_TAG
1450:lwIP/src/apps/http/httpd.c ****           len = (u16_t)LWIP_MIN(ssi->tag_end - hs->file, 0xffff);
1451:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SSI_INCLUDE_TAG*/
1452:lwIP/src/apps/http/httpd.c ****           LWIP_ASSERT("hs->started >= hs->file", ssi->tag_started >= hs->file);
1453:lwIP/src/apps/http/httpd.c ****           /* we would include the tag in sending */
1454:lwIP/src/apps/http/httpd.c ****           len = (u16_t)LWIP_MIN(ssi->tag_started - hs->file, 0xffff);
ARM GAS  /tmp/ccQlnpyR.s 			page 27


1455:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_INCLUDE_TAG*/
1456:lwIP/src/apps/http/httpd.c ****           if (len != 0) {
1457:lwIP/src/apps/http/httpd.c ****             err = http_write(pcb, hs->file, &len, HTTP_IS_DATA_VOLATILE(hs));
1458:lwIP/src/apps/http/httpd.c ****           } else {
1459:lwIP/src/apps/http/httpd.c ****             err = ERR_OK;
1460:lwIP/src/apps/http/httpd.c ****           }
1461:lwIP/src/apps/http/httpd.c ****           if (err == ERR_OK) {
1462:lwIP/src/apps/http/httpd.c ****             data_to_send = 1;
1463:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_INCLUDE_TAG
1464:lwIP/src/apps/http/httpd.c ****             if (ssi->tag_started <= hs->file) {
1465:lwIP/src/apps/http/httpd.c ****               /* pretend to have sent the tag, too */
1466:lwIP/src/apps/http/httpd.c ****               len += (u16_t)(ssi->tag_end - ssi->tag_started);
1467:lwIP/src/apps/http/httpd.c ****             }
1468:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_INCLUDE_TAG*/
1469:lwIP/src/apps/http/httpd.c ****             hs->file += len;
1470:lwIP/src/apps/http/httpd.c ****             hs->left -= len;
1471:lwIP/src/apps/http/httpd.c ****           }
1472:lwIP/src/apps/http/httpd.c ****         } else {
1473:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
1474:lwIP/src/apps/http/httpd.c ****           if (ssi->tag_index >= ssi->tag_insert_len) {
1475:lwIP/src/apps/http/httpd.c ****             /* Did the last SSIHandler have more to send? */
1476:lwIP/src/apps/http/httpd.c ****             if (ssi->tag_part != HTTPD_LAST_TAG_PART) {
1477:lwIP/src/apps/http/httpd.c ****               /* If so, call it again */
1478:lwIP/src/apps/http/httpd.c ****               ssi->tag_index = 0;
1479:lwIP/src/apps/http/httpd.c ****               get_tag_insert(hs);
1480:lwIP/src/apps/http/httpd.c ****             }
1481:lwIP/src/apps/http/httpd.c ****           }
1482:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
1483:lwIP/src/apps/http/httpd.c **** 
1484:lwIP/src/apps/http/httpd.c ****           /* Do we still have insert data left to send? */
1485:lwIP/src/apps/http/httpd.c ****           if (ssi->tag_index < ssi->tag_insert_len) {
1486:lwIP/src/apps/http/httpd.c ****             /* We are sending the insert string itself. How much of the
1487:lwIP/src/apps/http/httpd.c ****              * insert can we send? */
1488:lwIP/src/apps/http/httpd.c ****             len = (ssi->tag_insert_len - ssi->tag_index);
1489:lwIP/src/apps/http/httpd.c **** 
1490:lwIP/src/apps/http/httpd.c ****             /* Note that we set the copy flag here since we only have a
1491:lwIP/src/apps/http/httpd.c ****              * single tag insert buffer per connection. If we don't do
1492:lwIP/src/apps/http/httpd.c ****              * this, insert corruption can occur if more than one insert
1493:lwIP/src/apps/http/httpd.c ****              * is processed before we call tcp_output. */
1494:lwIP/src/apps/http/httpd.c ****             err = http_write(pcb, &(ssi->tag_insert[ssi->tag_index]), &len,
1495:lwIP/src/apps/http/httpd.c ****                              HTTP_IS_TAG_VOLATILE(hs));
1496:lwIP/src/apps/http/httpd.c ****             if (err == ERR_OK) {
1497:lwIP/src/apps/http/httpd.c ****               data_to_send = 1;
1498:lwIP/src/apps/http/httpd.c ****               ssi->tag_index += len;
1499:lwIP/src/apps/http/httpd.c ****               /* Don't return here: keep on sending data */
1500:lwIP/src/apps/http/httpd.c ****             }
1501:lwIP/src/apps/http/httpd.c ****           } else {
1502:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_MULTIPART
1503:lwIP/src/apps/http/httpd.c ****             if (ssi->tag_part == HTTPD_LAST_TAG_PART)
1504:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_MULTIPART */
1505:lwIP/src/apps/http/httpd.c ****             {
1506:lwIP/src/apps/http/httpd.c ****               /* We have sent all the insert data so go back to looking for
1507:lwIP/src/apps/http/httpd.c ****                * a new tag. */
1508:lwIP/src/apps/http/httpd.c ****               LWIP_DEBUGF(HTTPD_DEBUG, ("Everything sent.\n"));
1509:lwIP/src/apps/http/httpd.c ****               ssi->tag_index = 0;
1510:lwIP/src/apps/http/httpd.c ****               ssi->tag_state = TAG_NONE;
1511:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI_INCLUDE_TAG
ARM GAS  /tmp/ccQlnpyR.s 			page 28


1512:lwIP/src/apps/http/httpd.c ****               ssi->parsed = ssi->tag_end;
1513:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI_INCLUDE_TAG*/
1514:lwIP/src/apps/http/httpd.c ****             }
1515:lwIP/src/apps/http/httpd.c ****           }
1516:lwIP/src/apps/http/httpd.c ****           break;
1517:lwIP/src/apps/http/httpd.c ****         default:
1518:lwIP/src/apps/http/httpd.c ****           break;
1519:lwIP/src/apps/http/httpd.c ****         }
1520:lwIP/src/apps/http/httpd.c ****     }
1521:lwIP/src/apps/http/httpd.c ****   }
1522:lwIP/src/apps/http/httpd.c **** 
1523:lwIP/src/apps/http/httpd.c ****   /* If we drop out of the end of the for loop, this implies we must have
1524:lwIP/src/apps/http/httpd.c ****    * file data to send so send it now. In TAG_SENDING state, we've already
1525:lwIP/src/apps/http/httpd.c ****    * handled this so skip the send if that's the case. */
1526:lwIP/src/apps/http/httpd.c ****   if ((ssi->tag_state != TAG_SENDING) && (ssi->parsed > hs->file)) {
1527:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ && !LWIP_HTTPD_SSI_INCLUDE_TAG
1528:lwIP/src/apps/http/httpd.c ****     if ((ssi->tag_state != TAG_NONE) && (ssi->tag_started > ssi->tag_end)) {
1529:lwIP/src/apps/http/httpd.c ****       /* If we found tag on the edge of the read buffer: just throw away the first part
1530:lwIP/src/apps/http/httpd.c ****          (we have copied/saved everything required for parsing on later). */
1531:lwIP/src/apps/http/httpd.c ****       len = (u16_t)(ssi->tag_started - hs->file);
1532:lwIP/src/apps/http/httpd.c ****       hs->left -= (ssi->parsed - ssi->tag_started);
1533:lwIP/src/apps/http/httpd.c ****       ssi->parsed = ssi->tag_started;
1534:lwIP/src/apps/http/httpd.c ****       ssi->tag_started = hs->buf;
1535:lwIP/src/apps/http/httpd.c ****     } else
1536:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_FILE_READ && !LWIP_HTTPD_SSI_INCLUDE_TAG */
1537:lwIP/src/apps/http/httpd.c ****     {
1538:lwIP/src/apps/http/httpd.c ****       len = (u16_t)LWIP_MIN(ssi->parsed - hs->file, 0xffff);
1539:lwIP/src/apps/http/httpd.c ****     }
1540:lwIP/src/apps/http/httpd.c **** 
1541:lwIP/src/apps/http/httpd.c ****     err = http_write(pcb, hs->file, &len, HTTP_IS_DATA_VOLATILE(hs));
1542:lwIP/src/apps/http/httpd.c ****     if (err == ERR_OK) {
1543:lwIP/src/apps/http/httpd.c ****       data_to_send = 1;
1544:lwIP/src/apps/http/httpd.c ****       hs->file += len;
1545:lwIP/src/apps/http/httpd.c ****       hs->left -= len;
1546:lwIP/src/apps/http/httpd.c ****     }
1547:lwIP/src/apps/http/httpd.c ****   }
1548:lwIP/src/apps/http/httpd.c ****   return data_to_send;
1549:lwIP/src/apps/http/httpd.c **** }
1550:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
1551:lwIP/src/apps/http/httpd.c **** 
1552:lwIP/src/apps/http/httpd.c **** /**
1553:lwIP/src/apps/http/httpd.c ****  * Try to send more data on this pcb.
1554:lwIP/src/apps/http/httpd.c ****  *
1555:lwIP/src/apps/http/httpd.c ****  * @param pcb the pcb to send data
1556:lwIP/src/apps/http/httpd.c ****  * @param hs connection state
1557:lwIP/src/apps/http/httpd.c ****  */
1558:lwIP/src/apps/http/httpd.c **** static u8_t
1559:lwIP/src/apps/http/httpd.c **** http_send(struct altcp_pcb *pcb, struct http_state *hs)
1560:lwIP/src/apps/http/httpd.c **** {
1561:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = HTTP_NO_DATA_TO_SEND;
1562:lwIP/src/apps/http/httpd.c **** 
1563:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_send: pcb=%p hs=%p left=%d\n", (void *)pcb,
1564:lwIP/src/apps/http/httpd.c ****               (void *)hs, hs != NULL ? (int)hs->left : 0));
1565:lwIP/src/apps/http/httpd.c **** 
1566:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND
1567:lwIP/src/apps/http/httpd.c ****   if (hs->unrecved_bytes != 0) {
1568:lwIP/src/apps/http/httpd.c ****     return 0;
ARM GAS  /tmp/ccQlnpyR.s 			page 29


1569:lwIP/src/apps/http/httpd.c ****   }
1570:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND */
1571:lwIP/src/apps/http/httpd.c **** 
1572:lwIP/src/apps/http/httpd.c ****   /* If we were passed a NULL state structure pointer, ignore the call. */
1573:lwIP/src/apps/http/httpd.c ****   if (hs == NULL) {
1574:lwIP/src/apps/http/httpd.c ****     return 0;
1575:lwIP/src/apps/http/httpd.c ****   }
1576:lwIP/src/apps/http/httpd.c **** 
1577:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_FS_ASYNC_READ
1578:lwIP/src/apps/http/httpd.c ****   /* Check if we are allowed to read from this file.
1579:lwIP/src/apps/http/httpd.c ****      (e.g. SSI might want to delay sending until data is available) */
1580:lwIP/src/apps/http/httpd.c ****   if (!fs_is_file_ready(hs->handle, http_continue, hs)) {
1581:lwIP/src/apps/http/httpd.c ****     return 0;
1582:lwIP/src/apps/http/httpd.c ****   }
1583:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_FS_ASYNC_READ */
1584:lwIP/src/apps/http/httpd.c **** 
1585:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
1586:lwIP/src/apps/http/httpd.c ****   /* Do we have any more header data to send for this file? */
1587:lwIP/src/apps/http/httpd.c ****   if (hs->hdr_index < NUM_FILE_HDR_STRINGS) {
1588:lwIP/src/apps/http/httpd.c ****     data_to_send = http_send_headers(pcb, hs);
1589:lwIP/src/apps/http/httpd.c ****     if ((data_to_send == HTTP_DATA_TO_SEND_FREED) ||
1590:lwIP/src/apps/http/httpd.c ****         ((data_to_send != HTTP_DATA_TO_SEND_CONTINUE) &&
1591:lwIP/src/apps/http/httpd.c ****          (hs->hdr_index < NUM_FILE_HDR_STRINGS))) {
1592:lwIP/src/apps/http/httpd.c ****       return data_to_send;
1593:lwIP/src/apps/http/httpd.c ****     }
1594:lwIP/src/apps/http/httpd.c ****   }
1595:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_HEADERS */
1596:lwIP/src/apps/http/httpd.c **** 
1597:lwIP/src/apps/http/httpd.c ****   /* Have we run out of file data to send? If so, we need to read the next
1598:lwIP/src/apps/http/httpd.c ****    * block from the file. */
1599:lwIP/src/apps/http/httpd.c ****   if (hs->left == 0) {
1600:lwIP/src/apps/http/httpd.c ****     if (!http_check_eof(pcb, hs)) {
1601:lwIP/src/apps/http/httpd.c ****       return 0;
1602:lwIP/src/apps/http/httpd.c ****     }
1603:lwIP/src/apps/http/httpd.c ****   }
1604:lwIP/src/apps/http/httpd.c **** 
1605:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
1606:lwIP/src/apps/http/httpd.c ****   if (hs->ssi) {
1607:lwIP/src/apps/http/httpd.c ****     data_to_send = http_send_data_ssi(pcb, hs);
1608:lwIP/src/apps/http/httpd.c ****   } else
1609:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
1610:lwIP/src/apps/http/httpd.c ****   {
1611:lwIP/src/apps/http/httpd.c ****     data_to_send = http_send_data_nonssi(pcb, hs);
1612:lwIP/src/apps/http/httpd.c ****   }
1613:lwIP/src/apps/http/httpd.c **** 
1614:lwIP/src/apps/http/httpd.c ****   if ((hs->left == 0) && (fs_bytes_left(hs->handle) <= 0)) {
1615:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
1616:lwIP/src/apps/http/httpd.c ****      * This adds the FIN flag right into the last data segment. */
1617:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("End of file.\n"));
1618:lwIP/src/apps/http/httpd.c ****     http_eof(pcb, hs);
1619:lwIP/src/apps/http/httpd.c ****     return 0;
1620:lwIP/src/apps/http/httpd.c ****   }
1621:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("send_data end.\n"));
1622:lwIP/src/apps/http/httpd.c ****   return data_to_send;
1623:lwIP/src/apps/http/httpd.c **** }
1624:lwIP/src/apps/http/httpd.c **** 
1625:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_EXTSTATUS
ARM GAS  /tmp/ccQlnpyR.s 			page 30


1626:lwIP/src/apps/http/httpd.c **** /** Initialize a http connection with a file to send for an error message
1627:lwIP/src/apps/http/httpd.c ****  *
1628:lwIP/src/apps/http/httpd.c ****  * @param hs http connection state
1629:lwIP/src/apps/http/httpd.c ****  * @param error_nr HTTP error number
1630:lwIP/src/apps/http/httpd.c ****  * @return ERR_OK if file was found and hs has been initialized correctly
1631:lwIP/src/apps/http/httpd.c ****  *         another err_t otherwise
1632:lwIP/src/apps/http/httpd.c ****  */
1633:lwIP/src/apps/http/httpd.c **** static err_t
1634:lwIP/src/apps/http/httpd.c **** http_find_error_file(struct http_state *hs, u16_t error_nr)
1635:lwIP/src/apps/http/httpd.c **** {
1636:lwIP/src/apps/http/httpd.c ****   const char *uri, *uri1, *uri2, *uri3;
1637:lwIP/src/apps/http/httpd.c **** 
1638:lwIP/src/apps/http/httpd.c ****   if (error_nr == 501) {
1639:lwIP/src/apps/http/httpd.c ****     uri1 = "/501.html";
1640:lwIP/src/apps/http/httpd.c ****     uri2 = "/501.htm";
1641:lwIP/src/apps/http/httpd.c ****     uri3 = "/501.shtml";
1642:lwIP/src/apps/http/httpd.c ****   } else {
1643:lwIP/src/apps/http/httpd.c ****     /* 400 (bad request is the default) */
1644:lwIP/src/apps/http/httpd.c ****     uri1 = "/400.html";
1645:lwIP/src/apps/http/httpd.c ****     uri2 = "/400.htm";
1646:lwIP/src/apps/http/httpd.c ****     uri3 = "/400.shtml";
1647:lwIP/src/apps/http/httpd.c ****   }
1648:lwIP/src/apps/http/httpd.c ****   if (fs_open(&hs->file_handle, uri1) == ERR_OK) {
1649:lwIP/src/apps/http/httpd.c ****     uri = uri1;
1650:lwIP/src/apps/http/httpd.c ****   } else if (fs_open(&hs->file_handle, uri2) == ERR_OK) {
1651:lwIP/src/apps/http/httpd.c ****     uri = uri2;
1652:lwIP/src/apps/http/httpd.c ****   } else if (fs_open(&hs->file_handle, uri3) == ERR_OK) {
1653:lwIP/src/apps/http/httpd.c ****     uri = uri3;
1654:lwIP/src/apps/http/httpd.c ****   } else {
1655:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error page for error %"U16_F" not found\n",
1656:lwIP/src/apps/http/httpd.c ****                               error_nr));
1657:lwIP/src/apps/http/httpd.c ****     return ERR_ARG;
1658:lwIP/src/apps/http/httpd.c ****   }
1659:lwIP/src/apps/http/httpd.c ****   return http_init_file(hs, &hs->file_handle, 0, uri, 0, NULL);
1660:lwIP/src/apps/http/httpd.c **** }
1661:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SUPPORT_EXTSTATUS */
1662:lwIP/src/apps/http/httpd.c **** #define http_find_error_file(hs, error_nr) ERR_ARG
1663:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_EXTSTATUS */
1664:lwIP/src/apps/http/httpd.c **** 
1665:lwIP/src/apps/http/httpd.c **** /**
1666:lwIP/src/apps/http/httpd.c ****  * Get the file struct for a 404 error page.
1667:lwIP/src/apps/http/httpd.c ****  * Tries some file names and returns NULL if none found.
1668:lwIP/src/apps/http/httpd.c ****  *
1669:lwIP/src/apps/http/httpd.c ****  * @param uri pointer that receives the actual file name URI
1670:lwIP/src/apps/http/httpd.c ****  * @return file struct for the error page or NULL no matching file was found
1671:lwIP/src/apps/http/httpd.c ****  */
1672:lwIP/src/apps/http/httpd.c **** static struct fs_file *
1673:lwIP/src/apps/http/httpd.c **** http_get_404_file(struct http_state *hs, const char **uri)
1674:lwIP/src/apps/http/httpd.c **** {
1675:lwIP/src/apps/http/httpd.c ****   err_t err;
1676:lwIP/src/apps/http/httpd.c **** 
1677:lwIP/src/apps/http/httpd.c ****   *uri = "/404.html";
1678:lwIP/src/apps/http/httpd.c ****   err = fs_open(&hs->file_handle, *uri);
1679:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
1680:lwIP/src/apps/http/httpd.c ****     /* 404.html doesn't exist. Try 404.htm instead. */
1681:lwIP/src/apps/http/httpd.c ****     *uri = "/404.htm";
1682:lwIP/src/apps/http/httpd.c ****     err = fs_open(&hs->file_handle, *uri);
ARM GAS  /tmp/ccQlnpyR.s 			page 31


1683:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
1684:lwIP/src/apps/http/httpd.c ****       /* 404.htm doesn't exist either. Try 404.shtml instead. */
1685:lwIP/src/apps/http/httpd.c ****       *uri = "/404.shtml";
1686:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, *uri);
1687:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
1688:lwIP/src/apps/http/httpd.c ****         /* 404.htm doesn't exist either. Indicate to the caller that it should
1689:lwIP/src/apps/http/httpd.c ****          * send back a default 404 page.
1690:lwIP/src/apps/http/httpd.c ****          */
1691:lwIP/src/apps/http/httpd.c ****         *uri = NULL;
1692:lwIP/src/apps/http/httpd.c ****         return NULL;
1693:lwIP/src/apps/http/httpd.c ****       }
1694:lwIP/src/apps/http/httpd.c ****     }
1695:lwIP/src/apps/http/httpd.c ****   }
1696:lwIP/src/apps/http/httpd.c **** 
1697:lwIP/src/apps/http/httpd.c ****   return &hs->file_handle;
1698:lwIP/src/apps/http/httpd.c **** }
1699:lwIP/src/apps/http/httpd.c **** 
1700:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
1701:lwIP/src/apps/http/httpd.c **** static err_t
1702:lwIP/src/apps/http/httpd.c **** http_handle_post_finished(struct http_state *hs)
1703:lwIP/src/apps/http/httpd.c **** {
1704:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MANUAL_WND
1705:lwIP/src/apps/http/httpd.c ****   /* Prevent multiple calls to httpd_post_finished, since it might have already
1706:lwIP/src/apps/http/httpd.c ****      been called before from httpd_post_data_recved(). */
1707:lwIP/src/apps/http/httpd.c ****   if (hs->post_finished) {
1708:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
1709:lwIP/src/apps/http/httpd.c ****   }
1710:lwIP/src/apps/http/httpd.c ****   hs->post_finished = 1;
1711:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_POST_MANUAL_WND */
1712:lwIP/src/apps/http/httpd.c ****   /* application error or POST finished */
1713:lwIP/src/apps/http/httpd.c ****   /* NULL-terminate the buffer */
1714:lwIP/src/apps/http/httpd.c ****   http_uri_buf[0] = 0;
1715:lwIP/src/apps/http/httpd.c ****   httpd_post_finished(hs, http_uri_buf, LWIP_HTTPD_URI_BUF_LEN);
1716:lwIP/src/apps/http/httpd.c ****   return http_find_file(hs, http_uri_buf, 0);
1717:lwIP/src/apps/http/httpd.c **** }
1718:lwIP/src/apps/http/httpd.c **** 
1719:lwIP/src/apps/http/httpd.c **** /** Pass received POST body data to the application and correctly handle
1720:lwIP/src/apps/http/httpd.c ****  * returning a response document or closing the connection.
1721:lwIP/src/apps/http/httpd.c ****  * ATTENTION: The application is responsible for the pbuf now, so don't free it!
1722:lwIP/src/apps/http/httpd.c ****  *
1723:lwIP/src/apps/http/httpd.c ****  * @param hs http connection state
1724:lwIP/src/apps/http/httpd.c ****  * @param p pbuf to pass to the application
1725:lwIP/src/apps/http/httpd.c ****  * @return ERR_OK if passed successfully, another err_t if the response file
1726:lwIP/src/apps/http/httpd.c ****  *         hasn't been found (after POST finished)
1727:lwIP/src/apps/http/httpd.c ****  */
1728:lwIP/src/apps/http/httpd.c **** static err_t
1729:lwIP/src/apps/http/httpd.c **** http_post_rxpbuf(struct http_state *hs, struct pbuf *p)
1730:lwIP/src/apps/http/httpd.c **** {
1731:lwIP/src/apps/http/httpd.c ****   err_t err;
1732:lwIP/src/apps/http/httpd.c **** 
1733:lwIP/src/apps/http/httpd.c ****   if (p != NULL) {
1734:lwIP/src/apps/http/httpd.c ****     /* adjust remaining Content-Length */
1735:lwIP/src/apps/http/httpd.c ****     if (hs->post_content_len_left < p->tot_len) {
1736:lwIP/src/apps/http/httpd.c ****       hs->post_content_len_left = 0;
1737:lwIP/src/apps/http/httpd.c ****     } else {
1738:lwIP/src/apps/http/httpd.c ****       hs->post_content_len_left -= p->tot_len;
1739:lwIP/src/apps/http/httpd.c ****     }
ARM GAS  /tmp/ccQlnpyR.s 			page 32


1740:lwIP/src/apps/http/httpd.c ****   }
1741:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND
1742:lwIP/src/apps/http/httpd.c ****   /* prevent connection being closed if httpd_post_data_recved() is called nested */
1743:lwIP/src/apps/http/httpd.c ****   hs->unrecved_bytes++;
1744:lwIP/src/apps/http/httpd.c **** #endif
1745:lwIP/src/apps/http/httpd.c ****   if (p != NULL) {
1746:lwIP/src/apps/http/httpd.c ****     err = httpd_post_receive_data(hs, p);
1747:lwIP/src/apps/http/httpd.c ****   } else {
1748:lwIP/src/apps/http/httpd.c ****     err = ERR_OK;
1749:lwIP/src/apps/http/httpd.c ****   }
1750:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND
1751:lwIP/src/apps/http/httpd.c ****   hs->unrecved_bytes--;
1752:lwIP/src/apps/http/httpd.c **** #endif
1753:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
1754:lwIP/src/apps/http/httpd.c ****     /* Ignore remaining content in case of application error */
1755:lwIP/src/apps/http/httpd.c ****     hs->post_content_len_left = 0;
1756:lwIP/src/apps/http/httpd.c ****   }
1757:lwIP/src/apps/http/httpd.c ****   if (hs->post_content_len_left == 0) {
1758:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND
1759:lwIP/src/apps/http/httpd.c ****     if (hs->unrecved_bytes != 0) {
1760:lwIP/src/apps/http/httpd.c ****       return ERR_OK;
1761:lwIP/src/apps/http/httpd.c ****     }
1762:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND */
1763:lwIP/src/apps/http/httpd.c ****     /* application error or POST finished */
1764:lwIP/src/apps/http/httpd.c ****     return http_handle_post_finished(hs);
1765:lwIP/src/apps/http/httpd.c ****   }
1766:lwIP/src/apps/http/httpd.c **** 
1767:lwIP/src/apps/http/httpd.c ****   return ERR_OK;
1768:lwIP/src/apps/http/httpd.c **** }
1769:lwIP/src/apps/http/httpd.c **** 
1770:lwIP/src/apps/http/httpd.c **** /** Handle a post request. Called from http_parse_request when method 'POST'
1771:lwIP/src/apps/http/httpd.c ****  * is found.
1772:lwIP/src/apps/http/httpd.c ****  *
1773:lwIP/src/apps/http/httpd.c ****  * @param p The input pbuf (containing the POST header and body).
1774:lwIP/src/apps/http/httpd.c ****  * @param hs The http connection state.
1775:lwIP/src/apps/http/httpd.c ****  * @param data HTTP request (header and part of body) from input pbuf(s).
1776:lwIP/src/apps/http/httpd.c ****  * @param data_len Size of 'data'.
1777:lwIP/src/apps/http/httpd.c ****  * @param uri The HTTP URI parsed from input pbuf(s).
1778:lwIP/src/apps/http/httpd.c ****  * @param uri_end Pointer to the end of 'uri' (here, the rest of the HTTP
1779:lwIP/src/apps/http/httpd.c ****  *                header starts).
1780:lwIP/src/apps/http/httpd.c ****  * @return ERR_OK: POST correctly parsed and accepted by the application.
1781:lwIP/src/apps/http/httpd.c ****  *         ERR_INPROGRESS: POST not completely parsed (no error yet)
1782:lwIP/src/apps/http/httpd.c ****  *         another err_t: Error parsing POST or denied by the application
1783:lwIP/src/apps/http/httpd.c ****  */
1784:lwIP/src/apps/http/httpd.c **** static err_t
1785:lwIP/src/apps/http/httpd.c **** http_post_request(struct pbuf *inp, struct http_state *hs,
1786:lwIP/src/apps/http/httpd.c ****                   char *data, u16_t data_len, char *uri, char *uri_end)
1787:lwIP/src/apps/http/httpd.c **** {
1788:lwIP/src/apps/http/httpd.c ****   err_t err;
1789:lwIP/src/apps/http/httpd.c ****   /* search for end-of-header (first double-CRLF) */
1790:lwIP/src/apps/http/httpd.c ****   char *crlfcrlf = lwip_strnstr(uri_end + 1, CRLF CRLF, data_len - (uri_end + 1 - data));
1791:lwIP/src/apps/http/httpd.c **** 
1792:lwIP/src/apps/http/httpd.c ****   if (crlfcrlf != NULL) {
1793:lwIP/src/apps/http/httpd.c ****     /* search for "Content-Length: " */
1794:lwIP/src/apps/http/httpd.c **** #define HTTP_HDR_CONTENT_LEN                "Content-Length: "
1795:lwIP/src/apps/http/httpd.c **** #define HTTP_HDR_CONTENT_LEN_LEN            16
1796:lwIP/src/apps/http/httpd.c **** #define HTTP_HDR_CONTENT_LEN_DIGIT_MAX_LEN  10
ARM GAS  /tmp/ccQlnpyR.s 			page 33


1797:lwIP/src/apps/http/httpd.c ****     char *scontent_len = lwip_strnstr(uri_end + 1, HTTP_HDR_CONTENT_LEN, crlfcrlf - (uri_end + 1));
1798:lwIP/src/apps/http/httpd.c ****     if (scontent_len != NULL) {
1799:lwIP/src/apps/http/httpd.c ****       char *scontent_len_end = lwip_strnstr(scontent_len + HTTP_HDR_CONTENT_LEN_LEN, CRLF, HTTP_HDR
1800:lwIP/src/apps/http/httpd.c ****       if (scontent_len_end != NULL) {
1801:lwIP/src/apps/http/httpd.c ****         int content_len;
1802:lwIP/src/apps/http/httpd.c ****         char *content_len_num = scontent_len + HTTP_HDR_CONTENT_LEN_LEN;
1803:lwIP/src/apps/http/httpd.c ****         content_len = atoi(content_len_num);
1804:lwIP/src/apps/http/httpd.c ****         if (content_len == 0) {
1805:lwIP/src/apps/http/httpd.c ****           /* if atoi returns 0 on error, fix this */
1806:lwIP/src/apps/http/httpd.c ****           if ((content_len_num[0] != '0') || (content_len_num[1] != '\r')) {
1807:lwIP/src/apps/http/httpd.c ****             content_len = -1;
1808:lwIP/src/apps/http/httpd.c ****           }
1809:lwIP/src/apps/http/httpd.c ****         }
1810:lwIP/src/apps/http/httpd.c ****         if (content_len >= 0) {
1811:lwIP/src/apps/http/httpd.c ****           /* adjust length of HTTP header passed to application */
1812:lwIP/src/apps/http/httpd.c ****           const char *hdr_start_after_uri = uri_end + 1;
1813:lwIP/src/apps/http/httpd.c ****           u16_t hdr_len = (u16_t)LWIP_MIN(data_len, crlfcrlf + 4 - data);
1814:lwIP/src/apps/http/httpd.c ****           u16_t hdr_data_len = (u16_t)LWIP_MIN(data_len, crlfcrlf + 4 - hdr_start_after_uri);
1815:lwIP/src/apps/http/httpd.c ****           u8_t post_auto_wnd = 1;
1816:lwIP/src/apps/http/httpd.c ****           http_uri_buf[0] = 0;
1817:lwIP/src/apps/http/httpd.c ****           /* trim http header */
1818:lwIP/src/apps/http/httpd.c ****           *crlfcrlf = 0;
1819:lwIP/src/apps/http/httpd.c ****           err = httpd_post_begin(hs, uri, hdr_start_after_uri, hdr_data_len, content_len,
1820:lwIP/src/apps/http/httpd.c ****                                  http_uri_buf, LWIP_HTTPD_URI_BUF_LEN, &post_auto_wnd);
1821:lwIP/src/apps/http/httpd.c ****           if (err == ERR_OK) {
1822:lwIP/src/apps/http/httpd.c ****             /* try to pass in data of the first pbuf(s) */
1823:lwIP/src/apps/http/httpd.c ****             struct pbuf *q = inp;
1824:lwIP/src/apps/http/httpd.c ****             u16_t start_offset = hdr_len;
1825:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MANUAL_WND
1826:lwIP/src/apps/http/httpd.c ****             hs->no_auto_wnd = !post_auto_wnd;
1827:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_POST_MANUAL_WND */
1828:lwIP/src/apps/http/httpd.c ****             /* set the Content-Length to be received for this POST */
1829:lwIP/src/apps/http/httpd.c ****             hs->post_content_len_left = (u32_t)content_len;
1830:lwIP/src/apps/http/httpd.c **** 
1831:lwIP/src/apps/http/httpd.c ****             /* get to the pbuf where the body starts */
1832:lwIP/src/apps/http/httpd.c ****             while ((q != NULL) && (q->len <= start_offset)) {
1833:lwIP/src/apps/http/httpd.c ****               start_offset -= q->len;
1834:lwIP/src/apps/http/httpd.c ****               q = q->next;
1835:lwIP/src/apps/http/httpd.c ****             }
1836:lwIP/src/apps/http/httpd.c ****             if (q != NULL) {
1837:lwIP/src/apps/http/httpd.c ****               /* hide the remaining HTTP header */
1838:lwIP/src/apps/http/httpd.c ****               pbuf_remove_header(q, start_offset);
1839:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MANUAL_WND
1840:lwIP/src/apps/http/httpd.c ****               if (!post_auto_wnd) {
1841:lwIP/src/apps/http/httpd.c ****                 /* already tcp_recved() this data... */
1842:lwIP/src/apps/http/httpd.c ****                 hs->unrecved_bytes = q->tot_len;
1843:lwIP/src/apps/http/httpd.c ****               }
1844:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_POST_MANUAL_WND */
1845:lwIP/src/apps/http/httpd.c ****               pbuf_ref(q);
1846:lwIP/src/apps/http/httpd.c ****               return http_post_rxpbuf(hs, q);
1847:lwIP/src/apps/http/httpd.c ****             } else if (hs->post_content_len_left == 0) {
1848:lwIP/src/apps/http/httpd.c ****               q = pbuf_alloc(PBUF_RAW, 0, PBUF_REF);
1849:lwIP/src/apps/http/httpd.c ****               return http_post_rxpbuf(hs, q);
1850:lwIP/src/apps/http/httpd.c ****             } else {
1851:lwIP/src/apps/http/httpd.c ****               return ERR_OK;
1852:lwIP/src/apps/http/httpd.c ****             }
1853:lwIP/src/apps/http/httpd.c ****           } else {
ARM GAS  /tmp/ccQlnpyR.s 			page 34


1854:lwIP/src/apps/http/httpd.c ****             /* return file passed from application */
1855:lwIP/src/apps/http/httpd.c ****             return http_find_file(hs, http_uri_buf, 0);
1856:lwIP/src/apps/http/httpd.c ****           }
1857:lwIP/src/apps/http/httpd.c ****         } else {
1858:lwIP/src/apps/http/httpd.c ****           LWIP_DEBUGF(HTTPD_DEBUG, ("POST received invalid Content-Length: %s\n",
1859:lwIP/src/apps/http/httpd.c ****                                     content_len_num));
1860:lwIP/src/apps/http/httpd.c ****           return ERR_ARG;
1861:lwIP/src/apps/http/httpd.c ****         }
1862:lwIP/src/apps/http/httpd.c ****       }
1863:lwIP/src/apps/http/httpd.c ****     }
1864:lwIP/src/apps/http/httpd.c ****     /* If we come here, headers are fully received (double-crlf), but Content-Length
1865:lwIP/src/apps/http/httpd.c ****        was not included. Since this is currently the only supported method, we have
1866:lwIP/src/apps/http/httpd.c ****        to fail in this case! */
1867:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error when parsing Content-Length\n"));
1868:lwIP/src/apps/http/httpd.c ****     return ERR_ARG;
1869:lwIP/src/apps/http/httpd.c ****   }
1870:lwIP/src/apps/http/httpd.c ****   /* if we come here, the POST is incomplete */
1871:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
1872:lwIP/src/apps/http/httpd.c ****   return ERR_INPROGRESS;
1873:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
1874:lwIP/src/apps/http/httpd.c ****   return ERR_ARG;
1875:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
1876:lwIP/src/apps/http/httpd.c **** }
1877:lwIP/src/apps/http/httpd.c **** 
1878:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_POST_MANUAL_WND
1879:lwIP/src/apps/http/httpd.c **** /**
1880:lwIP/src/apps/http/httpd.c ****  * @ingroup httpd
1881:lwIP/src/apps/http/httpd.c ****  * A POST implementation can call this function to update the TCP window.
1882:lwIP/src/apps/http/httpd.c ****  * This can be used to throttle data reception (e.g. when received data is
1883:lwIP/src/apps/http/httpd.c ****  * programmed to flash and data is received faster than programmed).
1884:lwIP/src/apps/http/httpd.c ****  *
1885:lwIP/src/apps/http/httpd.c ****  * @param connection A connection handle passed to httpd_post_begin for which
1886:lwIP/src/apps/http/httpd.c ****  *        httpd_post_finished has *NOT* been called yet!
1887:lwIP/src/apps/http/httpd.c ****  * @param recved_len Length of data received (for window update)
1888:lwIP/src/apps/http/httpd.c ****  */
1889:lwIP/src/apps/http/httpd.c **** void httpd_post_data_recved(void *connection, u16_t recved_len)
1890:lwIP/src/apps/http/httpd.c **** {
1891:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)connection;
1892:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
1893:lwIP/src/apps/http/httpd.c ****     if (hs->no_auto_wnd) {
1894:lwIP/src/apps/http/httpd.c ****       u16_t len = recved_len;
1895:lwIP/src/apps/http/httpd.c ****       if (hs->unrecved_bytes >= recved_len) {
1896:lwIP/src/apps/http/httpd.c ****         hs->unrecved_bytes -= recved_len;
1897:lwIP/src/apps/http/httpd.c ****       } else {
1898:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_LEVEL_WARNING, ("httpd_post_data_recved: recved_len too 
1899:lwIP/src/apps/http/httpd.c ****         len = (u16_t)hs->unrecved_bytes;
1900:lwIP/src/apps/http/httpd.c ****         hs->unrecved_bytes = 0;
1901:lwIP/src/apps/http/httpd.c ****       }
1902:lwIP/src/apps/http/httpd.c ****       if (hs->pcb != NULL) {
1903:lwIP/src/apps/http/httpd.c ****         if (len != 0) {
1904:lwIP/src/apps/http/httpd.c ****           altcp_recved(hs->pcb, len);
1905:lwIP/src/apps/http/httpd.c ****         }
1906:lwIP/src/apps/http/httpd.c ****         if ((hs->post_content_len_left == 0) && (hs->unrecved_bytes == 0)) {
1907:lwIP/src/apps/http/httpd.c ****           /* finished handling POST */
1908:lwIP/src/apps/http/httpd.c ****           http_handle_post_finished(hs);
1909:lwIP/src/apps/http/httpd.c ****           http_send(hs->pcb, hs);
1910:lwIP/src/apps/http/httpd.c ****         }
ARM GAS  /tmp/ccQlnpyR.s 			page 35


1911:lwIP/src/apps/http/httpd.c ****       }
1912:lwIP/src/apps/http/httpd.c ****     }
1913:lwIP/src/apps/http/httpd.c ****   }
1914:lwIP/src/apps/http/httpd.c **** }
1915:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_POST_MANUAL_WND */
1916:lwIP/src/apps/http/httpd.c **** 
1917:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
1918:lwIP/src/apps/http/httpd.c **** 
1919:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_FS_ASYNC_READ
1920:lwIP/src/apps/http/httpd.c **** /** Try to send more data if file has been blocked before
1921:lwIP/src/apps/http/httpd.c ****  * This is a callback function passed to fs_read_async().
1922:lwIP/src/apps/http/httpd.c ****  */
1923:lwIP/src/apps/http/httpd.c **** static void
1924:lwIP/src/apps/http/httpd.c **** http_continue(void *connection)
1925:lwIP/src/apps/http/httpd.c **** {
1926:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)connection;
1927:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT_CORE_LOCKED();
1928:lwIP/src/apps/http/httpd.c ****   if (hs && (hs->pcb) && (hs->handle)) {
1929:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("hs->pcb != NULL", hs->pcb != NULL);
1930:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("httpd_continue: try to send more data\n"));
1931:lwIP/src/apps/http/httpd.c ****     if (http_send(hs->pcb, hs)) {
1932:lwIP/src/apps/http/httpd.c ****       /* If we wrote anything to be sent, go ahead and send it now. */
1933:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("tcp_output\n"));
1934:lwIP/src/apps/http/httpd.c ****       altcp_output(hs->pcb);
1935:lwIP/src/apps/http/httpd.c ****     }
1936:lwIP/src/apps/http/httpd.c ****   }
1937:lwIP/src/apps/http/httpd.c **** }
1938:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_FS_ASYNC_READ */
1939:lwIP/src/apps/http/httpd.c **** 
1940:lwIP/src/apps/http/httpd.c **** /**
1941:lwIP/src/apps/http/httpd.c ****  * When data has been received in the correct state, try to parse it
1942:lwIP/src/apps/http/httpd.c ****  * as a HTTP request.
1943:lwIP/src/apps/http/httpd.c ****  *
1944:lwIP/src/apps/http/httpd.c ****  * @param inp the received pbuf
1945:lwIP/src/apps/http/httpd.c ****  * @param hs the connection state
1946:lwIP/src/apps/http/httpd.c ****  * @param pcb the altcp_pcb which received this packet
1947:lwIP/src/apps/http/httpd.c ****  * @return ERR_OK if request was OK and hs has been initialized correctly
1948:lwIP/src/apps/http/httpd.c ****  *         ERR_INPROGRESS if request was OK so far but not fully received
1949:lwIP/src/apps/http/httpd.c ****  *         another err_t otherwise
1950:lwIP/src/apps/http/httpd.c ****  */
1951:lwIP/src/apps/http/httpd.c **** static err_t
1952:lwIP/src/apps/http/httpd.c **** http_parse_request(struct pbuf *inp, struct http_state *hs, struct altcp_pcb *pcb)
1953:lwIP/src/apps/http/httpd.c **** {
1954:lwIP/src/apps/http/httpd.c ****   char *data;
1955:lwIP/src/apps/http/httpd.c ****   char *crlf;
1956:lwIP/src/apps/http/httpd.c ****   u16_t data_len;
1957:lwIP/src/apps/http/httpd.c ****   struct pbuf *p = inp;
1958:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
1959:lwIP/src/apps/http/httpd.c ****   u16_t clen;
1960:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
1961:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
1962:lwIP/src/apps/http/httpd.c ****   err_t err;
1963:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
1964:lwIP/src/apps/http/httpd.c **** 
1965:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(pcb); /* only used for post */
1966:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("p != NULL", p != NULL);
1967:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("hs != NULL", hs != NULL);
ARM GAS  /tmp/ccQlnpyR.s 			page 36


1968:lwIP/src/apps/http/httpd.c **** 
1969:lwIP/src/apps/http/httpd.c ****   if ((hs->handle != NULL) || (hs->file != NULL)) {
1970:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Received data while sending a file\n"));
1971:lwIP/src/apps/http/httpd.c ****     /* already sending a file */
1972:lwIP/src/apps/http/httpd.c ****     /* @todo: abort? */
1973:lwIP/src/apps/http/httpd.c ****     return ERR_USE;
1974:lwIP/src/apps/http/httpd.c ****   }
1975:lwIP/src/apps/http/httpd.c **** 
1976:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
1977:lwIP/src/apps/http/httpd.c **** 
1978:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("Received %"U16_F" bytes\n", p->tot_len));
1979:lwIP/src/apps/http/httpd.c **** 
1980:lwIP/src/apps/http/httpd.c ****   /* first check allowed characters in this pbuf? */
1981:lwIP/src/apps/http/httpd.c **** 
1982:lwIP/src/apps/http/httpd.c ****   /* enqueue the pbuf */
1983:lwIP/src/apps/http/httpd.c ****   if (hs->req == NULL) {
1984:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("First pbuf\n"));
1985:lwIP/src/apps/http/httpd.c ****     hs->req = p;
1986:lwIP/src/apps/http/httpd.c ****   } else {
1987:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("pbuf enqueued\n"));
1988:lwIP/src/apps/http/httpd.c ****     pbuf_cat(hs->req, p);
1989:lwIP/src/apps/http/httpd.c ****   }
1990:lwIP/src/apps/http/httpd.c ****   /* increase pbuf ref counter as it is freed when we return but we want to
1991:lwIP/src/apps/http/httpd.c ****      keep it on the req list */
1992:lwIP/src/apps/http/httpd.c ****   pbuf_ref(p);
1993:lwIP/src/apps/http/httpd.c **** 
1994:lwIP/src/apps/http/httpd.c ****   if (hs->req->next != NULL) {
1995:lwIP/src/apps/http/httpd.c ****     data_len = LWIP_MIN(hs->req->tot_len, LWIP_HTTPD_MAX_REQ_LENGTH);
1996:lwIP/src/apps/http/httpd.c ****     pbuf_copy_partial(hs->req, httpd_req_buf, data_len, 0);
1997:lwIP/src/apps/http/httpd.c ****     data = httpd_req_buf;
1998:lwIP/src/apps/http/httpd.c ****   } else
1999:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
2000:lwIP/src/apps/http/httpd.c ****   {
2001:lwIP/src/apps/http/httpd.c ****     data = (char *)p->payload;
2002:lwIP/src/apps/http/httpd.c ****     data_len = p->len;
2003:lwIP/src/apps/http/httpd.c ****     if (p->len != p->tot_len) {
2004:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("Warning: incomplete header due to chained pbufs\n"));
2005:lwIP/src/apps/http/httpd.c ****     }
2006:lwIP/src/apps/http/httpd.c ****   }
2007:lwIP/src/apps/http/httpd.c **** 
2008:lwIP/src/apps/http/httpd.c ****   /* received enough data for minimal request? */
2009:lwIP/src/apps/http/httpd.c ****   if (data_len >= MIN_REQ_LEN) {
2010:lwIP/src/apps/http/httpd.c ****     /* wait for CRLF before parsing anything */
2011:lwIP/src/apps/http/httpd.c ****     crlf = lwip_strnstr(data, CRLF, data_len);
2012:lwIP/src/apps/http/httpd.c ****     if (crlf != NULL) {
2013:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2014:lwIP/src/apps/http/httpd.c ****       int is_post = 0;
2015:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2016:lwIP/src/apps/http/httpd.c ****       int is_09 = 0;
2017:lwIP/src/apps/http/httpd.c ****       char *sp1, *sp2;
2018:lwIP/src/apps/http/httpd.c ****       u16_t left_len, uri_len;
2019:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("CRLF received, parsing request\n"));
2020:lwIP/src/apps/http/httpd.c ****       /* parse method */
2021:lwIP/src/apps/http/httpd.c ****       if (!strncmp(data, "GET ", 4)) {
2022:lwIP/src/apps/http/httpd.c ****         sp1 = data + 3;
2023:lwIP/src/apps/http/httpd.c ****         /* received GET request */
2024:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Received GET request\"\n"));
ARM GAS  /tmp/ccQlnpyR.s 			page 37


2025:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2026:lwIP/src/apps/http/httpd.c ****       } else if (!strncmp(data, "POST ", 5)) {
2027:lwIP/src/apps/http/httpd.c ****         /* store request type */
2028:lwIP/src/apps/http/httpd.c ****         is_post = 1;
2029:lwIP/src/apps/http/httpd.c ****         sp1 = data + 4;
2030:lwIP/src/apps/http/httpd.c ****         /* received GET request */
2031:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Received POST request\n"));
2032:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2033:lwIP/src/apps/http/httpd.c ****       } else {
2034:lwIP/src/apps/http/httpd.c ****         /* null-terminate the METHOD (pbuf is freed anyway wen returning) */
2035:lwIP/src/apps/http/httpd.c ****         data[4] = 0;
2036:lwIP/src/apps/http/httpd.c ****         /* unsupported method! */
2037:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG, ("Unsupported request method (not implemented): \"%s\"\n",
2038:lwIP/src/apps/http/httpd.c ****                                   data));
2039:lwIP/src/apps/http/httpd.c ****         return http_find_error_file(hs, 501);
2040:lwIP/src/apps/http/httpd.c ****       }
2041:lwIP/src/apps/http/httpd.c ****       /* if we come here, method is OK, parse URI */
2042:lwIP/src/apps/http/httpd.c ****       left_len = (u16_t)(data_len - ((sp1 + 1) - data));
2043:lwIP/src/apps/http/httpd.c ****       sp2 = lwip_strnstr(sp1 + 1, " ", left_len);
2044:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_V09
2045:lwIP/src/apps/http/httpd.c ****       if (sp2 == NULL) {
2046:lwIP/src/apps/http/httpd.c ****         /* HTTP 0.9: respond with correct protocol version */
2047:lwIP/src/apps/http/httpd.c ****         sp2 = lwip_strnstr(sp1 + 1, CRLF, left_len);
2048:lwIP/src/apps/http/httpd.c ****         is_09 = 1;
2049:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2050:lwIP/src/apps/http/httpd.c ****         if (is_post) {
2051:lwIP/src/apps/http/httpd.c ****           /* HTTP/0.9 does not support POST */
2052:lwIP/src/apps/http/httpd.c ****           goto badrequest;
2053:lwIP/src/apps/http/httpd.c ****         }
2054:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2055:lwIP/src/apps/http/httpd.c ****       }
2056:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_V09 */
2057:lwIP/src/apps/http/httpd.c ****       uri_len = (u16_t)(sp2 - (sp1 + 1));
2058:lwIP/src/apps/http/httpd.c ****       if ((sp2 != 0) && (sp2 > sp1)) {
2059:lwIP/src/apps/http/httpd.c ****         /* wait for CRLFCRLF (indicating end of HTTP headers) before parsing anything */
2060:lwIP/src/apps/http/httpd.c ****         if (lwip_strnstr(data, CRLF CRLF, data_len) != NULL) {
2061:lwIP/src/apps/http/httpd.c ****           char *uri = sp1 + 1;
2062:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
2063:lwIP/src/apps/http/httpd.c ****           /* This is HTTP/1.0 compatible: for strict 1.1, a connection
2064:lwIP/src/apps/http/httpd.c ****              would always be persistent unless "close" was specified. */
2065:lwIP/src/apps/http/httpd.c ****           if (!is_09 && (lwip_strnstr(data, HTTP11_CONNECTIONKEEPALIVE, data_len) ||
2066:lwIP/src/apps/http/httpd.c ****                          lwip_strnstr(data, HTTP11_CONNECTIONKEEPALIVE2, data_len))) {
2067:lwIP/src/apps/http/httpd.c ****             hs->keepalive = 1;
2068:lwIP/src/apps/http/httpd.c ****           } else {
2069:lwIP/src/apps/http/httpd.c ****             hs->keepalive = 0;
2070:lwIP/src/apps/http/httpd.c ****           }
2071:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_11_KEEPALIVE */
2072:lwIP/src/apps/http/httpd.c ****           /* null-terminate the METHOD (pbuf is freed anyway wen returning) */
2073:lwIP/src/apps/http/httpd.c ****           *sp1 = 0;
2074:lwIP/src/apps/http/httpd.c ****           uri[uri_len] = 0;
2075:lwIP/src/apps/http/httpd.c ****           LWIP_DEBUGF(HTTPD_DEBUG, ("Received \"%s\" request for URI: \"%s\"\n",
2076:lwIP/src/apps/http/httpd.c ****                                     data, uri));
2077:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2078:lwIP/src/apps/http/httpd.c ****           if (is_post) {
2079:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
2080:lwIP/src/apps/http/httpd.c ****             struct pbuf *q = hs->req;
2081:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
ARM GAS  /tmp/ccQlnpyR.s 			page 38


2082:lwIP/src/apps/http/httpd.c ****             struct pbuf *q = inp;
2083:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
2084:lwIP/src/apps/http/httpd.c ****             err = http_post_request(q, hs, data, data_len, uri, sp2);
2085:lwIP/src/apps/http/httpd.c ****             if (err != ERR_OK) {
2086:lwIP/src/apps/http/httpd.c ****               /* restore header for next try */
2087:lwIP/src/apps/http/httpd.c ****               *sp1 = ' ';
2088:lwIP/src/apps/http/httpd.c ****               *sp2 = ' ';
2089:lwIP/src/apps/http/httpd.c ****               uri[uri_len] = ' ';
2090:lwIP/src/apps/http/httpd.c ****             }
2091:lwIP/src/apps/http/httpd.c ****             if (err == ERR_ARG) {
2092:lwIP/src/apps/http/httpd.c ****               goto badrequest;
2093:lwIP/src/apps/http/httpd.c ****             }
2094:lwIP/src/apps/http/httpd.c ****             return err;
2095:lwIP/src/apps/http/httpd.c ****           } else
2096:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2097:lwIP/src/apps/http/httpd.c ****           {
2098:lwIP/src/apps/http/httpd.c ****             return http_find_file(hs, uri, is_09);
2099:lwIP/src/apps/http/httpd.c ****           }
2100:lwIP/src/apps/http/httpd.c ****         }
2101:lwIP/src/apps/http/httpd.c ****       } else {
2102:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG, ("invalid URI\n"));
2103:lwIP/src/apps/http/httpd.c ****       }
2104:lwIP/src/apps/http/httpd.c ****     }
2105:lwIP/src/apps/http/httpd.c ****   }
2106:lwIP/src/apps/http/httpd.c **** 
2107:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
2108:lwIP/src/apps/http/httpd.c ****   clen = pbuf_clen(hs->req);
2109:lwIP/src/apps/http/httpd.c ****   if ((hs->req->tot_len <= LWIP_HTTPD_REQ_BUFSIZE) &&
2110:lwIP/src/apps/http/httpd.c ****       (clen <= LWIP_HTTPD_REQ_QUEUELEN)) {
2111:lwIP/src/apps/http/httpd.c ****     /* request not fully received (too short or CRLF is missing) */
2112:lwIP/src/apps/http/httpd.c ****     return ERR_INPROGRESS;
2113:lwIP/src/apps/http/httpd.c ****   } else
2114:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
2115:lwIP/src/apps/http/httpd.c ****   {
2116:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2117:lwIP/src/apps/http/httpd.c **** badrequest:
2118:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2119:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("bad request\n"));
2120:lwIP/src/apps/http/httpd.c ****     /* could not parse request */
2121:lwIP/src/apps/http/httpd.c ****     return http_find_error_file(hs, 400);
2122:lwIP/src/apps/http/httpd.c ****   }
2123:lwIP/src/apps/http/httpd.c **** }
2124:lwIP/src/apps/http/httpd.c **** 
2125:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI && (LWIP_HTTPD_SSI_BY_FILE_EXTENSION == 1)
2126:lwIP/src/apps/http/httpd.c **** /* Check if SSI should be parsed for this file/URL
2127:lwIP/src/apps/http/httpd.c ****  * (With LWIP_HTTPD_SSI_BY_FILE_EXTENSION == 2, this function can be
2128:lwIP/src/apps/http/httpd.c ****  * overridden by an external implementation.)
2129:lwIP/src/apps/http/httpd.c ****  *
2130:lwIP/src/apps/http/httpd.c ****  * @return 1 for SSI, 0 for standard files
2131:lwIP/src/apps/http/httpd.c ****  */
2132:lwIP/src/apps/http/httpd.c **** static u8_t
2133:lwIP/src/apps/http/httpd.c **** http_uri_is_ssi(struct fs_file *file, const char *uri)
2134:lwIP/src/apps/http/httpd.c **** {
2135:lwIP/src/apps/http/httpd.c ****   size_t loop;
2136:lwIP/src/apps/http/httpd.c ****   u8_t tag_check = 0;
2137:lwIP/src/apps/http/httpd.c ****   if (file != NULL) {
2138:lwIP/src/apps/http/httpd.c ****     /* See if we have been asked for an shtml file and, if so,
ARM GAS  /tmp/ccQlnpyR.s 			page 39


2139:lwIP/src/apps/http/httpd.c ****         enable tag checking. */
2140:lwIP/src/apps/http/httpd.c ****     const char *ext = NULL, *sub;
2141:lwIP/src/apps/http/httpd.c ****     char *param = (char *)strstr(uri, "?");
2142:lwIP/src/apps/http/httpd.c ****     if (param != NULL) {
2143:lwIP/src/apps/http/httpd.c ****       /* separate uri from parameters for now, set back later */
2144:lwIP/src/apps/http/httpd.c ****       *param = 0;
2145:lwIP/src/apps/http/httpd.c ****     }
2146:lwIP/src/apps/http/httpd.c ****     sub = uri;
2147:lwIP/src/apps/http/httpd.c ****     ext = uri;
2148:lwIP/src/apps/http/httpd.c ****     for (sub = strstr(sub, "."); sub != NULL; sub = strstr(sub, ".")) {
2149:lwIP/src/apps/http/httpd.c ****       ext = sub;
2150:lwIP/src/apps/http/httpd.c ****       sub++;
2151:lwIP/src/apps/http/httpd.c ****     }
2152:lwIP/src/apps/http/httpd.c ****     for (loop = 0; loop < NUM_SHTML_EXTENSIONS; loop++) {
2153:lwIP/src/apps/http/httpd.c ****       if (!lwip_stricmp(ext, g_pcSSIExtensions[loop])) {
2154:lwIP/src/apps/http/httpd.c ****         tag_check = 1;
2155:lwIP/src/apps/http/httpd.c ****         break;
2156:lwIP/src/apps/http/httpd.c ****       }
2157:lwIP/src/apps/http/httpd.c ****     }
2158:lwIP/src/apps/http/httpd.c ****     if (param != NULL) {
2159:lwIP/src/apps/http/httpd.c ****       *param = '?';
2160:lwIP/src/apps/http/httpd.c ****     }
2161:lwIP/src/apps/http/httpd.c ****   }
2162:lwIP/src/apps/http/httpd.c ****   return tag_check;
2163:lwIP/src/apps/http/httpd.c **** }
2164:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
2165:lwIP/src/apps/http/httpd.c **** 
2166:lwIP/src/apps/http/httpd.c **** /** Try to find the file specified by uri and, if found, initialize hs
2167:lwIP/src/apps/http/httpd.c ****  * accordingly.
2168:lwIP/src/apps/http/httpd.c ****  *
2169:lwIP/src/apps/http/httpd.c ****  * @param hs the connection state
2170:lwIP/src/apps/http/httpd.c ****  * @param uri the HTTP header URI
2171:lwIP/src/apps/http/httpd.c ****  * @param is_09 1 if the request is HTTP/0.9 (no HTTP headers in response)
2172:lwIP/src/apps/http/httpd.c ****  * @return ERR_OK if file was found and hs has been initialized correctly
2173:lwIP/src/apps/http/httpd.c ****  *         another err_t otherwise
2174:lwIP/src/apps/http/httpd.c ****  */
2175:lwIP/src/apps/http/httpd.c **** static err_t
2176:lwIP/src/apps/http/httpd.c **** http_find_file(struct http_state *hs, const char *uri, int is_09)
2177:lwIP/src/apps/http/httpd.c **** {
2178:lwIP/src/apps/http/httpd.c ****   size_t loop;
2179:lwIP/src/apps/http/httpd.c ****   struct fs_file *file = NULL;
2180:lwIP/src/apps/http/httpd.c ****   char *params = NULL;
2181:lwIP/src/apps/http/httpd.c ****   err_t err;
2182:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI
2183:lwIP/src/apps/http/httpd.c ****   int i;
2184:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CGI */
2185:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SSI
2186:lwIP/src/apps/http/httpd.c ****   const
2187:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI */
2188:lwIP/src/apps/http/httpd.c ****   /* By default, assume we will not be processing server-side-includes tags */
2189:lwIP/src/apps/http/httpd.c ****   u8_t tag_check = 0;
2190:lwIP/src/apps/http/httpd.c **** 
2191:lwIP/src/apps/http/httpd.c ****   /* Have we been asked for the default file (in root or a directory) ? */
2192:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_MAX_REQUEST_URI_LEN
2193:lwIP/src/apps/http/httpd.c ****   size_t uri_len = strlen(uri);
2194:lwIP/src/apps/http/httpd.c ****   if ((uri_len > 0) && (uri[uri_len - 1] == '/') &&
2195:lwIP/src/apps/http/httpd.c ****       ((uri != http_uri_buf) || (uri_len == 1))) {
ARM GAS  /tmp/ccQlnpyR.s 			page 40


2196:lwIP/src/apps/http/httpd.c ****     size_t copy_len = LWIP_MIN(sizeof(http_uri_buf) - 1, uri_len - 1);
2197:lwIP/src/apps/http/httpd.c ****     if (copy_len > 0) {
2198:lwIP/src/apps/http/httpd.c ****       MEMCPY(http_uri_buf, uri, copy_len);
2199:lwIP/src/apps/http/httpd.c ****       http_uri_buf[copy_len] = 0;
2200:lwIP/src/apps/http/httpd.c ****     }
2201:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_MAX_REQUEST_URI_LEN */
2202:lwIP/src/apps/http/httpd.c ****   if ((uri[0] == '/') &&  (uri[1] == 0)) {
2203:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_MAX_REQUEST_URI_LEN */
2204:lwIP/src/apps/http/httpd.c ****     /* Try each of the configured default filenames until we find one
2205:lwIP/src/apps/http/httpd.c ****        that exists. */
2206:lwIP/src/apps/http/httpd.c ****     for (loop = 0; loop < NUM_DEFAULT_FILENAMES; loop++) {
2207:lwIP/src/apps/http/httpd.c ****       const char *file_name;
2208:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_MAX_REQUEST_URI_LEN
2209:lwIP/src/apps/http/httpd.c ****       if (copy_len > 0) {
2210:lwIP/src/apps/http/httpd.c ****         size_t len_left = sizeof(http_uri_buf) - copy_len - 1;
2211:lwIP/src/apps/http/httpd.c ****         if (len_left > 0) {
2212:lwIP/src/apps/http/httpd.c ****           size_t name_len = strlen(httpd_default_filenames[loop].name);
2213:lwIP/src/apps/http/httpd.c ****           size_t name_copy_len = LWIP_MIN(len_left, name_len);
2214:lwIP/src/apps/http/httpd.c ****           MEMCPY(&http_uri_buf[copy_len], httpd_default_filenames[loop].name, name_copy_len);
2215:lwIP/src/apps/http/httpd.c ****           http_uri_buf[copy_len + name_copy_len] = 0;
2216:lwIP/src/apps/http/httpd.c ****         }
2217:lwIP/src/apps/http/httpd.c ****         file_name = http_uri_buf;
2218:lwIP/src/apps/http/httpd.c ****       } else
2219:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_MAX_REQUEST_URI_LEN */
2220:lwIP/src/apps/http/httpd.c ****       {
2221:lwIP/src/apps/http/httpd.c ****         file_name = httpd_default_filenames[loop].name;
2222:lwIP/src/apps/http/httpd.c ****       }
2223:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Looking for %s...\n", file_name));
2224:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, file_name);
2225:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
2226:lwIP/src/apps/http/httpd.c ****         uri = file_name;
2227:lwIP/src/apps/http/httpd.c ****         file = &hs->file_handle;
2228:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Opened.\n"));
2229:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
2230:lwIP/src/apps/http/httpd.c ****         tag_check = httpd_default_filenames[loop].shtml;
2231:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
2232:lwIP/src/apps/http/httpd.c ****         break;
2233:lwIP/src/apps/http/httpd.c ****       }
2234:lwIP/src/apps/http/httpd.c ****     }
2235:lwIP/src/apps/http/httpd.c ****   }
2236:lwIP/src/apps/http/httpd.c ****   if (file == NULL) {
2237:lwIP/src/apps/http/httpd.c ****     /* No - we've been asked for a specific file. */
2238:lwIP/src/apps/http/httpd.c ****     /* First, isolate the base URI (without any parameters) */
2239:lwIP/src/apps/http/httpd.c ****     params = (char *)strchr(uri, '?');
2240:lwIP/src/apps/http/httpd.c ****     if (params != NULL) {
2241:lwIP/src/apps/http/httpd.c ****       /* URI contains parameters. NULL-terminate the base URI */
2242:lwIP/src/apps/http/httpd.c ****       *params = '\0';
2243:lwIP/src/apps/http/httpd.c ****       params++;
2244:lwIP/src/apps/http/httpd.c ****     }
2245:lwIP/src/apps/http/httpd.c **** 
2246:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI
2247:lwIP/src/apps/http/httpd.c ****     http_cgi_paramcount = -1;
2248:lwIP/src/apps/http/httpd.c ****     /* Does the base URI we have isolated correspond to a CGI handler? */
2249:lwIP/src/apps/http/httpd.c ****     if (httpd_num_cgis && httpd_cgis) {
2250:lwIP/src/apps/http/httpd.c ****       for (i = 0; i < httpd_num_cgis; i++) {
2251:lwIP/src/apps/http/httpd.c ****         if (strcmp(uri, httpd_cgis[i].pcCGIName) == 0) {
2252:lwIP/src/apps/http/httpd.c ****           /*
ARM GAS  /tmp/ccQlnpyR.s 			page 41


2253:lwIP/src/apps/http/httpd.c ****            * We found a CGI that handles this URI so extract the
2254:lwIP/src/apps/http/httpd.c ****            * parameters and call the handler.
2255:lwIP/src/apps/http/httpd.c ****            */
2256:lwIP/src/apps/http/httpd.c ****           http_cgi_paramcount = extract_uri_parameters(hs, params);
2257:lwIP/src/apps/http/httpd.c ****           uri = httpd_cgis[i].pfnCGIHandler(i, http_cgi_paramcount, hs->params,
2258:lwIP/src/apps/http/httpd.c ****                                          hs->param_vals);
2259:lwIP/src/apps/http/httpd.c ****           break;
2260:lwIP/src/apps/http/httpd.c ****         }
2261:lwIP/src/apps/http/httpd.c ****       }
2262:lwIP/src/apps/http/httpd.c ****     }
2263:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CGI */
2264:lwIP/src/apps/http/httpd.c **** 
2265:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Opening %s\n", uri));
2266:lwIP/src/apps/http/httpd.c **** 
2267:lwIP/src/apps/http/httpd.c ****     err = fs_open(&hs->file_handle, uri);
2268:lwIP/src/apps/http/httpd.c ****     if (err == ERR_OK) {
2269:lwIP/src/apps/http/httpd.c ****       file = &hs->file_handle;
2270:lwIP/src/apps/http/httpd.c ****     } else {
2271:lwIP/src/apps/http/httpd.c ****       file = http_get_404_file(hs, &uri);
2272:lwIP/src/apps/http/httpd.c ****     }
2273:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
2274:lwIP/src/apps/http/httpd.c ****     if (file != NULL) {
2275:lwIP/src/apps/http/httpd.c ****       if (file->flags & FS_FILE_FLAGS_SSI) {
2276:lwIP/src/apps/http/httpd.c ****         tag_check = 1;
2277:lwIP/src/apps/http/httpd.c ****       } else {
2278:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI_BY_FILE_EXTENSION
2279:lwIP/src/apps/http/httpd.c ****         tag_check = http_uri_is_ssi(file, uri);
2280:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI_BY_FILE_EXTENSION */
2281:lwIP/src/apps/http/httpd.c ****       }
2282:lwIP/src/apps/http/httpd.c ****     }
2283:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
2284:lwIP/src/apps/http/httpd.c ****   }
2285:lwIP/src/apps/http/httpd.c ****   if (file == NULL) {
2286:lwIP/src/apps/http/httpd.c ****     /* None of the default filenames exist so send back a 404 page */
2287:lwIP/src/apps/http/httpd.c ****     file = http_get_404_file(hs, &uri);
2288:lwIP/src/apps/http/httpd.c ****   }
2289:lwIP/src/apps/http/httpd.c ****   return http_init_file(hs, file, is_09, uri, tag_check, params);
2290:lwIP/src/apps/http/httpd.c **** }
2291:lwIP/src/apps/http/httpd.c **** 
2292:lwIP/src/apps/http/httpd.c **** /** Initialize a http connection with a file to send (if found).
2293:lwIP/src/apps/http/httpd.c ****  * Called by http_find_file and http_find_error_file.
2294:lwIP/src/apps/http/httpd.c ****  *
2295:lwIP/src/apps/http/httpd.c ****  * @param hs http connection state
2296:lwIP/src/apps/http/httpd.c ****  * @param file file structure to send (or NULL if not found)
2297:lwIP/src/apps/http/httpd.c ****  * @param is_09 1 if the request is HTTP/0.9 (no HTTP headers in response)
2298:lwIP/src/apps/http/httpd.c ****  * @param uri the HTTP header URI
2299:lwIP/src/apps/http/httpd.c ****  * @param tag_check enable SSI tag checking
2300:lwIP/src/apps/http/httpd.c ****  * @param params != NULL if URI has parameters (separated by '?')
2301:lwIP/src/apps/http/httpd.c ****  * @return ERR_OK if file was found and hs has been initialized correctly
2302:lwIP/src/apps/http/httpd.c ****  *         another err_t otherwise
2303:lwIP/src/apps/http/httpd.c ****  */
2304:lwIP/src/apps/http/httpd.c **** static err_t
2305:lwIP/src/apps/http/httpd.c **** http_init_file(struct http_state *hs, struct fs_file *file, int is_09, const char *uri,
2306:lwIP/src/apps/http/httpd.c ****                u8_t tag_check, char *params)
2307:lwIP/src/apps/http/httpd.c **** {
2308:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_SUPPORT_V09
2309:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(is_09);
ARM GAS  /tmp/ccQlnpyR.s 			page 42


2310:lwIP/src/apps/http/httpd.c **** #endif
2311:lwIP/src/apps/http/httpd.c ****   if (file != NULL) {
2312:lwIP/src/apps/http/httpd.c ****     /* file opened, initialise struct http_state */
2313:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_DYNAMIC_FILE_READ
2314:lwIP/src/apps/http/httpd.c ****     /* If dynamic read is disabled, file data must be in one piece and available now */
2315:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("file->data != NULL", file->data != NULL);
2316:lwIP/src/apps/http/httpd.c **** #endif
2317:lwIP/src/apps/http/httpd.c **** 
2318:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
2319:lwIP/src/apps/http/httpd.c ****     if (tag_check) {
2320:lwIP/src/apps/http/httpd.c ****       struct http_ssi_state *ssi = http_ssi_state_alloc();
2321:lwIP/src/apps/http/httpd.c ****       if (ssi != NULL) {
2322:lwIP/src/apps/http/httpd.c ****         ssi->tag_index = 0;
2323:lwIP/src/apps/http/httpd.c ****         ssi->tag_state = TAG_NONE;
2324:lwIP/src/apps/http/httpd.c ****         ssi->parsed = file->data;
2325:lwIP/src/apps/http/httpd.c ****         ssi->parse_left = file->len;
2326:lwIP/src/apps/http/httpd.c ****         ssi->tag_end = file->data;
2327:lwIP/src/apps/http/httpd.c ****         hs->ssi = ssi;
2328:lwIP/src/apps/http/httpd.c ****       }
2329:lwIP/src/apps/http/httpd.c ****     }
2330:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_SSI */
2331:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(tag_check);
2332:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
2333:lwIP/src/apps/http/httpd.c ****     hs->handle = file;
2334:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI_SSI
2335:lwIP/src/apps/http/httpd.c ****     if (params != NULL) {
2336:lwIP/src/apps/http/httpd.c ****       /* URI contains parameters, call generic CGI handler */
2337:lwIP/src/apps/http/httpd.c ****       int count;
2338:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI
2339:lwIP/src/apps/http/httpd.c ****       if (http_cgi_paramcount >= 0) {
2340:lwIP/src/apps/http/httpd.c ****         count = http_cgi_paramcount;
2341:lwIP/src/apps/http/httpd.c ****       } else
2342:lwIP/src/apps/http/httpd.c **** #endif
2343:lwIP/src/apps/http/httpd.c ****       {
2344:lwIP/src/apps/http/httpd.c ****         count = extract_uri_parameters(hs, params);
2345:lwIP/src/apps/http/httpd.c ****       }
2346:lwIP/src/apps/http/httpd.c ****       httpd_cgi_handler(file, uri, count, http_cgi_params, http_cgi_param_vals
2347:lwIP/src/apps/http/httpd.c **** #if defined(LWIP_HTTPD_FILE_STATE) && LWIP_HTTPD_FILE_STATE
2348:lwIP/src/apps/http/httpd.c ****                         , file->state
2349:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_FILE_STATE */
2350:lwIP/src/apps/http/httpd.c ****                        );
2351:lwIP/src/apps/http/httpd.c ****     }
2352:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_CGI_SSI */
2353:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(params);
2354:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CGI_SSI */
2355:lwIP/src/apps/http/httpd.c ****     hs->file = file->data;
2356:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("File length must be positive!", (file->len >= 0));
2357:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
2358:lwIP/src/apps/http/httpd.c ****     if (file->is_custom_file && (file->data == NULL)) {
2359:lwIP/src/apps/http/httpd.c ****       /* custom file, need to read data first (via fs_read_custom) */
2360:lwIP/src/apps/http/httpd.c ****       hs->left = 0;
2361:lwIP/src/apps/http/httpd.c ****     } else
2362:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_CUSTOM_FILES */
2363:lwIP/src/apps/http/httpd.c ****     {
2364:lwIP/src/apps/http/httpd.c ****       hs->left = (u32_t)file->len;
2365:lwIP/src/apps/http/httpd.c ****     }
2366:lwIP/src/apps/http/httpd.c ****     hs->retries = 0;
ARM GAS  /tmp/ccQlnpyR.s 			page 43


2367:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
2368:lwIP/src/apps/http/httpd.c ****     hs->time_started = sys_now();
2369:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_TIMING */
2370:lwIP/src/apps/http/httpd.c **** #if !LWIP_HTTPD_DYNAMIC_HEADERS
2371:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("HTTP headers not included in file system",
2372:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
2373:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_DYNAMIC_HEADERS */
2374:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_V09
2375:lwIP/src/apps/http/httpd.c ****     if (is_09 && ((hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0)) {
2376:lwIP/src/apps/http/httpd.c ****       /* HTTP/0.9 responses are sent without HTTP header,
2377:lwIP/src/apps/http/httpd.c ****          search for the end of the header. */
2378:lwIP/src/apps/http/httpd.c ****       char *file_start = lwip_strnstr(hs->file, CRLF CRLF, hs->left);
2379:lwIP/src/apps/http/httpd.c ****       if (file_start != NULL) {
2380:lwIP/src/apps/http/httpd.c ****         int diff = file_start + 4 - hs->file;
2381:lwIP/src/apps/http/httpd.c ****         hs->file += diff;
2382:lwIP/src/apps/http/httpd.c ****         hs->left -= (u32_t)diff;
2383:lwIP/src/apps/http/httpd.c ****       }
2384:lwIP/src/apps/http/httpd.c ****     }
2385:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_V09*/
2386:lwIP/src/apps/http/httpd.c ****   } else {
2387:lwIP/src/apps/http/httpd.c ****     hs->handle = NULL;
2388:lwIP/src/apps/http/httpd.c ****     hs->file = NULL;
2389:lwIP/src/apps/http/httpd.c ****     hs->left = 0;
2390:lwIP/src/apps/http/httpd.c ****     hs->retries = 0;
2391:lwIP/src/apps/http/httpd.c ****   }
2392:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
2393:lwIP/src/apps/http/httpd.c ****   /* Determine the HTTP headers to send based on the file extension of
2394:lwIP/src/apps/http/httpd.c ****    * the requested URI. */
2395:lwIP/src/apps/http/httpd.c ****   if ((hs->handle == NULL) || ((hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) == 0)) {
2396:lwIP/src/apps/http/httpd.c ****     get_http_headers(hs, uri);
2397:lwIP/src/apps/http/httpd.c ****   }
2398:lwIP/src/apps/http/httpd.c **** #else /* LWIP_HTTPD_DYNAMIC_HEADERS */
2399:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(uri);
2400:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_DYNAMIC_HEADERS */
2401:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
2402:lwIP/src/apps/http/httpd.c ****   if (hs->keepalive) {
2403:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
2404:lwIP/src/apps/http/httpd.c ****     if (hs->ssi != NULL) {
2405:lwIP/src/apps/http/httpd.c ****       hs->keepalive = 0;
2406:lwIP/src/apps/http/httpd.c ****     } else
2407:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
2408:lwIP/src/apps/http/httpd.c ****     {
2409:lwIP/src/apps/http/httpd.c ****       if ((hs->handle != NULL) &&
2410:lwIP/src/apps/http/httpd.c ****           ((hs->handle->flags & (FS_FILE_FLAGS_HEADER_INCLUDED | FS_FILE_FLAGS_HEADER_PERSISTENT)) 
2411:lwIP/src/apps/http/httpd.c ****         hs->keepalive = 0;
2412:lwIP/src/apps/http/httpd.c ****       }
2413:lwIP/src/apps/http/httpd.c ****     }
2414:lwIP/src/apps/http/httpd.c ****   }
2415:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_11_KEEPALIVE */
2416:lwIP/src/apps/http/httpd.c ****   return ERR_OK;
2417:lwIP/src/apps/http/httpd.c **** }
2418:lwIP/src/apps/http/httpd.c **** 
2419:lwIP/src/apps/http/httpd.c **** /**
2420:lwIP/src/apps/http/httpd.c ****  * The pcb had an error and is already deallocated.
2421:lwIP/src/apps/http/httpd.c ****  * The argument might still be valid (if != NULL).
2422:lwIP/src/apps/http/httpd.c ****  */
2423:lwIP/src/apps/http/httpd.c **** static void
ARM GAS  /tmp/ccQlnpyR.s 			page 44


2424:lwIP/src/apps/http/httpd.c **** http_err(void *arg, err_t err)
2425:lwIP/src/apps/http/httpd.c **** {
2426:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
2427:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(err);
2428:lwIP/src/apps/http/httpd.c **** 
2429:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("http_err: %s", lwip_strerr(err)));
2430:lwIP/src/apps/http/httpd.c **** 
2431:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
2432:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
2433:lwIP/src/apps/http/httpd.c ****   }
2434:lwIP/src/apps/http/httpd.c **** }
2435:lwIP/src/apps/http/httpd.c **** 
2436:lwIP/src/apps/http/httpd.c **** /**
2437:lwIP/src/apps/http/httpd.c ****  * Data has been sent and acknowledged by the remote host.
2438:lwIP/src/apps/http/httpd.c ****  * This means that more data can be sent.
2439:lwIP/src/apps/http/httpd.c ****  */
2440:lwIP/src/apps/http/httpd.c **** static err_t
2441:lwIP/src/apps/http/httpd.c **** http_sent(void *arg, struct altcp_pcb *pcb, u16_t len)
2442:lwIP/src/apps/http/httpd.c **** {
2443:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
2444:lwIP/src/apps/http/httpd.c **** 
2445:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_sent %p\n", (void *)pcb));
2446:lwIP/src/apps/http/httpd.c **** 
2447:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(len);
2448:lwIP/src/apps/http/httpd.c **** 
2449:lwIP/src/apps/http/httpd.c ****   if (hs == NULL) {
2450:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
2451:lwIP/src/apps/http/httpd.c ****   }
2452:lwIP/src/apps/http/httpd.c **** 
2453:lwIP/src/apps/http/httpd.c ****   hs->retries = 0;
2454:lwIP/src/apps/http/httpd.c **** 
2455:lwIP/src/apps/http/httpd.c ****   http_send(pcb, hs);
2456:lwIP/src/apps/http/httpd.c **** 
2457:lwIP/src/apps/http/httpd.c ****   return ERR_OK;
2458:lwIP/src/apps/http/httpd.c **** }
2459:lwIP/src/apps/http/httpd.c **** 
2460:lwIP/src/apps/http/httpd.c **** /**
2461:lwIP/src/apps/http/httpd.c ****  * The poll function is called every 2nd second.
2462:lwIP/src/apps/http/httpd.c ****  * If there has been no data sent (which resets the retries) in 8 seconds, close.
2463:lwIP/src/apps/http/httpd.c ****  * If the last portion of a file has not been sent in 2 seconds, close.
2464:lwIP/src/apps/http/httpd.c ****  *
2465:lwIP/src/apps/http/httpd.c ****  * This could be increased, but we don't want to waste resources for bad connections.
2466:lwIP/src/apps/http/httpd.c ****  */
2467:lwIP/src/apps/http/httpd.c **** static err_t
2468:lwIP/src/apps/http/httpd.c **** http_poll(void *arg, struct altcp_pcb *pcb)
2469:lwIP/src/apps/http/httpd.c **** {
2470:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
2471:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_poll: pcb=%p hs=%p pcb_state=%s\n",
2472:lwIP/src/apps/http/httpd.c ****               (void *)pcb, (void *)hs, tcp_debug_state_str(altcp_dbg_get_tcp_state(pcb))));
2473:lwIP/src/apps/http/httpd.c **** 
2474:lwIP/src/apps/http/httpd.c ****   if (hs == NULL) {
2475:lwIP/src/apps/http/httpd.c ****     err_t closed;
2476:lwIP/src/apps/http/httpd.c ****     /* arg is null, close. */
2477:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("http_poll: arg is NULL, close\n"));
2478:lwIP/src/apps/http/httpd.c ****     closed = http_close_conn(pcb, NULL);
2479:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(closed);
2480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_ABORT_ON_CLOSE_MEM_ERROR
ARM GAS  /tmp/ccQlnpyR.s 			page 45


2481:lwIP/src/apps/http/httpd.c ****     if (closed == ERR_MEM) {
2482:lwIP/src/apps/http/httpd.c ****       altcp_abort(pcb);
2483:lwIP/src/apps/http/httpd.c ****       return ERR_ABRT;
2484:lwIP/src/apps/http/httpd.c ****     }
2485:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_ABORT_ON_CLOSE_MEM_ERROR */
2486:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
2487:lwIP/src/apps/http/httpd.c ****   } else {
2488:lwIP/src/apps/http/httpd.c ****     hs->retries++;
2489:lwIP/src/apps/http/httpd.c ****     if (hs->retries == HTTPD_MAX_RETRIES) {
2490:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("http_poll: too many retries, close\n"));
2491:lwIP/src/apps/http/httpd.c ****       http_close_conn(pcb, hs);
2492:lwIP/src/apps/http/httpd.c ****       return ERR_OK;
2493:lwIP/src/apps/http/httpd.c ****     }
2494:lwIP/src/apps/http/httpd.c **** 
2495:lwIP/src/apps/http/httpd.c ****     /* If this connection has a file open, try to send some more data. If
2496:lwIP/src/apps/http/httpd.c ****      * it has not yet received a GET request, don't do this since it will
2497:lwIP/src/apps/http/httpd.c ****      * cause the connection to close immediately. */
2498:lwIP/src/apps/http/httpd.c ****     if (hs->handle) {
2499:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_poll: try to send more data\n"));
2500:lwIP/src/apps/http/httpd.c ****       if (http_send(pcb, hs)) {
2501:lwIP/src/apps/http/httpd.c ****         /* If we wrote anything to be sent, go ahead and send it now. */
2502:lwIP/src/apps/http/httpd.c ****         LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("tcp_output\n"));
2503:lwIP/src/apps/http/httpd.c ****         altcp_output(pcb);
2504:lwIP/src/apps/http/httpd.c ****       }
2505:lwIP/src/apps/http/httpd.c ****     }
2506:lwIP/src/apps/http/httpd.c ****   }
2507:lwIP/src/apps/http/httpd.c **** 
2508:lwIP/src/apps/http/httpd.c ****   return ERR_OK;
2509:lwIP/src/apps/http/httpd.c **** }
2510:lwIP/src/apps/http/httpd.c **** 
2511:lwIP/src/apps/http/httpd.c **** /**
2512:lwIP/src/apps/http/httpd.c ****  * Data has been received on this pcb.
2513:lwIP/src/apps/http/httpd.c ****  * For HTTP 1.0, this should normally only happen once (if the request fits in one packet).
2514:lwIP/src/apps/http/httpd.c ****  */
2515:lwIP/src/apps/http/httpd.c **** static err_t
2516:lwIP/src/apps/http/httpd.c **** http_recv(void *arg, struct altcp_pcb *pcb, struct pbuf *p, err_t err)
2517:lwIP/src/apps/http/httpd.c **** {
2518:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
2519:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_recv: pcb=%p pbuf=%p err=%s\n", (void *)pcb,
2520:lwIP/src/apps/http/httpd.c ****               (void *)p, lwip_strerr(err)));
2521:lwIP/src/apps/http/httpd.c **** 
2522:lwIP/src/apps/http/httpd.c ****   if ((err != ERR_OK) || (p == NULL) || (hs == NULL)) {
2523:lwIP/src/apps/http/httpd.c ****     /* error or closed by other side? */
2524:lwIP/src/apps/http/httpd.c ****     if (p != NULL) {
2525:lwIP/src/apps/http/httpd.c ****       /* Inform TCP that we have taken the data. */
2526:lwIP/src/apps/http/httpd.c ****       altcp_recved(pcb, p->tot_len);
2527:lwIP/src/apps/http/httpd.c ****       pbuf_free(p);
2528:lwIP/src/apps/http/httpd.c ****     }
2529:lwIP/src/apps/http/httpd.c ****     if (hs == NULL) {
2530:lwIP/src/apps/http/httpd.c ****       /* this should not happen, only to be robust */
2531:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("Error, http_recv: hs is NULL, close\n"));
2532:lwIP/src/apps/http/httpd.c ****     }
2533:lwIP/src/apps/http/httpd.c ****     http_close_conn(pcb, hs);
2534:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
2535:lwIP/src/apps/http/httpd.c ****   }
2536:lwIP/src/apps/http/httpd.c **** 
2537:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND
ARM GAS  /tmp/ccQlnpyR.s 			page 46


2538:lwIP/src/apps/http/httpd.c ****   if (hs->no_auto_wnd) {
2539:lwIP/src/apps/http/httpd.c ****     hs->unrecved_bytes += p->tot_len;
2540:lwIP/src/apps/http/httpd.c ****   } else
2541:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST && LWIP_HTTPD_POST_MANUAL_WND */
2542:lwIP/src/apps/http/httpd.c ****   {
2543:lwIP/src/apps/http/httpd.c ****     /* Inform TCP that we have taken the data. */
2544:lwIP/src/apps/http/httpd.c ****     altcp_recved(pcb, p->tot_len);
2545:lwIP/src/apps/http/httpd.c ****   }
2546:lwIP/src/apps/http/httpd.c **** 
2547:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2548:lwIP/src/apps/http/httpd.c ****   if (hs->post_content_len_left > 0) {
2549:lwIP/src/apps/http/httpd.c ****     /* reset idle counter when POST data is received */
2550:lwIP/src/apps/http/httpd.c ****     hs->retries = 0;
2551:lwIP/src/apps/http/httpd.c ****     /* this is data for a POST, pass the complete pbuf to the application */
2552:lwIP/src/apps/http/httpd.c ****     http_post_rxpbuf(hs, p);
2553:lwIP/src/apps/http/httpd.c ****     /* pbuf is passed to the application, don't free it! */
2554:lwIP/src/apps/http/httpd.c ****     if (hs->post_content_len_left == 0) {
2555:lwIP/src/apps/http/httpd.c ****       /* all data received, send response or close connection */
2556:lwIP/src/apps/http/httpd.c ****       http_send(pcb, hs);
2557:lwIP/src/apps/http/httpd.c ****     }
2558:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
2559:lwIP/src/apps/http/httpd.c ****   } else
2560:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2561:lwIP/src/apps/http/httpd.c ****   {
2562:lwIP/src/apps/http/httpd.c ****     if (hs->handle == NULL) {
2563:lwIP/src/apps/http/httpd.c ****       err_t parsed = http_parse_request(p, hs, pcb);
2564:lwIP/src/apps/http/httpd.c ****       LWIP_ASSERT("http_parse_request: unexpected return value", parsed == ERR_OK
2565:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
2566:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
2567:lwIP/src/apps/http/httpd.c ****       if (parsed != ERR_INPROGRESS) {
2568:lwIP/src/apps/http/httpd.c ****         /* request fully parsed or error */
2569:lwIP/src/apps/http/httpd.c ****         if (hs->req != NULL) {
2570:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
2571:lwIP/src/apps/http/httpd.c ****           hs->req = NULL;
2572:lwIP/src/apps/http/httpd.c ****         }
2573:lwIP/src/apps/http/httpd.c ****       }
2574:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
2575:lwIP/src/apps/http/httpd.c ****       pbuf_free(p);
2576:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
2577:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
2578:lwIP/src/apps/http/httpd.c ****         if (hs->post_content_len_left == 0)
2579:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_POST */
2580:lwIP/src/apps/http/httpd.c ****         {
2581:lwIP/src/apps/http/httpd.c ****           LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_recv: data %p len %"S32_F"\n", (const vo
2582:lwIP/src/apps/http/httpd.c ****           http_send(pcb, hs);
2583:lwIP/src/apps/http/httpd.c ****         }
2584:lwIP/src/apps/http/httpd.c ****       } else if (parsed == ERR_ARG) {
2585:lwIP/src/apps/http/httpd.c ****         /* @todo: close on ERR_USE? */
2586:lwIP/src/apps/http/httpd.c ****         http_close_conn(pcb, hs);
2587:lwIP/src/apps/http/httpd.c ****       }
2588:lwIP/src/apps/http/httpd.c ****     } else {
2589:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("http_recv: already sending data\n"));
2590:lwIP/src/apps/http/httpd.c ****       /* already sending but still receiving data, we might want to RST here? */
2591:lwIP/src/apps/http/httpd.c ****       pbuf_free(p);
2592:lwIP/src/apps/http/httpd.c ****     }
2593:lwIP/src/apps/http/httpd.c ****   }
2594:lwIP/src/apps/http/httpd.c ****   return ERR_OK;
ARM GAS  /tmp/ccQlnpyR.s 			page 47


2595:lwIP/src/apps/http/httpd.c **** }
2596:lwIP/src/apps/http/httpd.c **** 
2597:lwIP/src/apps/http/httpd.c **** /**
2598:lwIP/src/apps/http/httpd.c ****  * A new incoming connection has been accepted.
2599:lwIP/src/apps/http/httpd.c ****  */
2600:lwIP/src/apps/http/httpd.c **** static err_t
2601:lwIP/src/apps/http/httpd.c **** http_accept(void *arg, struct altcp_pcb *pcb, err_t err)
2602:lwIP/src/apps/http/httpd.c **** {
  30              		.loc 1 2602 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
2603:lwIP/src/apps/http/httpd.c ****   struct http_state *hs;
  34              		.loc 1 2603 3 view .LVU1
2604:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(err);
  35              		.loc 1 2604 3 view .LVU2
2605:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(arg);
  36              		.loc 1 2605 3 view .LVU3
2606:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("http_accept %p / %p\n", (void *)pcb, arg));
  37              		.loc 1 2606 72 view .LVU4
2607:lwIP/src/apps/http/httpd.c **** 
2608:lwIP/src/apps/http/httpd.c ****   if ((err != ERR_OK) || (pcb == NULL)) {
  38              		.loc 1 2608 3 view .LVU5
  39              		.loc 1 2608 6 is_stmt 0 view .LVU6
  40 0000 82BB     		cbnz	r2, .L6
2602:lwIP/src/apps/http/httpd.c ****   struct http_state *hs;
  41              		.loc 1 2602 1 view .LVU7
  42 0002 70B5     		push	{r4, r5, r6, lr}
  43              	.LCFI0:
  44              		.cfi_def_cfa_offset 16
  45              		.cfi_offset 4, -16
  46              		.cfi_offset 5, -12
  47              		.cfi_offset 6, -8
  48              		.cfi_offset 14, -4
  49              		.loc 1 2608 6 view .LVU8
  50 0004 B1FA81F5 		clz	r5, r1
  51 0008 0C46     		mov	r4, r1
  52 000a 6D09     		lsrs	r5, r5, #5
  53 000c 39B3     		cbz	r1, .L3
2609:lwIP/src/apps/http/httpd.c ****     return ERR_VAL;
2610:lwIP/src/apps/http/httpd.c ****   }
2611:lwIP/src/apps/http/httpd.c **** 
2612:lwIP/src/apps/http/httpd.c ****   /* Set priority */
2613:lwIP/src/apps/http/httpd.c ****   altcp_setprio(pcb, HTTPD_TCP_PRIO);
  54              		.loc 1 2613 3 is_stmt 1 view .LVU9
  55 000e 0121     		movs	r1, #1
  56              	.LVL1:
  57              		.loc 1 2613 3 is_stmt 0 view .LVU10
  58 0010 2046     		mov	r0, r4
  59              	.LVL2:
  60              		.loc 1 2613 3 view .LVU11
  61 0012 FFF7FEFF 		bl	tcp_setprio
  62              	.LVL3:
2614:lwIP/src/apps/http/httpd.c **** 
2615:lwIP/src/apps/http/httpd.c ****   /* Allocate memory for the structure that holds the state of the
2616:lwIP/src/apps/http/httpd.c ****      connection - initialized by that function. */
2617:lwIP/src/apps/http/httpd.c ****   hs = http_state_alloc();
ARM GAS  /tmp/ccQlnpyR.s 			page 48


  63              		.loc 1 2617 3 is_stmt 1 view .LVU12
  64              	.LBB55:
  65              	.LBI55:
 458:lwIP/src/apps/http/httpd.c **** {
  66              		.loc 1 458 1 view .LVU13
  67              	.LBB56:
 460:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED
  68              		.loc 1 460 3 view .LVU14
 460:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_KILL_OLD_ON_CONNECTIONS_EXCEEDED
  69              		.loc 1 460 28 is_stmt 0 view .LVU15
  70 0016 2C20     		movs	r0, #44
  71 0018 FFF7FEFF 		bl	mem_malloc
  72              	.LVL4:
 467:lwIP/src/apps/http/httpd.c ****     http_state_init(ret);
  73              		.loc 1 467 3 is_stmt 1 view .LVU16
 467:lwIP/src/apps/http/httpd.c ****     http_state_init(ret);
  74              		.loc 1 467 6 is_stmt 0 view .LVU17
  75 001c 0646     		mov	r6, r0
  76 001e D8B1     		cbz	r0, .L4
 468:lwIP/src/apps/http/httpd.c ****     http_add_connection(ret);
  77              		.loc 1 468 5 is_stmt 1 view .LVU18
  78              	.LVL5:
  79              	.LBB57:
  80              	.LBI57:
 446:lwIP/src/apps/http/httpd.c **** {
  81              		.loc 1 446 1 view .LVU19
  82              	.LBB58:
 449:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
  83              		.loc 1 449 3 view .LVU20
  84 0020 2C22     		movs	r2, #44
  85 0022 2946     		mov	r1, r5
  86 0024 FFF7FEFF 		bl	memset
  87              	.LVL6:
 449:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_HEADERS
  88              		.loc 1 449 3 is_stmt 0 view .LVU21
  89              	.LBE58:
  90              	.LBE57:
 469:lwIP/src/apps/http/httpd.c ****   }
  91              		.loc 1 469 29 is_stmt 1 view .LVU22
 471:lwIP/src/apps/http/httpd.c **** }
  92              		.loc 1 471 3 view .LVU23
 471:lwIP/src/apps/http/httpd.c **** }
  93              		.loc 1 471 3 is_stmt 0 view .LVU24
  94              	.LBE56:
  95              	.LBE55:
2618:lwIP/src/apps/http/httpd.c ****   if (hs == NULL) {
  96              		.loc 1 2618 3 is_stmt 1 view .LVU25
2619:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("http_accept: Out of memory, RST\n"));
2620:lwIP/src/apps/http/httpd.c ****     return ERR_MEM;
2621:lwIP/src/apps/http/httpd.c ****   }
2622:lwIP/src/apps/http/httpd.c ****   hs->pcb = pcb;
  97              		.loc 1 2622 3 view .LVU26
2623:lwIP/src/apps/http/httpd.c **** 
2624:lwIP/src/apps/http/httpd.c ****   /* Tell TCP that this is the structure we wish to be passed for our
2625:lwIP/src/apps/http/httpd.c ****      callbacks. */
2626:lwIP/src/apps/http/httpd.c ****   altcp_arg(pcb, hs);
  98              		.loc 1 2626 3 is_stmt 0 view .LVU27
ARM GAS  /tmp/ccQlnpyR.s 			page 49


  99 0028 3146     		mov	r1, r6
 100 002a 2046     		mov	r0, r4
2622:lwIP/src/apps/http/httpd.c **** 
 101              		.loc 1 2622 11 view .LVU28
 102 002c F461     		str	r4, [r6, #28]
 103              		.loc 1 2626 3 is_stmt 1 view .LVU29
 104 002e FFF7FEFF 		bl	tcp_arg
 105              	.LVL7:
2627:lwIP/src/apps/http/httpd.c **** 
2628:lwIP/src/apps/http/httpd.c ****   /* Set up the various callback functions */
2629:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, http_recv);
 106              		.loc 1 2629 3 view .LVU30
 107 0032 2046     		mov	r0, r4
 108 0034 0D49     		ldr	r1, .L10
 109 0036 FFF7FEFF 		bl	tcp_recv
 110              	.LVL8:
2630:lwIP/src/apps/http/httpd.c ****   altcp_err(pcb, http_err);
 111              		.loc 1 2630 3 view .LVU31
 112 003a 2046     		mov	r0, r4
 113 003c 0C49     		ldr	r1, .L10+4
 114 003e FFF7FEFF 		bl	tcp_err
 115              	.LVL9:
2631:lwIP/src/apps/http/httpd.c ****   altcp_poll(pcb, http_poll, HTTPD_POLL_INTERVAL);
 116              		.loc 1 2631 3 view .LVU32
 117 0042 0422     		movs	r2, #4
 118 0044 2046     		mov	r0, r4
 119 0046 0B49     		ldr	r1, .L10+8
 120 0048 FFF7FEFF 		bl	tcp_poll
 121              	.LVL10:
2632:lwIP/src/apps/http/httpd.c ****   altcp_sent(pcb, http_sent);
 122              		.loc 1 2632 3 view .LVU33
 123 004c 2046     		mov	r0, r4
 124 004e 0A49     		ldr	r1, .L10+12
 125 0050 FFF7FEFF 		bl	tcp_sent
 126              	.LVL11:
2633:lwIP/src/apps/http/httpd.c **** 
2634:lwIP/src/apps/http/httpd.c ****   return ERR_OK;
 127              		.loc 1 2634 3 view .LVU34
 128              		.loc 1 2634 10 is_stmt 0 view .LVU35
 129 0054 2846     		mov	r0, r5
 130              	.LVL12:
2635:lwIP/src/apps/http/httpd.c **** }
 131              		.loc 1 2635 1 view .LVU36
 132 0056 70BD     		pop	{r4, r5, r6, pc}
 133              	.LVL13:
 134              	.L4:
2620:lwIP/src/apps/http/httpd.c ****   }
 135              		.loc 1 2620 12 view .LVU37
 136 0058 4FF0FF30 		mov	r0, #-1
 137              	.LVL14:
 138              		.loc 1 2635 1 view .LVU38
 139 005c 70BD     		pop	{r4, r5, r6, pc}
 140              	.LVL15:
 141              	.L3:
2609:lwIP/src/apps/http/httpd.c ****   }
 142              		.loc 1 2609 12 view .LVU39
 143 005e 6FF00500 		mvn	r0, #5
ARM GAS  /tmp/ccQlnpyR.s 			page 50


 144              	.LVL16:
 145              		.loc 1 2635 1 view .LVU40
 146 0062 70BD     		pop	{r4, r5, r6, pc}
 147              	.LVL17:
 148              	.L6:
 149              	.LCFI1:
 150              		.cfi_def_cfa_offset 0
 151              		.cfi_restore 4
 152              		.cfi_restore 5
 153              		.cfi_restore 6
 154              		.cfi_restore 14
2609:lwIP/src/apps/http/httpd.c ****   }
 155              		.loc 1 2609 12 view .LVU41
 156 0064 6FF00500 		mvn	r0, #5
 157              	.LVL18:
 158              		.loc 1 2635 1 view .LVU42
 159 0068 7047     		bx	lr
 160              	.L11:
 161 006a 00BF     		.align	2
 162              	.L10:
 163 006c 00000000 		.word	http_recv
 164 0070 00000000 		.word	http_err
 165 0074 00000000 		.word	http_poll
 166 0078 00000000 		.word	http_sent
 167              		.cfi_endproc
 168              	.LFE124:
 170              		.section	.text.http_err,"ax",%progbits
 171              		.align	1
 172              		.p2align 2,,3
 173              		.syntax unified
 174              		.thumb
 175              		.thumb_func
 176              		.fpu fpv4-sp-d16
 178              	http_err:
 179              	.LVL19:
 180              	.LFB120:
2425:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 181              		.loc 1 2425 1 is_stmt 1 view -0
 182              		.cfi_startproc
 183              		@ args = 0, pretend = 0, frame = 0
 184              		@ frame_needed = 0, uses_anonymous_args = 0
2426:lwIP/src/apps/http/httpd.c ****   LWIP_UNUSED_ARG(err);
 185              		.loc 1 2426 3 view .LVU44
2427:lwIP/src/apps/http/httpd.c **** 
 186              		.loc 1 2427 3 view .LVU45
2429:lwIP/src/apps/http/httpd.c **** 
 187              		.loc 1 2429 63 view .LVU46
2431:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
 188              		.loc 1 2431 3 view .LVU47
2431:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
 189              		.loc 1 2431 6 is_stmt 0 view .LVU48
 190 0000 90B1     		cbz	r0, .L12
2432:lwIP/src/apps/http/httpd.c ****   }
 191              		.loc 1 2432 5 is_stmt 1 view .LVU49
 192              	.LVL20:
 193              	.LBB65:
 194              	.LBI65:
ARM GAS  /tmp/ccQlnpyR.s 			page 51


 514:lwIP/src/apps/http/httpd.c **** {
 195              		.loc 1 514 1 view .LVU50
 196              	.LBE65:
 516:lwIP/src/apps/http/httpd.c ****     http_state_eof(hs);
 197              		.loc 1 516 3 view .LVU51
 198              	.LBB76:
 199              	.LBB66:
 200              	.LBI66:
 514:lwIP/src/apps/http/httpd.c **** {
 201              		.loc 1 514 1 view .LVU52
 202              	.LBB67:
 517:lwIP/src/apps/http/httpd.c ****     http_remove_connection(hs);
 203              		.loc 1 517 5 view .LVU53
 204              	.LBB68:
 205              	.LBI68:
 478:lwIP/src/apps/http/httpd.c **** {
 206              		.loc 1 478 1 view .LVU54
 207              	.LBB69:
 480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 208              		.loc 1 480 3 view .LVU55
 209              	.LBE69:
 210              	.LBE68:
 211              	.LBE67:
 212              	.LBE66:
 213              	.LBE76:
2425:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 214              		.loc 1 2425 1 is_stmt 0 view .LVU56
 215 0002 10B5     		push	{r4, lr}
 216              	.LCFI2:
 217              		.cfi_def_cfa_offset 8
 218              		.cfi_offset 4, -8
 219              		.cfi_offset 14, -4
 220 0004 0446     		mov	r4, r0
 221              	.LBB77:
 222              	.LBB74:
 223              	.LBB72:
 224              	.LBB71:
 225              	.LBB70:
 480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 226              		.loc 1 480 9 view .LVU57
 227 0006 4069     		ldr	r0, [r0, #20]
 228              	.LVL21:
 480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 229              		.loc 1 480 6 view .LVU58
 230 0008 18B1     		cbz	r0, .L14
 487:lwIP/src/apps/http/httpd.c ****     hs->handle = NULL;
 231              		.loc 1 487 5 is_stmt 1 view .LVU59
 232 000a FFF7FEFF 		bl	fs_close
 233              	.LVL22:
 488:lwIP/src/apps/http/httpd.c ****   }
 234              		.loc 1 488 5 view .LVU60
 488:lwIP/src/apps/http/httpd.c ****   }
 235              		.loc 1 488 16 is_stmt 0 view .LVU61
 236 000e 0023     		movs	r3, #0
 237 0010 6361     		str	r3, [r4, #20]
 238              	.L14:
 503:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
ARM GAS  /tmp/ccQlnpyR.s 			page 52


 239              		.loc 1 503 3 is_stmt 1 view .LVU62
 503:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
 240              		.loc 1 503 9 is_stmt 0 view .LVU63
 241 0012 206A     		ldr	r0, [r4, #32]
 503:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
 242              		.loc 1 503 6 view .LVU64
 243 0014 18B1     		cbz	r0, .L15
 504:lwIP/src/apps/http/httpd.c ****     hs->req = NULL;
 244              		.loc 1 504 5 is_stmt 1 view .LVU65
 245 0016 FFF7FEFF 		bl	pbuf_free
 246              	.LVL23:
 505:lwIP/src/apps/http/httpd.c ****   }
 247              		.loc 1 505 5 view .LVU66
 505:lwIP/src/apps/http/httpd.c ****   }
 248              		.loc 1 505 13 is_stmt 0 view .LVU67
 249 001a 0023     		movs	r3, #0
 250 001c 2362     		str	r3, [r4, #32]
 251              	.L15:
 252              	.LBE70:
 253              	.LBE71:
 518:lwIP/src/apps/http/httpd.c ****     HTTP_FREE_HTTP_STATE(hs);
 254              		.loc 1 518 31 is_stmt 1 view .LVU68
 519:lwIP/src/apps/http/httpd.c ****   }
 255              		.loc 1 519 5 view .LVU69
 256 001e 2046     		mov	r0, r4
 257              	.LBE72:
 258              	.LBE74:
 259              	.LBE77:
2434:lwIP/src/apps/http/httpd.c **** 
 260              		.loc 1 2434 1 is_stmt 0 view .LVU70
 261 0020 BDE81040 		pop	{r4, lr}
 262              	.LCFI3:
 263              		.cfi_restore 14
 264              		.cfi_restore 4
 265              		.cfi_def_cfa_offset 0
 266              	.LVL24:
 267              	.LBB78:
 268              	.LBB75:
 269              	.LBB73:
 519:lwIP/src/apps/http/httpd.c ****   }
 270              		.loc 1 519 5 view .LVU71
 271 0024 FFF7FEBF 		b	mem_free
 272              	.LVL25:
 273              	.L12:
 519:lwIP/src/apps/http/httpd.c ****   }
 274              		.loc 1 519 5 view .LVU72
 275 0028 7047     		bx	lr
 276              	.LBE73:
 277              	.LBE75:
 278              	.LBE78:
 279              		.cfi_endproc
 280              	.LFE120:
 282 002a 00BF     		.section	.text.http_close_or_abort_conn.constprop.0,"ax",%progbits
 283              		.align	1
 284              		.p2align 2,,3
 285              		.syntax unified
 286              		.thumb
ARM GAS  /tmp/ccQlnpyR.s 			page 53


 287              		.thumb_func
 288              		.fpu fpv4-sp-d16
 290              	http_close_or_abort_conn.constprop.0:
 291              	.LVL26:
 292              	.LFB136:
 596:lwIP/src/apps/http/httpd.c **** {
 293              		.loc 1 596 1 is_stmt 1 view -0
 294              		.cfi_startproc
 295              		@ args = 0, pretend = 0, frame = 0
 296              		@ frame_needed = 0, uses_anonymous_args = 0
 598:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("Closing connection %p\n", (void *)pcb));
 297              		.loc 1 598 3 view .LVU74
 599:lwIP/src/apps/http/httpd.c **** 
 298              		.loc 1 599 69 view .LVU75
 616:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 299              		.loc 1 616 3 view .LVU76
 596:lwIP/src/apps/http/httpd.c **** {
 300              		.loc 1 596 1 is_stmt 0 view .LVU77
 301 0000 38B5     		push	{r3, r4, r5, lr}
 302              	.LCFI4:
 303              		.cfi_def_cfa_offset 16
 304              		.cfi_offset 3, -16
 305              		.cfi_offset 4, -12
 306              		.cfi_offset 5, -8
 307              		.cfi_offset 14, -4
 596:lwIP/src/apps/http/httpd.c **** {
 308              		.loc 1 596 1 view .LVU78
 309 0002 0446     		mov	r4, r0
 310 0004 0D46     		mov	r5, r1
 616:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 311              		.loc 1 616 3 view .LVU79
 312 0006 0021     		movs	r1, #0
 313              	.LVL27:
 616:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 314              		.loc 1 616 3 view .LVU80
 315 0008 FFF7FEFF 		bl	tcp_arg
 316              	.LVL28:
 617:lwIP/src/apps/http/httpd.c ****   altcp_err(pcb, NULL);
 317              		.loc 1 617 3 is_stmt 1 view .LVU81
 318 000c 0021     		movs	r1, #0
 319 000e 2046     		mov	r0, r4
 320 0010 FFF7FEFF 		bl	tcp_recv
 321              	.LVL29:
 618:lwIP/src/apps/http/httpd.c ****   altcp_poll(pcb, NULL, 0);
 322              		.loc 1 618 3 view .LVU82
 323 0014 2046     		mov	r0, r4
 324 0016 0021     		movs	r1, #0
 325 0018 FFF7FEFF 		bl	tcp_err
 326              	.LVL30:
 619:lwIP/src/apps/http/httpd.c ****   altcp_sent(pcb, NULL);
 327              		.loc 1 619 3 view .LVU83
 328 001c 0022     		movs	r2, #0
 329 001e 2046     		mov	r0, r4
 330 0020 1146     		mov	r1, r2
 331 0022 FFF7FEFF 		bl	tcp_poll
 332              	.LVL31:
 620:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
ARM GAS  /tmp/ccQlnpyR.s 			page 54


 333              		.loc 1 620 3 view .LVU84
 334 0026 2046     		mov	r0, r4
 335 0028 0021     		movs	r1, #0
 336 002a FFF7FEFF 		bl	tcp_sent
 337              	.LVL32:
 621:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
 338              		.loc 1 621 3 view .LVU85
 621:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
 339              		.loc 1 621 6 is_stmt 0 view .LVU86
 340 002e 75B1     		cbz	r5, .L26
 622:lwIP/src/apps/http/httpd.c ****   }
 341              		.loc 1 622 5 is_stmt 1 view .LVU87
 342              	.LVL33:
 343              	.LBB87:
 344              	.LBI87:
 514:lwIP/src/apps/http/httpd.c **** {
 345              		.loc 1 514 1 view .LVU88
 346              	.LBE87:
 516:lwIP/src/apps/http/httpd.c ****     http_state_eof(hs);
 347              		.loc 1 516 3 view .LVU89
 348              	.LBB92:
 349              	.LBB88:
 350              	.LBI88:
 514:lwIP/src/apps/http/httpd.c **** {
 351              		.loc 1 514 1 view .LVU90
 352              	.LBB89:
 517:lwIP/src/apps/http/httpd.c ****     http_remove_connection(hs);
 353              		.loc 1 517 5 view .LVU91
 354              	.LBB90:
 355              	.LBI90:
 478:lwIP/src/apps/http/httpd.c **** {
 356              		.loc 1 478 1 view .LVU92
 357              	.LBB91:
 480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 358              		.loc 1 480 3 view .LVU93
 480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 359              		.loc 1 480 9 is_stmt 0 view .LVU94
 360 0030 6869     		ldr	r0, [r5, #20]
 480:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 361              		.loc 1 480 6 view .LVU95
 362 0032 18B1     		cbz	r0, .L27
 487:lwIP/src/apps/http/httpd.c ****     hs->handle = NULL;
 363              		.loc 1 487 5 is_stmt 1 view .LVU96
 364 0034 FFF7FEFF 		bl	fs_close
 365              	.LVL34:
 488:lwIP/src/apps/http/httpd.c ****   }
 366              		.loc 1 488 5 view .LVU97
 488:lwIP/src/apps/http/httpd.c ****   }
 367              		.loc 1 488 16 is_stmt 0 view .LVU98
 368 0038 0023     		movs	r3, #0
 369 003a 6B61     		str	r3, [r5, #20]
 370              	.L27:
 503:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
 371              		.loc 1 503 3 is_stmt 1 view .LVU99
 503:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
 372              		.loc 1 503 9 is_stmt 0 view .LVU100
 373 003c 286A     		ldr	r0, [r5, #32]
ARM GAS  /tmp/ccQlnpyR.s 			page 55


 503:lwIP/src/apps/http/httpd.c ****     pbuf_free(hs->req);
 374              		.loc 1 503 6 view .LVU101
 375 003e 18B1     		cbz	r0, .L28
 504:lwIP/src/apps/http/httpd.c ****     hs->req = NULL;
 376              		.loc 1 504 5 is_stmt 1 view .LVU102
 377 0040 FFF7FEFF 		bl	pbuf_free
 378              	.LVL35:
 505:lwIP/src/apps/http/httpd.c ****   }
 379              		.loc 1 505 5 view .LVU103
 505:lwIP/src/apps/http/httpd.c ****   }
 380              		.loc 1 505 13 is_stmt 0 view .LVU104
 381 0044 0023     		movs	r3, #0
 382 0046 2B62     		str	r3, [r5, #32]
 383              	.L28:
 384              	.LBE91:
 385              	.LBE90:
 518:lwIP/src/apps/http/httpd.c ****     HTTP_FREE_HTTP_STATE(hs);
 386              		.loc 1 518 31 is_stmt 1 view .LVU105
 519:lwIP/src/apps/http/httpd.c ****   }
 387              		.loc 1 519 5 view .LVU106
 388 0048 2846     		mov	r0, r5
 389 004a FFF7FEFF 		bl	mem_free
 390              	.LVL36:
 391              	.L26:
 519:lwIP/src/apps/http/httpd.c ****   }
 392              		.loc 1 519 5 is_stmt 0 view .LVU107
 393              	.LBE89:
 394              	.LBE88:
 395              	.LBE92:
 625:lwIP/src/apps/http/httpd.c ****     altcp_abort(pcb);
 396              		.loc 1 625 3 is_stmt 1 view .LVU108
 629:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 397              		.loc 1 629 3 view .LVU109
 629:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 398              		.loc 1 629 9 is_stmt 0 view .LVU110
 399 004e 2046     		mov	r0, r4
 400 0050 FFF7FEFF 		bl	tcp_close
 401              	.LVL37:
 630:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error %d closing %p\n", err, (void *)pcb));
 402              		.loc 1 630 3 is_stmt 1 view .LVU111
 630:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error %d closing %p\n", err, (void *)pcb));
 403              		.loc 1 630 6 is_stmt 0 view .LVU112
 404 0054 0546     		mov	r5, r0
 405              	.LVL38:
 630:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error %d closing %p\n", err, (void *)pcb));
 406              		.loc 1 630 6 view .LVU113
 407 0056 08B9     		cbnz	r0, .L43
 636:lwIP/src/apps/http/httpd.c **** 
 408              		.loc 1 636 1 view .LVU114
 409 0058 2846     		mov	r0, r5
 410              	.LVL39:
 636:lwIP/src/apps/http/httpd.c **** 
 411              		.loc 1 636 1 view .LVU115
 412 005a 38BD     		pop	{r3, r4, r5, pc}
 413              	.LVL40:
 414              	.L43:
 631:lwIP/src/apps/http/httpd.c ****     /* error closing, try again later in poll */
ARM GAS  /tmp/ccQlnpyR.s 			page 56


 415              		.loc 1 631 74 is_stmt 1 view .LVU116
 633:lwIP/src/apps/http/httpd.c ****   }
 416              		.loc 1 633 5 view .LVU117
 417 005c 2046     		mov	r0, r4
 418              	.LVL41:
 633:lwIP/src/apps/http/httpd.c ****   }
 419              		.loc 1 633 5 is_stmt 0 view .LVU118
 420 005e 0422     		movs	r2, #4
 421 0060 0249     		ldr	r1, .L44
 422 0062 FFF7FEFF 		bl	tcp_poll
 423              	.LVL42:
 636:lwIP/src/apps/http/httpd.c **** 
 424              		.loc 1 636 1 view .LVU119
 425 0066 2846     		mov	r0, r5
 426 0068 38BD     		pop	{r3, r4, r5, pc}
 427              	.LVL43:
 428              	.L45:
 636:lwIP/src/apps/http/httpd.c **** 
 429              		.loc 1 636 1 view .LVU120
 430 006a 00BF     		.align	2
 431              	.L44:
 432 006c 00000000 		.word	http_poll
 433              		.cfi_endproc
 434              	.LFE136:
 436              		.section	.rodata.http_send.str1.4,"aMS",%progbits,1
 437              		.align	2
 438              	.LC0:
 439 0000 53534920 		.ascii	"SSI and DYNAMIC_HEADERS turned off but eof not reac"
 439      616E6420 
 439      44594E41 
 439      4D49435F 
 439      48454144 
 440 0033 68656400 		.ascii	"hed\000"
 441              		.section	.text.http_send,"ax",%progbits
 442              		.align	1
 443              		.p2align 2,,3
 444              		.syntax unified
 445              		.thumb
 446              		.thumb_func
 447              		.fpu fpv4-sp-d16
 449              	http_send:
 450              	.LVL44:
 451              	.LFB115:
1560:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = HTTP_NO_DATA_TO_SEND;
 452              		.loc 1 1560 1 is_stmt 1 view -0
 453              		.cfi_startproc
 454              		@ args = 0, pretend = 0, frame = 0
 455              		@ frame_needed = 0, uses_anonymous_args = 0
1561:lwIP/src/apps/http/httpd.c **** 
 456              		.loc 1 1561 3 view .LVU122
1564:lwIP/src/apps/http/httpd.c **** 
 457              		.loc 1 1564 59 view .LVU123
1573:lwIP/src/apps/http/httpd.c ****     return 0;
 458              		.loc 1 1573 3 view .LVU124
1560:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = HTTP_NO_DATA_TO_SEND;
 459              		.loc 1 1560 1 is_stmt 0 view .LVU125
 460 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
ARM GAS  /tmp/ccQlnpyR.s 			page 57


 461              	.LCFI5:
 462              		.cfi_def_cfa_offset 24
 463              		.cfi_offset 3, -24
 464              		.cfi_offset 4, -20
 465              		.cfi_offset 5, -16
 466              		.cfi_offset 6, -12
 467              		.cfi_offset 7, -8
 468              		.cfi_offset 14, -4
1573:lwIP/src/apps/http/httpd.c ****     return 0;
 469              		.loc 1 1573 6 view .LVU126
 470 0002 0D46     		mov	r5, r1
 471 0004 0029     		cmp	r1, #0
 472 0006 4DD0     		beq	.L63
1599:lwIP/src/apps/http/httpd.c ****     if (!http_check_eof(pcb, hs)) {
 473              		.loc 1 1599 3 is_stmt 1 view .LVU127
1599:lwIP/src/apps/http/httpd.c ****     if (!http_check_eof(pcb, hs)) {
 474              		.loc 1 1599 9 is_stmt 0 view .LVU128
 475 0008 4B6A     		ldr	r3, [r1, #36]
 476 000a 0646     		mov	r6, r0
1599:lwIP/src/apps/http/httpd.c ****     if (!http_check_eof(pcb, hs)) {
 477              		.loc 1 1599 6 view .LVU129
 478 000c 53B9     		cbnz	r3, .L48
1600:lwIP/src/apps/http/httpd.c ****       return 0;
 479              		.loc 1 1600 5 is_stmt 1 view .LVU130
 480              	.LVL45:
 481              	.LBB110:
 482              	.LBI110:
1093:lwIP/src/apps/http/httpd.c **** {
 483              		.loc 1 1093 1 view .LVU131
 484              	.LBB111:
1095:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_DYNAMIC_FILE_READ
 485              		.loc 1 1095 3 view .LVU132
1104:lwIP/src/apps/http/httpd.c ****     /* No - close the connection. */
 486              		.loc 1 1104 3 view .LVU133
1104:lwIP/src/apps/http/httpd.c ****     /* No - close the connection. */
 487              		.loc 1 1104 9 is_stmt 0 view .LVU134
 488 000e 4869     		ldr	r0, [r1, #20]
 489              	.LVL46:
1104:lwIP/src/apps/http/httpd.c ****     /* No - close the connection. */
 490              		.loc 1 1104 6 view .LVU135
 491 0010 0028     		cmp	r0, #0
 492 0012 43D0     		beq	.L50
1109:lwIP/src/apps/http/httpd.c ****   if (bytes_left <= 0) {
 493              		.loc 1 1109 3 is_stmt 1 view .LVU136
1109:lwIP/src/apps/http/httpd.c ****   if (bytes_left <= 0) {
 494              		.loc 1 1109 16 is_stmt 0 view .LVU137
 495 0014 FFF7FEFF 		bl	fs_bytes_left
 496              	.LVL47:
1110:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done. */
 497              		.loc 1 1110 3 is_stmt 1 view .LVU138
1110:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done. */
 498              		.loc 1 1110 6 is_stmt 0 view .LVU139
 499 0018 0028     		cmp	r0, #0
 500 001a 3FDD     		ble	.L50
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 501              		.loc 1 1181 3 is_stmt 1 view .LVU140
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
ARM GAS  /tmp/ccQlnpyR.s 			page 58


 502              		.loc 1 1181 3 view .LVU141
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 503              		.loc 1 1181 3 view .LVU142
 504 001c 2548     		ldr	r0, .L68
 505              	.LVL48:
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 506              		.loc 1 1181 3 is_stmt 0 view .LVU143
 507 001e FFF7FEFF 		bl	printf
 508              	.LVL49:
 509              	.L51:
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 510              		.loc 1 1181 3 is_stmt 1 view .LVU144
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 511              		.loc 1 1181 3 view .LVU145
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 512              		.loc 1 1181 3 view .LVU146
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 513              		.loc 1 1181 3 view .LVU147
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 514              		.loc 1 1181 3 view .LVU148
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 515              		.loc 1 1181 3 view .LVU149
 516 0022 FEE7     		b	.L51
 517              	.LVL50:
 518              	.L48:
1181:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI || LWIP_HTTPD_DYNAMIC_HEADERS */
 519              		.loc 1 1181 3 is_stmt 0 view .LVU150
 520              	.LBE111:
 521              	.LBE110:
 522              	.LBB118:
 523              	.LBI118:
1559:lwIP/src/apps/http/httpd.c **** {
 524              		.loc 1 1559 1 is_stmt 1 view .LVU151
 525              	.LBB119:
1611:lwIP/src/apps/http/httpd.c ****   }
 526              		.loc 1 1611 5 view .LVU152
 527              	.LBB120:
 528              	.LBI120:
1192:lwIP/src/apps/http/httpd.c **** {
 529              		.loc 1 1192 1 view .LVU153
 530              	.LBB121:
1194:lwIP/src/apps/http/httpd.c ****   u16_t len;
 531              		.loc 1 1194 3 view .LVU154
1195:lwIP/src/apps/http/httpd.c ****   u8_t data_to_send = 0;
 532              		.loc 1 1195 3 view .LVU155
1196:lwIP/src/apps/http/httpd.c **** 
 533              		.loc 1 1196 3 view .LVU156
1200:lwIP/src/apps/http/httpd.c **** 
 534              		.loc 1 1200 3 view .LVU157
 535              	.LBB122:
 536              	.LBB123:
 549:lwIP/src/apps/http/httpd.c ****   if (len > max_len) {
 537              		.loc 1 549 11 is_stmt 0 view .LVU158
 538 0024 418E     		ldrh	r1, [r0, #50]
 539              	.LVL51:
 549:lwIP/src/apps/http/httpd.c ****   if (len > max_len) {
 540              		.loc 1 549 11 view .LVU159
ARM GAS  /tmp/ccQlnpyR.s 			page 59


 541              	.LBE123:
 542              	.LBE122:
1200:lwIP/src/apps/http/httpd.c **** 
 543              		.loc 1 1200 9 view .LVU160
 544 0026 4FF6FE74 		movw	r4, #65534
 545 002a 4FF6FF72 		movw	r2, #65535
 546 002e B0F86400 		ldrh	r0, [r0, #100]
 547              	.LVL52:
 548              	.LBB128:
 549              	.LBB124:
 549:lwIP/src/apps/http/httpd.c ****   if (len > max_len) {
 550              		.loc 1 549 11 view .LVU161
 551 0032 4900     		lsls	r1, r1, #1
 552              	.LBE124:
 553              	.LBE128:
1202:lwIP/src/apps/http/httpd.c ****   if (err == ERR_OK) {
 554              		.loc 1 1202 27 view .LVU162
 555 0034 AF69     		ldr	r7, [r5, #24]
1200:lwIP/src/apps/http/httpd.c **** 
 556              		.loc 1 1200 9 view .LVU163
 557 0036 A342     		cmp	r3, r4
 558 0038 88BF     		it	hi
 559 003a 1346     		movhi	r3, r2
 560              	.LVL53:
1202:lwIP/src/apps/http/httpd.c ****   if (err == ERR_OK) {
 561              		.loc 1 1202 3 is_stmt 1 view .LVU164
 562              	.LBB129:
 563              	.LBI122:
 533:lwIP/src/apps/http/httpd.c **** {
 564              		.loc 1 533 1 view .LVU165
 565              	.LBB125:
 535:lwIP/src/apps/http/httpd.c ****   err_t err;
 566              		.loc 1 535 3 view .LVU166
 536:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("length != NULL", length != NULL);
 567              		.loc 1 536 3 view .LVU167
 537:lwIP/src/apps/http/httpd.c ****   len = *length;
 568              		.loc 1 537 3 view .LVU168
 537:lwIP/src/apps/http/httpd.c ****   len = *length;
 569              		.loc 1 537 3 view .LVU169
 537:lwIP/src/apps/http/httpd.c ****   len = *length;
 570              		.loc 1 537 3 view .LVU170
 538:lwIP/src/apps/http/httpd.c ****   if (len == 0) {
 571              		.loc 1 538 3 view .LVU171
 539:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
 572              		.loc 1 539 3 view .LVU172
 543:lwIP/src/apps/http/httpd.c ****   if (max_len < len) {
 573              		.loc 1 543 3 view .LVU173
 544:lwIP/src/apps/http/httpd.c ****     len = max_len;
 574              		.loc 1 544 3 view .LVU174
 549:lwIP/src/apps/http/httpd.c ****   if (len > max_len) {
 575              		.loc 1 549 3 view .LVU175
 550:lwIP/src/apps/http/httpd.c ****     len = max_len;
 576              		.loc 1 550 3 view .LVU176
 577 003c 8CB2     		uxth	r4, r1
 578 003e 9AB2     		uxth	r2, r3
 579 0040 8442     		cmp	r4, r0
 580 0042 28BF     		it	cs
ARM GAS  /tmp/ccQlnpyR.s 			page 60


 581 0044 0446     		movcs	r4, r0
 582 0046 9442     		cmp	r4, r2
 583 0048 28BF     		it	cs
 584 004a 1446     		movcs	r4, r2
 585              	.LVL54:
 586              	.L57:
 554:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Trying to send %d bytes\n", len));
 587              		.loc 1 554 3 view .LVU177
 555:lwIP/src/apps/http/httpd.c ****     err = altcp_write(pcb, ptr, len, apiflags);
 588              		.loc 1 555 82 view .LVU178
 556:lwIP/src/apps/http/httpd.c ****     if (err == ERR_MEM) {
 589              		.loc 1 556 5 view .LVU179
 556:lwIP/src/apps/http/httpd.c ****     if (err == ERR_MEM) {
 590              		.loc 1 556 11 is_stmt 0 view .LVU180
 591 004c 0023     		movs	r3, #0
 592 004e 2246     		mov	r2, r4
 593 0050 3946     		mov	r1, r7
 594 0052 3046     		mov	r0, r6
 595 0054 FFF7FEFF 		bl	tcp_write
 596              	.LVL55:
 557:lwIP/src/apps/http/httpd.c ****       if ((altcp_sndbuf(pcb) == 0) ||
 597              		.loc 1 557 5 is_stmt 1 view .LVU181
 557:lwIP/src/apps/http/httpd.c ****       if ((altcp_sndbuf(pcb) == 0) ||
 598              		.loc 1 557 8 is_stmt 0 view .LVU182
 599 0058 431C     		adds	r3, r0, #1
 600 005a 0AD0     		beq	.L64
 601              	.LVL56:
 570:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Sent %d bytes\n", len));
 602              		.loc 1 570 3 is_stmt 1 view .LVU183
 603 005c 6B6A     		ldr	r3, [r5, #36]
 570:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Sent %d bytes\n", len));
 604              		.loc 1 570 6 is_stmt 0 view .LVU184
 605 005e 20BB     		cbnz	r0, .L65
 606              	.LVL57:
 570:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("Sent %d bytes\n", len));
 607              		.loc 1 570 6 view .LVU185
 608              	.LBE125:
 609              	.LBE129:
1203:lwIP/src/apps/http/httpd.c ****     data_to_send = 1;
 610              		.loc 1 1203 3 is_stmt 1 view .LVU186
1204:lwIP/src/apps/http/httpd.c ****     hs->file += len;
 611              		.loc 1 1204 5 view .LVU187
1205:lwIP/src/apps/http/httpd.c ****     hs->left -= len;
 612              		.loc 1 1205 5 view .LVU188
1205:lwIP/src/apps/http/httpd.c ****     hs->left -= len;
 613              		.loc 1 1205 14 is_stmt 0 view .LVU189
 614 0060 AA69     		ldr	r2, [r5, #24]
1206:lwIP/src/apps/http/httpd.c ****   }
 615              		.loc 1 1206 14 view .LVU190
 616 0062 1B1B     		subs	r3, r3, r4
1204:lwIP/src/apps/http/httpd.c ****     hs->file += len;
 617              		.loc 1 1204 18 view .LVU191
 618 0064 0127     		movs	r7, #1
1205:lwIP/src/apps/http/httpd.c ****     hs->left -= len;
 619              		.loc 1 1205 14 view .LVU192
 620 0066 2244     		add	r2, r2, r4
1206:lwIP/src/apps/http/httpd.c ****   }
ARM GAS  /tmp/ccQlnpyR.s 			page 61


 621              		.loc 1 1206 14 view .LVU193
 622 0068 6B62     		str	r3, [r5, #36]
1205:lwIP/src/apps/http/httpd.c ****     hs->left -= len;
 623              		.loc 1 1205 14 view .LVU194
 624 006a AA61     		str	r2, [r5, #24]
1206:lwIP/src/apps/http/httpd.c ****   }
 625              		.loc 1 1206 5 is_stmt 1 view .LVU195
 626              	.LVL58:
1209:lwIP/src/apps/http/httpd.c **** }
 627              		.loc 1 1209 3 view .LVU196
1209:lwIP/src/apps/http/httpd.c **** }
 628              		.loc 1 1209 3 is_stmt 0 view .LVU197
 629              	.LBE121:
 630              	.LBE120:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 631              		.loc 1 1614 3 is_stmt 1 view .LVU198
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 632              		.loc 1 1614 6 is_stmt 0 view .LVU199
 633 006c 8BB1     		cbz	r3, .L66
 634              	.L60:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 635              		.loc 1 1614 6 view .LVU200
 636              	.LBE119:
 637              	.LBE118:
1623:lwIP/src/apps/http/httpd.c **** 
 638              		.loc 1 1623 1 view .LVU201
 639 006e 3846     		mov	r0, r7
 640 0070 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 641              	.LVL59:
 642              	.L64:
 643              	.LBB140:
 644              	.LBB138:
 645              	.LBB135:
 646              	.LBB132:
 647              	.LBB130:
 648              	.LBB126:
 558:lwIP/src/apps/http/httpd.c ****           (altcp_sndqueuelen(pcb) >= TCP_SND_QUEUELEN)) {
 649              		.loc 1 558 7 is_stmt 1 view .LVU202
 558:lwIP/src/apps/http/httpd.c ****           (altcp_sndqueuelen(pcb) >= TCP_SND_QUEUELEN)) {
 650              		.loc 1 558 10 is_stmt 0 view .LVU203
 651 0072 B6F86430 		ldrh	r3, [r6, #100]
 652 0076 23B1     		cbz	r3, .L56
 563:lwIP/src/apps/http/httpd.c ****       }
 653              		.loc 1 563 9 is_stmt 1 view .LVU204
 558:lwIP/src/apps/http/httpd.c ****           (altcp_sndqueuelen(pcb) >= TCP_SND_QUEUELEN)) {
 654              		.loc 1 558 36 is_stmt 0 view .LVU205
 655 0078 B6F86630 		ldrh	r3, [r6, #102]
 563:lwIP/src/apps/http/httpd.c ****       }
 656              		.loc 1 563 13 view .LVU206
 657 007c 6408     		lsrs	r4, r4, #1
 658              	.LVL60:
 566:lwIP/src/apps/http/httpd.c ****     }
 659              		.loc 1 566 66 is_stmt 1 view .LVU207
 568:lwIP/src/apps/http/httpd.c **** 
 660              		.loc 1 568 11 view .LVU208
 558:lwIP/src/apps/http/httpd.c ****           (altcp_sndqueuelen(pcb) >= TCP_SND_QUEUELEN)) {
 661              		.loc 1 558 36 is_stmt 0 view .LVU209
ARM GAS  /tmp/ccQlnpyR.s 			page 62


 662 007e 072B     		cmp	r3, #7
 663 0080 04D9     		bls	.L67
 664              	.L56:
 558:lwIP/src/apps/http/httpd.c ****           (altcp_sndqueuelen(pcb) >= TCP_SND_QUEUELEN)) {
 665              		.loc 1 558 36 view .LVU210
 666 0082 6B6A     		ldr	r3, [r5, #36]
 667              	.LBE126:
 668              	.LBE130:
1196:lwIP/src/apps/http/httpd.c **** 
 669              		.loc 1 1196 8 view .LVU211
 670 0084 0027     		movs	r7, #0
 671              	.LVL61:
1209:lwIP/src/apps/http/httpd.c **** }
 672              		.loc 1 1209 3 is_stmt 1 view .LVU212
1209:lwIP/src/apps/http/httpd.c **** }
 673              		.loc 1 1209 3 is_stmt 0 view .LVU213
 674              	.LBE132:
 675              	.LBE135:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 676              		.loc 1 1614 3 is_stmt 1 view .LVU214
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 677              		.loc 1 1614 6 is_stmt 0 view .LVU215
 678 0086 002B     		cmp	r3, #0
 679 0088 F1D1     		bne	.L60
 680 008a 02E0     		b	.L66
 681              	.LVL62:
 682              	.L67:
 683              	.LBB136:
 684              	.LBB133:
 685              	.LBB131:
 686              	.LBB127:
 568:lwIP/src/apps/http/httpd.c **** 
 687              		.loc 1 568 3 view .LVU216
 688 008c 012C     		cmp	r4, #1
 689 008e DDD8     		bhi	.L57
 690 0090 F7E7     		b	.L56
 691              	.LVL63:
 692              	.L66:
 568:lwIP/src/apps/http/httpd.c **** 
 693              		.loc 1 568 3 view .LVU217
 694              	.LBE127:
 695              	.LBE131:
 696              	.LBE133:
 697              	.LBE136:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 698              		.loc 1 1614 27 view .LVU218
 699 0092 6869     		ldr	r0, [r5, #20]
 700 0094 FFF7FEFF 		bl	fs_bytes_left
 701              	.LVL64:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 702              		.loc 1 1614 23 view .LVU219
 703 0098 0028     		cmp	r0, #0
 704 009a E8DC     		bgt	.L60
 705              	.LVL65:
 706              	.L50:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 707              		.loc 1 1614 23 view .LVU220
ARM GAS  /tmp/ccQlnpyR.s 			page 63


 708              	.LBE138:
 709              	.LBE140:
 710              	.LBB141:
 711              	.LBB116:
1106:lwIP/src/apps/http/httpd.c ****     return 0;
 712              		.loc 1 1106 5 is_stmt 1 view .LVU221
 713              	.LBB112:
 714              	.LBI112:
 655:lwIP/src/apps/http/httpd.c **** {
 715              		.loc 1 655 1 view .LVU222
 716              	.LBE112:
 717              	.LBE116:
 718              	.LBE141:
 673:lwIP/src/apps/http/httpd.c ****   }
 719              		.loc 1 673 5 view .LVU223
 720              	.LBB142:
 721              	.LBB117:
 722              	.LBB115:
 723              	.LBB113:
 724              	.LBI113:
 646:lwIP/src/apps/http/httpd.c **** {
 725              		.loc 1 646 1 view .LVU224
 726              	.LBB114:
 648:lwIP/src/apps/http/httpd.c **** }
 727              		.loc 1 648 3 view .LVU225
 648:lwIP/src/apps/http/httpd.c **** }
 728              		.loc 1 648 10 is_stmt 0 view .LVU226
 729 009c 2946     		mov	r1, r5
 730 009e 3046     		mov	r0, r6
 731 00a0 FFF7FEFF 		bl	http_close_or_abort_conn.constprop.0
 732              	.LVL66:
 733              	.L63:
 648:lwIP/src/apps/http/httpd.c **** }
 734              		.loc 1 648 10 view .LVU227
 735              	.LBE114:
 736              	.LBE113:
 737              	.LBE115:
1107:lwIP/src/apps/http/httpd.c ****   }
 738              		.loc 1 1107 5 is_stmt 1 view .LVU228
 739              	.LBE117:
 740              	.LBE142:
1601:lwIP/src/apps/http/httpd.c ****     }
 741              		.loc 1 1601 14 is_stmt 0 view .LVU229
 742 00a4 0027     		movs	r7, #0
1623:lwIP/src/apps/http/httpd.c **** 
 743              		.loc 1 1623 1 view .LVU230
 744 00a6 3846     		mov	r0, r7
 745 00a8 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 746              	.LVL67:
 747              	.L65:
 748              	.LBB143:
 749              	.LBB139:
 750              	.LBB137:
 751              	.LBB134:
1196:lwIP/src/apps/http/httpd.c **** 
 752              		.loc 1 1196 8 view .LVU231
 753 00aa 0027     		movs	r7, #0
ARM GAS  /tmp/ccQlnpyR.s 			page 64


 754              	.LVL68:
1209:lwIP/src/apps/http/httpd.c **** }
 755              		.loc 1 1209 3 is_stmt 1 view .LVU232
1209:lwIP/src/apps/http/httpd.c **** }
 756              		.loc 1 1209 3 is_stmt 0 view .LVU233
 757              	.LBE134:
 758              	.LBE137:
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 759              		.loc 1 1614 3 is_stmt 1 view .LVU234
1614:lwIP/src/apps/http/httpd.c ****     /* We reached the end of the file so this request is done.
 760              		.loc 1 1614 6 is_stmt 0 view .LVU235
 761 00ac 002B     		cmp	r3, #0
 762 00ae DED1     		bne	.L60
 763 00b0 EFE7     		b	.L66
 764              	.L69:
 765 00b2 00BF     		.align	2
 766              	.L68:
 767 00b4 00000000 		.word	.LC0
 768              	.LBE139:
 769              	.LBE143:
 770              		.cfi_endproc
 771              	.LFE115:
 773              		.section	.text.http_sent,"ax",%progbits
 774              		.align	1
 775              		.p2align 2,,3
 776              		.syntax unified
 777              		.thumb
 778              		.thumb_func
 779              		.fpu fpv4-sp-d16
 781              	http_sent:
 782              	.LVL69:
 783              	.LFB121:
2442:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 784              		.loc 1 2442 1 is_stmt 1 view -0
 785              		.cfi_startproc
 786              		@ args = 0, pretend = 0, frame = 0
 787              		@ frame_needed = 0, uses_anonymous_args = 0
2443:lwIP/src/apps/http/httpd.c **** 
 788              		.loc 1 2443 3 view .LVU237
2445:lwIP/src/apps/http/httpd.c **** 
 789              		.loc 1 2445 77 view .LVU238
2447:lwIP/src/apps/http/httpd.c **** 
 790              		.loc 1 2447 3 view .LVU239
2449:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
 791              		.loc 1 2449 3 view .LVU240
2442:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 792              		.loc 1 2442 1 is_stmt 0 view .LVU241
 793 0000 08B5     		push	{r3, lr}
 794              	.LCFI6:
 795              		.cfi_def_cfa_offset 8
 796              		.cfi_offset 3, -8
 797              		.cfi_offset 14, -4
2449:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
 798              		.loc 1 2449 6 view .LVU242
 799 0002 0346     		mov	r3, r0
 800 0004 30B1     		cbz	r0, .L71
2453:lwIP/src/apps/http/httpd.c **** 
ARM GAS  /tmp/ccQlnpyR.s 			page 65


 801              		.loc 1 2453 15 view .LVU243
 802 0006 0022     		movs	r2, #0
 803              	.LVL70:
2453:lwIP/src/apps/http/httpd.c **** 
 804              		.loc 1 2453 15 view .LVU244
 805 0008 0846     		mov	r0, r1
 806              	.LVL71:
2453:lwIP/src/apps/http/httpd.c **** 
 807              		.loc 1 2453 3 is_stmt 1 view .LVU245
2455:lwIP/src/apps/http/httpd.c **** 
 808              		.loc 1 2455 3 is_stmt 0 view .LVU246
 809 000a 1946     		mov	r1, r3
 810              	.LVL72:
2453:lwIP/src/apps/http/httpd.c **** 
 811              		.loc 1 2453 15 view .LVU247
 812 000c 83F82820 		strb	r2, [r3, #40]
2455:lwIP/src/apps/http/httpd.c **** 
 813              		.loc 1 2455 3 is_stmt 1 view .LVU248
 814 0010 FFF7FEFF 		bl	http_send
 815              	.LVL73:
2457:lwIP/src/apps/http/httpd.c **** }
 816              		.loc 1 2457 3 view .LVU249
 817              	.L71:
2458:lwIP/src/apps/http/httpd.c **** 
 818              		.loc 1 2458 1 is_stmt 0 view .LVU250
 819 0014 0020     		movs	r0, #0
 820 0016 08BD     		pop	{r3, pc}
 821              		.cfi_endproc
 822              	.LFE121:
 824              		.section	.rodata.http_recv.str1.4,"aMS",%progbits,1
 825              		.align	2
 826              	.LC1:
 827 0000 0D0A00   		.ascii	"\015\012\000"
 828 0003 00       		.align	2
 829              	.LC2:
 830 0004 47455420 		.ascii	"GET \000"
 830      00
 831 0009 000000   		.align	2
 832              	.LC3:
 833 000c 2000     		.ascii	" \000"
 834 000e 0000     		.align	2
 835              	.LC4:
 836 0010 0D0A0D0A 		.ascii	"\015\012\015\012\000"
 836      00
 837 0015 000000   		.align	2
 838              	.LC5:
 839 0018 2F343034 		.ascii	"/404.html\000"
 839      2E68746D 
 839      6C00
 840 0022 0000     		.align	2
 841              	.LC6:
 842 0024 2F343034 		.ascii	"/404.htm\000"
 842      2E68746D 
 842      00
 843 002d 000000   		.align	2
 844              	.LC7:
 845 0030 2F343034 		.ascii	"/404.shtml\000"
ARM GAS  /tmp/ccQlnpyR.s 			page 66


 845      2E736874 
 845      6D6C00
 846 003b 00       		.align	2
 847              	.LC8:
 848 003c 66696C65 		.ascii	"file->data != NULL\000"
 848      2D3E6461 
 848      74612021 
 848      3D204E55 
 848      4C4C00
 849 004f 00       		.align	2
 850              	.LC9:
 851 0050 46696C65 		.ascii	"File length must be positive!\000"
 851      206C656E 
 851      67746820 
 851      6D757374 
 851      20626520 
 852 006e 0000     		.align	2
 853              	.LC10:
 854 0070 48545450 		.ascii	"HTTP headers not included in file system\000"
 854      20686561 
 854      64657273 
 854      206E6F74 
 854      20696E63 
 855              		.section	.text.http_recv,"ax",%progbits
 856              		.align	1
 857              		.p2align 2,,3
 858              		.syntax unified
 859              		.thumb
 860              		.thumb_func
 861              		.fpu fpv4-sp-d16
 863              	http_recv:
 864              	.LVL74:
 865              	.LFB123:
2517:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 866              		.loc 1 2517 1 is_stmt 1 view -0
 867              		.cfi_startproc
 868              		@ args = 0, pretend = 0, frame = 16
 869              		@ frame_needed = 0, uses_anonymous_args = 0
2518:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_recv: pcb=%p pbuf=%p err=%s\n", (void *)pcb,
 870              		.loc 1 2518 3 view .LVU252
2517:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 871              		.loc 1 2517 1 is_stmt 0 view .LVU253
 872 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 873              	.LCFI7:
 874              		.cfi_def_cfa_offset 36
 875              		.cfi_offset 4, -36
 876              		.cfi_offset 5, -32
 877              		.cfi_offset 6, -28
 878              		.cfi_offset 7, -24
 879              		.cfi_offset 8, -20
 880              		.cfi_offset 9, -16
 881              		.cfi_offset 10, -12
 882              		.cfi_offset 11, -8
 883              		.cfi_offset 14, -4
 884 0004 0446     		mov	r4, r0
 885              	.LVL75:
2520:lwIP/src/apps/http/httpd.c **** 
ARM GAS  /tmp/ccQlnpyR.s 			page 67


 886              		.loc 1 2520 44 is_stmt 1 view .LVU254
2522:lwIP/src/apps/http/httpd.c ****     /* error or closed by other side? */
 887              		.loc 1 2522 3 view .LVU255
2517:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 888              		.loc 1 2517 1 is_stmt 0 view .LVU256
 889 0006 85B0     		sub	sp, sp, #20
 890              	.LCFI8:
 891              		.cfi_def_cfa_offset 56
2517:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 892              		.loc 1 2517 1 view .LVU257
 893 0008 0E46     		mov	r6, r1
 894 000a 1546     		mov	r5, r2
2522:lwIP/src/apps/http/httpd.c ****     /* error or closed by other side? */
 895              		.loc 1 2522 6 view .LVU258
 896 000c 002B     		cmp	r3, #0
 897 000e 74D1     		bne	.L77
 898 0010 002A     		cmp	r2, #0
 899 0012 6AD0     		beq	.L80
 900 0014 1189     		ldrh	r1, [r2, #8]
 901              	.LVL76:
2522:lwIP/src/apps/http/httpd.c ****     /* error or closed by other side? */
 902              		.loc 1 2522 38 discriminator 1 view .LVU259
 903 0016 0028     		cmp	r0, #0
 904 0018 72D0     		beq	.L78
2544:lwIP/src/apps/http/httpd.c ****   }
 905              		.loc 1 2544 5 is_stmt 1 view .LVU260
 906 001a 3046     		mov	r0, r6
 907              	.LVL77:
2544:lwIP/src/apps/http/httpd.c ****   }
 908              		.loc 1 2544 5 is_stmt 0 view .LVU261
 909 001c FFF7FEFF 		bl	tcp_recved
 910              	.LVL78:
2562:lwIP/src/apps/http/httpd.c ****       err_t parsed = http_parse_request(p, hs, pcb);
 911              		.loc 1 2562 5 is_stmt 1 view .LVU262
2562:lwIP/src/apps/http/httpd.c ****       err_t parsed = http_parse_request(p, hs, pcb);
 912              		.loc 1 2562 8 is_stmt 0 view .LVU263
 913 0020 6769     		ldr	r7, [r4, #20]
 914 0022 37B1     		cbz	r7, .L200
 915              	.L199:
 916              	.LBB171:
 917              	.LBB172:
 918              	.LBB173:
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 919              		.loc 1 2575 7 is_stmt 1 view .LVU264
 920 0024 2846     		mov	r0, r5
 921 0026 FFF7FEFF 		bl	pbuf_free
 922              	.LVL79:
2576:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 923              		.loc 1 2576 7 view .LVU265
2584:lwIP/src/apps/http/httpd.c ****         /* @todo: close on ERR_USE? */
 924              		.loc 1 2584 14 view .LVU266
 925              	.LBE173:
 926              	.LBE172:
 927              	.LBE171:
2595:lwIP/src/apps/http/httpd.c **** 
 928              		.loc 1 2595 1 is_stmt 0 view .LVU267
 929 002a 0020     		movs	r0, #0
ARM GAS  /tmp/ccQlnpyR.s 			page 68


 930 002c 05B0     		add	sp, sp, #20
 931              	.LCFI9:
 932              		.cfi_remember_state
 933              		.cfi_def_cfa_offset 36
 934              		@ sp needed
 935 002e BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 936              	.LVL80:
 937              	.L200:
 938              	.LCFI10:
 939              		.cfi_restore_state
 940              	.LBB241:
 941              	.LBI171:
2516:lwIP/src/apps/http/httpd.c **** {
 942              		.loc 1 2516 1 is_stmt 1 view .LVU268
 943              	.LBB239:
 944              	.LBB237:
2563:lwIP/src/apps/http/httpd.c ****       LWIP_ASSERT("http_parse_request: unexpected return value", parsed == ERR_OK
 945              		.loc 1 2563 7 view .LVU269
 946              	.LBB174:
 947              	.LBI174:
1952:lwIP/src/apps/http/httpd.c **** {
 948              		.loc 1 1952 1 view .LVU270
 949              	.LBB175:
1954:lwIP/src/apps/http/httpd.c ****   char *crlf;
 950              		.loc 1 1954 3 view .LVU271
1955:lwIP/src/apps/http/httpd.c ****   u16_t data_len;
 951              		.loc 1 1955 3 view .LVU272
1956:lwIP/src/apps/http/httpd.c ****   struct pbuf *p = inp;
 952              		.loc 1 1956 3 view .LVU273
1957:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_REQUESTLIST
 953              		.loc 1 1957 3 view .LVU274
1959:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SUPPORT_REQUESTLIST */
 954              		.loc 1 1959 3 view .LVU275
1965:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("p != NULL", p != NULL);
 955              		.loc 1 1965 3 view .LVU276
1966:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("hs != NULL", hs != NULL);
 956              		.loc 1 1966 3 view .LVU277
1966:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("hs != NULL", hs != NULL);
 957              		.loc 1 1966 3 view .LVU278
1966:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("hs != NULL", hs != NULL);
 958              		.loc 1 1966 3 view .LVU279
1967:lwIP/src/apps/http/httpd.c **** 
 959              		.loc 1 1967 3 view .LVU280
1967:lwIP/src/apps/http/httpd.c **** 
 960              		.loc 1 1967 3 view .LVU281
1967:lwIP/src/apps/http/httpd.c **** 
 961              		.loc 1 1967 3 view .LVU282
1969:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Received data while sending a file\n"));
 962              		.loc 1 1969 3 view .LVU283
1969:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Received data while sending a file\n"));
 963              		.loc 1 1969 28 is_stmt 0 view .LVU284
 964 0032 A369     		ldr	r3, [r4, #24]
 965 0034 206A     		ldr	r0, [r4, #32]
 966 0036 002B     		cmp	r3, #0
 967 0038 6FD1     		bne	.L83
1978:lwIP/src/apps/http/httpd.c **** 
 968              		.loc 1 1978 70 is_stmt 1 view .LVU285
ARM GAS  /tmp/ccQlnpyR.s 			page 69


1983:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("First pbuf\n"));
 969              		.loc 1 1983 3 view .LVU286
1983:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("First pbuf\n"));
 970              		.loc 1 1983 6 is_stmt 0 view .LVU287
 971 003a 0028     		cmp	r0, #0
 972 003c 67D0     		beq	.L201
1987:lwIP/src/apps/http/httpd.c ****     pbuf_cat(hs->req, p);
 973              		.loc 1 1987 50 is_stmt 1 view .LVU288
1988:lwIP/src/apps/http/httpd.c ****   }
 974              		.loc 1 1988 5 view .LVU289
 975 003e 2946     		mov	r1, r5
 976 0040 FFF7FEFF 		bl	pbuf_cat
 977              	.LVL81:
 978              	.L85:
1992:lwIP/src/apps/http/httpd.c **** 
 979              		.loc 1 1992 3 view .LVU290
 980 0044 2846     		mov	r0, r5
 981 0046 FFF7FEFF 		bl	pbuf_ref
 982              	.LVL82:
1994:lwIP/src/apps/http/httpd.c ****     data_len = LWIP_MIN(hs->req->tot_len, LWIP_HTTPD_MAX_REQ_LENGTH);
 983              		.loc 1 1994 3 view .LVU291
1994:lwIP/src/apps/http/httpd.c ****     data_len = LWIP_MIN(hs->req->tot_len, LWIP_HTTPD_MAX_REQ_LENGTH);
 984              		.loc 1 1994 9 is_stmt 0 view .LVU292
 985 004a 206A     		ldr	r0, [r4, #32]
1994:lwIP/src/apps/http/httpd.c ****     data_len = LWIP_MIN(hs->req->tot_len, LWIP_HTTPD_MAX_REQ_LENGTH);
 986              		.loc 1 1994 6 view .LVU293
 987 004c 0368     		ldr	r3, [r0]
 988 004e 002B     		cmp	r3, #0
 989 0050 5FD0     		beq	.L86
1995:lwIP/src/apps/http/httpd.c ****     pbuf_copy_partial(hs->req, httpd_req_buf, data_len, 0);
 990              		.loc 1 1995 5 is_stmt 1 view .LVU294
1995:lwIP/src/apps/http/httpd.c ****     pbuf_copy_partial(hs->req, httpd_req_buf, data_len, 0);
 991              		.loc 1 1995 14 is_stmt 0 view .LVU295
 992 0052 B0F80890 		ldrh	r9, [r0, #8]
 993 0056 40F2FF32 		movw	r2, #1023
1996:lwIP/src/apps/http/httpd.c ****     data = httpd_req_buf;
 994              		.loc 1 1996 5 view .LVU296
 995 005a B749     		ldr	r1, .L212
 996 005c 0023     		movs	r3, #0
1995:lwIP/src/apps/http/httpd.c ****     pbuf_copy_partial(hs->req, httpd_req_buf, data_len, 0);
 997              		.loc 1 1995 14 view .LVU297
 998 005e 9145     		cmp	r9, r2
1997:lwIP/src/apps/http/httpd.c ****   } else
 999              		.loc 1 1997 10 view .LVU298
 1000 0060 0F46     		mov	r7, r1
1995:lwIP/src/apps/http/httpd.c ****     pbuf_copy_partial(hs->req, httpd_req_buf, data_len, 0);
 1001              		.loc 1 1995 14 view .LVU299
 1002 0062 28BF     		it	cs
 1003 0064 9146     		movcs	r9, r2
 1004              	.LVL83:
1996:lwIP/src/apps/http/httpd.c ****     data = httpd_req_buf;
 1005              		.loc 1 1996 5 is_stmt 1 view .LVU300
 1006 0066 4A46     		mov	r2, r9
 1007 0068 FFF7FEFF 		bl	pbuf_copy_partial
 1008              	.LVL84:
1997:lwIP/src/apps/http/httpd.c ****   } else
 1009              		.loc 1 1997 5 view .LVU301
ARM GAS  /tmp/ccQlnpyR.s 			page 70


 1010              	.L87:
2004:lwIP/src/apps/http/httpd.c ****     }
 1011              		.loc 1 2004 86 view .LVU302
2009:lwIP/src/apps/http/httpd.c ****     /* wait for CRLF before parsing anything */
 1012              		.loc 1 2009 3 view .LVU303
2009:lwIP/src/apps/http/httpd.c ****     /* wait for CRLF before parsing anything */
 1013              		.loc 1 2009 6 is_stmt 0 view .LVU304
 1014 006c B9F1060F 		cmp	r9, #6
 1015 0070 29D9     		bls	.L88
2011:lwIP/src/apps/http/httpd.c ****     if (crlf != NULL) {
 1016              		.loc 1 2011 5 is_stmt 1 view .LVU305
2011:lwIP/src/apps/http/httpd.c ****     if (crlf != NULL) {
 1017              		.loc 1 2011 12 is_stmt 0 view .LVU306
 1018 0072 4A46     		mov	r2, r9
 1019 0074 B149     		ldr	r1, .L212+4
 1020 0076 3846     		mov	r0, r7
 1021 0078 FFF7FEFF 		bl	lwip_strnstr
 1022              	.LVL85:
2012:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1023              		.loc 1 2012 5 is_stmt 1 view .LVU307
2012:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1024              		.loc 1 2012 8 is_stmt 0 view .LVU308
 1025 007c 18B3     		cbz	r0, .L88
 1026              	.LBB176:
2016:lwIP/src/apps/http/httpd.c ****       char *sp1, *sp2;
 1027              		.loc 1 2016 7 is_stmt 1 view .LVU309
 1028              	.LVL86:
2017:lwIP/src/apps/http/httpd.c ****       u16_t left_len, uri_len;
 1029              		.loc 1 2017 7 view .LVU310
2018:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("CRLF received, parsing request\n"));
 1030              		.loc 1 2018 7 view .LVU311
2019:lwIP/src/apps/http/httpd.c ****       /* parse method */
 1031              		.loc 1 2019 86 view .LVU312
2021:lwIP/src/apps/http/httpd.c ****         sp1 = data + 3;
 1032              		.loc 1 2021 7 view .LVU313
2021:lwIP/src/apps/http/httpd.c ****         sp1 = data + 3;
 1033              		.loc 1 2021 12 is_stmt 0 view .LVU314
 1034 007e 0422     		movs	r2, #4
 1035 0080 AF49     		ldr	r1, .L212+8
 1036 0082 3846     		mov	r0, r7
 1037              	.LVL87:
2021:lwIP/src/apps/http/httpd.c ****         sp1 = data + 3;
 1038              		.loc 1 2021 12 view .LVU315
 1039 0084 FFF7FEFF 		bl	strncmp
 1040              	.LVL88:
2021:lwIP/src/apps/http/httpd.c ****         sp1 = data + 3;
 1041              		.loc 1 2021 10 view .LVU316
 1042 0088 8246     		mov	r10, r0
 1043 008a 0028     		cmp	r0, #0
 1044 008c 40F00381 		bne	.L89
2022:lwIP/src/apps/http/httpd.c ****         /* received GET request */
 1045              		.loc 1 2022 9 is_stmt 1 view .LVU317
2042:lwIP/src/apps/http/httpd.c ****       sp2 = lwip_strnstr(sp1 + 1, " ", left_len);
 1046              		.loc 1 2042 16 is_stmt 0 view .LVU318
 1047 0090 A9F10402 		sub	r2, r9, #4
2042:lwIP/src/apps/http/httpd.c ****       sp2 = lwip_strnstr(sp1 + 1, " ", left_len);
 1048              		.loc 1 2042 43 view .LVU319
ARM GAS  /tmp/ccQlnpyR.s 			page 71


 1049 0094 07F10408 		add	r8, r7, #4
2043:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_V09
 1050              		.loc 1 2043 13 view .LVU320
 1051 0098 AA49     		ldr	r1, .L212+12
2022:lwIP/src/apps/http/httpd.c ****         /* received GET request */
 1052              		.loc 1 2022 13 view .LVU321
 1053 009a 07F1030B 		add	fp, r7, #3
 1054              	.LVL89:
2024:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1055              		.loc 1 2024 80 is_stmt 1 view .LVU322
2042:lwIP/src/apps/http/httpd.c ****       sp2 = lwip_strnstr(sp1 + 1, " ", left_len);
 1056              		.loc 1 2042 7 view .LVU323
2043:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_V09
 1057              		.loc 1 2043 7 view .LVU324
2043:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_V09
 1058              		.loc 1 2043 13 is_stmt 0 view .LVU325
 1059 009e 92B2     		uxth	r2, r2
 1060 00a0 4046     		mov	r0, r8
 1061 00a2 0092     		str	r2, [sp]
 1062 00a4 FFF7FEFF 		bl	lwip_strnstr
 1063              	.LVL90:
2045:lwIP/src/apps/http/httpd.c ****         /* HTTP 0.9: respond with correct protocol version */
 1064              		.loc 1 2045 7 is_stmt 1 view .LVU326
2045:lwIP/src/apps/http/httpd.c ****         /* HTTP 0.9: respond with correct protocol version */
 1065              		.loc 1 2045 10 is_stmt 0 view .LVU327
 1066 00a8 009A     		ldr	r2, [sp]
 1067 00aa 0346     		mov	r3, r0
 1068 00ac 0028     		cmp	r0, #0
 1069 00ae 00F0E780 		beq	.L202
 1070              	.LVL91:
 1071              	.L196:
2058:lwIP/src/apps/http/httpd.c ****         /* wait for CRLFCRLF (indicating end of HTTP headers) before parsing anything */
 1072              		.loc 1 2058 10 view .LVU328
 1073 00b2 9B45     		cmp	fp, r3
 1074 00b4 0093     		str	r3, [sp]
 1075 00b6 06D2     		bcs	.L88
2060:lwIP/src/apps/http/httpd.c ****           char *uri = sp1 + 1;
 1076              		.loc 1 2060 9 is_stmt 1 view .LVU329
2060:lwIP/src/apps/http/httpd.c ****           char *uri = sp1 + 1;
 1077              		.loc 1 2060 13 is_stmt 0 view .LVU330
 1078 00b8 4A46     		mov	r2, r9
 1079 00ba A349     		ldr	r1, .L212+16
 1080 00bc 3846     		mov	r0, r7
 1081              	.LVL92:
2060:lwIP/src/apps/http/httpd.c ****           char *uri = sp1 + 1;
 1082              		.loc 1 2060 13 view .LVU331
 1083 00be FFF7FEFF 		bl	lwip_strnstr
 1084              	.LVL93:
2060:lwIP/src/apps/http/httpd.c ****           char *uri = sp1 + 1;
 1085              		.loc 1 2060 12 view .LVU332
 1086 00c2 009B     		ldr	r3, [sp]
 1087 00c4 90BB     		cbnz	r0, .L203
 1088              	.LVL94:
 1089              	.L88:
2102:lwIP/src/apps/http/httpd.c ****       }
 1090              		.loc 1 2102 52 is_stmt 1 view .LVU333
 1091              	.LBE176:
ARM GAS  /tmp/ccQlnpyR.s 			page 72


2108:lwIP/src/apps/http/httpd.c ****   if ((hs->req->tot_len <= LWIP_HTTPD_REQ_BUFSIZE) &&
 1092              		.loc 1 2108 3 view .LVU334
2108:lwIP/src/apps/http/httpd.c ****   if ((hs->req->tot_len <= LWIP_HTTPD_REQ_BUFSIZE) &&
 1093              		.loc 1 2108 10 is_stmt 0 view .LVU335
 1094 00c6 206A     		ldr	r0, [r4, #32]
 1095 00c8 FFF7FEFF 		bl	pbuf_clen
 1096              	.LVL95:
2109:lwIP/src/apps/http/httpd.c ****       (clen <= LWIP_HTTPD_REQ_QUEUELEN)) {
 1097              		.loc 1 2109 10 view .LVU336
 1098 00cc 226A     		ldr	r2, [r4, #32]
 1099              	.LVL96:
2109:lwIP/src/apps/http/httpd.c ****       (clen <= LWIP_HTTPD_REQ_QUEUELEN)) {
 1100              		.loc 1 2109 3 is_stmt 1 view .LVU337
2109:lwIP/src/apps/http/httpd.c ****       (clen <= LWIP_HTTPD_REQ_QUEUELEN)) {
 1101              		.loc 1 2109 6 is_stmt 0 view .LVU338
 1102 00ce 1189     		ldrh	r1, [r2, #8]
2109:lwIP/src/apps/http/httpd.c ****       (clen <= LWIP_HTTPD_REQ_QUEUELEN)) {
 1103              		.loc 1 2109 52 view .LVU339
 1104 00d0 B1F5806F 		cmp	r1, #1024
 1105 00d4 01D2     		bcs	.L113
 1106 00d6 0528     		cmp	r0, #5
 1107 00d8 A4D9     		bls	.L199
 1108              	.L113:
 1109              	.LVL97:
2109:lwIP/src/apps/http/httpd.c ****       (clen <= LWIP_HTTPD_REQ_QUEUELEN)) {
 1110              		.loc 1 2109 52 view .LVU340
 1111              	.LBE175:
 1112              	.LBE174:
2564:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
 1113              		.loc 1 2564 7 is_stmt 1 view .LVU341
2564:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
 1114              		.loc 1 2564 7 view .LVU342
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1115              		.loc 1 2569 9 view .LVU343
2570:lwIP/src/apps/http/httpd.c ****           hs->req = NULL;
 1116              		.loc 1 2570 11 view .LVU344
 1117 00da 1046     		mov	r0, r2
 1118 00dc FFF7FEFF 		bl	pbuf_free
 1119              	.LVL98:
2571:lwIP/src/apps/http/httpd.c ****         }
 1120              		.loc 1 2571 11 view .LVU345
2571:lwIP/src/apps/http/httpd.c ****         }
 1121              		.loc 1 2571 19 is_stmt 0 view .LVU346
 1122 00e0 0023     		movs	r3, #0
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1123              		.loc 1 2575 7 view .LVU347
 1124 00e2 2846     		mov	r0, r5
2571:lwIP/src/apps/http/httpd.c ****         }
 1125              		.loc 1 2571 19 view .LVU348
 1126 00e4 2362     		str	r3, [r4, #32]
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1127              		.loc 1 2575 7 is_stmt 1 view .LVU349
 1128 00e6 FFF7FEFF 		bl	pbuf_free
 1129              	.LVL99:
2576:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1130              		.loc 1 2576 7 view .LVU350
2584:lwIP/src/apps/http/httpd.c ****         /* @todo: close on ERR_USE? */
ARM GAS  /tmp/ccQlnpyR.s 			page 73


 1131              		.loc 1 2584 14 view .LVU351
 1132              	.L80:
2584:lwIP/src/apps/http/httpd.c ****         /* @todo: close on ERR_USE? */
 1133              		.loc 1 2584 14 is_stmt 0 view .LVU352
 1134              	.LBE237:
 1135              	.LBE239:
 1136              	.LBE241:
2529:lwIP/src/apps/http/httpd.c ****       /* this should not happen, only to be robust */
 1137              		.loc 1 2529 5 is_stmt 1 view .LVU353
2531:lwIP/src/apps/http/httpd.c ****     }
 1138              		.loc 1 2531 74 view .LVU354
2533:lwIP/src/apps/http/httpd.c ****     return ERR_OK;
 1139              		.loc 1 2533 5 view .LVU355
 1140              	.LBB242:
 1141              	.LBI242:
 646:lwIP/src/apps/http/httpd.c **** {
 1142              		.loc 1 646 1 view .LVU356
 1143              	.LBB243:
 648:lwIP/src/apps/http/httpd.c **** }
 1144              		.loc 1 648 3 view .LVU357
 648:lwIP/src/apps/http/httpd.c **** }
 1145              		.loc 1 648 10 is_stmt 0 view .LVU358
 1146 00ea 2146     		mov	r1, r4
 1147 00ec 3046     		mov	r0, r6
 1148 00ee FFF7FEFF 		bl	http_close_or_abort_conn.constprop.0
 1149              	.LVL100:
 648:lwIP/src/apps/http/httpd.c **** }
 1150              		.loc 1 648 10 view .LVU359
 1151              	.LBE243:
 1152              	.LBE242:
2534:lwIP/src/apps/http/httpd.c ****   }
 1153              		.loc 1 2534 5 is_stmt 1 view .LVU360
 1154              	.L189:
2595:lwIP/src/apps/http/httpd.c **** 
 1155              		.loc 1 2595 1 is_stmt 0 view .LVU361
 1156 00f2 0020     		movs	r0, #0
 1157 00f4 05B0     		add	sp, sp, #20
 1158              	.LCFI11:
 1159              		.cfi_remember_state
 1160              		.cfi_def_cfa_offset 36
 1161              		@ sp needed
 1162 00f6 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1163              	.LVL101:
 1164              	.L77:
 1165              	.LCFI12:
 1166              		.cfi_restore_state
2524:lwIP/src/apps/http/httpd.c ****       /* Inform TCP that we have taken the data. */
 1167              		.loc 1 2524 5 is_stmt 1 view .LVU362
2524:lwIP/src/apps/http/httpd.c ****       /* Inform TCP that we have taken the data. */
 1168              		.loc 1 2524 8 is_stmt 0 view .LVU363
 1169 00fa 002A     		cmp	r2, #0
 1170 00fc F5D0     		beq	.L80
 1171 00fe 1189     		ldrh	r1, [r2, #8]
 1172              	.LVL102:
 1173              	.L78:
2526:lwIP/src/apps/http/httpd.c ****       pbuf_free(p);
 1174              		.loc 1 2526 7 is_stmt 1 view .LVU364
ARM GAS  /tmp/ccQlnpyR.s 			page 74


 1175 0100 3046     		mov	r0, r6
 1176              	.LVL103:
2526:lwIP/src/apps/http/httpd.c ****       pbuf_free(p);
 1177              		.loc 1 2526 7 is_stmt 0 view .LVU365
 1178 0102 FFF7FEFF 		bl	tcp_recved
 1179              	.LVL104:
 1180              	.L198:
2527:lwIP/src/apps/http/httpd.c ****     }
 1181              		.loc 1 2527 7 is_stmt 1 view .LVU366
 1182 0106 2846     		mov	r0, r5
 1183 0108 FFF7FEFF 		bl	pbuf_free
 1184              	.LVL105:
 1185 010c EDE7     		b	.L80
 1186              	.LVL106:
 1187              	.L201:
 1188              	.LBB244:
 1189              	.LBB240:
 1190              	.LBB238:
 1191              	.LBB232:
 1192              	.LBB227:
1984:lwIP/src/apps/http/httpd.c ****     hs->req = p;
 1193              		.loc 1 1984 47 view .LVU367
1985:lwIP/src/apps/http/httpd.c ****   } else {
 1194              		.loc 1 1985 5 view .LVU368
1985:lwIP/src/apps/http/httpd.c ****   } else {
 1195              		.loc 1 1985 13 is_stmt 0 view .LVU369
 1196 010e 2562     		str	r5, [r4, #32]
 1197 0110 98E7     		b	.L85
 1198              	.L86:
2001:lwIP/src/apps/http/httpd.c ****     data_len = p->len;
 1199              		.loc 1 2001 5 is_stmt 1 view .LVU370
2001:lwIP/src/apps/http/httpd.c ****     data_len = p->len;
 1200              		.loc 1 2001 10 is_stmt 0 view .LVU371
 1201 0112 6F68     		ldr	r7, [r5, #4]
 1202              	.LVL107:
2002:lwIP/src/apps/http/httpd.c ****     if (p->len != p->tot_len) {
 1203              		.loc 1 2002 5 is_stmt 1 view .LVU372
2002:lwIP/src/apps/http/httpd.c ****     if (p->len != p->tot_len) {
 1204              		.loc 1 2002 14 is_stmt 0 view .LVU373
 1205 0114 B5F80A90 		ldrh	r9, [r5, #10]
 1206              	.LVL108:
2003:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("Warning: incomplete header due to chained pbufs\n"));
 1207              		.loc 1 2003 5 is_stmt 1 view .LVU374
 1208 0118 A8E7     		b	.L87
 1209              	.LVL109:
 1210              	.L83:
2003:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("Warning: incomplete header due to chained pbufs\n"));
 1211              		.loc 1 2003 5 is_stmt 0 view .LVU375
 1212              	.LBE227:
 1213              	.LBE232:
2564:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
 1214              		.loc 1 2564 7 is_stmt 1 view .LVU376
2564:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
 1215              		.loc 1 2564 7 view .LVU377
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1216              		.loc 1 2569 9 view .LVU378
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
ARM GAS  /tmp/ccQlnpyR.s 			page 75


 1217              		.loc 1 2569 12 is_stmt 0 view .LVU379
 1218 011a 0028     		cmp	r0, #0
 1219 011c 82D0     		beq	.L199
2570:lwIP/src/apps/http/httpd.c ****           hs->req = NULL;
 1220              		.loc 1 2570 11 is_stmt 1 view .LVU380
 1221 011e FFF7FEFF 		bl	pbuf_free
 1222              	.LVL110:
2571:lwIP/src/apps/http/httpd.c ****         }
 1223              		.loc 1 2571 11 view .LVU381
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1224              		.loc 1 2575 7 is_stmt 0 view .LVU382
 1225 0122 2846     		mov	r0, r5
2571:lwIP/src/apps/http/httpd.c ****         }
 1226              		.loc 1 2571 19 view .LVU383
 1227 0124 2762     		str	r7, [r4, #32]
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1228              		.loc 1 2575 7 is_stmt 1 view .LVU384
 1229 0126 FFF7FEFF 		bl	pbuf_free
 1230              	.LVL111:
2576:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1231              		.loc 1 2576 7 view .LVU385
2584:lwIP/src/apps/http/httpd.c ****         /* @todo: close on ERR_USE? */
 1232              		.loc 1 2584 14 view .LVU386
 1233 012a E2E7     		b	.L189
 1234              	.LVL112:
 1235              	.L203:
 1236              	.LBB233:
 1237              	.LBB228:
 1238              	.LBB223:
 1239              	.LBB177:
2061:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_11_KEEPALIVE
 1240              		.loc 1 2061 11 view .LVU387
2073:lwIP/src/apps/http/httpd.c ****           uri[uri_len] = 0;
 1241              		.loc 1 2073 11 view .LVU388
 1242              	.LBE177:
2057:lwIP/src/apps/http/httpd.c ****       if ((sp2 != 0) && (sp2 > sp1)) {
 1243              		.loc 1 2057 29 is_stmt 0 view .LVU389
 1244 012c A3EB0803 		sub	r3, r3, r8
 1245              	.LBB219:
2073:lwIP/src/apps/http/httpd.c ****           uri[uri_len] = 0;
 1246              		.loc 1 2073 16 view .LVU390
 1247 0130 0022     		movs	r2, #0
 1248              	.LBB178:
 1249              	.LBB179:
2193:lwIP/src/apps/http/httpd.c ****   if ((uri_len > 0) && (uri[uri_len - 1] == '/') &&
 1250              		.loc 1 2193 20 view .LVU391
 1251 0132 4046     		mov	r0, r8
 1252              	.LBE179:
 1253              	.LBE178:
2074:lwIP/src/apps/http/httpd.c ****           LWIP_DEBUGF(HTTPD_DEBUG, ("Received \"%s\" request for URI: \"%s\"\n",
 1254              		.loc 1 2074 14 view .LVU392
 1255 0134 9BB2     		uxth	r3, r3
2073:lwIP/src/apps/http/httpd.c ****           uri[uri_len] = 0;
 1256              		.loc 1 2073 16 view .LVU393
 1257 0136 FA70     		strb	r2, [r7, #3]
2074:lwIP/src/apps/http/httpd.c ****           LWIP_DEBUGF(HTTPD_DEBUG, ("Received \"%s\" request for URI: \"%s\"\n",
 1258              		.loc 1 2074 11 is_stmt 1 view .LVU394
ARM GAS  /tmp/ccQlnpyR.s 			page 76


2074:lwIP/src/apps/http/httpd.c ****           LWIP_DEBUGF(HTTPD_DEBUG, ("Received \"%s\" request for URI: \"%s\"\n",
 1259              		.loc 1 2074 24 is_stmt 0 view .LVU395
 1260 0138 08F80320 		strb	r2, [r8, r3]
2076:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1261              		.loc 1 2076 48 is_stmt 1 view .LVU396
2098:lwIP/src/apps/http/httpd.c ****           }
 1262              		.loc 1 2098 13 view .LVU397
 1263              	.LVL113:
 1264              	.LBB215:
 1265              	.LBI178:
2176:lwIP/src/apps/http/httpd.c **** {
 1266              		.loc 1 2176 1 view .LVU398
 1267              	.LBB211:
2178:lwIP/src/apps/http/httpd.c ****   struct fs_file *file = NULL;
 1268              		.loc 1 2178 3 view .LVU399
2179:lwIP/src/apps/http/httpd.c ****   char *params = NULL;
 1269              		.loc 1 2179 3 view .LVU400
2180:lwIP/src/apps/http/httpd.c ****   err_t err;
 1270              		.loc 1 2180 3 view .LVU401
2181:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI
 1271              		.loc 1 2181 3 view .LVU402
2186:lwIP/src/apps/http/httpd.c **** #endif /* !LWIP_HTTPD_SSI */
 1272              		.loc 1 2186 3 view .LVU403
2193:lwIP/src/apps/http/httpd.c ****   if ((uri_len > 0) && (uri[uri_len - 1] == '/') &&
 1273              		.loc 1 2193 3 view .LVU404
2193:lwIP/src/apps/http/httpd.c ****   if ((uri_len > 0) && (uri[uri_len - 1] == '/') &&
 1274              		.loc 1 2193 20 is_stmt 0 view .LVU405
 1275 013c FFF7FEFF 		bl	strlen
 1276              	.LVL114:
2194:lwIP/src/apps/http/httpd.c ****       ((uri != http_uri_buf) || (uri_len == 1))) {
 1277              		.loc 1 2194 3 is_stmt 1 view .LVU406
2194:lwIP/src/apps/http/httpd.c ****       ((uri != http_uri_buf) || (uri_len == 1))) {
 1278              		.loc 1 2194 6 is_stmt 0 view .LVU407
 1279 0140 28B1     		cbz	r0, .L94
2194:lwIP/src/apps/http/httpd.c ****       ((uri != http_uri_buf) || (uri_len == 1))) {
 1280              		.loc 1 2194 28 view .LVU408
 1281 0142 00F1FF39 		add	r9, r0, #-1
 1282              	.LVL115:
2194:lwIP/src/apps/http/httpd.c ****       ((uri != http_uri_buf) || (uri_len == 1))) {
 1283              		.loc 1 2194 21 view .LVU409
 1284 0146 18F80930 		ldrb	r3, [r8, r9]	@ zero_extendqisi2
 1285 014a 2F2B     		cmp	r3, #47
 1286 014c 30D0     		beq	.L204
 1287              	.LVL116:
 1288              	.L94:
2239:lwIP/src/apps/http/httpd.c ****     if (params != NULL) {
 1289              		.loc 1 2239 5 is_stmt 1 view .LVU410
2239:lwIP/src/apps/http/httpd.c ****     if (params != NULL) {
 1290              		.loc 1 2239 14 is_stmt 0 view .LVU411
 1291 014e 3F21     		movs	r1, #63
 1292 0150 4046     		mov	r0, r8
 1293 0152 FFF7FEFF 		bl	strchr
 1294              	.LVL117:
2240:lwIP/src/apps/http/httpd.c ****       /* URI contains parameters. NULL-terminate the base URI */
 1295              		.loc 1 2240 5 is_stmt 1 view .LVU412
2240:lwIP/src/apps/http/httpd.c ****       /* URI contains parameters. NULL-terminate the base URI */
 1296              		.loc 1 2240 8 is_stmt 0 view .LVU413
ARM GAS  /tmp/ccQlnpyR.s 			page 77


 1297 0156 08B1     		cbz	r0, .L103
2242:lwIP/src/apps/http/httpd.c ****       params++;
 1298              		.loc 1 2242 7 is_stmt 1 view .LVU414
2242:lwIP/src/apps/http/httpd.c ****       params++;
 1299              		.loc 1 2242 15 is_stmt 0 view .LVU415
 1300 0158 0023     		movs	r3, #0
 1301 015a 0370     		strb	r3, [r0]
2243:lwIP/src/apps/http/httpd.c ****     }
 1302              		.loc 1 2243 7 is_stmt 1 view .LVU416
 1303              	.LVL118:
 1304              	.L103:
2265:lwIP/src/apps/http/httpd.c **** 
 1305              		.loc 1 2265 69 view .LVU417
2267:lwIP/src/apps/http/httpd.c ****     if (err == ERR_OK) {
 1306              		.loc 1 2267 5 view .LVU418
2267:lwIP/src/apps/http/httpd.c ****     if (err == ERR_OK) {
 1307              		.loc 1 2267 11 is_stmt 0 view .LVU419
 1308 015c 4146     		mov	r1, r8
 1309 015e 2046     		mov	r0, r4
 1310 0160 FFF7FEFF 		bl	fs_open
 1311              	.LVL119:
2268:lwIP/src/apps/http/httpd.c ****       file = &hs->file_handle;
 1312              		.loc 1 2268 5 is_stmt 1 view .LVU420
2268:lwIP/src/apps/http/httpd.c ****       file = &hs->file_handle;
 1313              		.loc 1 2268 8 is_stmt 0 view .LVU421
 1314 0164 0028     		cmp	r0, #0
 1315 0166 5FD1     		bne	.L205
 1316              	.LVL120:
 1317              	.L104:
2289:lwIP/src/apps/http/httpd.c **** }
 1318              		.loc 1 2289 3 is_stmt 1 view .LVU422
 1319              	.LBB180:
 1320              	.LBI180:
2305:lwIP/src/apps/http/httpd.c ****                u8_t tag_check, char *params)
 1321              		.loc 1 2305 1 view .LVU423
 1322              	.LBB181:
2311:lwIP/src/apps/http/httpd.c ****     /* file opened, initialise struct http_state */
 1323              		.loc 1 2311 3 view .LVU424
2315:lwIP/src/apps/http/httpd.c **** #endif
 1324              		.loc 1 2315 5 view .LVU425
2315:lwIP/src/apps/http/httpd.c **** #endif
 1325              		.loc 1 2315 5 view .LVU426
 1326 0168 2068     		ldr	r0, [r4]
 1327 016a 0028     		cmp	r0, #0
 1328 016c 58D0     		beq	.L206
2315:lwIP/src/apps/http/httpd.c **** #endif
 1329              		.loc 1 2315 5 view .LVU427
2331:lwIP/src/apps/http/httpd.c **** #endif /* LWIP_HTTPD_SSI */
 1330              		.loc 1 2331 5 view .LVU428
2333:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CGI_SSI
 1331              		.loc 1 2333 5 view .LVU429
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1332              		.loc 1 2356 5 is_stmt 0 view .LVU430
 1333 016e 6268     		ldr	r2, [r4, #4]
 1334 0170 002A     		cmp	r2, #0
2355:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("File length must be positive!", (file->len >= 0));
 1335              		.loc 1 2355 14 view .LVU431
ARM GAS  /tmp/ccQlnpyR.s 			page 78


 1336 0172 C4E90540 		strd	r4, r0, [r4, #20]
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1337              		.loc 1 2356 5 is_stmt 1 view .LVU432
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1338              		.loc 1 2356 5 view .LVU433
 1339 0176 C0F2A280 		blt	.L207
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1340              		.loc 1 2356 5 view .LVU434
2364:lwIP/src/apps/http/httpd.c ****     }
 1341              		.loc 1 2364 7 view .LVU435
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1342              		.loc 1 2371 5 is_stmt 0 view .LVU436
 1343 017a 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
2366:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 1344              		.loc 1 2366 17 view .LVU437
 1345 017c 0021     		movs	r1, #0
2364:lwIP/src/apps/http/httpd.c ****     }
 1346              		.loc 1 2364 16 view .LVU438
 1347 017e 6262     		str	r2, [r4, #36]
2366:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 1348              		.loc 1 2366 5 is_stmt 1 view .LVU439
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1349              		.loc 1 2371 5 is_stmt 0 view .LVU440
 1350 0180 DB07     		lsls	r3, r3, #31
2366:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_TIMING
 1351              		.loc 1 2366 17 view .LVU441
 1352 0182 84F82810 		strb	r1, [r4, #40]
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1353              		.loc 1 2371 5 is_stmt 1 view .LVU442
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1354              		.loc 1 2371 5 view .LVU443
 1355 0186 40F19680 		bpl	.L208
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1356              		.loc 1 2371 5 view .LVU444
2375:lwIP/src/apps/http/httpd.c ****       /* HTTP/0.9 responses are sent without HTTP header,
 1357              		.loc 1 2375 5 view .LVU445
2375:lwIP/src/apps/http/httpd.c ****       /* HTTP/0.9 responses are sent without HTTP header,
 1358              		.loc 1 2375 8 is_stmt 0 view .LVU446
 1359 018a BAF1000F 		cmp	r10, #0
 1360 018e 40F09A80 		bne	.L209
 1361              	.LVL121:
 1362              	.L105:
2375:lwIP/src/apps/http/httpd.c ****       /* HTTP/0.9 responses are sent without HTTP header,
 1363              		.loc 1 2375 8 view .LVU447
 1364              	.LBE181:
 1365              	.LBE180:
 1366              	.LBE211:
 1367              	.LBE215:
 1368              	.LBE219:
 1369              	.LBE223:
 1370              	.LBE228:
 1371              	.LBE233:
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1372              		.loc 1 2569 9 is_stmt 1 view .LVU448
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1373              		.loc 1 2569 15 is_stmt 0 view .LVU449
 1374 0192 206A     		ldr	r0, [r4, #32]
ARM GAS  /tmp/ccQlnpyR.s 			page 79


2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1375              		.loc 1 2569 12 view .LVU450
 1376 0194 0028     		cmp	r0, #0
 1377 0196 3FD0     		beq	.L210
2570:lwIP/src/apps/http/httpd.c ****           hs->req = NULL;
 1378              		.loc 1 2570 11 is_stmt 1 view .LVU451
 1379 0198 FFF7FEFF 		bl	pbuf_free
 1380              	.LVL122:
2571:lwIP/src/apps/http/httpd.c ****         }
 1381              		.loc 1 2571 11 view .LVU452
2571:lwIP/src/apps/http/httpd.c ****         }
 1382              		.loc 1 2571 19 is_stmt 0 view .LVU453
 1383 019c 0023     		movs	r3, #0
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1384              		.loc 1 2575 7 view .LVU454
 1385 019e 2846     		mov	r0, r5
2571:lwIP/src/apps/http/httpd.c ****         }
 1386              		.loc 1 2571 19 view .LVU455
 1387 01a0 2362     		str	r3, [r4, #32]
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1388              		.loc 1 2575 7 is_stmt 1 view .LVU456
 1389 01a2 FFF7FEFF 		bl	pbuf_free
 1390              	.LVL123:
2576:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1391              		.loc 1 2576 7 view .LVU457
 1392              	.L114:
2581:lwIP/src/apps/http/httpd.c ****           http_send(pcb, hs);
 1393              		.loc 1 2581 125 view .LVU458
2582:lwIP/src/apps/http/httpd.c ****         }
 1394              		.loc 1 2582 11 view .LVU459
 1395 01a6 2146     		mov	r1, r4
 1396 01a8 3046     		mov	r0, r6
 1397 01aa FFF7FEFF 		bl	http_send
 1398              	.LVL124:
 1399 01ae A0E7     		b	.L189
 1400              	.LVL125:
 1401              	.L204:
 1402              	.LBB234:
 1403              	.LBB229:
 1404              	.LBB224:
 1405              	.LBB220:
 1406              	.LBB216:
 1407              	.LBB212:
2195:lwIP/src/apps/http/httpd.c ****     size_t copy_len = LWIP_MIN(sizeof(http_uri_buf) - 1, uri_len - 1);
 1408              		.loc 1 2195 30 is_stmt 0 view .LVU460
 1409 01b0 0128     		cmp	r0, #1
 1410 01b2 02D0     		beq	.L121
2194:lwIP/src/apps/http/httpd.c ****       ((uri != http_uri_buf) || (uri_len == 1))) {
 1411              		.loc 1 2194 50 view .LVU461
 1412 01b4 654F     		ldr	r7, .L212+20
 1413              	.LVL126:
2195:lwIP/src/apps/http/httpd.c ****     size_t copy_len = LWIP_MIN(sizeof(http_uri_buf) - 1, uri_len - 1);
 1414              		.loc 1 2195 30 view .LVU462
 1415 01b6 B845     		cmp	r8, r7
 1416 01b8 14D0     		beq	.L120
 1417              	.L121:
 1418              	.LBB187:
ARM GAS  /tmp/ccQlnpyR.s 			page 80


2196:lwIP/src/apps/http/httpd.c ****     if (copy_len > 0) {
 1419              		.loc 1 2196 5 is_stmt 1 view .LVU463
2196:lwIP/src/apps/http/httpd.c ****     if (copy_len > 0) {
 1420              		.loc 1 2196 12 is_stmt 0 view .LVU464
 1421 01ba B9F13F0F 		cmp	r9, #63
 1422 01be 28BF     		it	cs
 1423 01c0 4FF03F09 		movcs	r9, #63
 1424              	.LVL127:
2197:lwIP/src/apps/http/httpd.c ****       MEMCPY(http_uri_buf, uri, copy_len);
 1425              		.loc 1 2197 5 is_stmt 1 view .LVU465
2197:lwIP/src/apps/http/httpd.c ****       MEMCPY(http_uri_buf, uri, copy_len);
 1426              		.loc 1 2197 8 is_stmt 0 view .LVU466
 1427 01c4 0128     		cmp	r0, #1
 1428 01c6 0FD1     		bne	.L211
 1429 01c8 0027     		movs	r7, #0
 1430 01ca DFF89C91 		ldr	r9, .L212+48
 1431              	.LVL128:
 1432              	.L100:
 1433              	.LBB188:
2207:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_MAX_REQUEST_URI_LEN
 1434              		.loc 1 2207 7 is_stmt 1 view .LVU467
2209:lwIP/src/apps/http/httpd.c ****         size_t len_left = sizeof(http_uri_buf) - copy_len - 1;
 1435              		.loc 1 2209 7 view .LVU468
2221:lwIP/src/apps/http/httpd.c ****       }
 1436              		.loc 1 2221 9 view .LVU469
2223:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, file_name);
 1437              		.loc 1 2223 84 view .LVU470
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1438              		.loc 1 2224 7 view .LVU471
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1439              		.loc 1 2224 13 is_stmt 0 view .LVU472
 1440 01ce 59F83710 		ldr	r1, [r9, r7, lsl #3]
 1441 01d2 2046     		mov	r0, r4
 1442              	.LBE188:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1443              		.loc 1 2206 54 view .LVU473
 1444 01d4 0137     		adds	r7, r7, #1
 1445              	.LVL129:
 1446              	.LBB197:
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1447              		.loc 1 2224 13 view .LVU474
 1448 01d6 FFF7FEFF 		bl	fs_open
 1449              	.LVL130:
 1450              	.LBE197:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1451              		.loc 1 2206 50 is_stmt 1 view .LVU475
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1452              		.loc 1 2206 20 view .LVU476
 1453              	.LBB198:
2225:lwIP/src/apps/http/httpd.c ****         uri = file_name;
 1454              		.loc 1 2225 7 view .LVU477
2225:lwIP/src/apps/http/httpd.c ****         uri = file_name;
 1455              		.loc 1 2225 10 is_stmt 0 view .LVU478
 1456 01da 0028     		cmp	r0, #0
 1457 01dc C4D0     		beq	.L104
 1458              	.LBE198:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
ARM GAS  /tmp/ccQlnpyR.s 			page 81


 1459              		.loc 1 2206 5 view .LVU479
 1460 01de 052F     		cmp	r7, #5
 1461 01e0 F5D1     		bne	.L100
 1462 01e2 B4E7     		b	.L94
 1463              	.LVL131:
 1464              	.L120:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1465              		.loc 1 2206 5 view .LVU480
 1466 01e4 B846     		mov	r8, r7
 1467 01e6 B2E7     		b	.L94
 1468              	.LVL132:
 1469              	.L211:
2198:lwIP/src/apps/http/httpd.c ****       http_uri_buf[copy_len] = 0;
 1470              		.loc 1 2198 7 is_stmt 1 view .LVU481
 1471 01e8 584F     		ldr	r7, .L212+20
 1472 01ea 4A46     		mov	r2, r9
 1473 01ec 4146     		mov	r1, r8
 1474 01ee 3846     		mov	r0, r7
 1475              	.LVL133:
2198:lwIP/src/apps/http/httpd.c ****       http_uri_buf[copy_len] = 0;
 1476              		.loc 1 2198 7 is_stmt 0 view .LVU482
 1477 01f0 FFF7FEFF 		bl	memcpy
 1478              	.LVL134:
2199:lwIP/src/apps/http/httpd.c ****     }
 1479              		.loc 1 2199 7 is_stmt 1 view .LVU483
2199:lwIP/src/apps/http/httpd.c ****     }
 1480              		.loc 1 2199 30 is_stmt 0 view .LVU484
 1481 01f4 0022     		movs	r2, #0
 1482 01f6 D9F13F0B 		rsbs	fp, r9, #63
 1483              	.LVL135:
2199:lwIP/src/apps/http/httpd.c ****     }
 1484              		.loc 1 2199 30 view .LVU485
 1485 01fa 07F80920 		strb	r2, [r7, r9]
 1486 01fe 70D1     		bne	.L97
 1487              	.LBB199:
 1488              	.LBB189:
2210:lwIP/src/apps/http/httpd.c ****         if (len_left > 0) {
 1489              		.loc 1 2210 16 view .LVU486
 1490 0200 4FF00509 		mov	r9, #5
 1491              	.LVL136:
 1492              	.L98:
2210:lwIP/src/apps/http/httpd.c ****         if (len_left > 0) {
 1493              		.loc 1 2210 16 view .LVU487
 1494              	.LBE189:
2207:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_MAX_REQUEST_URI_LEN
 1495              		.loc 1 2207 7 is_stmt 1 view .LVU488
2209:lwIP/src/apps/http/httpd.c ****         size_t len_left = sizeof(http_uri_buf) - copy_len - 1;
 1496              		.loc 1 2209 7 view .LVU489
 1497              	.LBB193:
2210:lwIP/src/apps/http/httpd.c ****         if (len_left > 0) {
 1498              		.loc 1 2210 9 view .LVU490
2211:lwIP/src/apps/http/httpd.c ****           size_t name_len = strlen(httpd_default_filenames[loop].name);
 1499              		.loc 1 2211 9 view .LVU491
2211:lwIP/src/apps/http/httpd.c ****           size_t name_len = strlen(httpd_default_filenames[loop].name);
 1500              		.loc 1 2211 9 is_stmt 0 view .LVU492
 1501              	.LBE193:
2223:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, file_name);
ARM GAS  /tmp/ccQlnpyR.s 			page 82


 1502              		.loc 1 2223 84 is_stmt 1 view .LVU493
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1503              		.loc 1 2224 7 view .LVU494
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1504              		.loc 1 2224 13 is_stmt 0 view .LVU495
 1505 0204 3946     		mov	r1, r7
 1506 0206 2046     		mov	r0, r4
 1507 0208 FFF7FEFF 		bl	fs_open
 1508              	.LVL137:
 1509              	.LBE199:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1510              		.loc 1 2206 50 is_stmt 1 view .LVU496
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1511              		.loc 1 2206 20 view .LVU497
 1512              	.LBB200:
2225:lwIP/src/apps/http/httpd.c ****         uri = file_name;
 1513              		.loc 1 2225 7 view .LVU498
2225:lwIP/src/apps/http/httpd.c ****         uri = file_name;
 1514              		.loc 1 2225 10 is_stmt 0 view .LVU499
 1515 020c 0028     		cmp	r0, #0
 1516 020e ABD0     		beq	.L104
 1517              	.LBE200:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1518              		.loc 1 2206 5 view .LVU500
 1519 0210 B9F10109 		subs	r9, r9, #1
 1520 0214 F6D1     		bne	.L98
 1521 0216 9AE7     		b	.L94
 1522              	.LVL138:
 1523              	.L210:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1524              		.loc 1 2206 5 view .LVU501
 1525              	.LBE187:
 1526              	.LBE212:
 1527              	.LBE216:
 1528              	.LBE220:
 1529              	.LBE224:
 1530              	.LBE229:
 1531              	.LBE234:
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1532              		.loc 1 2575 7 is_stmt 1 view .LVU502
 1533 0218 2846     		mov	r0, r5
 1534 021a FFF7FEFF 		bl	pbuf_free
 1535              	.LVL139:
2576:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1536              		.loc 1 2576 7 view .LVU503
 1537 021e C2E7     		b	.L114
 1538              	.LVL140:
 1539              	.L206:
 1540              	.LBB235:
 1541              	.LBB230:
 1542              	.LBB225:
 1543              	.LBB221:
 1544              	.LBB217:
 1545              	.LBB213:
 1546              	.LBB203:
 1547              	.LBB184:
2315:lwIP/src/apps/http/httpd.c **** #endif
ARM GAS  /tmp/ccQlnpyR.s 			page 83


 1548              		.loc 1 2315 5 view .LVU504
 1549 0220 4B48     		ldr	r0, .L212+24
 1550 0222 FFF7FEFF 		bl	printf
 1551              	.LVL141:
 1552              	.L106:
2315:lwIP/src/apps/http/httpd.c **** #endif
 1553              		.loc 1 2315 5 view .LVU505
2315:lwIP/src/apps/http/httpd.c **** #endif
 1554              		.loc 1 2315 5 view .LVU506
2315:lwIP/src/apps/http/httpd.c **** #endif
 1555              		.loc 1 2315 5 view .LVU507
2315:lwIP/src/apps/http/httpd.c **** #endif
 1556              		.loc 1 2315 5 view .LVU508
2315:lwIP/src/apps/http/httpd.c **** #endif
 1557              		.loc 1 2315 5 view .LVU509
2315:lwIP/src/apps/http/httpd.c **** #endif
 1558              		.loc 1 2315 5 view .LVU510
 1559 0226 FEE7     		b	.L106
 1560              	.LVL142:
 1561              	.L205:
2315:lwIP/src/apps/http/httpd.c **** #endif
 1562              		.loc 1 2315 5 is_stmt 0 view .LVU511
 1563              	.LBE184:
 1564              	.LBE203:
2271:lwIP/src/apps/http/httpd.c ****     }
 1565              		.loc 1 2271 7 is_stmt 1 view .LVU512
 1566              	.LBB204:
 1567              	.LBI204:
1673:lwIP/src/apps/http/httpd.c **** {
 1568              		.loc 1 1673 1 view .LVU513
 1569              	.LBB205:
1675:lwIP/src/apps/http/httpd.c **** 
 1570              		.loc 1 1675 3 view .LVU514
1677:lwIP/src/apps/http/httpd.c ****   err = fs_open(&hs->file_handle, *uri);
 1571              		.loc 1 1677 3 view .LVU515
1678:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 1572              		.loc 1 1678 3 view .LVU516
1678:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 1573              		.loc 1 1678 9 is_stmt 0 view .LVU517
 1574 0228 4A49     		ldr	r1, .L212+28
 1575 022a 2046     		mov	r0, r4
 1576              	.LVL143:
1678:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 1577              		.loc 1 1678 9 view .LVU518
 1578 022c FFF7FEFF 		bl	fs_open
 1579              	.LVL144:
1679:lwIP/src/apps/http/httpd.c ****     /* 404.html doesn't exist. Try 404.htm instead. */
 1580              		.loc 1 1679 3 is_stmt 1 view .LVU519
1679:lwIP/src/apps/http/httpd.c ****     /* 404.html doesn't exist. Try 404.htm instead. */
 1581              		.loc 1 1679 6 is_stmt 0 view .LVU520
 1582 0230 0028     		cmp	r0, #0
 1583 0232 99D0     		beq	.L104
1681:lwIP/src/apps/http/httpd.c ****     err = fs_open(&hs->file_handle, *uri);
 1584              		.loc 1 1681 5 is_stmt 1 view .LVU521
 1585              	.LVL145:
1682:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
 1586              		.loc 1 1682 5 view .LVU522
ARM GAS  /tmp/ccQlnpyR.s 			page 84


1682:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
 1587              		.loc 1 1682 11 is_stmt 0 view .LVU523
 1588 0234 4849     		ldr	r1, .L212+32
 1589 0236 2046     		mov	r0, r4
 1590              	.LVL146:
1682:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
 1591              		.loc 1 1682 11 view .LVU524
 1592 0238 FFF7FEFF 		bl	fs_open
 1593              	.LVL147:
1683:lwIP/src/apps/http/httpd.c ****       /* 404.htm doesn't exist either. Try 404.shtml instead. */
 1594              		.loc 1 1683 5 is_stmt 1 view .LVU525
1683:lwIP/src/apps/http/httpd.c ****       /* 404.htm doesn't exist either. Try 404.shtml instead. */
 1595              		.loc 1 1683 8 is_stmt 0 view .LVU526
 1596 023c 0028     		cmp	r0, #0
 1597 023e 93D0     		beq	.L104
1685:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, *uri);
 1598              		.loc 1 1685 7 is_stmt 1 view .LVU527
 1599              	.LVL148:
1686:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
 1600              		.loc 1 1686 7 view .LVU528
1686:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
 1601              		.loc 1 1686 13 is_stmt 0 view .LVU529
 1602 0240 4649     		ldr	r1, .L212+36
 1603 0242 2046     		mov	r0, r4
 1604              	.LVL149:
1686:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
 1605              		.loc 1 1686 13 view .LVU530
 1606 0244 FFF7FEFF 		bl	fs_open
 1607              	.LVL150:
1687:lwIP/src/apps/http/httpd.c ****         /* 404.htm doesn't exist either. Indicate to the caller that it should
 1608              		.loc 1 1687 7 is_stmt 1 view .LVU531
1687:lwIP/src/apps/http/httpd.c ****         /* 404.htm doesn't exist either. Indicate to the caller that it should
 1609              		.loc 1 1687 10 is_stmt 0 view .LVU532
 1610 0248 0028     		cmp	r0, #0
 1611 024a 8DD0     		beq	.L104
1691:lwIP/src/apps/http/httpd.c ****         return NULL;
 1612              		.loc 1 1691 9 is_stmt 1 view .LVU533
 1613              	.LVL151:
1692:lwIP/src/apps/http/httpd.c ****       }
 1614              		.loc 1 1692 9 view .LVU534
1692:lwIP/src/apps/http/httpd.c ****       }
 1615              		.loc 1 1692 9 is_stmt 0 view .LVU535
 1616              	.LBE205:
 1617              	.LBE204:
2285:lwIP/src/apps/http/httpd.c ****     /* None of the default filenames exist so send back a 404 page */
 1618              		.loc 1 2285 3 is_stmt 1 view .LVU536
2287:lwIP/src/apps/http/httpd.c ****   }
 1619              		.loc 1 2287 5 view .LVU537
 1620              	.LBB206:
 1621              	.LBI206:
1673:lwIP/src/apps/http/httpd.c **** {
 1622              		.loc 1 1673 1 view .LVU538
 1623              	.LBB207:
1675:lwIP/src/apps/http/httpd.c **** 
 1624              		.loc 1 1675 3 view .LVU539
1677:lwIP/src/apps/http/httpd.c ****   err = fs_open(&hs->file_handle, *uri);
 1625              		.loc 1 1677 3 view .LVU540
ARM GAS  /tmp/ccQlnpyR.s 			page 85


1678:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 1626              		.loc 1 1678 3 view .LVU541
1678:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 1627              		.loc 1 1678 9 is_stmt 0 view .LVU542
 1628 024c 4149     		ldr	r1, .L212+28
 1629 024e 2046     		mov	r0, r4
 1630 0250 FFF7FEFF 		bl	fs_open
 1631              	.LVL152:
1679:lwIP/src/apps/http/httpd.c ****     /* 404.html doesn't exist. Try 404.htm instead. */
 1632              		.loc 1 1679 3 is_stmt 1 view .LVU543
1679:lwIP/src/apps/http/httpd.c ****     /* 404.html doesn't exist. Try 404.htm instead. */
 1633              		.loc 1 1679 6 is_stmt 0 view .LVU544
 1634 0254 0028     		cmp	r0, #0
 1635 0256 87D0     		beq	.L104
1681:lwIP/src/apps/http/httpd.c ****     err = fs_open(&hs->file_handle, *uri);
 1636              		.loc 1 1681 5 is_stmt 1 view .LVU545
 1637              	.LVL153:
1682:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
 1638              		.loc 1 1682 5 view .LVU546
1682:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
 1639              		.loc 1 1682 11 is_stmt 0 view .LVU547
 1640 0258 3F49     		ldr	r1, .L212+32
 1641 025a 2046     		mov	r0, r4
 1642              	.LVL154:
1682:lwIP/src/apps/http/httpd.c ****     if (err != ERR_OK) {
 1643              		.loc 1 1682 11 view .LVU548
 1644 025c FFF7FEFF 		bl	fs_open
 1645              	.LVL155:
1683:lwIP/src/apps/http/httpd.c ****       /* 404.htm doesn't exist either. Try 404.shtml instead. */
 1646              		.loc 1 1683 5 is_stmt 1 view .LVU549
1683:lwIP/src/apps/http/httpd.c ****       /* 404.htm doesn't exist either. Try 404.shtml instead. */
 1647              		.loc 1 1683 8 is_stmt 0 view .LVU550
 1648 0260 0028     		cmp	r0, #0
 1649 0262 81D0     		beq	.L104
1685:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, *uri);
 1650              		.loc 1 1685 7 is_stmt 1 view .LVU551
 1651              	.LVL156:
1686:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
 1652              		.loc 1 1686 7 view .LVU552
1686:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
 1653              		.loc 1 1686 13 is_stmt 0 view .LVU553
 1654 0264 3D49     		ldr	r1, .L212+36
 1655 0266 2046     		mov	r0, r4
 1656              	.LVL157:
1686:lwIP/src/apps/http/httpd.c ****       if (err != ERR_OK) {
 1657              		.loc 1 1686 13 view .LVU554
 1658 0268 FFF7FEFF 		bl	fs_open
 1659              	.LVL158:
1687:lwIP/src/apps/http/httpd.c ****         /* 404.htm doesn't exist either. Indicate to the caller that it should
 1660              		.loc 1 1687 7 is_stmt 1 view .LVU555
1687:lwIP/src/apps/http/httpd.c ****         /* 404.htm doesn't exist either. Indicate to the caller that it should
 1661              		.loc 1 1687 10 is_stmt 0 view .LVU556
 1662 026c 0028     		cmp	r0, #0
 1663 026e 3FF47BAF 		beq	.L104
1691:lwIP/src/apps/http/httpd.c ****         return NULL;
 1664              		.loc 1 1691 9 is_stmt 1 view .LVU557
 1665              	.LVL159:
ARM GAS  /tmp/ccQlnpyR.s 			page 86


1692:lwIP/src/apps/http/httpd.c ****       }
 1666              		.loc 1 1692 9 view .LVU558
1692:lwIP/src/apps/http/httpd.c ****       }
 1667              		.loc 1 1692 9 is_stmt 0 view .LVU559
 1668              	.LBE207:
 1669              	.LBE206:
2289:lwIP/src/apps/http/httpd.c **** }
 1670              		.loc 1 2289 3 is_stmt 1 view .LVU560
 1671              	.LBB208:
2305:lwIP/src/apps/http/httpd.c ****                u8_t tag_check, char *params)
 1672              		.loc 1 2305 1 view .LVU561
 1673              	.LBB185:
2311:lwIP/src/apps/http/httpd.c ****     /* file opened, initialise struct http_state */
 1674              		.loc 1 2311 3 view .LVU562
2387:lwIP/src/apps/http/httpd.c ****     hs->file = NULL;
 1675              		.loc 1 2387 5 view .LVU563
2387:lwIP/src/apps/http/httpd.c ****     hs->file = NULL;
 1676              		.loc 1 2387 16 is_stmt 0 view .LVU564
 1677 0272 0023     		movs	r3, #0
2388:lwIP/src/apps/http/httpd.c ****     hs->left = 0;
 1678              		.loc 1 2388 14 view .LVU565
 1679 0274 C4E90533 		strd	r3, r3, [r4, #20]
2389:lwIP/src/apps/http/httpd.c ****     hs->retries = 0;
 1680              		.loc 1 2389 5 is_stmt 1 view .LVU566
2389:lwIP/src/apps/http/httpd.c ****     hs->retries = 0;
 1681              		.loc 1 2389 14 is_stmt 0 view .LVU567
 1682 0278 6362     		str	r3, [r4, #36]
2390:lwIP/src/apps/http/httpd.c ****   }
 1683              		.loc 1 2390 5 is_stmt 1 view .LVU568
2390:lwIP/src/apps/http/httpd.c ****   }
 1684              		.loc 1 2390 17 is_stmt 0 view .LVU569
 1685 027a 84F82830 		strb	r3, [r4, #40]
 1686 027e 88E7     		b	.L105
 1687              	.LVL160:
 1688              	.L202:
2390:lwIP/src/apps/http/httpd.c ****   }
 1689              		.loc 1 2390 17 view .LVU570
 1690              	.LBE185:
 1691              	.LBE208:
 1692              	.LBE213:
 1693              	.LBE217:
 1694              	.LBE221:
2047:lwIP/src/apps/http/httpd.c ****         is_09 = 1;
 1695              		.loc 1 2047 9 is_stmt 1 view .LVU571
2047:lwIP/src/apps/http/httpd.c ****         is_09 = 1;
 1696              		.loc 1 2047 15 is_stmt 0 view .LVU572
 1697 0280 2E49     		ldr	r1, .L212+4
 1698 0282 4046     		mov	r0, r8
 1699              	.LVL161:
2047:lwIP/src/apps/http/httpd.c ****         is_09 = 1;
 1700              		.loc 1 2047 15 view .LVU573
 1701 0284 FFF7FEFF 		bl	lwip_strnstr
 1702              	.LVL162:
2048:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1703              		.loc 1 2048 15 view .LVU574
 1704 0288 4FF0010A 		mov	r10, #1
2047:lwIP/src/apps/http/httpd.c ****         is_09 = 1;
ARM GAS  /tmp/ccQlnpyR.s 			page 87


 1705              		.loc 1 2047 15 view .LVU575
 1706 028c 0346     		mov	r3, r0
 1707              	.LVL163:
2048:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1708              		.loc 1 2048 9 is_stmt 1 view .LVU576
2057:lwIP/src/apps/http/httpd.c ****       if ((sp2 != 0) && (sp2 > sp1)) {
 1709              		.loc 1 2057 7 view .LVU577
2058:lwIP/src/apps/http/httpd.c ****         /* wait for CRLFCRLF (indicating end of HTTP headers) before parsing anything */
 1710              		.loc 1 2058 7 view .LVU578
2058:lwIP/src/apps/http/httpd.c ****         /* wait for CRLFCRLF (indicating end of HTTP headers) before parsing anything */
 1711              		.loc 1 2058 10 is_stmt 0 view .LVU579
 1712 028e 0028     		cmp	r0, #0
 1713 0290 3FF419AF 		beq	.L88
 1714 0294 0DE7     		b	.L196
 1715              	.LVL164:
 1716              	.L89:
2035:lwIP/src/apps/http/httpd.c ****         /* unsupported method! */
 1717              		.loc 1 2035 9 is_stmt 1 view .LVU580
2035:lwIP/src/apps/http/httpd.c ****         /* unsupported method! */
 1718              		.loc 1 2035 17 is_stmt 0 view .LVU581
 1719 0296 4FF00008 		mov	r8, #0
 1720 029a 87F80480 		strb	r8, [r7, #4]
2038:lwIP/src/apps/http/httpd.c ****         return http_find_error_file(hs, 501);
 1721              		.loc 1 2038 41 is_stmt 1 view .LVU582
2039:lwIP/src/apps/http/httpd.c ****       }
 1722              		.loc 1 2039 9 view .LVU583
 1723 029e 206A     		ldr	r0, [r4, #32]
 1724              	.LVL165:
2039:lwIP/src/apps/http/httpd.c ****       }
 1725              		.loc 1 2039 9 is_stmt 0 view .LVU584
 1726              	.LBE225:
 1727              	.LBE230:
 1728              	.LBE235:
2564:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
 1729              		.loc 1 2564 7 is_stmt 1 view .LVU585
2564:lwIP/src/apps/http/httpd.c ****                   || parsed == ERR_INPROGRESS || parsed == ERR_ARG || parsed == ERR_USE);
 1730              		.loc 1 2564 7 view .LVU586
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1731              		.loc 1 2569 9 view .LVU587
2569:lwIP/src/apps/http/httpd.c ****           pbuf_free(hs->req);
 1732              		.loc 1 2569 12 is_stmt 0 view .LVU588
 1733 02a0 0028     		cmp	r0, #0
 1734 02a2 3FF430AF 		beq	.L198
2570:lwIP/src/apps/http/httpd.c ****           hs->req = NULL;
 1735              		.loc 1 2570 11 is_stmt 1 view .LVU589
 1736 02a6 FFF7FEFF 		bl	pbuf_free
 1737              	.LVL166:
2571:lwIP/src/apps/http/httpd.c ****         }
 1738              		.loc 1 2571 11 view .LVU590
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1739              		.loc 1 2575 7 is_stmt 0 view .LVU591
 1740 02aa 2846     		mov	r0, r5
2571:lwIP/src/apps/http/httpd.c ****         }
 1741              		.loc 1 2571 19 view .LVU592
 1742 02ac C4F82080 		str	r8, [r4, #32]
2575:lwIP/src/apps/http/httpd.c ****       if (parsed == ERR_OK) {
 1743              		.loc 1 2575 7 is_stmt 1 view .LVU593
ARM GAS  /tmp/ccQlnpyR.s 			page 88


 1744 02b0 FFF7FEFF 		bl	pbuf_free
 1745              	.LVL167:
2576:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SUPPORT_POST
 1746              		.loc 1 2576 7 view .LVU594
2584:lwIP/src/apps/http/httpd.c ****         /* @todo: close on ERR_USE? */
 1747              		.loc 1 2584 14 view .LVU595
 1748 02b4 19E7     		b	.L80
 1749              	.LVL168:
 1750              	.L208:
 1751              	.LBB236:
 1752              	.LBB231:
 1753              	.LBB226:
 1754              	.LBB222:
 1755              	.LBB218:
 1756              	.LBB214:
 1757              	.LBB209:
 1758              	.LBB186:
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1759              		.loc 1 2371 5 view .LVU596
 1760 02b6 2A48     		ldr	r0, .L212+40
 1761 02b8 FFF7FEFF 		bl	printf
 1762              	.LVL169:
 1763              	.L110:
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1764              		.loc 1 2371 5 view .LVU597
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1765              		.loc 1 2371 5 view .LVU598
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1766              		.loc 1 2371 5 view .LVU599
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1767              		.loc 1 2371 5 view .LVU600
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1768              		.loc 1 2371 5 view .LVU601
2371:lwIP/src/apps/http/httpd.c ****                 (hs->handle->flags & FS_FILE_FLAGS_HEADER_INCLUDED) != 0);
 1769              		.loc 1 2371 5 view .LVU602
 1770 02bc FEE7     		b	.L110
 1771              	.L207:
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1772              		.loc 1 2356 5 view .LVU603
 1773 02be 2948     		ldr	r0, .L212+44
 1774 02c0 FFF7FEFF 		bl	printf
 1775              	.LVL170:
 1776              	.L108:
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1777              		.loc 1 2356 5 view .LVU604
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1778              		.loc 1 2356 5 view .LVU605
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1779              		.loc 1 2356 5 view .LVU606
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1780              		.loc 1 2356 5 view .LVU607
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1781              		.loc 1 2356 5 view .LVU608
2356:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_CUSTOM_FILES
 1782              		.loc 1 2356 5 view .LVU609
 1783 02c4 FEE7     		b	.L108
 1784              	.L209:
ARM GAS  /tmp/ccQlnpyR.s 			page 89


 1785              	.LBB182:
2378:lwIP/src/apps/http/httpd.c ****       if (file_start != NULL) {
 1786              		.loc 1 2378 7 view .LVU610
2378:lwIP/src/apps/http/httpd.c ****       if (file_start != NULL) {
 1787              		.loc 1 2378 26 is_stmt 0 view .LVU611
 1788 02c6 2049     		ldr	r1, .L212+16
 1789 02c8 FFF7FEFF 		bl	lwip_strnstr
 1790              	.LVL171:
2379:lwIP/src/apps/http/httpd.c ****         int diff = file_start + 4 - hs->file;
 1791              		.loc 1 2379 7 is_stmt 1 view .LVU612
2379:lwIP/src/apps/http/httpd.c ****         int diff = file_start + 4 - hs->file;
 1792              		.loc 1 2379 10 is_stmt 0 view .LVU613
 1793 02cc 0028     		cmp	r0, #0
 1794 02ce 3FF460AF 		beq	.L105
 1795              	.LBB183:
2380:lwIP/src/apps/http/httpd.c ****         hs->file += diff;
 1796              		.loc 1 2380 9 is_stmt 1 view .LVU614
2380:lwIP/src/apps/http/httpd.c ****         hs->file += diff;
 1797              		.loc 1 2380 31 is_stmt 0 view .LVU615
 1798 02d2 0430     		adds	r0, r0, #4
 1799              	.LVL172:
2381:lwIP/src/apps/http/httpd.c ****         hs->left -= (u32_t)diff;
 1800              		.loc 1 2381 9 is_stmt 1 view .LVU616
2380:lwIP/src/apps/http/httpd.c ****         hs->file += diff;
 1801              		.loc 1 2380 13 is_stmt 0 view .LVU617
 1802 02d4 A169     		ldr	r1, [r4, #24]
2382:lwIP/src/apps/http/httpd.c ****       }
 1803              		.loc 1 2382 18 view .LVU618
 1804 02d6 626A     		ldr	r2, [r4, #36]
2380:lwIP/src/apps/http/httpd.c ****         hs->file += diff;
 1805              		.loc 1 2380 13 view .LVU619
 1806 02d8 411A     		subs	r1, r0, r1
 1807              	.LVL173:
2381:lwIP/src/apps/http/httpd.c ****         hs->left -= (u32_t)diff;
 1808              		.loc 1 2381 18 view .LVU620
 1809 02da A061     		str	r0, [r4, #24]
2382:lwIP/src/apps/http/httpd.c ****       }
 1810              		.loc 1 2382 9 is_stmt 1 view .LVU621
2382:lwIP/src/apps/http/httpd.c ****       }
 1811              		.loc 1 2382 18 is_stmt 0 view .LVU622
 1812 02dc 521A     		subs	r2, r2, r1
 1813 02de 6262     		str	r2, [r4, #36]
 1814 02e0 57E7     		b	.L105
 1815              	.LVL174:
 1816              	.L97:
2382:lwIP/src/apps/http/httpd.c ****       }
 1817              		.loc 1 2382 18 view .LVU623
 1818 02e2 214B     		ldr	r3, .L212+48
 1819              	.LBE183:
 1820              	.LBE182:
 1821              	.LBE186:
 1822              	.LBE209:
 1823              	.LBB210:
 1824              	.LBB201:
 1825              	.LBB194:
 1826              	.LBB190:
2214:lwIP/src/apps/http/httpd.c ****           http_uri_buf[copy_len + name_copy_len] = 0;
ARM GAS  /tmp/ccQlnpyR.s 			page 90


 1827              		.loc 1 2214 11 view .LVU624
 1828 02e4 B944     		add	r9, r9, r7
 1829              	.LVL175:
2214:lwIP/src/apps/http/httpd.c ****           http_uri_buf[copy_len + name_copy_len] = 0;
 1830              		.loc 1 2214 11 view .LVU625
 1831 02e6 CDF800A0 		str	r10, [sp]
 1832              	.LVL176:
2214:lwIP/src/apps/http/httpd.c ****           http_uri_buf[copy_len + name_copy_len] = 0;
 1833              		.loc 1 2214 11 view .LVU626
 1834 02ea A246     		mov	r10, r4
 1835 02ec 0195     		str	r5, [sp, #4]
 1836 02ee 1D46     		mov	r5, r3
 1837              	.LVL177:
2215:lwIP/src/apps/http/httpd.c ****         }
 1838              		.loc 1 2215 50 view .LVU627
 1839 02f0 0292     		str	r2, [sp, #8]
 1840              	.LVL178:
 1841              	.L102:
2215:lwIP/src/apps/http/httpd.c ****         }
 1842              		.loc 1 2215 50 view .LVU628
 1843              	.LBE190:
 1844              	.LBE194:
2207:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_MAX_REQUEST_URI_LEN
 1845              		.loc 1 2207 7 is_stmt 1 view .LVU629
2209:lwIP/src/apps/http/httpd.c ****         size_t len_left = sizeof(http_uri_buf) - copy_len - 1;
 1846              		.loc 1 2209 7 view .LVU630
 1847              	.LBB195:
2210:lwIP/src/apps/http/httpd.c ****         if (len_left > 0) {
 1848              		.loc 1 2210 9 view .LVU631
2211:lwIP/src/apps/http/httpd.c ****           size_t name_len = strlen(httpd_default_filenames[loop].name);
 1849              		.loc 1 2211 9 view .LVU632
 1850              	.LBB191:
2212:lwIP/src/apps/http/httpd.c ****           size_t name_copy_len = LWIP_MIN(len_left, name_len);
 1851              		.loc 1 2212 11 view .LVU633
2212:lwIP/src/apps/http/httpd.c ****           size_t name_copy_len = LWIP_MIN(len_left, name_len);
 1852              		.loc 1 2212 29 is_stmt 0 view .LVU634
 1853 02f2 2968     		ldr	r1, [r5]
 1854 02f4 0835     		adds	r5, r5, #8
 1855 02f6 0846     		mov	r0, r1
 1856 02f8 0391     		str	r1, [sp, #12]
 1857 02fa FFF7FEFF 		bl	strlen
 1858              	.LVL179:
 1859 02fe 0446     		mov	r4, r0
 1860              	.LVL180:
2213:lwIP/src/apps/http/httpd.c ****           MEMCPY(&http_uri_buf[copy_len], httpd_default_filenames[loop].name, name_copy_len);
 1861              		.loc 1 2213 11 is_stmt 1 view .LVU635
2214:lwIP/src/apps/http/httpd.c ****           http_uri_buf[copy_len + name_copy_len] = 0;
 1862              		.loc 1 2214 11 is_stmt 0 view .LVU636
 1863 0300 0399     		ldr	r1, [sp, #12]
 1864 0302 4846     		mov	r0, r9
 1865              	.LVL181:
2213:lwIP/src/apps/http/httpd.c ****           MEMCPY(&http_uri_buf[copy_len], httpd_default_filenames[loop].name, name_copy_len);
 1866              		.loc 1 2213 18 view .LVU637
 1867 0304 5C45     		cmp	r4, fp
 1868 0306 28BF     		it	cs
 1869 0308 5C46     		movcs	r4, fp
 1870              	.LVL182:
ARM GAS  /tmp/ccQlnpyR.s 			page 91


2214:lwIP/src/apps/http/httpd.c ****           http_uri_buf[copy_len + name_copy_len] = 0;
 1871              		.loc 1 2214 11 is_stmt 1 view .LVU638
 1872 030a 2246     		mov	r2, r4
 1873 030c FFF7FEFF 		bl	memcpy
 1874              	.LVL183:
2215:lwIP/src/apps/http/httpd.c ****         }
 1875              		.loc 1 2215 11 view .LVU639
2215:lwIP/src/apps/http/httpd.c ****         }
 1876              		.loc 1 2215 50 is_stmt 0 view .LVU640
 1877 0310 029B     		ldr	r3, [sp, #8]
 1878              	.LBE191:
 1879              	.LBE195:
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1880              		.loc 1 2224 13 view .LVU641
 1881 0312 3946     		mov	r1, r7
 1882 0314 5046     		mov	r0, r10
 1883              	.LBB196:
 1884              	.LBB192:
2215:lwIP/src/apps/http/httpd.c ****         }
 1885              		.loc 1 2215 50 view .LVU642
 1886 0316 09F80430 		strb	r3, [r9, r4]
 1887              	.LVL184:
2215:lwIP/src/apps/http/httpd.c ****         }
 1888              		.loc 1 2215 50 view .LVU643
 1889              	.LBE192:
 1890              	.LBE196:
2223:lwIP/src/apps/http/httpd.c ****       err = fs_open(&hs->file_handle, file_name);
 1891              		.loc 1 2223 84 is_stmt 1 view .LVU644
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1892              		.loc 1 2224 7 view .LVU645
2224:lwIP/src/apps/http/httpd.c ****       if (err == ERR_OK) {
 1893              		.loc 1 2224 13 is_stmt 0 view .LVU646
 1894 031a FFF7FEFF 		bl	fs_open
 1895              	.LVL185:
 1896              	.LBE201:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1897              		.loc 1 2206 50 is_stmt 1 view .LVU647
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1898              		.loc 1 2206 20 view .LVU648
 1899              	.LBB202:
2225:lwIP/src/apps/http/httpd.c ****         uri = file_name;
 1900              		.loc 1 2225 7 view .LVU649
2225:lwIP/src/apps/http/httpd.c ****         uri = file_name;
 1901              		.loc 1 2225 10 is_stmt 0 view .LVU650
 1902 031e 30B1     		cbz	r0, .L195
 1903              	.LBE202:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1904              		.loc 1 2206 5 view .LVU651
 1905 0320 124B     		ldr	r3, .L212+52
 1906 0322 9D42     		cmp	r5, r3
 1907 0324 E5D1     		bne	.L102
 1908 0326 5446     		mov	r4, r10
 1909              	.LVL186:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1910              		.loc 1 2206 5 view .LVU652
 1911 0328 DDE900A5 		ldrd	r10, r5, [sp]
 1912              	.LVL187:
ARM GAS  /tmp/ccQlnpyR.s 			page 92


2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1913              		.loc 1 2206 5 view .LVU653
 1914 032c 0FE7     		b	.L94
 1915              	.LVL188:
 1916              	.L195:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1917              		.loc 1 2206 5 view .LVU654
 1918 032e 5446     		mov	r4, r10
 1919              	.LVL189:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1920              		.loc 1 2206 5 view .LVU655
 1921 0330 DDE900A5 		ldrd	r10, r5, [sp]
 1922              	.LVL190:
2206:lwIP/src/apps/http/httpd.c ****       const char *file_name;
 1923              		.loc 1 2206 5 view .LVU656
 1924 0334 18E7     		b	.L104
 1925              	.L213:
 1926 0336 00BF     		.align	2
 1927              	.L212:
 1928 0338 00000000 		.word	.LANCHOR0
 1929 033c 00000000 		.word	.LC1
 1930 0340 04000000 		.word	.LC2
 1931 0344 0C000000 		.word	.LC3
 1932 0348 10000000 		.word	.LC4
 1933 034c 00000000 		.word	.LANCHOR1
 1934 0350 3C000000 		.word	.LC8
 1935 0354 18000000 		.word	.LC5
 1936 0358 24000000 		.word	.LC6
 1937 035c 30000000 		.word	.LC7
 1938 0360 70000000 		.word	.LC10
 1939 0364 50000000 		.word	.LC9
 1940 0368 00000000 		.word	.LANCHOR2
 1941 036c 28000000 		.word	.LANCHOR2+40
 1942              	.LBE210:
 1943              	.LBE214:
 1944              	.LBE218:
 1945              	.LBE222:
 1946              	.LBE226:
 1947              	.LBE231:
 1948              	.LBE236:
 1949              	.LBE238:
 1950              	.LBE240:
 1951              	.LBE244:
 1952              		.cfi_endproc
 1953              	.LFE123:
 1955              		.section	.text.http_poll,"ax",%progbits
 1956              		.align	1
 1957              		.p2align 2,,3
 1958              		.syntax unified
 1959              		.thumb
 1960              		.thumb_func
 1961              		.fpu fpv4-sp-d16
 1963              	http_poll:
 1964              	.LVL191:
 1965              	.LFB122:
2469:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 1966              		.loc 1 2469 1 is_stmt 1 view -0
ARM GAS  /tmp/ccQlnpyR.s 			page 93


 1967              		.cfi_startproc
 1968              		@ args = 0, pretend = 0, frame = 0
 1969              		@ frame_needed = 0, uses_anonymous_args = 0
2470:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_poll: pcb=%p hs=%p pcb_state=%s\n",
 1970              		.loc 1 2470 3 view .LVU658
2472:lwIP/src/apps/http/httpd.c **** 
 1971              		.loc 1 2472 91 view .LVU659
2474:lwIP/src/apps/http/httpd.c ****     err_t closed;
 1972              		.loc 1 2474 3 view .LVU660
2469:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 1973              		.loc 1 2469 1 is_stmt 0 view .LVU661
 1974 0000 38B5     		push	{r3, r4, r5, lr}
 1975              	.LCFI13:
 1976              		.cfi_def_cfa_offset 16
 1977              		.cfi_offset 3, -16
 1978              		.cfi_offset 4, -12
 1979              		.cfi_offset 5, -8
 1980              		.cfi_offset 14, -4
2474:lwIP/src/apps/http/httpd.c ****     err_t closed;
 1981              		.loc 1 2474 6 view .LVU662
 1982 0002 0446     		mov	r4, r0
2469:lwIP/src/apps/http/httpd.c ****   struct http_state *hs = (struct http_state *)arg;
 1983              		.loc 1 2469 1 view .LVU663
 1984 0004 0D46     		mov	r5, r1
2474:lwIP/src/apps/http/httpd.c ****     err_t closed;
 1985              		.loc 1 2474 6 view .LVU664
 1986 0006 D8B1     		cbz	r0, .L227
2488:lwIP/src/apps/http/httpd.c ****     if (hs->retries == HTTPD_MAX_RETRIES) {
 1987              		.loc 1 2488 5 is_stmt 1 view .LVU665
2488:lwIP/src/apps/http/httpd.c ****     if (hs->retries == HTTPD_MAX_RETRIES) {
 1988              		.loc 1 2488 16 is_stmt 0 view .LVU666
 1989 0008 90F82830 		ldrb	r3, [r0, #40]	@ zero_extendqisi2
 1990 000c 0133     		adds	r3, r3, #1
 1991 000e DBB2     		uxtb	r3, r3
2489:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("http_poll: too many retries, close\n"));
 1992              		.loc 1 2489 8 view .LVU667
 1993 0010 042B     		cmp	r3, #4
2488:lwIP/src/apps/http/httpd.c ****     if (hs->retries == HTTPD_MAX_RETRIES) {
 1994              		.loc 1 2488 16 view .LVU668
 1995 0012 80F82830 		strb	r3, [r0, #40]
2489:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("http_poll: too many retries, close\n"));
 1996              		.loc 1 2489 5 is_stmt 1 view .LVU669
2489:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG, ("http_poll: too many retries, close\n"));
 1997              		.loc 1 2489 8 is_stmt 0 view .LVU670
 1998 0016 0DD0     		beq	.L228
2498:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_poll: try to send more data\n"));
 1999              		.loc 1 2498 5 is_stmt 1 view .LVU671
2498:lwIP/src/apps/http/httpd.c ****       LWIP_DEBUGF(HTTPD_DEBUG | LWIP_DBG_TRACE, ("http_poll: try to send more data\n"));
 2000              		.loc 1 2498 8 is_stmt 0 view .LVU672
 2001 0018 4369     		ldr	r3, [r0, #20]
 2002 001a 23B1     		cbz	r3, .L217
2499:lwIP/src/apps/http/httpd.c ****       if (http_send(pcb, hs)) {
 2003              		.loc 1 2499 88 is_stmt 1 view .LVU673
2500:lwIP/src/apps/http/httpd.c ****         /* If we wrote anything to be sent, go ahead and send it now. */
 2004              		.loc 1 2500 7 view .LVU674
2500:lwIP/src/apps/http/httpd.c ****         /* If we wrote anything to be sent, go ahead and send it now. */
 2005              		.loc 1 2500 11 is_stmt 0 view .LVU675
ARM GAS  /tmp/ccQlnpyR.s 			page 94


 2006 001c 0146     		mov	r1, r0
 2007              	.LVL192:
2500:lwIP/src/apps/http/httpd.c ****         /* If we wrote anything to be sent, go ahead and send it now. */
 2008              		.loc 1 2500 11 view .LVU676
 2009 001e 2846     		mov	r0, r5
 2010              	.LVL193:
2500:lwIP/src/apps/http/httpd.c ****         /* If we wrote anything to be sent, go ahead and send it now. */
 2011              		.loc 1 2500 11 view .LVU677
 2012 0020 FFF7FEFF 		bl	http_send
 2013              	.LVL194:
2500:lwIP/src/apps/http/httpd.c ****         /* If we wrote anything to be sent, go ahead and send it now. */
 2014              		.loc 1 2500 10 view .LVU678
 2015 0024 08B9     		cbnz	r0, .L229
 2016              	.L217:
2509:lwIP/src/apps/http/httpd.c **** 
 2017              		.loc 1 2509 1 view .LVU679
 2018 0026 0020     		movs	r0, #0
 2019 0028 38BD     		pop	{r3, r4, r5, pc}
 2020              	.LVL195:
 2021              	.L229:
2502:lwIP/src/apps/http/httpd.c ****         altcp_output(pcb);
 2022              		.loc 1 2502 68 is_stmt 1 view .LVU680
2503:lwIP/src/apps/http/httpd.c ****       }
 2023              		.loc 1 2503 9 view .LVU681
 2024 002a 2846     		mov	r0, r5
 2025 002c FFF7FEFF 		bl	tcp_output
 2026              	.LVL196:
2509:lwIP/src/apps/http/httpd.c **** 
 2027              		.loc 1 2509 1 is_stmt 0 view .LVU682
 2028 0030 0020     		movs	r0, #0
 2029 0032 38BD     		pop	{r3, r4, r5, pc}
 2030              	.LVL197:
 2031              	.L228:
2490:lwIP/src/apps/http/httpd.c ****       http_close_conn(pcb, hs);
 2032              		.loc 1 2490 73 is_stmt 1 view .LVU683
2491:lwIP/src/apps/http/httpd.c ****       return ERR_OK;
 2033              		.loc 1 2491 7 view .LVU684
 2034              	.LBB262:
 2035              	.LBI262:
 646:lwIP/src/apps/http/httpd.c **** {
 2036              		.loc 1 646 1 view .LVU685
 2037              	.LBB263:
 648:lwIP/src/apps/http/httpd.c **** }
 2038              		.loc 1 648 3 view .LVU686
 648:lwIP/src/apps/http/httpd.c **** }
 2039              		.loc 1 648 10 is_stmt 0 view .LVU687
 2040 0034 0146     		mov	r1, r0
 2041              	.LVL198:
 648:lwIP/src/apps/http/httpd.c **** }
 2042              		.loc 1 648 10 view .LVU688
 2043 0036 2846     		mov	r0, r5
 2044              	.LVL199:
 648:lwIP/src/apps/http/httpd.c **** }
 2045              		.loc 1 648 10 view .LVU689
 2046 0038 FFF7FEFF 		bl	http_close_or_abort_conn.constprop.0
 2047              	.LVL200:
 648:lwIP/src/apps/http/httpd.c **** }
ARM GAS  /tmp/ccQlnpyR.s 			page 95


 2048              		.loc 1 648 10 view .LVU690
 2049              	.LBE263:
 2050              	.LBE262:
2492:lwIP/src/apps/http/httpd.c ****     }
 2051              		.loc 1 2492 7 is_stmt 1 view .LVU691
2509:lwIP/src/apps/http/httpd.c **** 
 2052              		.loc 1 2509 1 is_stmt 0 view .LVU692
 2053 003c 0020     		movs	r0, #0
 2054 003e 38BD     		pop	{r3, r4, r5, pc}
 2055              	.LVL201:
 2056              	.L227:
 2057              	.LBB264:
 2058              	.LBI264:
2468:lwIP/src/apps/http/httpd.c **** {
 2059              		.loc 1 2468 1 is_stmt 1 view .LVU693
 2060              	.LBB265:
 2061              	.LBB266:
2475:lwIP/src/apps/http/httpd.c ****     /* arg is null, close. */
 2062              		.loc 1 2475 5 view .LVU694
2477:lwIP/src/apps/http/httpd.c ****     closed = http_close_conn(pcb, NULL);
 2063              		.loc 1 2477 66 view .LVU695
2478:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(closed);
 2064              		.loc 1 2478 5 view .LVU696
 2065              	.LBB267:
 2066              	.LBI267:
 646:lwIP/src/apps/http/httpd.c **** {
 2067              		.loc 1 646 1 view .LVU697
 2068              	.LBE267:
 2069              	.LBE266:
 2070              	.LBE265:
 2071              	.LBE264:
 648:lwIP/src/apps/http/httpd.c **** }
 2072              		.loc 1 648 3 view .LVU698
 2073              	.LBB273:
 2074              	.LBB272:
 2075              	.LBB271:
 2076              	.LBB270:
 2077              	.LBB268:
 2078              	.LBI268:
 596:lwIP/src/apps/http/httpd.c **** {
 2079              		.loc 1 596 1 view .LVU699
 2080              	.LBB269:
 598:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("Closing connection %p\n", (void *)pcb));
 2081              		.loc 1 598 3 view .LVU700
 599:lwIP/src/apps/http/httpd.c **** 
 2082              		.loc 1 599 69 view .LVU701
 616:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 2083              		.loc 1 616 3 view .LVU702
 2084 0040 0146     		mov	r1, r0
 2085              	.LVL202:
 616:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 2086              		.loc 1 616 3 is_stmt 0 view .LVU703
 2087 0042 2846     		mov	r0, r5
 2088              	.LVL203:
 616:lwIP/src/apps/http/httpd.c ****   altcp_recv(pcb, NULL);
 2089              		.loc 1 616 3 view .LVU704
 2090 0044 FFF7FEFF 		bl	tcp_arg
ARM GAS  /tmp/ccQlnpyR.s 			page 96


 2091              	.LVL204:
 617:lwIP/src/apps/http/httpd.c ****   altcp_err(pcb, NULL);
 2092              		.loc 1 617 3 is_stmt 1 view .LVU705
 2093 0048 2146     		mov	r1, r4
 2094 004a 2846     		mov	r0, r5
 2095 004c FFF7FEFF 		bl	tcp_recv
 2096              	.LVL205:
 618:lwIP/src/apps/http/httpd.c ****   altcp_poll(pcb, NULL, 0);
 2097              		.loc 1 618 3 view .LVU706
 2098 0050 2146     		mov	r1, r4
 2099 0052 2846     		mov	r0, r5
 2100 0054 FFF7FEFF 		bl	tcp_err
 2101              	.LVL206:
 619:lwIP/src/apps/http/httpd.c ****   altcp_sent(pcb, NULL);
 2102              		.loc 1 619 3 view .LVU707
 2103 0058 2246     		mov	r2, r4
 2104 005a 2146     		mov	r1, r4
 2105 005c 2846     		mov	r0, r5
 2106 005e FFF7FEFF 		bl	tcp_poll
 2107              	.LVL207:
 620:lwIP/src/apps/http/httpd.c ****   if (hs != NULL) {
 2108              		.loc 1 620 3 view .LVU708
 2109 0062 2846     		mov	r0, r5
 2110 0064 2146     		mov	r1, r4
 2111 0066 FFF7FEFF 		bl	tcp_sent
 2112              	.LVL208:
 621:lwIP/src/apps/http/httpd.c ****     http_state_free(hs);
 2113              		.loc 1 621 3 view .LVU709
 625:lwIP/src/apps/http/httpd.c ****     altcp_abort(pcb);
 2114              		.loc 1 625 3 view .LVU710
 629:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 2115              		.loc 1 629 3 view .LVU711
 629:lwIP/src/apps/http/httpd.c ****   if (err != ERR_OK) {
 2116              		.loc 1 629 9 is_stmt 0 view .LVU712
 2117 006a 2846     		mov	r0, r5
 2118 006c FFF7FEFF 		bl	tcp_close
 2119              	.LVL209:
 630:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error %d closing %p\n", err, (void *)pcb));
 2120              		.loc 1 630 3 is_stmt 1 view .LVU713
 630:lwIP/src/apps/http/httpd.c ****     LWIP_DEBUGF(HTTPD_DEBUG, ("Error %d closing %p\n", err, (void *)pcb));
 2121              		.loc 1 630 6 is_stmt 0 view .LVU714
 2122 0070 0028     		cmp	r0, #0
 2123 0072 D8D0     		beq	.L217
 631:lwIP/src/apps/http/httpd.c ****     /* error closing, try again later in poll */
 2124              		.loc 1 631 74 is_stmt 1 view .LVU715
 633:lwIP/src/apps/http/httpd.c ****   }
 2125              		.loc 1 633 5 view .LVU716
 2126 0074 2846     		mov	r0, r5
 2127              	.LVL210:
 633:lwIP/src/apps/http/httpd.c ****   }
 2128              		.loc 1 633 5 is_stmt 0 view .LVU717
 2129 0076 0422     		movs	r2, #4
 2130 0078 0149     		ldr	r1, .L230
 2131 007a FFF7FEFF 		bl	tcp_poll
 2132              	.LVL211:
 2133 007e D2E7     		b	.L217
 2134              	.L231:
ARM GAS  /tmp/ccQlnpyR.s 			page 97


 2135              		.align	2
 2136              	.L230:
 2137 0080 00000000 		.word	http_poll
 2138              	.LBE269:
 2139              	.LBE268:
 2140              	.LBE270:
 2141              	.LBE271:
 2142              	.LBE272:
 2143              	.LBE273:
 2144              		.cfi_endproc
 2145              	.LFE122:
 2147              		.section	.rodata.httpd_init.str1.4,"aMS",%progbits,1
 2148              		.align	2
 2149              	.LC11:
 2150 0000 68747470 		.ascii	"httpd_init: tcp_new failed\000"
 2150      645F696E 
 2150      69743A20 
 2150      7463705F 
 2150      6E657720 
 2151 001b 00       		.align	2
 2152              	.LC12:
 2153 001c 68747470 		.ascii	"httpd_init: tcp_bind failed\000"
 2153      645F696E 
 2153      69743A20 
 2153      7463705F 
 2153      62696E64 
 2154              		.align	2
 2155              	.LC13:
 2156 0038 68747470 		.ascii	"httpd_init: tcp_listen failed\000"
 2156      645F696E 
 2156      69743A20 
 2156      7463705F 
 2156      6C697374 
 2157              		.section	.text.httpd_init,"ax",%progbits
 2158              		.align	1
 2159              		.p2align 2,,3
 2160              		.global	httpd_init
 2161              		.syntax unified
 2162              		.thumb
 2163              		.thumb_func
 2164              		.fpu fpv4-sp-d16
 2166              	httpd_init:
 2167              	.LFB126:
2636:lwIP/src/apps/http/httpd.c **** 
2637:lwIP/src/apps/http/httpd.c **** static void
2638:lwIP/src/apps/http/httpd.c **** httpd_init_pcb(struct altcp_pcb *pcb, u16_t port)
2639:lwIP/src/apps/http/httpd.c **** {
2640:lwIP/src/apps/http/httpd.c ****   err_t err;
2641:lwIP/src/apps/http/httpd.c **** 
2642:lwIP/src/apps/http/httpd.c ****   if (pcb) {
2643:lwIP/src/apps/http/httpd.c ****     altcp_setprio(pcb, HTTPD_TCP_PRIO);
2644:lwIP/src/apps/http/httpd.c ****     /* set SOF_REUSEADDR here to explicitly bind httpd to multiple interfaces */
2645:lwIP/src/apps/http/httpd.c ****     err = altcp_bind(pcb, IP_ANY_TYPE, port);
2646:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(err); /* in case of LWIP_NOASSERT */
2647:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("httpd_init: tcp_bind failed", err == ERR_OK);
2648:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
2649:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("httpd_init: tcp_listen failed", pcb != NULL);
ARM GAS  /tmp/ccQlnpyR.s 			page 98


2650:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
2651:lwIP/src/apps/http/httpd.c ****   }
2652:lwIP/src/apps/http/httpd.c **** }
2653:lwIP/src/apps/http/httpd.c **** 
2654:lwIP/src/apps/http/httpd.c **** /**
2655:lwIP/src/apps/http/httpd.c ****  * @ingroup httpd
2656:lwIP/src/apps/http/httpd.c ****  * Initialize the httpd: set up a listening PCB and bind it to the defined port
2657:lwIP/src/apps/http/httpd.c ****  */
2658:lwIP/src/apps/http/httpd.c **** void
2659:lwIP/src/apps/http/httpd.c **** httpd_init(void)
2660:lwIP/src/apps/http/httpd.c **** {
 2168              		.loc 1 2660 1 is_stmt 1 view -0
 2169              		.cfi_startproc
 2170              		@ args = 0, pretend = 0, frame = 0
 2171              		@ frame_needed = 0, uses_anonymous_args = 0
2661:lwIP/src/apps/http/httpd.c ****   struct altcp_pcb *pcb;
 2172              		.loc 1 2661 3 view .LVU719
2662:lwIP/src/apps/http/httpd.c **** 
2663:lwIP/src/apps/http/httpd.c **** #if HTTPD_USE_MEM_POOL
2664:lwIP/src/apps/http/httpd.c ****   LWIP_MEMPOOL_INIT(HTTPD_STATE);
2665:lwIP/src/apps/http/httpd.c **** #if LWIP_HTTPD_SSI
2666:lwIP/src/apps/http/httpd.c ****   LWIP_MEMPOOL_INIT(HTTPD_SSI_STATE);
2667:lwIP/src/apps/http/httpd.c **** #endif
2668:lwIP/src/apps/http/httpd.c **** #endif
2669:lwIP/src/apps/http/httpd.c ****   LWIP_DEBUGF(HTTPD_DEBUG, ("httpd_init\n"));
 2173              		.loc 1 2669 45 view .LVU720
2670:lwIP/src/apps/http/httpd.c **** 
2671:lwIP/src/apps/http/httpd.c ****   /* LWIP_ASSERT_CORE_LOCKED(); is checked by tcp_new() */
2672:lwIP/src/apps/http/httpd.c **** 
2673:lwIP/src/apps/http/httpd.c ****   pcb = altcp_tcp_new_ip_type(IPADDR_TYPE_ANY);
 2174              		.loc 1 2673 3 view .LVU721
2660:lwIP/src/apps/http/httpd.c ****   struct altcp_pcb *pcb;
 2175              		.loc 1 2660 1 is_stmt 0 view .LVU722
 2176 0000 10B5     		push	{r4, lr}
 2177              	.LCFI14:
 2178              		.cfi_def_cfa_offset 8
 2179              		.cfi_offset 4, -8
 2180              		.cfi_offset 14, -4
 2181              		.loc 1 2673 9 view .LVU723
 2182 0002 2E20     		movs	r0, #46
 2183 0004 FFF7FEFF 		bl	tcp_new_ip_type
 2184              	.LVL212:
2674:lwIP/src/apps/http/httpd.c ****   LWIP_ASSERT("httpd_init: tcp_new failed", pcb != NULL);
 2185              		.loc 1 2674 3 is_stmt 1 view .LVU724
 2186              		.loc 1 2674 3 view .LVU725
 2187 0008 98B1     		cbz	r0, .L240
 2188              		.loc 1 2674 3 view .LVU726
2675:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2189              		.loc 1 2675 3 view .LVU727
 2190 000a 0446     		mov	r4, r0
 2191              	.LVL213:
 2192              	.LBB276:
 2193              	.LBI276:
2638:lwIP/src/apps/http/httpd.c **** {
 2194              		.loc 1 2638 1 view .LVU728
 2195              	.LBB277:
2640:lwIP/src/apps/http/httpd.c **** 
ARM GAS  /tmp/ccQlnpyR.s 			page 99


 2196              		.loc 1 2640 3 view .LVU729
2642:lwIP/src/apps/http/httpd.c ****     altcp_setprio(pcb, HTTPD_TCP_PRIO);
 2197              		.loc 1 2642 3 view .LVU730
2643:lwIP/src/apps/http/httpd.c ****     /* set SOF_REUSEADDR here to explicitly bind httpd to multiple interfaces */
 2198              		.loc 1 2643 5 view .LVU731
 2199 000c 0121     		movs	r1, #1
 2200 000e FFF7FEFF 		bl	tcp_setprio
 2201              	.LVL214:
2645:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(err); /* in case of LWIP_NOASSERT */
 2202              		.loc 1 2645 5 view .LVU732
2645:lwIP/src/apps/http/httpd.c ****     LWIP_UNUSED_ARG(err); /* in case of LWIP_NOASSERT */
 2203              		.loc 1 2645 11 is_stmt 0 view .LVU733
 2204 0012 5022     		movs	r2, #80
 2205 0014 0D49     		ldr	r1, .L243
 2206 0016 2046     		mov	r0, r4
 2207 0018 FFF7FEFF 		bl	tcp_bind
 2208              	.LVL215:
2646:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("httpd_init: tcp_bind failed", err == ERR_OK);
 2209              		.loc 1 2646 5 is_stmt 1 view .LVU734
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2210              		.loc 1 2647 5 view .LVU735
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2211              		.loc 1 2647 5 view .LVU736
 2212 001c 68B9     		cbnz	r0, .L241
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2213              		.loc 1 2647 5 view .LVU737
2648:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("httpd_init: tcp_listen failed", pcb != NULL);
 2214              		.loc 1 2648 5 view .LVU738
2648:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("httpd_init: tcp_listen failed", pcb != NULL);
 2215              		.loc 1 2648 11 is_stmt 0 view .LVU739
 2216 001e 2046     		mov	r0, r4
 2217              	.LVL216:
2648:lwIP/src/apps/http/httpd.c ****     LWIP_ASSERT("httpd_init: tcp_listen failed", pcb != NULL);
 2218              		.loc 1 2648 11 view .LVU740
 2219 0020 FF21     		movs	r1, #255
 2220 0022 FFF7FEFF 		bl	tcp_listen_with_backlog
 2221              	.LVL217:
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2222              		.loc 1 2649 5 is_stmt 1 view .LVU741
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2223              		.loc 1 2649 5 view .LVU742
 2224 0026 60B1     		cbz	r0, .L242
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2225              		.loc 1 2649 5 view .LVU743
2650:lwIP/src/apps/http/httpd.c ****   }
 2226              		.loc 1 2650 5 view .LVU744
 2227 0028 0949     		ldr	r1, .L243+4
 2228              	.LBE277:
 2229              	.LBE276:
2676:lwIP/src/apps/http/httpd.c **** }
 2230              		.loc 1 2676 1 is_stmt 0 view .LVU745
 2231 002a BDE81040 		pop	{r4, lr}
 2232              	.LCFI15:
 2233              		.cfi_remember_state
 2234              		.cfi_restore 14
 2235              		.cfi_restore 4
 2236              		.cfi_def_cfa_offset 0
ARM GAS  /tmp/ccQlnpyR.s 			page 100


 2237              	.LVL218:
 2238              	.LBB280:
 2239              	.LBB278:
2650:lwIP/src/apps/http/httpd.c ****   }
 2240              		.loc 1 2650 5 view .LVU746
 2241 002e FFF7FEBF 		b	tcp_accept
 2242              	.LVL219:
 2243              	.L240:
 2244              	.LCFI16:
 2245              		.cfi_restore_state
2650:lwIP/src/apps/http/httpd.c ****   }
 2246              		.loc 1 2650 5 view .LVU747
 2247              	.LBE278:
 2248              	.LBE280:
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2249              		.loc 1 2674 3 is_stmt 1 discriminator 1 view .LVU748
 2250 0032 0848     		ldr	r0, .L243+8
 2251              	.LVL220:
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2252              		.loc 1 2674 3 is_stmt 0 discriminator 1 view .LVU749
 2253 0034 FFF7FEFF 		bl	printf
 2254              	.LVL221:
 2255              	.L234:
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2256              		.loc 1 2674 3 is_stmt 1 discriminator 1 view .LVU750
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2257              		.loc 1 2674 3 discriminator 1 view .LVU751
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2258              		.loc 1 2674 3 discriminator 1 view .LVU752
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2259              		.loc 1 2674 3 discriminator 1 view .LVU753
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2260              		.loc 1 2674 3 discriminator 1 view .LVU754
2674:lwIP/src/apps/http/httpd.c ****   httpd_init_pcb(pcb, HTTPD_SERVER_PORT);
 2261              		.loc 1 2674 3 discriminator 1 view .LVU755
 2262 0038 FEE7     		b	.L234
 2263              	.LVL222:
 2264              	.L241:
 2265              	.LBB281:
 2266              	.LBB279:
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2267              		.loc 1 2647 5 view .LVU756
 2268 003a 0748     		ldr	r0, .L243+12
 2269              	.LVL223:
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2270              		.loc 1 2647 5 is_stmt 0 view .LVU757
 2271 003c FFF7FEFF 		bl	printf
 2272              	.LVL224:
 2273              	.L236:
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2274              		.loc 1 2647 5 is_stmt 1 view .LVU758
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2275              		.loc 1 2647 5 view .LVU759
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2276              		.loc 1 2647 5 view .LVU760
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2277              		.loc 1 2647 5 view .LVU761
ARM GAS  /tmp/ccQlnpyR.s 			page 101


2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2278              		.loc 1 2647 5 view .LVU762
2647:lwIP/src/apps/http/httpd.c ****     pcb = altcp_listen(pcb);
 2279              		.loc 1 2647 5 view .LVU763
 2280 0040 FEE7     		b	.L236
 2281              	.LVL225:
 2282              	.L242:
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2283              		.loc 1 2649 5 view .LVU764
 2284 0042 0648     		ldr	r0, .L243+16
 2285              	.LVL226:
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2286              		.loc 1 2649 5 is_stmt 0 view .LVU765
 2287 0044 FFF7FEFF 		bl	printf
 2288              	.LVL227:
 2289              	.L238:
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2290              		.loc 1 2649 5 is_stmt 1 view .LVU766
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2291              		.loc 1 2649 5 view .LVU767
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2292              		.loc 1 2649 5 view .LVU768
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2293              		.loc 1 2649 5 view .LVU769
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2294              		.loc 1 2649 5 view .LVU770
2649:lwIP/src/apps/http/httpd.c ****     altcp_accept(pcb, http_accept);
 2295              		.loc 1 2649 5 view .LVU771
 2296 0048 FEE7     		b	.L238
 2297              	.L244:
 2298 004a 00BF     		.align	2
 2299              	.L243:
 2300 004c 00000000 		.word	ip_addr_any
 2301 0050 00000000 		.word	http_accept
 2302 0054 00000000 		.word	.LC11
 2303 0058 1C000000 		.word	.LC12
 2304 005c 38000000 		.word	.LC13
 2305              	.LBE279:
 2306              	.LBE281:
 2307              		.cfi_endproc
 2308              	.LFE126:
 2310              		.section	.rodata.str1.4,"aMS",%progbits,1
 2311              		.align	2
 2312              	.LC14:
 2313 0000 2F696E64 		.ascii	"/index.shtml\000"
 2313      65782E73 
 2313      68746D6C 
 2313      00
 2314 000d 000000   		.align	2
 2315              	.LC15:
 2316 0010 2F696E64 		.ascii	"/index.ssi\000"
 2316      65782E73 
 2316      736900
 2317 001b 00       		.align	2
 2318              	.LC16:
 2319 001c 2F696E64 		.ascii	"/index.shtm\000"
 2319      65782E73 
ARM GAS  /tmp/ccQlnpyR.s 			page 102


 2319      68746D00 
 2320              		.align	2
 2321              	.LC17:
 2322 0028 2F696E64 		.ascii	"/index.html\000"
 2322      65782E68 
 2322      746D6C00 
 2323              		.align	2
 2324              	.LC18:
 2325 0034 2F696E64 		.ascii	"/index.htm\000"
 2325      65782E68 
 2325      746D00
 2326              		.section	.bss.http_uri_buf,"aw",%nobits
 2327              		.align	2
 2328              		.set	.LANCHOR1,. + 0
 2331              	http_uri_buf:
 2332 0000 00000000 		.space	64
 2332      00000000 
 2332      00000000 
 2332      00000000 
 2332      00000000 
 2333              		.section	.bss.httpd_req_buf,"aw",%nobits
 2334              		.align	2
 2335              		.set	.LANCHOR0,. + 0
 2338              	httpd_req_buf:
 2339 0000 00000000 		.space	1024
 2339      00000000 
 2339      00000000 
 2339      00000000 
 2339      00000000 
 2340              		.section	.rodata.httpd_default_filenames,"a"
 2341              		.align	2
 2342              		.set	.LANCHOR2,. + 0
 2345              	httpd_default_filenames:
 2346 0000 00000000 		.word	.LC14
 2347 0004 01       		.byte	1
 2348 0005 000000   		.space	3
 2349 0008 10000000 		.word	.LC15
 2350 000c 01       		.byte	1
 2351 000d 000000   		.space	3
 2352 0010 1C000000 		.word	.LC16
 2353 0014 01       		.byte	1
 2354 0015 000000   		.space	3
 2355 0018 28000000 		.word	.LC17
 2356 001c 00       		.byte	0
 2357 001d 000000   		.space	3
 2358 0020 34000000 		.word	.LC18
 2359 0024 00       		.byte	0
 2360 0025 000000   		.space	3
 2361              		.text
 2362              	.Letext0:
 2363              		.file 2 "/usr/lib/gcc/arm-none-eabi/9.2.0/include/stddef.h"
 2364              		.file 3 "/usr/arm-none-eabi/include/machine/_default_types.h"
 2365              		.file 4 "/usr/arm-none-eabi/include/sys/lock.h"
 2366              		.file 5 "/usr/arm-none-eabi/include/sys/_types.h"
 2367              		.file 6 "/usr/arm-none-eabi/include/sys/reent.h"
 2368              		.file 7 "/usr/arm-none-eabi/include/stdlib.h"
 2369              		.file 8 "/usr/arm-none-eabi/include/sys/_stdint.h"
ARM GAS  /tmp/ccQlnpyR.s 			page 103


 2370              		.file 9 "lwIP/src/include/lwip/arch.h"
 2371              		.file 10 "/usr/arm-none-eabi/include/ctype.h"
 2372              		.file 11 "lwIP/src/include/lwip/err.h"
 2373              		.file 12 "lwIP/src/include/lwip/pbuf.h"
 2374              		.file 13 "lwIP/src/include/lwip/memp.h"
 2375              		.file 14 "lwIP/src/include/lwip/priv/memp_priv.h"
 2376              		.file 15 "lwIP/src/include/lwip/apps/fs.h"
 2377              		.file 16 "lwIP/src/include/lwip/tcpbase.h"
 2378              		.file 17 "lwIP/src/include/lwip/prot/iana.h"
 2379              		.file 18 "lwIP/src/include/lwip/ip4_addr.h"
 2380              		.file 19 "lwIP/src/include/lwip/ip_addr.h"
 2381              		.file 20 "lwIP/src/include/lwip/netif.h"
 2382              		.file 21 "lwIP/src/include/lwip/prot/ip4.h"
 2383              		.file 22 "lwIP/src/include/lwip/ip.h"
 2384              		.file 23 "lwIP/src/include/lwip/tcp.h"
 2385              		.file 24 "/usr/arm-none-eabi/include/stdio.h"
 2386              		.file 25 "lwIP/src/include/lwip/mem.h"
 2387              		.file 26 "lwIP/src/include/lwip/def.h"
 2388              		.file 27 "/usr/arm-none-eabi/include/string.h"
 2389              		.file 28 "<built-in>"
ARM GAS  /tmp/ccQlnpyR.s 			page 104


DEFINED SYMBOLS
                            *ABS*:0000000000000000 httpd.c
     /tmp/ccQlnpyR.s:18     .text.http_accept:0000000000000000 $t
     /tmp/ccQlnpyR.s:26     .text.http_accept:0000000000000000 http_accept
     /tmp/ccQlnpyR.s:163    .text.http_accept:000000000000006c $d
     /tmp/ccQlnpyR.s:863    .text.http_recv:0000000000000000 http_recv
     /tmp/ccQlnpyR.s:178    .text.http_err:0000000000000000 http_err
     /tmp/ccQlnpyR.s:1963   .text.http_poll:0000000000000000 http_poll
     /tmp/ccQlnpyR.s:781    .text.http_sent:0000000000000000 http_sent
     /tmp/ccQlnpyR.s:171    .text.http_err:0000000000000000 $t
     /tmp/ccQlnpyR.s:283    .text.http_close_or_abort_conn.constprop.0:0000000000000000 $t
     /tmp/ccQlnpyR.s:290    .text.http_close_or_abort_conn.constprop.0:0000000000000000 http_close_or_abort_conn.constprop.0
     /tmp/ccQlnpyR.s:432    .text.http_close_or_abort_conn.constprop.0:000000000000006c $d
     /tmp/ccQlnpyR.s:437    .rodata.http_send.str1.4:0000000000000000 $d
     /tmp/ccQlnpyR.s:442    .text.http_send:0000000000000000 $t
     /tmp/ccQlnpyR.s:449    .text.http_send:0000000000000000 http_send
     /tmp/ccQlnpyR.s:767    .text.http_send:00000000000000b4 $d
     /tmp/ccQlnpyR.s:774    .text.http_sent:0000000000000000 $t
     /tmp/ccQlnpyR.s:825    .rodata.http_recv.str1.4:0000000000000000 $d
     /tmp/ccQlnpyR.s:856    .text.http_recv:0000000000000000 $t
     /tmp/ccQlnpyR.s:1928   .text.http_recv:0000000000000338 $d
     /tmp/ccQlnpyR.s:1956   .text.http_poll:0000000000000000 $t
     /tmp/ccQlnpyR.s:2137   .text.http_poll:0000000000000080 $d
     /tmp/ccQlnpyR.s:2148   .rodata.httpd_init.str1.4:0000000000000000 $d
     /tmp/ccQlnpyR.s:2158   .text.httpd_init:0000000000000000 $t
     /tmp/ccQlnpyR.s:2166   .text.httpd_init:0000000000000000 httpd_init
     /tmp/ccQlnpyR.s:2300   .text.httpd_init:000000000000004c $d
     /tmp/ccQlnpyR.s:2311   .rodata.str1.4:0000000000000000 $d
     /tmp/ccQlnpyR.s:2327   .bss.http_uri_buf:0000000000000000 $d
     /tmp/ccQlnpyR.s:2331   .bss.http_uri_buf:0000000000000000 http_uri_buf
     /tmp/ccQlnpyR.s:2334   .bss.httpd_req_buf:0000000000000000 $d
     /tmp/ccQlnpyR.s:2338   .bss.httpd_req_buf:0000000000000000 httpd_req_buf
     /tmp/ccQlnpyR.s:2341   .rodata.httpd_default_filenames:0000000000000000 $d
     /tmp/ccQlnpyR.s:2345   .rodata.httpd_default_filenames:0000000000000000 httpd_default_filenames

UNDEFINED SYMBOLS
tcp_setprio
mem_malloc
memset
tcp_arg
tcp_recv
tcp_err
tcp_poll
tcp_sent
fs_close
pbuf_free
mem_free
tcp_close
fs_bytes_left
printf
tcp_write
tcp_recved
pbuf_cat
pbuf_ref
pbuf_copy_partial
lwip_strnstr
strncmp
ARM GAS  /tmp/ccQlnpyR.s 			page 105


pbuf_clen
strlen
strchr
fs_open
memcpy
tcp_output
tcp_new_ip_type
tcp_bind
tcp_listen_with_backlog
tcp_accept
ip_addr_any
